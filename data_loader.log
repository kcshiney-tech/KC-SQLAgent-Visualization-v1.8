2025-09-01 16:22:29,003 - data_loader - DEBUG - Initialized ExcelDataSourceLoader for 20250813光模块分析.xlsx with sheets: [('工作表6', '光模块故障表')]
2025-09-01 16:22:29,004 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-09-01 16:22:29,005 - __main__ - DEBUG - Processing data source: <data_loader.ExcelDataSourceLoader object at 0x00000224539FC830>
2025-09-01 16:22:29,005 - data_loader - DEBUG - Loading Excel file: 20250813光模块分析.xlsx
2025-09-01 16:22:36,369 - data_loader - DEBUG - Reading sheet: 工作表6
2025-09-01 16:22:43,212 - data_loader - DEBUG - Columns in sheet 工作表6: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,217 - data_loader - DEBUG - Loaded sheet 工作表6 as table 光模块故障表 with 174 records
2025-09-01 16:22:43,217 - data_loader - INFO - Loaded Excel file 20250813光模块分析.xlsx with sheets: ['工作表6'] (status=0)
2025-09-01 16:22:43,218 - data_loader - INFO - Excel load completed for 20250813光模块分析.xlsx (status=0)
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sample record columns: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,244 - __main__ - INFO - Rebuilt table 光模块故障表 from 光模块故障表
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,250 - __main__ - INFO - Inserted 174 records into table 光模块故障表
2025-09-01 16:22:43,266 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:52:56,924 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:52:56,925 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:54:21,576 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:54:21,577 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:54:21,584 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:54:21,584 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:55:51,005 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:55:51,006 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:55:51,095 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:55:51,099 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:56:33,313 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:56:33,314 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:56:33,317 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:56:33,317 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,050 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,657 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,659 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,660 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,661 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,665 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,666 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,688 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,701 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.166899995761923, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:28.884Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42626, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,702 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,703 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>"}
2025-10-15 17:57:31,704 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,705 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,706 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,707 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,790 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07270179998886306}
2025-10-15 17:57:31,791 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08514739999372978}
2025-10-15 17:57:31,792 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,802 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 9.745999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,803 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,803 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:31,804 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:31.804125
2025-10-15 17:57:31,804 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,805 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005225999921094626}
2025-10-15 17:57:31,807 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,826 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.728, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,827 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,829 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,830 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,831 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,832 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006704999977955595}
2025-10-15 17:57:31,832 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,851 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.922, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,859 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,860 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:31,862 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:31,863 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:31,864 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,867 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,867 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 17:57:31,883 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002B6BADC3390>
2025-10-15 17:57:31,883 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,887 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,888 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,889 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,891 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,893 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,895 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,907 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,917 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.064999991096556, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:29.101Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42629, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,919 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,920 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>"}
2025-10-15 17:57:31,921 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,922 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,922 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,923 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,989 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05641550000291318}
2025-10-15 17:57:31,990 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0682307000097353}
2025-10-15 17:57:31,991 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,001 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 9.912, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,002 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,002 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:32,003 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:32.003461
2025-10-15 17:57:32,004 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,005 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004942999948980287}
2025-10-15 17:57:32,007 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 20.337999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,029 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,030 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,031 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,032 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006326000002445653}
2025-10-15 17:57:32,033 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,051 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 18.724, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,053 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,053 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:32,054 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:32,055 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:32,055 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:32,055 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 17:57:32,057 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,060 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,064 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,065 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,066 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,067 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,103 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 17:57:32,104 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,105 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,108 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,109 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,115 - backend.database_builder - INFO - Inserted 4 records into table 事件监控-光模块故障表
2025-10-15 17:57:32,141 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:57:32,429 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 507.1827000065241, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:44,558 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,559 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:44,560 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,560 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "remainingTimeMS": 4999}
2025-10-15 20:12:44,584 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:44,601 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.551199994864874, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.193Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42710, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:44,602 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>"}
2025-10-15 20:12:44,603 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04508509999141097}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056563300007837825}
2025-10-15 20:12:44,661 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,671 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 10.479000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,672 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,672 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:44,673 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:44.673086
2025-10-15 20:12:44,673 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,674 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00030520001018885523}
2025-10-15 20:12:44,675 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,695 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 20.1, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,696 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,696 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,697 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,697 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,698 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003618000046117231}
2025-10-15 20:12:44,698 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,758 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 60.125, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,761 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003352000057930127}
2025-10-15 20:12:44,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"getMore\": 5054377260502831866, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 274.81100000000004, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,040 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,044 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,047 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,047 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:45,049 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 20:12:45,057 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x0000021634723390>
2025-10-15 20:12:45,057 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,060 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "remainingTimeMS": 4999}
2025-10-15 20:12:45,075 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:45,089 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.31979998596944, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.681Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42713, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:45,090 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,090 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>"}
2025-10-15 20:12:45,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,091 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:45,091 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,092 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,136 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03614190001098905}
2025-10-15 20:12:45,137 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.045386199999484234}
2025-10-15 20:12:45,137 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,146 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 9.197000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,147 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,147 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:45,147 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:45.147662
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,148 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,149 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000228599994443357}
2025-10-15 20:12:45,149 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,168 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 19.352999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,169 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,170 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,170 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,171 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003893000102834776}
2025-10-15 20:12:45,171 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,232 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 61.038000000000004, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,233 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00039679999463260174}
2025-10-15 20:12:45,235 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"getMore\": 3746973641896813909, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 227.198, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,464 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,467 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,470 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,470 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,470 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,474 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,515 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 20:12:45,515 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,516 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,518 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,519 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,521 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,522 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,524 - backend.database_builder - INFO - Inserted 92 records into table 事件监控-光模块故障表
2025-10-15 20:12:45,552 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 20:12:45,607 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 515.7670000044163, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
