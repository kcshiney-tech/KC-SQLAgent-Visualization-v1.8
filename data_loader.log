2025-09-01 16:22:29,003 - data_loader - DEBUG - Initialized ExcelDataSourceLoader for 20250813光模块分析.xlsx with sheets: [('工作表6', '光模块故障表')]
2025-09-01 16:22:29,004 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-09-01 16:22:29,005 - __main__ - DEBUG - Processing data source: <data_loader.ExcelDataSourceLoader object at 0x00000224539FC830>
2025-09-01 16:22:29,005 - data_loader - DEBUG - Loading Excel file: 20250813光模块分析.xlsx
2025-09-01 16:22:36,369 - data_loader - DEBUG - Reading sheet: 工作表6
2025-09-01 16:22:43,212 - data_loader - DEBUG - Columns in sheet 工作表6: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,217 - data_loader - DEBUG - Loaded sheet 工作表6 as table 光模块故障表 with 174 records
2025-09-01 16:22:43,217 - data_loader - INFO - Loaded Excel file 20250813光模块分析.xlsx with sheets: ['工作表6'] (status=0)
2025-09-01 16:22:43,218 - data_loader - INFO - Excel load completed for 20250813光模块分析.xlsx (status=0)
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sample record columns: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,244 - __main__ - INFO - Rebuilt table 光模块故障表 from 光模块故障表
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,250 - __main__ - INFO - Inserted 174 records into table 光模块故障表
2025-09-01 16:22:43,266 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:52:56,924 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:52:56,925 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:54:21,576 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:54:21,577 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:54:21,584 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:54:21,584 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:55:51,005 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:55:51,006 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:55:51,095 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:55:51,099 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:56:33,313 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:56:33,314 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:56:33,317 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:56:33,317 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,050 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,657 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,659 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,660 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,661 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,665 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,666 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,688 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,701 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.166899995761923, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:28.884Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42626, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,702 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,703 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>"}
2025-10-15 17:57:31,704 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,705 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,706 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,707 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,790 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07270179998886306}
2025-10-15 17:57:31,791 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08514739999372978}
2025-10-15 17:57:31,792 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,802 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 9.745999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,803 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,803 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:31,804 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:31.804125
2025-10-15 17:57:31,804 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,805 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005225999921094626}
2025-10-15 17:57:31,807 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,826 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.728, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,827 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,829 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,830 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,831 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,832 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006704999977955595}
2025-10-15 17:57:31,832 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,851 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.922, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,859 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,860 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:31,862 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:31,863 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:31,864 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,867 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,867 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 17:57:31,883 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002B6BADC3390>
2025-10-15 17:57:31,883 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,887 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,888 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,889 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,891 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,893 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,895 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,907 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,917 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.064999991096556, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:29.101Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42629, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,919 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,920 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>"}
2025-10-15 17:57:31,921 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,922 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,922 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,923 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,989 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05641550000291318}
2025-10-15 17:57:31,990 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0682307000097353}
2025-10-15 17:57:31,991 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,001 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 9.912, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,002 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,002 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:32,003 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:32.003461
2025-10-15 17:57:32,004 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,005 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004942999948980287}
2025-10-15 17:57:32,007 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 20.337999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,029 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,030 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,031 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,032 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006326000002445653}
2025-10-15 17:57:32,033 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,051 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 18.724, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,053 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,053 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:32,054 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:32,055 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:32,055 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:32,055 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 17:57:32,057 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,060 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,064 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,065 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,066 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,067 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,103 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 17:57:32,104 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,105 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,108 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,109 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,115 - backend.database_builder - INFO - Inserted 4 records into table 事件监控-光模块故障表
2025-10-15 17:57:32,141 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:57:32,429 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 507.1827000065241, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:44,558 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,559 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:44,560 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,560 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "remainingTimeMS": 4999}
2025-10-15 20:12:44,584 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:44,601 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.551199994864874, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.193Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42710, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:44,602 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>"}
2025-10-15 20:12:44,603 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04508509999141097}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056563300007837825}
2025-10-15 20:12:44,661 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,671 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 10.479000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,672 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,672 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:44,673 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:44.673086
2025-10-15 20:12:44,673 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,674 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00030520001018885523}
2025-10-15 20:12:44,675 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,695 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 20.1, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,696 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,696 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,697 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,697 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,698 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003618000046117231}
2025-10-15 20:12:44,698 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,758 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 60.125, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,761 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003352000057930127}
2025-10-15 20:12:44,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"getMore\": 5054377260502831866, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 274.81100000000004, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,040 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,044 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,047 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,047 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:45,049 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 20:12:45,057 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x0000021634723390>
2025-10-15 20:12:45,057 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,060 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "remainingTimeMS": 4999}
2025-10-15 20:12:45,075 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:45,089 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.31979998596944, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.681Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42713, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:45,090 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,090 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>"}
2025-10-15 20:12:45,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,091 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:45,091 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,092 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,136 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03614190001098905}
2025-10-15 20:12:45,137 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.045386199999484234}
2025-10-15 20:12:45,137 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,146 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 9.197000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,147 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,147 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:45,147 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:45.147662
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,148 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,149 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000228599994443357}
2025-10-15 20:12:45,149 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,168 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 19.352999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,169 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,170 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,170 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,171 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003893000102834776}
2025-10-15 20:12:45,171 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,232 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 61.038000000000004, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,233 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00039679999463260174}
2025-10-15 20:12:45,235 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"getMore\": 3746973641896813909, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 227.198, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,464 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,467 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,470 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,470 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,470 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,474 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,515 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 20:12:45,515 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,516 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,518 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,519 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,521 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,522 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,524 - backend.database_builder - INFO - Inserted 92 records into table 事件监控-光模块故障表
2025-10-15 20:12:45,552 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 20:12:45,607 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 515.7670000044163, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:13:50,264 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:13:50,265 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:13:50,645 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,646 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "previousDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:13:50,647 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,648 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:13:50,650 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,651 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "remainingTimeMS": 4999}
2025-10-15 21:13:50,679 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:13:50,690 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverConnectionId": 42725, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.160899997572415, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:13:48.327Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42725, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:13:50,691 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,692 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "previousDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>"}
2025-10-15 21:13:50,693 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,694 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverConnectionId": 42725, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:13:50,694 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,695 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,767 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06076490000123158}
2025-10-15 21:13:50,767 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07307240000227466}
2025-10-15 21:13:50,768 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,780 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 12.414, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,781 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,781 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:13:50,782 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:13:50.782309
2025-10-15 21:13:50,783 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,784 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,784 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,785 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005285999941406772}
2025-10-15 21:13:50,786 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:50.782Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,806 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 20.082, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,807 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,807 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,808 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,809 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,809 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005624000041279942}
2025-10-15 21:13:50,810 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:50.782Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,886 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 75.899, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,893 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,893 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,894 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,895 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,895 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004589000018313527}
2025-10-15 21:13:50,896 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"getMore\": 1129965204086066459, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,122 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 226.30100000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,123 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,124 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:13:51,133 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 21:13:51,136 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 21:13:51,137 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:13:51,139 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:13:51,139 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:13:51,159 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x0000016735B73390>
2025-10-15 21:13:51,160 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:13:51,165 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,165 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "previousDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:13:51,166 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,167 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:13:51,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,169 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "remainingTimeMS": 4999}
2025-10-15 21:13:51,191 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:13:51,202 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverConnectionId": 42728, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.75100000121165, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:13:48.840Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42728, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:13:51,203 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,203 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "previousDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>"}
2025-10-15 21:13:51,204 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,205 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverConnectionId": 42728, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:13:51,205 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,206 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,259 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04333309999492485}
2025-10-15 21:13:51,260 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05520650000835303}
2025-10-15 21:13:51,261 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,272 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 11.207999999999998, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,273 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,274 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:13:51,275 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:13:51.275086
2025-10-15 21:13:51,275 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,276 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,277 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,278 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007470999989891425}
2025-10-15 21:13:51,279 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:51.275Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,298 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 19.616999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,299 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,300 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,301 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,302 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,302 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005055999936303124}
2025-10-15 21:13:51,303 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:51.275Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,380 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 77.352, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,383 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,384 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,385 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,386 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,386 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005604000034509227}
2025-10-15 21:13:51,415 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"getMore\": 1915413828488675802, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:52,177 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:13:52,305 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.07596589998865966}
2025-10-15 21:13:52,320 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:13:52,404 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 989.038, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:52,412 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:52,417 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:13:52,422 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.041064000004553236}
2025-10-15 21:13:52,441 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 21:13:52,442 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:13:52,459 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 21:13:52,466 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:13:52,468 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:13:52,469 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:13:52,473 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:13:52,491 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:13:52,502 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:13:52,505 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:13:52,514 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.03668710000056308}
2025-10-15 21:13:52,525 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:13:52,528 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:13:52,531 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:13:52,587 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02164650001213886}
2025-10-15 21:13:52,646 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:13:52,647 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:13:52,647 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:13:52,648 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:13:52,649 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:13:52,649 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:13:52,650 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:13:52,651 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:13:52,661 - backend.database_builder - INFO - Inserted 92 records into table 事件监控-光模块故障表
2025-10-15 21:13:52,734 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:13:53,249 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2044.148300003144, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:28:06,521 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:28:06,521 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:28:07,822 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:07,849 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "previousDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:28:07,865 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:07,872 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:28:07,991 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,015 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:28:08,080 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "remainingTimeMS": 4911}
2025-10-15 21:28:08,194 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverConnectionId": 42741, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 32.86839999782387, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:28:05.843Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42741, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:28:08,248 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,270 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "previousDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>"}
2025-10-15 21:28:08,275 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,280 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,280 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverConnectionId": 42741, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:28:08,348 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,615 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1627050999959465}
2025-10-15 21:28:08,621 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.3411100999946939}
2025-10-15 21:28:08,623 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,642 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 19.619, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,646 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,649 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:28:08,653 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:28:08.653306
2025-10-15 21:28:08,659 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,661 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,663 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,669 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0063510999898426235}
2025-10-15 21:28:08,675 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:28:08.653Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,706 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 31.534, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,726 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,733 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,756 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,762 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.006179200005135499}
2025-10-15 21:28:08,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:28:08.653Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,036 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:28:09,135 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 371.388, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,225 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:09,230 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B295772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:09,304 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B295772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,313 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.10731169999053236}
2025-10-15 21:28:09,331 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,339 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:28:09,355 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02461929999117274}
2025-10-15 21:28:09,369 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"getMore\": 5085479942393133435, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 2, "serverConnectionId": 42744, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,555 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.08340950000274461}
2025-10-15 21:28:09,557 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:28:09,633 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.05685079999966547}
2025-10-15 21:28:09,642 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:28:09,779 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04499900000519119}
2025-10-15 21:28:10,076 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 707.557, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 2, "serverConnectionId": 42744, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:10,079 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:28:10,081 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:28:10,086 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 297, in query_event_monitor_demo
    noc_case_id = noc_case.get("noc_case_id", "")
                  ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:28:10,087 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:28:10,419 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2139.2545999988215, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:29:44,111 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:29:44,111 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:29:44,639 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,640 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "previousDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:29:44,641 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,644 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:29:44,648 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,649 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "remainingTimeMS": 4999}
2025-10-15 21:29:44,673 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:29:44,684 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverConnectionId": 42748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.354500001994893, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:29:42.333Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:29:44,686 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,687 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "previousDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>"}
2025-10-15 21:29:44,692 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,693 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,694 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,695 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverConnectionId": 42748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:29:44,792 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08512650000920985}
2025-10-15 21:29:44,793 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.10031510000408161}
2025-10-15 21:29:44,794 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,808 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 14.244, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,809 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,810 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:29:44,811 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:29:44.811214
2025-10-15 21:29:44,812 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,814 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,815 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,816 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001378599990857765}
2025-10-15 21:29:44,817 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:44.811Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,840 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 23.311999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,841 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,842 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,845 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,847 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,848 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0013172000035410747}
2025-10-15 21:29:44,849 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:44.811Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,929 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 79.67299999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,935 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,937 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,940 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,943 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,944 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000980499986326322}
2025-10-15 21:29:44,945 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"getMore\": 2114070532873537457, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,485 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 540.303, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,490 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,494 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:29:45,505 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:29:45,522 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:29:45,528 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:29:45,545 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:29:45,546 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:29:45,551 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002236A362C10>
2025-10-15 21:29:45,552 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:29:45,561 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,564 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "previousDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:29:45,566 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,569 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:29:45,585 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,590 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "remainingTimeMS": 4995}
2025-10-15 21:29:45,617 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:29:45,631 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverConnectionId": 42751, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.377600003266707, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:29:43.280Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42751, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:29:45,632 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,635 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "previousDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>"}
2025-10-15 21:29:45,638 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,641 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,642 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,645 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverConnectionId": 42751, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:29:45,767 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11051059998862911}
2025-10-15 21:29:45,770 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1285545999999158}
2025-10-15 21:29:45,777 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,806 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 28.59, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,810 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,814 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:29:45,824 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:29:45.824048
2025-10-15 21:29:45,827 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,832 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,841 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,844 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0029910000012023374}
2025-10-15 21:29:45,848 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:45.824Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,882 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 33.984, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,896 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,900 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,904 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,908 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,911 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002620100000058301}
2025-10-15 21:29:45,920 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:45.824Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,040 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 120.62100000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,044 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:46,045 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:46,047 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,048 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,050 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002340799997909926}
2025-10-15 21:29:46,058 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"getMore\": 2104555677937635301, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,509 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 451.192, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,511 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:46,514 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:29:46,516 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:29:46,525 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:29:46,525 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:29:46,526 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:29:46,527 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:29:46,529 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:29:46,534 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:29:46,535 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:29:46,536 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:29:46,537 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:29:46,538 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:29:46,591 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:29:46,611 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:29:46,612 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:29:46,614 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:29:46,615 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:29:46,615 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:29:46,616 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:29:46,617 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:29:46,618 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:29:46,623 - backend.database_builder - INFO - Inserted 6 records into table 事件监控-光模块故障表
2025-10-15 21:29:46,633 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.027907199997571297}
2025-10-15 21:29:46,634 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:29:46,667 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:29:46,673 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.024851299996953458}
2025-10-15 21:29:46,677 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:29:46,712 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023344300003373064}
2025-10-15 21:29:46,713 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:29:46,744 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.01950609999767039}
2025-10-15 21:29:47,182 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1537.3638999881223, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:41:14,629 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:41:14,630 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:41:15,975 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:15,987 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "previousDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:41:15,996 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,012 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:41:16,058 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,061 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "remainingTimeMS": 4996}
2025-10-15 21:41:16,087 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:41:16,121 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverConnectionId": 42770, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 25.128399996901862, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:41:13.775Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42770, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:41:16,123 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,126 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "previousDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>"}
2025-10-15 21:41:16,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,130 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,132 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,139 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverConnectionId": 42770, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:41:16,309 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.15194310000515543}
2025-10-15 21:41:16,329 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.19988119999470655}
2025-10-15 21:41:16,331 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,353 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 21.802, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,357 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,360 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:41:16,362 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:41:16.362799
2025-10-15 21:41:16,391 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,409 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,414 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,421 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.007230200004414655}
2025-10-15 21:41:16,425 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:16.362Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,911 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 486.52099999999996, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,914 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,916 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,919 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,925 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,927 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001808600005460903}
2025-10-15 21:41:16,929 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:16.362Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,018 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 89.10600000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,024 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,025 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:17,026 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,028 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,028 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008606000046711415}
2025-10-15 21:41:17,029 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"getMore\": 8909637537337048233, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,060 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:41:17,140 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.04100050000124611}
2025-10-15 21:41:17,141 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:41:17,192 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.035644999996293336}
2025-10-15 21:41:17,193 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:41:17,253 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.04577169999538455}
2025-10-15 21:41:17,257 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:41:17,319 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04199129999324214}
2025-10-15 21:41:17,412 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 382.214, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,417 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,420 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:41:17,431 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:41:17,441 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:41:17,444 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:41:17,453 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:41:17,454 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:41:17,457 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001397C6A2C10>
2025-10-15 21:41:17,458 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:41:17,463 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,464 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "previousDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:41:17,464 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,467 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:41:17,470 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,473 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "remainingTimeMS": 4997}
2025-10-15 21:41:17,503 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:41:17,513 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverConnectionId": 42777, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.280600002966821, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:41:15.175Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42777, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:41:17,514 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,515 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "previousDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>"}
2025-10-15 21:41:17,518 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,519 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverConnectionId": 42777, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:41:17,522 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,523 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,618 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06925609998870641}
2025-10-15 21:41:17,619 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09770459998981096}
2025-10-15 21:41:17,621 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,632 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 11.376000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,633 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,634 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:41:17,635 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:41:17.635427
2025-10-15 21:41:17,636 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,637 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,638 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,640 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0014967999886721373}
2025-10-15 21:41:17,641 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:17.635Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,661 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 20.261000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,662 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,663 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,664 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,665 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,667 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011585000029299408}
2025-10-15 21:41:17,669 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:17.635Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,759 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 90.408, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,762 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,763 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,764 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,765 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,766 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011492999910842627}
2025-10-15 21:41:17,767 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"getMore\": 191292709385973757, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:18,216 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 448.913, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:18,218 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:18,220 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:41:18,227 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:41:18,236 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:41:18,237 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:41:18,238 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:41:18,239 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:41:18,242 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:41:18,248 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:41:18,250 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:41:18,251 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:41:18,254 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:41:18,258 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:41:18,355 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:41:18,357 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:41:18,358 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:41:18,359 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:41:18,360 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:41:18,361 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:41:18,363 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:41:18,372 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:41:18,376 - backend.database_builder - INFO - Inserted 6 records into table 事件监控-光模块故障表
2025-10-15 21:41:18,427 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:41:18,477 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:41:18,665 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.05358219999470748}
2025-10-15 21:41:18,667 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:41:18,698 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.019659500001580454}
2025-10-15 21:41:18,700 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:41:18,759 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023579400003654882}
2025-10-15 21:41:18,760 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:41:18,800 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02887639999971725}
2025-10-15 21:41:19,044 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1525.4249999998137, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:48:39,932 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:48:39,932 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:48:40,745 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,746 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "previousDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:48:40,747 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,749 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:48:40,753 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,754 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "remainingTimeMS": 4998}
2025-10-15 21:48:40,775 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:48:40,787 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverConnectionId": 42791, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.42020000750199, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:48:38.452Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42791, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:48:40,789 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,790 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "previousDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>"}
2025-10-15 21:48:40,791 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,792 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverConnectionId": 42791, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:48:40,793 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,795 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,879 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07432270000572316}
2025-10-15 21:48:40,880 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08674420000170358}
2025-10-15 21:48:40,881 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,891 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 9.898, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,892 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,892 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:48:40,893 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:48:40.893483
2025-10-15 21:48:40,894 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,895 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,897 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,897 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008760999917285517}
2025-10-15 21:48:40,899 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:40.893Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,922 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 23.499, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,923 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,925 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,926 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,926 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,927 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006239000067580491}
2025-10-15 21:48:40,928 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:40.893Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,998 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 69.982, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,003 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,005 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:41,006 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,007 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,009 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001539100005174987}
2025-10-15 21:48:41,010 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"getMore\": 2761820994334931500, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,330 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 320.034, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,333 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,336 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:48:41,341 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:48:41,350 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:48:41,351 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:48:41,355 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:48:41,356 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:48:41,359 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x00000229D64A3110>
2025-10-15 21:48:41,360 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:48:41,368 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,371 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "previousDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:48:41,372 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,376 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:48:41,382 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,385 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "remainingTimeMS": 4996}
2025-10-15 21:48:41,391 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:48:41,401 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverConnectionId": 42794, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.80660000257194, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:48:39.066Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42794, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:48:41,403 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,404 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "previousDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>"}
2025-10-15 21:48:41,406 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,407 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverConnectionId": 42794, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:48:41,408 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,410 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,506 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06546959999832325}
2025-10-15 21:48:41,507 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09855729999253526}
2025-10-15 21:48:41,508 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,529 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 21.408, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,530 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,531 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:48:41,532 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:48:41.532237
2025-10-15 21:48:41,533 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,536 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,538 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,539 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007875999872339889}
2025-10-15 21:48:41,540 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:41.532Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,561 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 20.559, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,562 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,563 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,564 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,566 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,568 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0025396999990334734}
2025-10-15 21:48:41,570 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:41.532Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,642 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 72.238, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,644 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,645 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,645 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,646 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,647 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000586000009207055}
2025-10-15 21:48:41,648 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"getMore\": 8689348324599948128, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,911 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 263.63599999999997, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,913 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,915 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:48:41,916 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:48:41,922 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:48:41,922 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:48:41,923 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:48:41,924 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:48:41,925 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:48:41,929 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:48:41,930 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:48:41,931 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:48:41,932 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:48:41,933 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:48:42,129 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:48:42,130 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:48:42,131 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:48:42,133 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:48:42,134 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:48:42,134 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:48:42,137 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:48:42,138 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:48:42,142 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:48:42,197 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:48:42,436 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1028.9198000100441, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:51:54,549 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:51:54,549 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:51:55,140 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,142 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:51:55,143 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,146 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:51:55,152 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,153 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "remainingTimeMS": 4998}
2025-10-15 21:51:55,172 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:51:55,194 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverConnectionId": 42798, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.043300005141646, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:51:52.860Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42798, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:51:55,197 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,198 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>"}
2025-10-15 21:51:55,199 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,200 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,201 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,206 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverConnectionId": 42798, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:51:55,319 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.10117510000418406}
2025-10-15 21:51:55,320 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11996219999855384}
2025-10-15 21:51:55,321 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,333 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 11.926, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,334 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,335 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:51:55,336 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:51:55.336380
2025-10-15 21:51:55,337 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,338 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,339 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,341 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0014795000024605542}
2025-10-15 21:51:55,343 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:55.336Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,362 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 19.748, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,363 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,365 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,366 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,367 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,368 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009962000040104613}
2025-10-15 21:51:55,370 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:55.336Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,451 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 81.114, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,456 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,457 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,458 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,459 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,460 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009806999878492206}
2025-10-15 21:51:55,462 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"getMore\": 8255088930409715994, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,800 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 338.793, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,806 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,809 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:51:55,814 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:51:55,828 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:51:55,829 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:51:55,862 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:51:55,863 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:51:55,870 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002D274382FD0>
2025-10-15 21:51:55,871 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:51:55,883 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:55,887 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:51:55,888 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,896 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:51:55,901 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:55,903 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "remainingTimeMS": 4997}
2025-10-15 21:51:55,942 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:51:55,954 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverConnectionId": 42801, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.205700004007667, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:51:53.624Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42801, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:51:55,956 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,957 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>"}
2025-10-15 21:51:55,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,967 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverConnectionId": 42801, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:51:55,968 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,971 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,095 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09189969999715686}
2025-10-15 21:51:56,099 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.13051160000031814}
2025-10-15 21:51:56,103 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,134 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 30.951, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,144 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,145 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:51:56,146 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:51:56.146643
2025-10-15 21:51:56,163 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,179 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,182 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0026959999959217384}
2025-10-15 21:51:56,185 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:56.146Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,222 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 37.083, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,226 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,229 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,230 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,232 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002549700002418831}
2025-10-15 21:51:56,237 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:56.146Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,366 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 129.28799999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,369 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,370 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,371 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,373 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,374 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009608999971533194}
2025-10-15 21:51:56,379 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"getMore\": 3873085917204919547, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,793 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 413.588, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,795 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,798 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:51:56,800 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:51:56,808 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:51:56,808 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:51:56,809 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:51:56,810 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:51:56,813 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:51:56,822 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:51:56,823 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:51:56,824 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:51:56,826 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:51:56,827 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:51:56,903 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:51:56,904 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:51:56,908 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:51:56,908 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:51:56,909 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:51:56,910 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:51:56,911 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:51:56,911 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:51:56,912 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:51:56,914 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:51:56,983 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.05662329999904614}
2025-10-15 21:51:56,985 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:51:56,991 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:51:57,021 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.01944369998818729}
2025-10-15 21:51:57,022 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:51:57,052 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.019824599992716685}
2025-10-15 21:51:57,053 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:51:57,085 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02183589999913238}
2025-10-15 21:51:57,511 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1544.3687999941176, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:54:47,323 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:54:47,324 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:54:47,825 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,826 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "previousDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:54:47,827 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,829 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:54:47,833 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,834 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "remainingTimeMS": 4998}
2025-10-15 21:54:47,844 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:54:47,865 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverConnectionId": 42809, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 20.74490000086371, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:54:45.533Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42809, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:54:47,867 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,867 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "previousDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>"}
2025-10-15 21:54:47,869 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,870 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverConnectionId": 42809, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:54:47,871 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,872 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:47,963 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07692799999495037}
2025-10-15 21:54:47,964 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09288820000074338}
2025-10-15 21:54:47,965 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,976 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 10.799, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,978 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:47,979 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:54:47,980 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:54:47.980035
2025-10-15 21:54:47,981 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,982 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,982 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,983 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007210000039776787}
2025-10-15 21:54:47,984 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:47.980Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,004 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 19.699, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,005 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,007 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:48,008 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,009 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,011 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0016450999974040315}
2025-10-15 21:54:48,013 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:47.980Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,085 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 72.738, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,089 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,090 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:48,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,092 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,092 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004969000001437962}
2025-10-15 21:54:48,093 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"getMore\": 642056611885069641, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,399 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 306.283, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,403 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,406 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:54:48,412 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:54:48,423 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:54:48,423 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:54:48,442 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:54:48,443 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:54:48,449 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001C58E7F3390>
2025-10-15 21:54:48,454 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:54:48,462 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,465 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "previousDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:54:48,469 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,473 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:54:48,478 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,479 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "remainingTimeMS": 4998}
2025-10-15 21:54:48,486 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:54:48,496 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverConnectionId": 42812, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.6035999993328, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:54:46.164Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42812, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:54:48,499 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,500 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "previousDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>"}
2025-10-15 21:54:48,502 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,502 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverConnectionId": 42812, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:54:48,503 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,505 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,586 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0702447000076063}
2025-10-15 21:54:48,587 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08364089998940472}
2025-10-15 21:54:48,588 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,600 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 11.892, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,601 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,602 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:54:48,602 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:54:48.602866
2025-10-15 21:54:48,603 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,604 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,605 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,606 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000774300002376549}
2025-10-15 21:54:48,607 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:48.602Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,629 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 22.093999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,632 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,634 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,636 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,637 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,638 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007474000012734905}
2025-10-15 21:54:48,639 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:48.602Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,718 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 78.22500000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,719 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,721 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,722 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,723 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,723 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006567999953404069}
2025-10-15 21:54:48,724 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"getMore\": 3244617196764948786, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:49,159 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 435.26599999999996, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:49,161 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:49,164 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:54:49,166 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:54:49,176 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:54:49,177 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:54:49,179 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:54:49,182 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:54:49,184 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:54:49,192 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:54:49,193 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:54:49,195 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:54:49,197 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:54:49,198 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:54:49,279 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:54:49,281 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:54:49,282 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:54:49,284 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:54:49,286 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:54:49,295 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:54:49,296 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:54:49,297 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:54:49,300 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:54:49,385 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:54:49,523 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1020.6214999925578, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:56:18,326 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:56:18,326 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:56:18,723 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,723 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "previousDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:56:18,724 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,725 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:56:18,728 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,729 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "remainingTimeMS": 4999}
2025-10-15 21:56:18,757 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:56:18,771 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverConnectionId": 42816, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.101100001018494, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:56:16.442Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42816, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:56:18,772 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,774 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "previousDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>"}
2025-10-15 21:56:18,776 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,777 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverConnectionId": 42816, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:56:18,778 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,779 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,845 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056574099988210946}
2025-10-15 21:56:18,845 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06763689999934286}
2025-10-15 21:56:18,846 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,856 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 10.234, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,857 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,858 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:56:18,859 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:56:18.859292
2025-10-15 21:56:18,860 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,861 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,861 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,862 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005152999947313219}
2025-10-15 21:56:18,862 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:18.859Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,882 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 19.541, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,883 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,884 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,884 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,885 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,886 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00048750000132713467}
2025-10-15 21:56:18,886 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:18.859Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,956 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 69.53, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,960 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,961 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000211D8322C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,961 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000211D8322C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,962 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,963 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005035999929532409}
2025-10-15 21:56:18,963 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"getMore\": 6638224362842435104, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:19,291 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 328.04100000000005, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:19,293 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:19,294 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:56:19,300 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 387, in query_event_monitor_demo
    module_name = optical_module.get("module_name", "non-data")
                  ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:56:19,300 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:56:19,794 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1017.3420000064652, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:56:37,906 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:56:37,907 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:56:38,227 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,227 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "previousDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:56:38,228 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,229 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:56:38,231 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,232 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "remainingTimeMS": 4999}
2025-10-15 21:56:38,241 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:56:38,253 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverConnectionId": 42819, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.27489999635145, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:56:35.925Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42819, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:56:38,254 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,254 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "previousDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>"}
2025-10-15 21:56:38,255 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,256 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverConnectionId": 42819, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:56:38,256 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,257 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,325 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056778900005156174}
2025-10-15 21:56:38,326 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06968659999256488}
2025-10-15 21:56:38,327 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,337 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 10.644, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,338 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,338 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:56:38,339 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:56:38.339152
2025-10-15 21:56:38,339 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,340 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,341 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,342 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004444999940460548}
2025-10-15 21:56:38,342 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:38.339Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,362 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 20.154, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,363 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,364 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,364 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,365 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,365 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00038219999987632036}
2025-10-15 21:56:38,366 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:38.339Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,428 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 62.021, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,430 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,431 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002A9B7D22C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,431 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002A9B7D22C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,432 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,432 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00037960000918246806}
2025-10-15 21:56:38,433 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"getMore\": 5828647788721058203, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,651 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 217.78300000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,652 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,653 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:56:38,657 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 387, in query_event_monitor_demo
    module_name = optical_module.get("module_name", "non-data")
                  ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:56:38,657 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:56:38,759 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 503.1449999951292, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:59:14,323 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:59:14,324 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:59:14,954 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:14,955 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "previousDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:59:14,956 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:14,958 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:59:14,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:14,963 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "remainingTimeMS": 4998}
2025-10-15 21:59:14,997 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:59:15,008 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverConnectionId": 42825, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.260600010748021, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:59:12.681Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42825, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:59:15,010 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,011 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "previousDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>"}
2025-10-15 21:59:15,013 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,015 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverConnectionId": 42825, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:59:15,016 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,020 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,113 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07035950000863522}
2025-10-15 21:59:15,114 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09840149999945424}
2025-10-15 21:59:15,115 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,125 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 9.998999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,126 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,127 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:59:15,127 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:59:15.127849
2025-10-15 21:59:15,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,129 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,130 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,131 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006229999999050051}
2025-10-15 21:59:15,131 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.127Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,152 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 21.023, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,154 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,155 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,156 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,156 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,157 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006013999955030158}
2025-10-15 21:59:15,158 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.127Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,233 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 74.828, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,236 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,237 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,238 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,239 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,239 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000562699991860427}
2025-10-15 21:59:15,240 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"getMore\": 478595367856304872, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,585 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 345.42699999999996, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,587 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,588 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:59:15,607 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 466 条记录
2025-10-15 21:59:15,615 - backend.data_loader - DEBUG - Loaded 466 records from MongoDB
2025-10-15 21:59:15,615 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:59:15,620 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:59:15,621 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:59:15,623 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x00000171BF183390>
2025-10-15 21:59:15,624 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:59:15,629 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,630 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "previousDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:59:15,635 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,637 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:59:15,639 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,640 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "remainingTimeMS": 4999}
2025-10-15 21:59:15,648 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:59:15,657 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverConnectionId": 42828, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.477399998810142, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:59:13.330Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42828, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:59:15,659 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,659 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "previousDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>"}
2025-10-15 21:59:15,661 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,661 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverConnectionId": 42828, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:59:15,662 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,665 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,732 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05665549999685027}
2025-10-15 21:59:15,733 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07063299999572337}
2025-10-15 21:59:15,734 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,744 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 10.181000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,745 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,746 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:59:15,746 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:59:15.746900
2025-10-15 21:59:15,747 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,749 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,750 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005434999911813065}
2025-10-15 21:59:15,751 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.746Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,772 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 20.962999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,773 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,774 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,775 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,776 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,777 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011341000063112006}
2025-10-15 21:59:15,779 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.746Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,848 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 69.34899999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,851 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,852 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,853 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,854 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,855 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007027999963611364}
2025-10-15 21:59:15,855 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"getMore\": 4863982385481659248, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:16,202 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 346.874, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:16,204 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:16,207 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:59:16,234 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 466 条记录
2025-10-15 21:59:16,254 - backend.data_loader - DEBUG - Loaded 466 records from MongoDB
2025-10-15 21:59:16,255 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:59:16,255 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:59:16,256 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:59:16,259 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:59:16,268 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:59:16,271 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:59:16,272 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:59:16,273 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:59:16,274 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:59:16,354 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:59:16,355 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:59:16,356 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:59:16,356 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:59:16,357 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:59:16,358 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:59:16,358 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:59:16,359 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:59:16,369 - backend.database_builder - INFO - Inserted 466 records into table 事件监控-光模块故障表
2025-10-15 21:59:16,402 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:59:16,690 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1029.2006999952719, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
