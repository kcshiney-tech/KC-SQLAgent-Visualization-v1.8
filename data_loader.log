2025-09-01 16:22:29,003 - data_loader - DEBUG - Initialized ExcelDataSourceLoader for 20250813光模块分析.xlsx with sheets: [('工作表6', '光模块故障表')]
2025-09-01 16:22:29,004 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-09-01 16:22:29,005 - __main__ - DEBUG - Processing data source: <data_loader.ExcelDataSourceLoader object at 0x00000224539FC830>
2025-09-01 16:22:29,005 - data_loader - DEBUG - Loading Excel file: 20250813光模块分析.xlsx
2025-09-01 16:22:36,369 - data_loader - DEBUG - Reading sheet: 工作表6
2025-09-01 16:22:43,212 - data_loader - DEBUG - Columns in sheet 工作表6: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,217 - data_loader - DEBUG - Loaded sheet 工作表6 as table 光模块故障表 with 174 records
2025-09-01 16:22:43,217 - data_loader - INFO - Loaded Excel file 20250813光模块分析.xlsx with sheets: ['工作表6'] (status=0)
2025-09-01 16:22:43,218 - data_loader - INFO - Excel load completed for 20250813光模块分析.xlsx (status=0)
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sample record columns: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,244 - __main__ - INFO - Rebuilt table 光模块故障表 from 光模块故障表
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,250 - __main__ - INFO - Inserted 174 records into table 光模块故障表
2025-09-01 16:22:43,266 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:52:56,924 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:52:56,925 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:54:21,576 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:54:21,577 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:54:21,584 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:54:21,584 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:55:51,005 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:55:51,006 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:55:51,095 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:55:51,099 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:56:33,313 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:56:33,314 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:56:33,317 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:56:33,317 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,050 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,657 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,659 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,660 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,661 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,665 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,666 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,688 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,701 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.166899995761923, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:28.884Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42626, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,702 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,703 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>"}
2025-10-15 17:57:31,704 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,705 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,706 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,707 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,790 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07270179998886306}
2025-10-15 17:57:31,791 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08514739999372978}
2025-10-15 17:57:31,792 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,802 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 9.745999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,803 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,803 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:31,804 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:31.804125
2025-10-15 17:57:31,804 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,805 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005225999921094626}
2025-10-15 17:57:31,807 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,826 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.728, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,827 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,829 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,830 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,831 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,832 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006704999977955595}
2025-10-15 17:57:31,832 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,851 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.922, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,859 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,860 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:31,862 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:31,863 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:31,864 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,867 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,867 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 17:57:31,883 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002B6BADC3390>
2025-10-15 17:57:31,883 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,887 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,888 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,889 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,891 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,893 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,895 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,907 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,917 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.064999991096556, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:29.101Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42629, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,919 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,920 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>"}
2025-10-15 17:57:31,921 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,922 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,922 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,923 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,989 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05641550000291318}
2025-10-15 17:57:31,990 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0682307000097353}
2025-10-15 17:57:31,991 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,001 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 9.912, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,002 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,002 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:32,003 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:32.003461
2025-10-15 17:57:32,004 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,005 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004942999948980287}
2025-10-15 17:57:32,007 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 20.337999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,029 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,030 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,031 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,032 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006326000002445653}
2025-10-15 17:57:32,033 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,051 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 18.724, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,053 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,053 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:32,054 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:32,055 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:32,055 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:32,055 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 17:57:32,057 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,060 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,064 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,065 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,066 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,067 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,103 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 17:57:32,104 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,105 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,108 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,109 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,115 - backend.database_builder - INFO - Inserted 4 records into table 事件监控-光模块故障表
2025-10-15 17:57:32,141 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:57:32,429 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 507.1827000065241, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:44,558 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,559 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:44,560 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,560 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "remainingTimeMS": 4999}
2025-10-15 20:12:44,584 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:44,601 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.551199994864874, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.193Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42710, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:44,602 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>"}
2025-10-15 20:12:44,603 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04508509999141097}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056563300007837825}
2025-10-15 20:12:44,661 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,671 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 10.479000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,672 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,672 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:44,673 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:44.673086
2025-10-15 20:12:44,673 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,674 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00030520001018885523}
2025-10-15 20:12:44,675 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,695 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 20.1, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,696 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,696 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,697 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,697 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,698 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003618000046117231}
2025-10-15 20:12:44,698 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,758 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 60.125, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,761 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003352000057930127}
2025-10-15 20:12:44,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"getMore\": 5054377260502831866, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 274.81100000000004, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,040 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,044 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,047 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,047 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:45,049 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 20:12:45,057 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x0000021634723390>
2025-10-15 20:12:45,057 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,060 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "remainingTimeMS": 4999}
2025-10-15 20:12:45,075 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:45,089 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.31979998596944, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.681Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42713, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:45,090 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,090 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>"}
2025-10-15 20:12:45,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,091 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:45,091 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,092 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,136 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03614190001098905}
2025-10-15 20:12:45,137 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.045386199999484234}
2025-10-15 20:12:45,137 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,146 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 9.197000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,147 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,147 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:45,147 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:45.147662
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,148 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,149 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000228599994443357}
2025-10-15 20:12:45,149 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,168 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 19.352999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,169 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,170 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,170 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,171 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003893000102834776}
2025-10-15 20:12:45,171 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,232 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 61.038000000000004, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,233 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00039679999463260174}
2025-10-15 20:12:45,235 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"getMore\": 3746973641896813909, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 227.198, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,464 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,467 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,470 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,470 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,470 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,474 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,515 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 20:12:45,515 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,516 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,518 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,519 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,521 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,522 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,524 - backend.database_builder - INFO - Inserted 92 records into table 事件监控-光模块故障表
2025-10-15 20:12:45,552 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 20:12:45,607 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 515.7670000044163, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:13:50,264 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:13:50,265 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:13:50,645 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,646 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "previousDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:13:50,647 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,648 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:13:50,650 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,651 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "remainingTimeMS": 4999}
2025-10-15 21:13:50,679 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:13:50,690 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverConnectionId": 42725, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.160899997572415, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:13:48.327Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42725, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:13:50,691 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,692 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "previousDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>"}
2025-10-15 21:13:50,693 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,694 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverConnectionId": 42725, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:13:50,694 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,695 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,767 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06076490000123158}
2025-10-15 21:13:50,767 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07307240000227466}
2025-10-15 21:13:50,768 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,780 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 12.414, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,781 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,781 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:13:50,782 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:13:50.782309
2025-10-15 21:13:50,783 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,784 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,784 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,785 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005285999941406772}
2025-10-15 21:13:50,786 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:50.782Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,806 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 20.082, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,807 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,807 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,808 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,809 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,809 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005624000041279942}
2025-10-15 21:13:50,810 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:50.782Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,886 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 75.899, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,893 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,893 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,894 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,895 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,895 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004589000018313527}
2025-10-15 21:13:50,896 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"getMore\": 1129965204086066459, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,122 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 226.30100000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,123 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,124 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:13:51,133 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 21:13:51,136 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 21:13:51,137 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:13:51,139 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:13:51,139 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:13:51,159 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x0000016735B73390>
2025-10-15 21:13:51,160 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:13:51,165 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,165 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "previousDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:13:51,166 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,167 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:13:51,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,169 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "remainingTimeMS": 4999}
2025-10-15 21:13:51,191 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:13:51,202 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverConnectionId": 42728, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.75100000121165, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:13:48.840Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42728, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:13:51,203 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,203 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "previousDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>"}
2025-10-15 21:13:51,204 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,205 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverConnectionId": 42728, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:13:51,205 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,206 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,259 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04333309999492485}
2025-10-15 21:13:51,260 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05520650000835303}
2025-10-15 21:13:51,261 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,272 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 11.207999999999998, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,273 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,274 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:13:51,275 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:13:51.275086
2025-10-15 21:13:51,275 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,276 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,277 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,278 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007470999989891425}
2025-10-15 21:13:51,279 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:51.275Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,298 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 19.616999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,299 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,300 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,301 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,302 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,302 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005055999936303124}
2025-10-15 21:13:51,303 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:51.275Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,380 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 77.352, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,383 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,384 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,385 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,386 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,386 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005604000034509227}
2025-10-15 21:13:51,415 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"getMore\": 1915413828488675802, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:52,177 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:13:52,305 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.07596589998865966}
2025-10-15 21:13:52,320 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:13:52,404 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 989.038, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:52,412 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:52,417 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:13:52,422 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.041064000004553236}
2025-10-15 21:13:52,441 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 21:13:52,442 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:13:52,459 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 21:13:52,466 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:13:52,468 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:13:52,469 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:13:52,473 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:13:52,491 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:13:52,502 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:13:52,505 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:13:52,514 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.03668710000056308}
2025-10-15 21:13:52,525 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:13:52,528 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:13:52,531 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:13:52,587 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02164650001213886}
2025-10-15 21:13:52,646 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:13:52,647 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:13:52,647 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:13:52,648 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:13:52,649 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:13:52,649 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:13:52,650 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:13:52,651 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:13:52,661 - backend.database_builder - INFO - Inserted 92 records into table 事件监控-光模块故障表
2025-10-15 21:13:52,734 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:13:53,249 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2044.148300003144, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:28:06,521 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:28:06,521 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:28:07,822 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:07,849 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "previousDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:28:07,865 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:07,872 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:28:07,991 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,015 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:28:08,080 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "remainingTimeMS": 4911}
2025-10-15 21:28:08,194 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverConnectionId": 42741, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 32.86839999782387, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:28:05.843Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42741, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:28:08,248 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,270 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "previousDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>"}
2025-10-15 21:28:08,275 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,280 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,280 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverConnectionId": 42741, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:28:08,348 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,615 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1627050999959465}
2025-10-15 21:28:08,621 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.3411100999946939}
2025-10-15 21:28:08,623 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,642 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 19.619, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,646 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,649 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:28:08,653 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:28:08.653306
2025-10-15 21:28:08,659 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,661 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,663 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,669 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0063510999898426235}
2025-10-15 21:28:08,675 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:28:08.653Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,706 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 31.534, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,726 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,733 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,756 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,762 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.006179200005135499}
2025-10-15 21:28:08,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:28:08.653Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,036 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:28:09,135 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 371.388, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,225 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:09,230 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B295772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:09,304 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B295772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,313 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.10731169999053236}
2025-10-15 21:28:09,331 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,339 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:28:09,355 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02461929999117274}
2025-10-15 21:28:09,369 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"getMore\": 5085479942393133435, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 2, "serverConnectionId": 42744, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,555 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.08340950000274461}
2025-10-15 21:28:09,557 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:28:09,633 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.05685079999966547}
2025-10-15 21:28:09,642 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:28:09,779 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04499900000519119}
2025-10-15 21:28:10,076 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 707.557, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 2, "serverConnectionId": 42744, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:10,079 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:28:10,081 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:28:10,086 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 297, in query_event_monitor_demo
    noc_case_id = noc_case.get("noc_case_id", "")
                  ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:28:10,087 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:28:10,419 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2139.2545999988215, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:29:44,111 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:29:44,111 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:29:44,639 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,640 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "previousDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:29:44,641 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,644 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:29:44,648 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,649 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "remainingTimeMS": 4999}
2025-10-15 21:29:44,673 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:29:44,684 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverConnectionId": 42748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.354500001994893, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:29:42.333Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:29:44,686 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,687 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "previousDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>"}
2025-10-15 21:29:44,692 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,693 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,694 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,695 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverConnectionId": 42748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:29:44,792 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08512650000920985}
2025-10-15 21:29:44,793 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.10031510000408161}
2025-10-15 21:29:44,794 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,808 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 14.244, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,809 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,810 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:29:44,811 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:29:44.811214
2025-10-15 21:29:44,812 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,814 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,815 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,816 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001378599990857765}
2025-10-15 21:29:44,817 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:44.811Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,840 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 23.311999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,841 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,842 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,845 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,847 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,848 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0013172000035410747}
2025-10-15 21:29:44,849 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:44.811Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,929 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 79.67299999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,935 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,937 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,940 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,943 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,944 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000980499986326322}
2025-10-15 21:29:44,945 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"getMore\": 2114070532873537457, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,485 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 540.303, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,490 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,494 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:29:45,505 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:29:45,522 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:29:45,528 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:29:45,545 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:29:45,546 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:29:45,551 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002236A362C10>
2025-10-15 21:29:45,552 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:29:45,561 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,564 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "previousDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:29:45,566 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,569 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:29:45,585 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,590 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "remainingTimeMS": 4995}
2025-10-15 21:29:45,617 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:29:45,631 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverConnectionId": 42751, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.377600003266707, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:29:43.280Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42751, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:29:45,632 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,635 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "previousDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>"}
2025-10-15 21:29:45,638 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,641 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,642 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,645 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverConnectionId": 42751, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:29:45,767 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11051059998862911}
2025-10-15 21:29:45,770 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1285545999999158}
2025-10-15 21:29:45,777 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,806 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 28.59, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,810 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,814 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:29:45,824 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:29:45.824048
2025-10-15 21:29:45,827 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,832 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,841 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,844 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0029910000012023374}
2025-10-15 21:29:45,848 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:45.824Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,882 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 33.984, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,896 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,900 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,904 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,908 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,911 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002620100000058301}
2025-10-15 21:29:45,920 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:45.824Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,040 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 120.62100000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,044 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:46,045 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:46,047 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,048 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,050 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002340799997909926}
2025-10-15 21:29:46,058 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"getMore\": 2104555677937635301, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,509 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 451.192, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,511 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:46,514 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:29:46,516 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:29:46,525 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:29:46,525 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:29:46,526 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:29:46,527 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:29:46,529 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:29:46,534 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:29:46,535 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:29:46,536 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:29:46,537 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:29:46,538 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:29:46,591 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:29:46,611 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:29:46,612 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:29:46,614 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:29:46,615 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:29:46,615 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:29:46,616 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:29:46,617 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:29:46,618 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:29:46,623 - backend.database_builder - INFO - Inserted 6 records into table 事件监控-光模块故障表
2025-10-15 21:29:46,633 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.027907199997571297}
2025-10-15 21:29:46,634 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:29:46,667 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:29:46,673 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.024851299996953458}
2025-10-15 21:29:46,677 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:29:46,712 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023344300003373064}
2025-10-15 21:29:46,713 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:29:46,744 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.01950609999767039}
2025-10-15 21:29:47,182 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1537.3638999881223, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:41:14,629 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:41:14,630 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:41:15,975 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:15,987 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "previousDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:41:15,996 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,012 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:41:16,058 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,061 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "remainingTimeMS": 4996}
2025-10-15 21:41:16,087 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:41:16,121 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverConnectionId": 42770, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 25.128399996901862, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:41:13.775Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42770, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:41:16,123 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,126 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "previousDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>"}
2025-10-15 21:41:16,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,130 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,132 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,139 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverConnectionId": 42770, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:41:16,309 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.15194310000515543}
2025-10-15 21:41:16,329 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.19988119999470655}
2025-10-15 21:41:16,331 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,353 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 21.802, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,357 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,360 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:41:16,362 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:41:16.362799
2025-10-15 21:41:16,391 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,409 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,414 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,421 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.007230200004414655}
2025-10-15 21:41:16,425 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:16.362Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,911 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 486.52099999999996, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,914 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,916 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,919 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,925 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,927 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001808600005460903}
2025-10-15 21:41:16,929 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:16.362Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,018 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 89.10600000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,024 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,025 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:17,026 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,028 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,028 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008606000046711415}
2025-10-15 21:41:17,029 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"getMore\": 8909637537337048233, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,060 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:41:17,140 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.04100050000124611}
2025-10-15 21:41:17,141 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:41:17,192 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.035644999996293336}
2025-10-15 21:41:17,193 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:41:17,253 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.04577169999538455}
2025-10-15 21:41:17,257 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:41:17,319 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04199129999324214}
2025-10-15 21:41:17,412 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 382.214, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,417 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,420 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:41:17,431 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:41:17,441 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:41:17,444 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:41:17,453 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:41:17,454 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:41:17,457 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001397C6A2C10>
2025-10-15 21:41:17,458 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:41:17,463 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,464 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "previousDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:41:17,464 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,467 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:41:17,470 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,473 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "remainingTimeMS": 4997}
2025-10-15 21:41:17,503 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:41:17,513 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverConnectionId": 42777, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.280600002966821, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:41:15.175Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42777, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:41:17,514 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,515 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "previousDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>"}
2025-10-15 21:41:17,518 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,519 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverConnectionId": 42777, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:41:17,522 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,523 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,618 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06925609998870641}
2025-10-15 21:41:17,619 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09770459998981096}
2025-10-15 21:41:17,621 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,632 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 11.376000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,633 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,634 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:41:17,635 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:41:17.635427
2025-10-15 21:41:17,636 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,637 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,638 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,640 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0014967999886721373}
2025-10-15 21:41:17,641 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:17.635Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,661 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 20.261000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,662 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,663 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,664 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,665 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,667 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011585000029299408}
2025-10-15 21:41:17,669 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:17.635Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,759 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 90.408, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,762 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,763 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,764 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,765 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,766 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011492999910842627}
2025-10-15 21:41:17,767 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"getMore\": 191292709385973757, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:18,216 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 448.913, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:18,218 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:18,220 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:41:18,227 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:41:18,236 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:41:18,237 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:41:18,238 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:41:18,239 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:41:18,242 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:41:18,248 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:41:18,250 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:41:18,251 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:41:18,254 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:41:18,258 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:41:18,355 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:41:18,357 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:41:18,358 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:41:18,359 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:41:18,360 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:41:18,361 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:41:18,363 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:41:18,372 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:41:18,376 - backend.database_builder - INFO - Inserted 6 records into table 事件监控-光模块故障表
2025-10-15 21:41:18,427 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:41:18,477 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:41:18,665 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.05358219999470748}
2025-10-15 21:41:18,667 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:41:18,698 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.019659500001580454}
2025-10-15 21:41:18,700 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:41:18,759 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023579400003654882}
2025-10-15 21:41:18,760 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:41:18,800 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02887639999971725}
2025-10-15 21:41:19,044 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1525.4249999998137, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:48:39,932 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:48:39,932 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:48:40,745 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,746 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "previousDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:48:40,747 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,749 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:48:40,753 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,754 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "remainingTimeMS": 4998}
2025-10-15 21:48:40,775 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:48:40,787 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverConnectionId": 42791, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.42020000750199, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:48:38.452Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42791, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:48:40,789 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,790 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "previousDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>"}
2025-10-15 21:48:40,791 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,792 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverConnectionId": 42791, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:48:40,793 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,795 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,879 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07432270000572316}
2025-10-15 21:48:40,880 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08674420000170358}
2025-10-15 21:48:40,881 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,891 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 9.898, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,892 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,892 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:48:40,893 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:48:40.893483
2025-10-15 21:48:40,894 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,895 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,897 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,897 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008760999917285517}
2025-10-15 21:48:40,899 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:40.893Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,922 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 23.499, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,923 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,925 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,926 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,926 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,927 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006239000067580491}
2025-10-15 21:48:40,928 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:40.893Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,998 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 69.982, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,003 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,005 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:41,006 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,007 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,009 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001539100005174987}
2025-10-15 21:48:41,010 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"getMore\": 2761820994334931500, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,330 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 320.034, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,333 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,336 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:48:41,341 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:48:41,350 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:48:41,351 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:48:41,355 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:48:41,356 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:48:41,359 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x00000229D64A3110>
2025-10-15 21:48:41,360 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:48:41,368 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,371 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "previousDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:48:41,372 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,376 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:48:41,382 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,385 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "remainingTimeMS": 4996}
2025-10-15 21:48:41,391 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:48:41,401 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverConnectionId": 42794, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.80660000257194, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:48:39.066Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42794, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:48:41,403 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,404 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "previousDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>"}
2025-10-15 21:48:41,406 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,407 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverConnectionId": 42794, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:48:41,408 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,410 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,506 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06546959999832325}
2025-10-15 21:48:41,507 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09855729999253526}
2025-10-15 21:48:41,508 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,529 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 21.408, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,530 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,531 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:48:41,532 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:48:41.532237
2025-10-15 21:48:41,533 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,536 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,538 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,539 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007875999872339889}
2025-10-15 21:48:41,540 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:41.532Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,561 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 20.559, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,562 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,563 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,564 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,566 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,568 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0025396999990334734}
2025-10-15 21:48:41,570 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:41.532Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,642 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 72.238, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,644 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,645 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,645 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,646 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,647 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000586000009207055}
2025-10-15 21:48:41,648 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"getMore\": 8689348324599948128, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,911 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 263.63599999999997, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,913 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,915 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:48:41,916 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:48:41,922 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:48:41,922 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:48:41,923 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:48:41,924 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:48:41,925 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:48:41,929 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:48:41,930 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:48:41,931 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:48:41,932 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:48:41,933 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:48:42,129 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:48:42,130 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:48:42,131 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:48:42,133 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:48:42,134 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:48:42,134 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:48:42,137 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:48:42,138 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:48:42,142 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:48:42,197 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:48:42,436 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1028.9198000100441, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:51:54,549 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:51:54,549 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:51:55,140 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,142 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:51:55,143 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,146 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:51:55,152 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,153 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "remainingTimeMS": 4998}
2025-10-15 21:51:55,172 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:51:55,194 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverConnectionId": 42798, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.043300005141646, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:51:52.860Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42798, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:51:55,197 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,198 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>"}
2025-10-15 21:51:55,199 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,200 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,201 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,206 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverConnectionId": 42798, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:51:55,319 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.10117510000418406}
2025-10-15 21:51:55,320 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11996219999855384}
2025-10-15 21:51:55,321 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,333 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 11.926, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,334 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,335 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:51:55,336 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:51:55.336380
2025-10-15 21:51:55,337 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,338 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,339 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,341 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0014795000024605542}
2025-10-15 21:51:55,343 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:55.336Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,362 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 19.748, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,363 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,365 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,366 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,367 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,368 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009962000040104613}
2025-10-15 21:51:55,370 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:55.336Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,451 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 81.114, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,456 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,457 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,458 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,459 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,460 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009806999878492206}
2025-10-15 21:51:55,462 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"getMore\": 8255088930409715994, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,800 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 338.793, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,806 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,809 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:51:55,814 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:51:55,828 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:51:55,829 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:51:55,862 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:51:55,863 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:51:55,870 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002D274382FD0>
2025-10-15 21:51:55,871 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:51:55,883 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:55,887 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:51:55,888 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,896 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:51:55,901 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:55,903 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "remainingTimeMS": 4997}
2025-10-15 21:51:55,942 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:51:55,954 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverConnectionId": 42801, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.205700004007667, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:51:53.624Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42801, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:51:55,956 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,957 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>"}
2025-10-15 21:51:55,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,967 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverConnectionId": 42801, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:51:55,968 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,971 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,095 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09189969999715686}
2025-10-15 21:51:56,099 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.13051160000031814}
2025-10-15 21:51:56,103 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,134 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 30.951, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,144 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,145 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:51:56,146 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:51:56.146643
2025-10-15 21:51:56,163 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,179 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,182 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0026959999959217384}
2025-10-15 21:51:56,185 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:56.146Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,222 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 37.083, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,226 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,229 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,230 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,232 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002549700002418831}
2025-10-15 21:51:56,237 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:56.146Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,366 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 129.28799999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,369 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,370 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,371 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,373 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,374 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009608999971533194}
2025-10-15 21:51:56,379 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"getMore\": 3873085917204919547, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,793 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 413.588, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,795 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,798 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:51:56,800 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:51:56,808 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:51:56,808 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:51:56,809 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:51:56,810 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:51:56,813 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:51:56,822 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:51:56,823 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:51:56,824 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:51:56,826 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:51:56,827 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:51:56,903 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:51:56,904 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:51:56,908 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:51:56,908 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:51:56,909 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:51:56,910 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:51:56,911 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:51:56,911 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:51:56,912 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:51:56,914 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:51:56,983 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.05662329999904614}
2025-10-15 21:51:56,985 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:51:56,991 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:51:57,021 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.01944369998818729}
2025-10-15 21:51:57,022 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:51:57,052 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.019824599992716685}
2025-10-15 21:51:57,053 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:51:57,085 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02183589999913238}
2025-10-15 21:51:57,511 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1544.3687999941176, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:54:47,323 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:54:47,324 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:54:47,825 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,826 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "previousDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:54:47,827 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,829 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:54:47,833 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,834 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "remainingTimeMS": 4998}
2025-10-15 21:54:47,844 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:54:47,865 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverConnectionId": 42809, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 20.74490000086371, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:54:45.533Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42809, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:54:47,867 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,867 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "previousDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>"}
2025-10-15 21:54:47,869 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,870 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverConnectionId": 42809, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:54:47,871 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,872 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:47,963 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07692799999495037}
2025-10-15 21:54:47,964 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09288820000074338}
2025-10-15 21:54:47,965 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,976 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 10.799, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,978 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:47,979 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:54:47,980 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:54:47.980035
2025-10-15 21:54:47,981 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,982 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,982 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,983 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007210000039776787}
2025-10-15 21:54:47,984 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:47.980Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,004 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 19.699, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,005 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,007 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:48,008 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,009 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,011 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0016450999974040315}
2025-10-15 21:54:48,013 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:47.980Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,085 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 72.738, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,089 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,090 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:48,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,092 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,092 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004969000001437962}
2025-10-15 21:54:48,093 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"getMore\": 642056611885069641, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,399 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 306.283, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,403 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,406 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:54:48,412 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:54:48,423 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:54:48,423 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:54:48,442 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:54:48,443 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:54:48,449 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001C58E7F3390>
2025-10-15 21:54:48,454 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:54:48,462 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,465 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "previousDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:54:48,469 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,473 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:54:48,478 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,479 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "remainingTimeMS": 4998}
2025-10-15 21:54:48,486 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:54:48,496 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverConnectionId": 42812, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.6035999993328, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:54:46.164Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42812, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:54:48,499 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,500 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "previousDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>"}
2025-10-15 21:54:48,502 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,502 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverConnectionId": 42812, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:54:48,503 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,505 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,586 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0702447000076063}
2025-10-15 21:54:48,587 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08364089998940472}
2025-10-15 21:54:48,588 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,600 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 11.892, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,601 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,602 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:54:48,602 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:54:48.602866
2025-10-15 21:54:48,603 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,604 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,605 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,606 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000774300002376549}
2025-10-15 21:54:48,607 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:48.602Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,629 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 22.093999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,632 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,634 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,636 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,637 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,638 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007474000012734905}
2025-10-15 21:54:48,639 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:48.602Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,718 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 78.22500000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,719 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,721 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,722 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,723 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,723 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006567999953404069}
2025-10-15 21:54:48,724 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"getMore\": 3244617196764948786, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:49,159 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 435.26599999999996, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:49,161 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:49,164 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:54:49,166 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:54:49,176 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:54:49,177 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:54:49,179 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:54:49,182 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:54:49,184 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:54:49,192 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:54:49,193 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:54:49,195 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:54:49,197 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:54:49,198 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:54:49,279 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:54:49,281 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:54:49,282 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:54:49,284 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:54:49,286 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:54:49,295 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:54:49,296 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:54:49,297 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:54:49,300 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:54:49,385 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:54:49,523 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1020.6214999925578, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:56:18,326 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:56:18,326 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:56:18,723 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,723 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "previousDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:56:18,724 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,725 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:56:18,728 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,729 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "remainingTimeMS": 4999}
2025-10-15 21:56:18,757 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:56:18,771 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverConnectionId": 42816, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.101100001018494, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:56:16.442Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42816, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:56:18,772 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,774 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "previousDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>"}
2025-10-15 21:56:18,776 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,777 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverConnectionId": 42816, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:56:18,778 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,779 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,845 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056574099988210946}
2025-10-15 21:56:18,845 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06763689999934286}
2025-10-15 21:56:18,846 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,856 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 10.234, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,857 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,858 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:56:18,859 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:56:18.859292
2025-10-15 21:56:18,860 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,861 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,861 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,862 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005152999947313219}
2025-10-15 21:56:18,862 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:18.859Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,882 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 19.541, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,883 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,884 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,884 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,885 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,886 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00048750000132713467}
2025-10-15 21:56:18,886 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:18.859Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,956 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 69.53, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,960 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,961 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000211D8322C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,961 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000211D8322C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,962 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,963 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005035999929532409}
2025-10-15 21:56:18,963 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"getMore\": 6638224362842435104, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:19,291 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 328.04100000000005, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:19,293 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:19,294 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:56:19,300 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 387, in query_event_monitor_demo
    module_name = optical_module.get("module_name", "non-data")
                  ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:56:19,300 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:56:19,794 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1017.3420000064652, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:56:37,906 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:56:37,907 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:56:38,227 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,227 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "previousDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:56:38,228 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,229 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:56:38,231 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,232 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "remainingTimeMS": 4999}
2025-10-15 21:56:38,241 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:56:38,253 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverConnectionId": 42819, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.27489999635145, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:56:35.925Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42819, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:56:38,254 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,254 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "previousDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>"}
2025-10-15 21:56:38,255 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,256 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverConnectionId": 42819, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:56:38,256 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,257 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,325 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056778900005156174}
2025-10-15 21:56:38,326 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06968659999256488}
2025-10-15 21:56:38,327 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,337 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 10.644, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,338 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,338 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:56:38,339 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:56:38.339152
2025-10-15 21:56:38,339 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,340 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,341 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,342 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004444999940460548}
2025-10-15 21:56:38,342 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:38.339Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,362 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 20.154, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,363 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,364 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,364 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,365 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,365 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00038219999987632036}
2025-10-15 21:56:38,366 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:38.339Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,428 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 62.021, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,430 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,431 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002A9B7D22C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,431 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002A9B7D22C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,432 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,432 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00037960000918246806}
2025-10-15 21:56:38,433 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"getMore\": 5828647788721058203, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,651 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 217.78300000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,652 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,653 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:56:38,657 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 387, in query_event_monitor_demo
    module_name = optical_module.get("module_name", "non-data")
                  ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:56:38,657 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:56:38,759 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 503.1449999951292, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:59:14,323 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:59:14,324 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:59:14,954 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:14,955 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "previousDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:59:14,956 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:14,958 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:59:14,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:14,963 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "remainingTimeMS": 4998}
2025-10-15 21:59:14,997 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:59:15,008 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverConnectionId": 42825, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.260600010748021, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:59:12.681Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42825, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:59:15,010 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,011 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "previousDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>"}
2025-10-15 21:59:15,013 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,015 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverConnectionId": 42825, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:59:15,016 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,020 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,113 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07035950000863522}
2025-10-15 21:59:15,114 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09840149999945424}
2025-10-15 21:59:15,115 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,125 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 9.998999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,126 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,127 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:59:15,127 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:59:15.127849
2025-10-15 21:59:15,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,129 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,130 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,131 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006229999999050051}
2025-10-15 21:59:15,131 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.127Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,152 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 21.023, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,154 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,155 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,156 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,156 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,157 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006013999955030158}
2025-10-15 21:59:15,158 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.127Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,233 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 74.828, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,236 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,237 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,238 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,239 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,239 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000562699991860427}
2025-10-15 21:59:15,240 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"getMore\": 478595367856304872, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,585 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 345.42699999999996, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,587 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,588 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:59:15,607 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 466 条记录
2025-10-15 21:59:15,615 - backend.data_loader - DEBUG - Loaded 466 records from MongoDB
2025-10-15 21:59:15,615 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:59:15,620 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:59:15,621 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:59:15,623 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x00000171BF183390>
2025-10-15 21:59:15,624 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:59:15,629 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,630 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "previousDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:59:15,635 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,637 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:59:15,639 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,640 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "remainingTimeMS": 4999}
2025-10-15 21:59:15,648 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:59:15,657 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverConnectionId": 42828, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.477399998810142, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:59:13.330Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42828, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:59:15,659 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,659 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "previousDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>"}
2025-10-15 21:59:15,661 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,661 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverConnectionId": 42828, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:59:15,662 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,665 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,732 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05665549999685027}
2025-10-15 21:59:15,733 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07063299999572337}
2025-10-15 21:59:15,734 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,744 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 10.181000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,745 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,746 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:59:15,746 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:59:15.746900
2025-10-15 21:59:15,747 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,749 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,750 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005434999911813065}
2025-10-15 21:59:15,751 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.746Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,772 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 20.962999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,773 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,774 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,775 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,776 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,777 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011341000063112006}
2025-10-15 21:59:15,779 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.746Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,848 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 69.34899999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,851 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,852 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,853 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,854 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,855 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007027999963611364}
2025-10-15 21:59:15,855 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"getMore\": 4863982385481659248, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:16,202 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 346.874, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:16,204 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:16,207 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:59:16,234 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 466 条记录
2025-10-15 21:59:16,254 - backend.data_loader - DEBUG - Loaded 466 records from MongoDB
2025-10-15 21:59:16,255 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:59:16,255 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:59:16,256 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:59:16,259 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:59:16,268 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:59:16,271 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:59:16,272 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:59:16,273 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:59:16,274 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:59:16,354 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:59:16,355 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:59:16,356 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:59:16,356 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:59:16,357 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:59:16,358 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:59:16,358 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:59:16,359 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:59:16,369 - backend.database_builder - INFO - Inserted 466 records into table 事件监控-光模块故障表
2025-10-15 21:59:16,402 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:59:16,690 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1029.2006999952719, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 18:25:45,567 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:25:45,569 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:25:45,947 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:45,948 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "previousDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:25:45,949 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:45,950 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:25:45,954 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:45,954 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "remainingTimeMS": 4999}
2025-10-18 18:25:45,977 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:25:46,020 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "driverConnectionId": 1, "serverConnectionId": 45573, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 41.61249997559935, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:25:40.356Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45573, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:25:46,043 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,044 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "previousDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>"}
2025-10-18 18:25:46,045 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,051 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,053 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "driverConnectionId": 1, "serverConnectionId": 45573, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:25:46,068 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,296 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.19596779998391867}
2025-10-18 18:25:46,297 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.24586689998977818}
2025-10-18 18:25:46,298 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,349 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 50.776, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,351 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,352 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:25:46,352 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:25:46.352705
2025-10-18 18:25:46,353 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:46,354 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,355 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,355 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005484999855980277}
2025-10-18 18:25:46,356 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:46.352Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,381 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 24.798000000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,383 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,384 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:46,385 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,386 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,387 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005575999966822565}
2025-10-18 18:25:46,388 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:46.352Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,691 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 303.613, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,701 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,702 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:46,703 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,704 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,705 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007919000054243952}
2025-10-18 18:25:46,706 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"getMore\": 8318068146207549427, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,954 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 18:25:47,074 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.07504060000064783}
2025-10-18 18:25:47,075 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 18:25:47,209 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.03857629999401979}
2025-10-18 18:25:47,210 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 18:25:47,320 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.051711700012674555}
2025-10-18 18:25:47,323 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 18:25:47,448 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04446910001570359}
2025-10-18 18:25:47,702 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 996.4739999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,704 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:47,706 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:25:47,709 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 11 条记录
2025-10-18 18:25:47,719 - backend.data_loader - DEBUG - Loaded 11 records from MongoDB
2025-10-18 18:25:47,719 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:25:47,725 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:25:47,726 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 18:25:47,743 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001B707052C10>
2025-10-18 18:25:47,744 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:25:47,750 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:47,751 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "previousDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:25:47,752 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,753 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:25:47,758 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:47,759 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "remainingTimeMS": 4998}
2025-10-18 18:25:47,792 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:25:47,809 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "driverConnectionId": 1, "serverConnectionId": 45580, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.15070000034757, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:25:42.175Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45580, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:25:47,811 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,813 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "previousDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>"}
2025-10-18 18:25:47,816 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,817 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "driverConnectionId": 1, "serverConnectionId": 45580, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:25:47,818 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,820 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,010 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1791275000141468}
2025-10-18 18:25:48,057 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.2391666999901645}
2025-10-18 18:25:48,072 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,084 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 12.600999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,086 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,086 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:25:48,087 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:25:48.087720
2025-10-18 18:25:48,088 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:48,090 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,091 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,091 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007611000037286431}
2025-10-18 18:25:48,092 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:48.087Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,138 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 45.258, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,139 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,140 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:48,141 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,142 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,143 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000686999992467463}
2025-10-18 18:25:48,144 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:48.087Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,259 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 115.19699999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,263 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,264 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:48,265 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,266 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,267 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007027999963611364}
2025-10-18 18:25:48,267 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"getMore\": 1683173298301450532, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,780 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 18:25:48,810 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 542.7180000000001, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,814 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,816 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:25:48,819 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 11 条记录
2025-10-18 18:25:48,830 - backend.data_loader - DEBUG - Loaded 11 records from MongoDB
2025-10-18 18:25:48,832 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:25:48,835 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 18:25:48,837 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:25:48,847 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:25:48,851 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:25:48,852 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:25:48,853 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:25:48,854 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:25:48,855 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:25:48,856 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:25:48,862 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.0319358000124339}
2025-10-18 18:25:48,865 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:25:48,866 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 18:25:48,868 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:25:48,869 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:25:48,870 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:25:48,872 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:25:48,872 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:25:48,876 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:25:48,877 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:25:48,902 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.022860400000354275}
2025-10-18 18:25:48,903 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 18:25:49,120 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 18:25:49,123 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:25:49,124 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.18961010000202805}
2025-10-18 18:25:49,131 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:25:49,132 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 18:25:49,134 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:25:49,138 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:25:49,139 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:25:49,140 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:25:49,140 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:25:49,141 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:25:49,142 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:25:49,142 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:25:49,144 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:25:49,147 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:25:49,148 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:25:49,149 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:25:49,149 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:25:49,150 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:25:49,159 - backend.database_builder - INFO - Inserted 11 records into table 事件监控-光模块故障表
2025-10-18 18:25:49,203 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.05207570001948625}
2025-10-18 18:25:49,224 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 18:25:49,352 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1535.4507000010926, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 18:34:48,249 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:34:48,249 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:34:48,416 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,416 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "previousDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:34:48,416 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,417 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:34:48,419 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,419 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "remainingTimeMS": 4999}
2025-10-18 18:34:48,449 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:34:48,461 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "driverConnectionId": 1, "serverConnectionId": 45589, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.377999995602295, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:34:42.830Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45589, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:34:48,461 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,462 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "previousDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>"}
2025-10-18 18:34:48,462 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,462 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "driverConnectionId": 1, "serverConnectionId": 45589, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:34:48,463 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,463 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,517 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04264230001717806}
2025-10-18 18:34:48,517 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.054292699991492555}
2025-10-18 18:34:48,518 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,529 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 11.198, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,529 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,529 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:34:48,530 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:34:48.530061
2025-10-18 18:34:48,530 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,530 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,530 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,531 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00021040000137872994}
2025-10-18 18:34:48,531 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:48.530Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,554 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 22.603, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,554 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,554 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,555 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,555 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,555 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00019650001195259392}
2025-10-18 18:34:48,555 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:48.530Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,630 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 74.935, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,632 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,633 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,633 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,633 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,634 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002154999820049852}
2025-10-18 18:34:48,634 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"getMore\": 1143578447385398918, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,014 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 380.567, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,015 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,016 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:34:49,030 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 18:34:49,033 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 18:34:49,033 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:34:49,036 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:34:49,036 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 18:34:49,037 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002457D823390>
2025-10-18 18:34:49,037 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:34:49,038 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,038 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "previousDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:34:49,039 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,039 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:34:49,040 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,040 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "remainingTimeMS": 4999}
2025-10-18 18:34:49,075 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:34:49,090 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "driverConnectionId": 1, "serverConnectionId": 45592, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.339200017275289, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:34:43.458Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45592, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:34:49,091 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,092 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "previousDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>"}
2025-10-18 18:34:49,092 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,093 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "driverConnectionId": 1, "serverConnectionId": 45592, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:34:49,093 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,094 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,141 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03600309998728335}
2025-10-18 18:34:49,142 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.048364799993578345}
2025-10-18 18:34:49,142 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,152 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 10.266, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,153 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,153 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:34:49,154 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:34:49.154016
2025-10-18 18:34:49,154 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,154 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,155 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,155 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00019609997980296612}
2025-10-18 18:34:49,155 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:49.154Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,173 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 18.395000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,174 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,174 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,175 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,176 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,176 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002804999821819365}
2025-10-18 18:34:49,176 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:49.154Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,255 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 78.387, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,256 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,256 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,256 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,257 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,257 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003043999895453453}
2025-10-18 18:34:49,257 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"getMore\": 5285905477664583787, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,737 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 480.208, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,738 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,739 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:34:49,752 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 18:34:49,755 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 18:34:49,755 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:34:49,755 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 18:34:49,756 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:34:49,758 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:34:49,758 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:34:49,758 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:34:49,760 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:34:49,760 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:34:49,760 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:34:49,761 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:34:49,761 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:34:49,761 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:34:49,763 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:34:49,803 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:34:49,817 - backend.database_builder - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 18:34:49,834 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 18:34:50,121 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1027.3723999853246, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 18:45:45,829 - data_loader - ERROR - File not found: 20250813光模块分析.xlsx (status=1)
2025-10-18 18:45:45,830 - data_loader - ERROR - Initialization failed: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\data_loader.py", line 43, in __init__
    raise FileNotFoundError(f"Excel file not found: {file_path}")
FileNotFoundError: Excel file not found: 20250813光模块分析.xlsx

2025-10-18 18:46:09,971 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:46:09,971 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 18:46:09,972 - __main__ - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001BDCE920D70>
2025-10-18 18:46:09,972 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:46:10,104 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,104 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "previousDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:46:10,104 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,105 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:46:10,107 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,107 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "remainingTimeMS": 4999}
2025-10-18 18:46:10,140 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:46:10,153 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "driverConnectionId": 1, "serverConnectionId": 45599, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.545599980512634, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:46:04.535Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45599, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:46:10,154 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,154 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "previousDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>"}
2025-10-18 18:46:10,155 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,155 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "driverConnectionId": 1, "serverConnectionId": 45599, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:46:10,156 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,157 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,211 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04150099999969825}
2025-10-18 18:46:10,211 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05529899999964982}
2025-10-18 18:46:10,211 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,223 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 11.520000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,224 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,224 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:46:10,224 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:46:10.224777
2025-10-18 18:46:10,225 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,225 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,226 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,226 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003491000097710639}
2025-10-18 18:46:10,226 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:46:10.224Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,247 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 20.953, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,248 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,249 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,249 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,249 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,250 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002995999820996076}
2025-10-18 18:46:10,250 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:46:10.224Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,355 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 105.42500000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,357 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,357 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BDCEBEF240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,358 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BDCEBEF240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,358 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,359 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002924000145867467}
2025-10-18 18:46:10,359 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"getMore\": 1016983114054841584, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,713 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 353.71599999999995, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,714 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,714 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:46:10,732 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 18:46:10,735 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 18:46:10,735 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:46:10,735 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 18:46:10,736 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:46:10,738 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:46:10,738 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:46:10,738 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:46:10,739 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:46:10,739 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:46:10,739 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:46:10,740 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:46:10,740 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:46:10,740 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:46:10,741 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:46:10,741 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:46:10,741 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:46:10,742 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:46:10,742 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:46:10,742 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:46:10,768 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:46:10,772 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:46:10,772 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:46:10,780 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 18:46:10,793 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 18:46:11,177 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1021.627800015267, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 20:51:07,783 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 20:51:07,785 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 20:51:07,803 - __main__ - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001B7D5390D70>
2025-10-18 20:51:07,804 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 20:51:09,738 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:09,740 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "previousDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 20:51:09,741 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,743 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 20:51:09,749 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:09,750 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "remainingTimeMS": 4998}
2025-10-18 20:51:09,814 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 20:51:09,883 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "driverConnectionId": 1, "serverConnectionId": 45657, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 67.90339999133721, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T12:51:03.137Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45657, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 20:51:09,885 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,886 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "previousDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>"}
2025-10-18 20:51:09,888 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,890 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "driverConnectionId": 1, "serverConnectionId": 45657, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 20:51:09,891 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,894 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:10,153 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.18449169999803416}
2025-10-18 20:51:10,154 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.2632819999998901}
2025-10-18 20:51:10,155 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,172 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 16.297, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,173 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:10,174 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 20:51:10,175 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 20:51:10.175718
2025-10-18 20:51:10,176 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:10,178 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,179 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,180 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001136499980930239}
2025-10-18 20:51:10,181 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T20:51:10.175Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,216 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 34.303, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,217 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:10,219 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:10,221 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,223 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,224 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001370599988149479}
2025-10-18 20:51:10,226 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T20:51:10.175Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,751 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 20:51:12,003 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.17179929997655563}
2025-10-18 20:51:12,005 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 20:51:12,128 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 1902.836, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,146 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:12,147 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B7D565F240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:12,149 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B7D565F240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,151 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,154 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002653700008522719}
2025-10-18 20:51:12,156 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"getMore\": 2692390928945327481, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,179 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.07488989998819306}
2025-10-18 20:51:12,181 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 20:51:12,241 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.03705030001583509}
2025-10-18 20:51:12,243 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 20:51:12,315 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04948440002044663}
2025-10-18 20:51:13,274 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 1117.79, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:13,275 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:13,276 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 20:51:13,314 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 20:51:13,321 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 20:51:13,322 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 20:51:13,323 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 20:51:13,323 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 20:51:13,329 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 20:51:13,330 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 20:51:13,331 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 20:51:13,332 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 20:51:13,332 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 20:51:13,333 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 20:51:13,334 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 20:51:13,337 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 20:51:13,338 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 20:51:13,339 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 20:51:13,340 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 20:51:13,341 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 20:51:13,342 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 20:51:13,345 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 20:51:13,346 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 20:51:13,346 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 20:51:13,424 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 20:51:13,426 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 20:51:13,427 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 20:51:13,428 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 20:51:13,428 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 20:51:13,429 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 20:51:13,429 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 20:51:13,430 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 20:51:13,430 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 20:51:13,431 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 20:51:13,431 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 20:51:13,431 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 20:51:13,432 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 20:51:13,432 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 20:51:13,433 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 20:51:13,433 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 20:51:13,434 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 20:51:13,434 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 20:51:13,459 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 20:51:13,484 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 20:51:13,974 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 4084.5706000109203, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 23:29:25,751 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 23:29:25,754 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-18 23:29:25,754 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 23:29:25,755 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000029EDFD1CD70>
2025-10-18 23:29:25,755 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 23:29:26,729 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,731 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "previousDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 23:29:26,731 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,732 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 23:29:26,734 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,735 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "remainingTimeMS": 4999}
2025-10-18 23:29:26,755 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 23:29:26,766 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.130799986654893, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T15:29:20.547Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45727, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 23:29:26,766 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,767 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "previousDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>"}
2025-10-18 23:29:26,767 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,768 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 23:29:26,768 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,768 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,820 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.042580600013025105}
2025-10-18 23:29:26,821 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05297920000157319}
2025-10-18 23:29:26,821 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,831 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 9.530000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,831 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,832 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 23:29:26,832 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 23:29:26.832438
2025-10-18 23:29:26,833 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,833 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,833 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,834 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003060000017285347}
2025-10-18 23:29:26,834 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T23:29:26.832Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,854 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 20.119, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,855 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,855 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,856 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,856 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,856 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022620000527240336}
2025-10-18 23:29:26,856 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T23:29:26.832Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,955 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 98.15599999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,961 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000029EDFFEF4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000029EDFFEF4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,963 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,963 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003330000035930425}
2025-10-18 23:29:26,964 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"getMore\": 7859898831059463066, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:27,432 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 468.474, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:27,433 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:27,434 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 23:29:27,448 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 23:29:27,451 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 23:29:27,452 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 23:29:27,452 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 23:29:27,452 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 23:29:27,454 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 23:29:27,455 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 23:29:27,455 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 23:29:27,493 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 23:29:27,504 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 23:29:27,505 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x0000029EDFD1CEC0>
2025-10-18 23:29:27,505 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-18 23:29:27,507 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-18 23:29:27,735 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 23:29:27,773 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02563050002208911}
2025-10-18 23:29:27,774 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 23:29:27,820 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.03643979999469593}
2025-10-18 23:29:27,821 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 23:29:27,878 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023953800002345815}
2025-10-18 23:29:27,879 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 23:29:27,912 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02104029999463819}
2025-10-18 23:29:28,477 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:28,526 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-18 23:29:28,527 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-18 23:29:29,623 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:29,667 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-18 23:29:29,667 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-18 23:29:30,627 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:30,744 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-18 23:29:30,744 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-18 23:29:31,771 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:31,912 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-18 23:29:31,913 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-18 23:29:32,912 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:32,997 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-18 23:29:32,997 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-18 23:29:33,978 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:34,042 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-18 23:29:34,042 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-18 23:29:35,077 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:35,116 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-18 23:29:35,117 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-18 23:29:36,121 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:36,196 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-18 23:29:36,197 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-18 23:29:36,780 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10011.663399985991, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T15:29:30.559Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45727, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 23:29:36,782 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 23:29:37,097 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:37,141 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-18 23:29:37,142 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-18 23:29:38,125 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:38,167 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-18 23:29:38,167 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-18 23:29:39,120 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:39,164 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-18 23:29:39,164 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-18 23:29:40,045 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:40,088 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-18 23:29:40,088 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-18 23:29:41,037 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:41,085 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-18 23:29:41,085 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-18 23:29:42,084 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:42,128 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-18 23:29:42,138 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-18 23:29:43,035 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:43,086 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-18 23:29:43,086 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-18 23:29:43,971 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:44,028 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-18 23:29:44,030 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-18 23:29:44,949 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:44,995 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-18 23:29:44,995 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-18 23:29:45,900 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:45,943 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-18 23:29:45,943 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-18 23:29:46,790 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10006.146399973659, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T15:29:40.570Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45727, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 23:29:46,791 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 23:29:46,913 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:46,955 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-18 23:29:46,956 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-18 23:29:47,838 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-18 23:29:48,317 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1525.8389999798965, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 23:32:09,854 - backend.data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-18 23:32:09,854 - backend.data_loader - DEBUG - Loading optical module inventory data from API
2025-10-18 23:32:09,862 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-18 23:32:10,953 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:10,997 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-18 23:32:10,999 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-18 23:32:11,979 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:12,029 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-18 23:32:12,030 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-18 23:32:13,001 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:13,059 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-18 23:32:13,060 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-18 23:32:14,115 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:14,159 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-18 23:32:14,160 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-18 23:32:15,101 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:15,145 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-18 23:32:15,146 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-18 23:32:16,195 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:16,296 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-18 23:32:16,297 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-18 23:32:17,284 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:17,331 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-18 23:32:17,332 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-18 23:32:18,267 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:18,317 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-18 23:32:18,318 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-18 23:32:19,259 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:19,305 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-18 23:32:19,305 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-18 23:32:20,286 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:20,327 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-18 23:32:20,328 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-18 23:32:21,238 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:21,289 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-18 23:32:21,290 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-18 23:32:22,257 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:22,300 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-18 23:32:22,300 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-18 23:32:23,241 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:23,297 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-18 23:32:23,299 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-18 23:32:24,309 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:24,441 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-18 23:32:24,441 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-18 23:32:25,330 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:25,376 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-18 23:32:25,376 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-18 23:32:26,320 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:26,369 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-18 23:32:26,369 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-18 23:32:27,329 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:27,372 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-18 23:32:27,372 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-18 23:32:28,275 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:28,320 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-18 23:32:28,320 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-18 23:32:29,210 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:29,251 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-18 23:32:29,252 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-18 23:32:30,173 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:30,219 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-18 23:32:30,220 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-18 23:32:31,155 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:31,200 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-18 23:32:31,200 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-18 23:32:32,053 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:32,092 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-18 23:32:32,093 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-18 23:32:32,974 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:33,021 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-18 23:32:33,021 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-18 23:32:33,915 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:33,959 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-18 23:32:33,960 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-18 23:32:34,773 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:34,813 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-18 23:32:34,813 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-18 23:32:35,668 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:35,711 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-18 23:32:35,711 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-18 23:32:36,550 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:36,594 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-18 23:32:36,595 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-18 23:32:37,477 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:37,519 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-18 23:32:37,519 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-18 23:32:38,341 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:38,400 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-18 23:32:38,401 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-18 23:32:39,217 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:39,267 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-18 23:32:39,267 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-18 23:32:40,108 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:40,147 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-18 23:32:40,147 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-18 23:32:40,973 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:41,012 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-18 23:32:41,012 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-18 23:32:41,808 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:41,853 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-18 23:32:41,854 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-18 23:32:42,707 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:42,745 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-18 23:32:42,746 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-18 23:32:43,577 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:43,618 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-18 23:32:43,619 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-18 23:32:44,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:44,422 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-18 23:32:44,423 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-18 23:32:45,201 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:45,242 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-18 23:32:45,243 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-18 23:32:46,062 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:46,109 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-18 23:32:46,110 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-18 23:32:46,891 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:46,932 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-18 23:32:46,933 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-18 23:32:47,718 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:47,768 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-18 23:32:47,769 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-18 23:32:48,623 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:48,669 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-18 23:32:48,670 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-18 23:32:49,496 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:49,549 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-18 23:32:49,550 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-18 23:32:50,383 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:50,432 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-18 23:32:50,432 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-18 23:32:51,269 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:51,318 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-18 23:32:51,318 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-18 23:32:52,103 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:52,156 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-18 23:32:52,157 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-18 23:32:52,941 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:52,987 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-18 23:32:52,988 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-18 23:32:53,731 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:53,773 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-18 23:32:53,774 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-18 23:32:54,302 - backend.data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-18 23:32:54,303 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_optical_module.db
2025-10-18 23:32:54,305 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalModuleInventoryDataSourceLoader object at 0x000001910A2F4D70>
2025-10-18 23:32:54,305 - backend.data_loader - DEBUG - Loading optical module inventory data from API
2025-10-18 23:32:54,313 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-18 23:32:54,559 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:54,599 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-18 23:32:54,599 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-18 23:32:55,596 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:55,599 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:55,661 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-18 23:32:55,665 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-18 23:32:55,669 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-18 23:32:55,669 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-18 23:32:56,627 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:56,672 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-18 23:32:56,673 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-18 23:32:57,071 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:57,115 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-18 23:32:57,115 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-18 23:32:57,534 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:57,576 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-18 23:32:57,576 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-18 23:32:58,311 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:58,359 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-18 23:32:58,359 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-18 23:32:58,477 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:58,526 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-18 23:32:58,528 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-18 23:32:59,413 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:59,452 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-18 23:32:59,453 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-18 23:32:59,543 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:59,584 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-18 23:32:59,585 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-18 23:33:00,253 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:00,301 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-18 23:33:00,309 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-18 23:33:00,816 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:00,899 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-18 23:33:00,899 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-18 23:33:01,174 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:01,231 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-18 23:33:01,232 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-18 23:33:01,997 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:02,041 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:02,044 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-18 23:33:02,045 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-18 23:33:02,174 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-18 23:33:02,198 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-18 23:33:02,970 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:03,014 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-18 23:33:03,015 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-18 23:33:03,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:03,544 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-18 23:33:03,545 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-18 23:33:03,777 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:03,816 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-18 23:33:03,817 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-18 23:33:04,572 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:04,615 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-18 23:33:04,616 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-18 23:33:04,676 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:04,721 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-18 23:33:04,722 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-18 23:33:05,388 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:05,446 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-18 23:33:05,447 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-18 23:33:05,952 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:05,997 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-18 23:33:05,997 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-18 23:33:06,210 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:06,258 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-18 23:33:06,259 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-18 23:33:07,002 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:07,041 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-18 23:33:07,042 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-18 23:33:07,092 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:07,130 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-18 23:33:07,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-18 23:33:07,804 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:07,848 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-18 23:33:07,849 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-18 23:33:08,289 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:08,332 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-18 23:33:08,333 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-18 23:33:08,533 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:08,572 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-18 23:33:08,572 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-18 23:33:09,374 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:09,416 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-18 23:33:09,416 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-18 23:33:09,540 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:09,582 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-18 23:33:09,583 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-18 23:33:10,056 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:10,124 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-18 23:33:10,125 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-18 23:33:10,690 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:10,735 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-18 23:33:10,735 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-18 23:33:10,872 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:10,916 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-18 23:33:10,917 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-18 23:33:11,504 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:11,543 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-18 23:33:11,545 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-18 23:33:11,801 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:11,848 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-18 23:33:11,849 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-18 23:33:12,196 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:12,230 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-18 23:33:12,230 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-18 23:33:12,858 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:12,895 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-18 23:33:12,895 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-18 23:33:13,005 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:13,058 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-18 23:33:13,058 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-18 23:33:13,434 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:13,468 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-18 23:33:13,469 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-18 23:33:14,000 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:14,037 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-18 23:33:14,037 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-18 23:33:14,042 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:14,083 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-18 23:33:14,083 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-18 23:33:14,622 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:14,652 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-18 23:33:14,652 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-18 23:33:15,253 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:15,270 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:15,295 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-18 23:33:15,295 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-18 23:33:15,306 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-18 23:33:15,307 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-18 23:33:15,929 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:15,962 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-18 23:33:15,962 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-18 23:33:16,454 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:16,476 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:16,501 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-18 23:33:16,502 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-18 23:33:16,512 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-18 23:33:16,513 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-18 23:33:17,085 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:17,119 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-18 23:33:17,119 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-18 23:33:17,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:17,615 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:17,697 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-18 23:33:17,698 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-18 23:33:17,702 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-18 23:33:17,702 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-18 23:33:18,188 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:18,224 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-18 23:33:18,224 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-18 23:33:18,738 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:18,752 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:18,794 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-18 23:33:18,794 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-18 23:33:18,828 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-18 23:33:18,829 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-18 23:33:19,268 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:19,302 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-18 23:33:19,302 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-18 23:33:19,773 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:19,814 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-18 23:33:19,815 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-18 23:33:19,876 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:19,920 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-18 23:33:19,921 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-18 23:33:20,213 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:20,241 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-18 23:33:20,242 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-18 23:33:20,645 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:20,678 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-18 23:33:20,679 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-18 23:33:20,951 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:20,998 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-18 23:33:20,998 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-18 23:33:21,011 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:21,043 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-18 23:33:21,043 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-18 23:33:21,444 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:21,472 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-18 23:33:21,473 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-18 23:33:21,859 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:21,893 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-18 23:33:21,893 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-18 23:33:22,110 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,159 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-18 23:33:22,160 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-18 23:33:22,243 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,270 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-18 23:33:22,271 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-18 23:33:22,591 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,619 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-18 23:33:22,619 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-18 23:33:22,946 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,974 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-18 23:33:22,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-18 23:33:23,237 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:23,282 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:23,284 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-18 23:33:23,284 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-18 23:33:23,308 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-18 23:33:23,308 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-18 23:33:23,551 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:23,581 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-18 23:33:23,582 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-18 23:33:23,852 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,008 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-18 23:33:24,008 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-18 23:33:24,303 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,305 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,327 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-18 23:33:24,328 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-18 23:33:24,379 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-18 23:33:24,380 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-18 23:33:24,560 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,582 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-18 23:33:24,582 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-18 23:33:24,773 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,798 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-18 23:33:24,798 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-18 23:33:24,989 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,007 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-18 23:33:25,008 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-18 23:33:25,200 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,225 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-18 23:33:25,225 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-18 23:33:25,348 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,379 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,400 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-18 23:33:25,400 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-18 23:33:25,400 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-18 23:33:25,401 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-18 23:33:25,581 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,605 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-18 23:33:25,605 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-18 23:33:25,764 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,783 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-18 23:33:25,783 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-18 23:33:25,912 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,930 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-18 23:33:25,931 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-18 23:33:26,018 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,040 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-18 23:33:26,044 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-18 23:33:26,112 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,124 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-18 23:33:26,125 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-18 23:33:26,175 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,183 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-18 23:33:26,184 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-18 23:33:26,231 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-18 23:33:26,232 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-18 23:33:26,235 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-18 23:33:26,236 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-18 23:33:26,238 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-18 23:33:26,238 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-18 23:33:26,240 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-18 23:33:26,241 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-18 23:33:26,245 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-18 23:33:26,247 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-18 23:33:26,248 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-18 23:33:26,251 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-18 23:33:26,252 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-18 23:33:26,254 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-18 23:33:26,255 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-18 23:33:26,255 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-18 23:33:26,256 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-18 23:33:26,257 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-18 23:33:26,257 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-18 23:33:26,258 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-18 23:33:26,259 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-18 23:33:26,259 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-18 23:33:26,259 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-18 23:33:26,261 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-18 23:33:26,261 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-18 23:33:26,262 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-18 23:33:26,262 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-18 23:33:26,262 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-18 23:33:26,263 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-18 23:33:26,263 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-18 23:33:26,264 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-18 23:33:26,264 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-18 23:33:26,265 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-18 23:33:26,265 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-18 23:33:26,267 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-18 23:33:26,268 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-18 23:33:26,268 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-18 23:33:26,269 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-18 23:33:26,269 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-18 23:33:26,270 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-18 23:33:26,270 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-18 23:33:26,271 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-18 23:33:26,272 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-18 23:33:26,273 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-18 23:33:26,274 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-18 23:33:26,274 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-18 23:33:26,275 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-18 23:33:26,276 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-18 23:33:26,276 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-18 23:33:26,278 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-18 23:33:26,279 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-18 23:33:26,279 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-18 23:33:26,280 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-18 23:33:26,280 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-18 23:33:26,281 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-18 23:33:26,281 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-18 23:33:26,282 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-18 23:33:26,285 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-18 23:33:26,286 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-18 23:33:26,286 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-18 23:33:26,287 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-18 23:33:26,287 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-18 23:33:26,288 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-18 23:33:26,289 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-18 23:33:26,291 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-18 23:33:26,293 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-18 23:33:26,293 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-18 23:33:26,294 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-18 23:33:26,295 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-18 23:33:26,295 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-18 23:33:26,296 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-18 23:33:26,297 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-18 23:33:26,297 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-18 23:33:26,301 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-18 23:33:26,302 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-18 23:33:26,303 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-18 23:33:26,305 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-18 23:33:26,306 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-18 23:33:26,307 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-18 23:33:26,308 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-18 23:33:26,308 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-18 23:33:26,309 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-18 23:33:26,309 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-18 23:33:26,310 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-18 23:33:26,312 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-18 23:33:26,314 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-18 23:33:26,317 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-18 23:33:26,360 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,370 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-18 23:33:26,373 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-18 23:33:26,374 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-18 23:33:26,375 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-18 23:33:26,375 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-18 23:33:26,376 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-18 23:33:26,376 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-18 23:33:26,377 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-18 23:33:26,378 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-18 23:33:26,378 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-18 23:33:26,379 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-18 23:33:26,379 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-18 23:33:26,380 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-18 23:33:26,381 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-18 23:33:26,387 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-18 23:33:26,387 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-18 23:33:26,389 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-18 23:33:26,390 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-18 23:33:26,391 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-18 23:33:26,392 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-18 23:33:26,393 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-18 23:33:26,393 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-18 23:33:26,411 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-18 23:33:26,415 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-18 23:33:26,446 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-18 23:33:26,447 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-18 23:33:27,319 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:27,381 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-18 23:33:27,384 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-18 23:33:28,245 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:28,292 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-18 23:33:28,293 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-18 23:33:28,568 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1642 条记录
2025-10-18 23:33:28,606 - backend.data_loader - DEBUG - Loaded 1642 records from API
2025-10-18 23:33:28,606 - backend.data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-18 23:33:29,095 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:29,145 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-18 23:33:29,152 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-18 23:33:30,091 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:30,139 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-18 23:33:30,140 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-18 23:33:30,972 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:31,017 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-18 23:33:31,018 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-18 23:33:31,802 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:31,848 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-18 23:33:31,849 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-18 23:33:32,781 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:32,822 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-18 23:33:32,822 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-18 23:33:33,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:33,652 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-18 23:33:33,653 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-18 23:33:34,482 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:34,539 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-18 23:33:34,540 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-18 23:33:35,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:35,434 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-18 23:33:35,435 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-18 23:33:36,208 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:36,254 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-18 23:33:36,255 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-18 23:33:37,072 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:37,126 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-18 23:33:37,126 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-18 23:33:37,999 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:38,060 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-18 23:33:38,060 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-18 23:33:38,879 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:38,924 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-18 23:33:38,925 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-18 23:33:39,705 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:39,748 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-18 23:33:39,748 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-18 23:33:40,544 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:40,585 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-18 23:33:40,586 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-18 23:33:41,423 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:41,463 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-18 23:33:41,463 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-18 23:33:42,254 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:42,293 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-18 23:33:42,294 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-18 23:33:43,046 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:43,087 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-18 23:33:43,088 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-18 23:33:43,885 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:43,926 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-18 23:33:43,927 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-18 23:33:44,688 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:44,733 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-18 23:33:44,734 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-18 23:33:45,501 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:45,540 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-18 23:33:45,541 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-18 23:33:46,250 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:46,293 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-18 23:33:46,294 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-18 23:33:47,011 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:47,048 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-18 23:33:47,049 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-18 23:33:47,821 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:47,863 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-18 23:33:47,863 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-18 23:33:48,546 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:48,588 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-18 23:33:48,588 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-18 23:33:49,254 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:49,297 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-18 23:33:49,297 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-18 23:33:50,011 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:50,056 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-18 23:33:50,057 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-18 23:33:50,796 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:50,836 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-18 23:33:50,836 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-18 23:33:51,552 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:51,592 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-18 23:33:51,593 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-18 23:33:52,255 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:52,302 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-18 23:33:52,303 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-18 23:33:52,922 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:52,962 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-18 23:33:52,962 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-18 23:33:53,596 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:53,647 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-18 23:33:53,648 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-18 23:33:54,286 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:54,325 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-18 23:33:54,325 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-18 23:33:54,917 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:54,957 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-18 23:33:54,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-18 23:33:55,535 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:55,574 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-18 23:33:55,575 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-18 23:33:56,142 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:56,180 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-18 23:33:56,181 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-18 23:33:56,783 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:56,821 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-18 23:33:56,822 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-18 23:33:57,422 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:57,470 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-18 23:33:57,470 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-18 23:33:58,021 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:58,068 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-18 23:33:58,068 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-18 23:33:58,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:58,748 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-18 23:33:58,759 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-18 23:33:59,282 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:59,316 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-18 23:33:59,316 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-18 23:33:59,869 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:59,912 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-18 23:33:59,912 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-18 23:34:00,431 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:00,471 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-18 23:34:00,471 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-18 23:34:00,964 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:01,009 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-18 23:34:01,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-18 23:34:01,509 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:01,549 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-18 23:34:01,550 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-18 23:34:02,006 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:02,045 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-18 23:34:02,045 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-18 23:34:02,539 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:02,623 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-18 23:34:02,623 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-18 23:34:03,074 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:03,120 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-18 23:34:03,121 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-18 23:34:03,564 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:03,601 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-18 23:34:03,601 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-18 23:34:04,094 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:04,130 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-18 23:34:04,130 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-18 23:34:04,541 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:04,569 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-18 23:34:04,570 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-18 23:34:04,996 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:05,028 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-18 23:34:05,029 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-18 23:34:05,409 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:05,434 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-18 23:34:05,435 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-18 23:34:05,798 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:05,845 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-18 23:34:05,846 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-18 23:34:06,193 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:06,221 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-18 23:34:06,221 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-18 23:34:06,532 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:06,562 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-18 23:34:06,563 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-18 23:34:06,864 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:06,890 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-18 23:34:06,890 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-18 23:34:07,185 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:07,224 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-18 23:34:07,225 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-18 23:34:07,507 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:07,542 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-18 23:34:07,543 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-18 23:34:07,833 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:07,870 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-18 23:34:07,871 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-18 23:34:08,140 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,172 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-18 23:34:08,173 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-18 23:34:08,423 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,452 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-18 23:34:08,453 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-18 23:34:08,683 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,718 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-18 23:34:08,719 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-18 23:34:08,957 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,987 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-18 23:34:08,987 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-18 23:34:09,200 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,228 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-18 23:34:09,229 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-18 23:34:09,426 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,456 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-18 23:34:09,457 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-18 23:34:09,662 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,692 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-18 23:34:09,692 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-18 23:34:09,869 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,890 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-18 23:34:09,891 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-18 23:34:10,054 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,071 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-18 23:34:10,072 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-18 23:34:10,228 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,248 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-18 23:34:10,248 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-18 23:34:10,395 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,423 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-18 23:34:10,424 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-18 23:34:10,565 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,581 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-18 23:34:10,582 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-18 23:34:10,725 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,748 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-18 23:34:10,749 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-18 23:34:10,872 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,895 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-18 23:34:10,896 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-18 23:34:10,975 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:11,006 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-18 23:34:11,007 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-18 23:34:11,067 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:11,093 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-18 23:34:11,094 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-18 23:34:11,147 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:11,153 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-18 23:34:11,153 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-18 23:34:11,194 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-18 23:34:11,194 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-18 23:34:11,195 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-18 23:34:11,195 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-18 23:34:11,195 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-18 23:34:11,196 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-18 23:34:11,196 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-18 23:34:11,196 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-18 23:34:11,197 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-18 23:34:11,197 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-18 23:34:11,197 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-18 23:34:11,198 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-18 23:34:11,198 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-18 23:34:11,198 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-18 23:34:11,199 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-18 23:34:11,199 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-18 23:34:11,199 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-18 23:34:11,200 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-18 23:34:11,201 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-18 23:34:11,201 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-18 23:34:11,203 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-18 23:34:11,203 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-18 23:34:11,203 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-18 23:34:11,204 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-18 23:34:11,204 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-18 23:34:11,204 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-18 23:34:11,219 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-18 23:34:11,219 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-18 23:34:11,713 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1642 条记录
2025-10-18 23:34:11,727 - backend.data_loader - DEBUG - Loaded 1642 records from API
2025-10-18 23:34:11,727 - backend.data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-18 23:34:11,727 - backend.database_builder - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-18 23:34:11,728 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-18 23:34:11,730 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:34:11,730 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:34:11,731 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:34:11,731 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:34:11,731 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:34:11,732 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-18 23:34:11,756 - backend.database_builder - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:34:11,758 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:34:11,758 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-18 23:34:11,764 - backend.database_builder - INFO - Inserted 1642 records into table 光模块在线总数量统计表
2025-10-18 23:34:11,776 - backend.database_builder - INFO - Database built/updated at test_optical_module.db (rebuild=True, status=0)
2025-10-19 00:03:28,464 - backend.data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 00:03:28,465 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 00:03:28,467 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalModuleInventoryDataSourceLoader object at 0x00000263D530CD70>
2025-10-19 00:03:28,467 - backend.data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 00:03:28,506 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 00:03:29,690 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:29,737 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 00:03:29,741 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 00:03:30,789 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:30,835 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 00:03:30,835 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 00:03:31,891 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:31,934 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 00:03:31,934 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 00:03:32,985 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:33,040 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 00:03:33,041 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 00:03:34,098 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:34,159 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 00:03:34,160 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 00:03:35,198 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:35,252 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 00:03:35,252 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 00:03:36,234 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:36,280 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 00:03:36,281 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 00:03:37,207 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:37,257 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 00:03:37,258 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 00:03:38,255 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:38,297 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 00:03:38,297 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 00:03:39,289 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:39,336 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 00:03:39,337 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 00:03:40,322 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:40,370 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 00:03:40,372 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 00:03:41,340 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:41,430 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 00:03:41,431 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 00:03:42,499 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:42,555 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 00:03:42,555 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 00:03:43,513 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:43,568 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 00:03:43,569 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 00:03:44,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:44,551 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 00:03:44,553 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 00:03:45,524 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:45,572 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 00:03:45,573 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 00:03:46,533 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:46,576 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 00:03:46,577 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 00:03:47,485 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:47,525 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 00:03:47,526 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 00:03:48,422 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:48,489 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 00:03:48,490 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 00:03:49,412 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:49,461 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 00:03:49,462 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 00:03:50,404 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:50,465 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 00:03:50,466 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 00:03:51,343 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:51,392 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 00:03:51,392 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 00:03:52,297 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:52,333 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 00:03:52,334 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 00:03:53,167 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:53,208 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 00:03:53,210 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 00:03:54,045 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:54,090 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 00:03:54,091 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 00:03:54,916 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:54,962 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 00:03:54,963 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 00:03:55,792 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:55,849 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 00:03:55,850 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 00:03:56,681 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:56,738 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 00:03:56,740 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 00:03:57,558 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:57,600 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 00:03:57,601 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 00:03:58,413 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:58,467 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 00:03:58,468 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 00:03:59,290 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:59,344 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 00:03:59,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 00:04:00,156 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:00,205 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 00:04:00,205 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 00:04:01,006 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:01,064 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 00:04:01,065 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 00:04:01,855 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:01,899 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 00:04:01,900 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 00:04:02,673 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:02,725 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 00:04:02,726 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 00:04:03,517 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:03,558 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 00:04:03,558 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 00:04:04,322 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:04,369 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 00:04:04,370 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 00:04:05,142 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:05,207 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 00:04:05,208 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 00:04:05,995 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:06,048 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 00:04:06,049 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 00:04:06,811 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:06,854 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 00:04:06,855 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 00:04:07,624 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:07,671 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 00:04:07,671 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 00:04:08,421 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:08,468 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 00:04:08,468 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 00:04:09,298 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:09,343 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 00:04:09,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 00:04:10,077 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:10,124 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 00:04:10,125 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 00:04:10,972 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:11,020 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 00:04:11,021 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 00:04:11,764 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:11,813 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 00:04:11,814 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 00:04:12,537 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:12,595 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 00:04:12,595 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 00:04:13,311 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:13,364 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 00:04:13,364 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 00:04:14,083 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:14,145 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 00:04:14,146 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 00:04:14,906 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:14,964 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 00:04:14,965 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 00:04:15,716 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:15,796 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 00:04:15,797 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 00:04:16,485 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:16,548 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-19 00:04:16,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-19 00:04:17,240 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:17,323 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-19 00:04:17,325 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-19 00:04:17,998 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:18,048 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-19 00:04:18,049 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-19 00:04:18,758 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:18,802 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-19 00:04:18,803 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-19 00:04:19,467 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:19,575 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-19 00:04:19,576 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-19 00:04:20,232 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:20,276 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-19 00:04:20,278 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-19 00:04:20,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:20,974 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-19 00:04:20,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-19 00:04:21,629 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:21,724 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-19 00:04:21,724 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-19 00:04:22,369 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:22,414 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-19 00:04:22,414 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-19 00:04:23,079 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:23,118 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-19 00:04:23,119 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-19 00:04:23,738 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:23,771 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-19 00:04:23,772 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-19 00:04:24,472 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:24,524 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-19 00:04:24,529 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-19 00:04:25,137 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:25,184 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-19 00:04:25,184 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-19 00:04:25,836 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:25,887 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-19 00:04:25,888 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-19 00:04:26,450 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:26,560 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-19 00:04:26,560 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-19 00:04:27,171 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:27,214 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-19 00:04:27,215 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-19 00:04:27,805 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:27,853 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-19 00:04:27,854 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-19 00:04:28,453 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:28,510 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-19 00:04:28,518 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-19 00:04:29,082 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:29,121 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-19 00:04:29,122 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-19 00:04:29,617 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:29,656 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-19 00:04:29,657 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-19 00:04:30,150 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:30,210 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-19 00:04:30,211 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-19 00:04:30,726 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:30,765 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-19 00:04:30,766 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-19 00:04:31,302 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:31,341 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-19 00:04:31,343 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-19 00:04:31,808 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:31,850 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-19 00:04:31,850 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-19 00:04:32,334 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:32,375 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-19 00:04:32,378 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-19 00:04:32,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:32,923 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-19 00:04:32,924 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-19 00:04:33,502 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:33,748 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-19 00:04:33,749 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-19 00:04:34,232 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:34,280 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-19 00:04:34,283 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-19 00:04:34,714 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:34,754 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-19 00:04:34,754 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-19 00:04:35,184 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:35,218 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-19 00:04:35,219 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-19 00:04:35,605 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:35,664 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-19 00:04:35,665 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-19 00:04:36,029 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:36,064 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-19 00:04:36,065 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-19 00:04:36,403 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:36,551 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-19 00:04:36,579 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-19 00:04:36,947 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:36,991 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-19 00:04:36,992 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-19 00:04:37,299 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:37,379 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-19 00:04:37,381 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-19 00:04:37,704 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:37,751 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-19 00:04:37,752 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-19 00:04:38,035 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:38,080 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-19 00:04:38,083 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-19 00:04:38,379 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:38,451 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-19 00:04:38,452 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-19 00:04:38,753 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:38,792 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-19 00:04:38,794 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-19 00:04:39,034 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,070 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-19 00:04:39,072 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-19 00:04:39,303 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,332 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-19 00:04:39,333 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-19 00:04:39,553 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,625 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-19 00:04:39,631 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-19 00:04:39,842 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,905 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-19 00:04:39,908 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-19 00:04:40,106 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,141 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-19 00:04:40,142 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-19 00:04:40,330 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,367 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-19 00:04:40,368 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-19 00:04:40,546 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,575 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-19 00:04:40,576 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-19 00:04:40,741 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,781 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-19 00:04:40,782 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-19 00:04:40,933 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,956 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-19 00:04:40,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-19 00:04:41,109 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,245 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-19 00:04:41,291 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-19 00:04:41,470 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,509 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-19 00:04:41,511 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-19 00:04:41,629 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,665 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-19 00:04:41,666 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-19 00:04:41,741 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,776 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-19 00:04:41,779 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-19 00:04:41,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,877 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-19 00:04:41,879 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-19 00:04:41,929 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,940 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-19 00:04:41,941 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-19 00:04:41,988 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-19 00:04:41,991 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-19 00:04:41,992 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-19 00:04:41,992 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-19 00:04:41,993 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-19 00:04:41,994 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-19 00:04:41,994 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-19 00:04:41,995 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-19 00:04:41,996 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-19 00:04:41,997 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-19 00:04:41,997 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-19 00:04:41,998 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-19 00:04:41,999 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-19 00:04:41,999 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-19 00:04:42,000 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-19 00:04:42,002 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-19 00:04:42,004 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-19 00:04:42,005 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-19 00:04:42,006 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-19 00:04:42,007 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-19 00:04:42,008 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-19 00:04:42,008 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-19 00:04:42,009 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-19 00:04:42,010 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-19 00:04:42,011 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-19 00:04:42,012 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-19 00:04:42,013 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-19 00:04:42,013 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-19 00:04:42,014 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-19 00:04:42,017 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-19 00:04:42,018 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-19 00:04:42,022 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-19 00:04:42,022 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-19 00:04:42,023 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-19 00:04:42,024 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-19 00:04:42,026 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-19 00:04:42,032 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-19 00:04:42,038 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-19 00:04:42,039 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-19 00:04:42,040 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-19 00:04:42,041 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-19 00:04:42,042 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-19 00:04:42,043 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-19 00:04:42,044 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-19 00:04:42,045 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-19 00:04:42,046 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-19 00:04:42,046 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-19 00:04:42,049 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-19 00:04:42,049 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-19 00:04:42,050 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-19 00:04:42,051 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-19 00:04:42,054 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-19 00:04:42,055 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-19 00:04:42,055 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-19 00:04:42,056 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-19 00:04:42,059 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-19 00:04:42,059 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-19 00:04:42,060 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-19 00:04:42,060 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-19 00:04:42,061 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-19 00:04:42,062 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-19 00:04:42,062 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-19 00:04:42,064 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-19 00:04:42,064 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-19 00:04:42,068 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-19 00:04:42,071 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-19 00:04:42,072 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-19 00:04:42,072 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-19 00:04:42,073 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-19 00:04:42,073 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-19 00:04:42,074 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-19 00:04:42,075 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-19 00:04:42,075 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-19 00:04:42,076 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-19 00:04:42,077 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-19 00:04:42,078 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-19 00:04:42,089 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-19 00:04:42,090 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-19 00:04:42,091 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-19 00:04:42,091 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-19 00:04:42,092 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-19 00:04:42,093 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-19 00:04:42,093 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-19 00:04:42,096 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-19 00:04:42,096 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-19 00:04:42,099 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-19 00:04:42,100 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-19 00:04:42,106 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-19 00:04:42,108 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-19 00:04:42,112 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-19 00:04:42,117 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-19 00:04:42,130 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-19 00:04:42,140 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-19 00:04:42,146 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-19 00:04:42,153 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-19 00:04:42,166 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-19 00:04:42,173 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-19 00:04:42,181 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-19 00:04:42,188 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-19 00:04:42,197 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-19 00:04:42,201 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-19 00:04:42,227 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-19 00:04:42,284 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-19 00:04:42,424 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-19 00:04:42,515 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-19 00:04:42,608 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-19 00:04:42,645 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-19 00:04:42,646 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-19 00:04:42,652 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-19 00:04:42,657 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-19 00:04:42,658 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 00:04:46,492 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1648 条记录
2025-10-19 00:04:46,571 - backend.data_loader - DEBUG - Loaded 1648 records from API
2025-10-19 00:04:46,573 - backend.data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 00:04:46,580 - backend.database_builder - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-19 00:04:46,585 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:04:46,603 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:04:46,609 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:04:46,611 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:04:46,613 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:04:46,617 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:04:46,619 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:04:46,691 - backend.database_builder - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-19 00:04:46,692 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:04:46,693 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:04:46,695 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:04:46,697 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:04:46,702 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:04:46,707 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:04:46,708 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:04:46,756 - backend.database_builder - INFO - Inserted 1648 records into table 光模块在线总数量统计表
2025-10-19 00:04:46,807 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 00:07:12,031 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 00:07:12,031 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 00:07:12,031 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 00:07:12,032 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x00000177FC47CD70>
2025-10-19 00:07:12,033 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 00:07:12,337 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,338 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "previousDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 00:07:12,338 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,338 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 00:07:12,340 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,341 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "remainingTimeMS": 4999}
2025-10-19 00:07:12,370 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 00:07:12,380 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.383800002979115, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:06.193Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:12,381 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,381 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "previousDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>"}
2025-10-19 00:07:12,382 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,382 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:12,382 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,383 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,439 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.047283400024753064}
2025-10-19 00:07:12,440 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.057959500001743436}
2025-10-19 00:07:12,441 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,455 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 14.248999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,456 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,457 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 00:07:12,458 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 00:07:12.458030
2025-10-19 00:07:12,458 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,459 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,460 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,460 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005603000172413886}
2025-10-19 00:07:12,461 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T00:07:12.458Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,483 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 22.113, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,484 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,485 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,485 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,485 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,486 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003588999970816076}
2025-10-19 00:07:12,486 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T00:07:12.458Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,557 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 70.551, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,560 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,560 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000177FC74F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,561 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000177FC74F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,561 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,562 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003215000033378601}
2025-10-19 00:07:12,562 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"getMore\": 8008865835941389949, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,876 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 314.072, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,877 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,878 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 00:07:12,896 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 00:07:12,899 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 00:07:12,899 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 00:07:12,909 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 00:07:12,910 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 00:07:12,914 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 00:07:12,914 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 00:07:12,915 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 00:07:12,915 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 00:07:12,915 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 00:07:12,916 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 00:07:12,916 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 00:07:12,916 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:07:12,917 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:07:12,917 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:07:12,917 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 00:07:12,919 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 00:07:12,948 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 00:07:12,952 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 00:07:12,952 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 00:07:12,952 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 00:07:12,961 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 00:07:12,961 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x00000177FC47CEC0>
2025-10-19 00:07:12,962 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 00:07:12,964 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 00:07:13,351 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 00:07:13,388 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02651319999131374}
2025-10-19 00:07:13,395 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 00:07:13,434 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.020014100009575486}
2025-10-19 00:07:13,434 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 00:07:13,465 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.02138570000533946}
2025-10-19 00:07:13,466 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 00:07:13,495 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02057939997757785}
2025-10-19 00:07:14,134 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:14,257 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 00:07:14,260 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 00:07:15,301 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:15,343 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 00:07:15,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 00:07:16,298 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:16,338 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 00:07:16,338 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 00:07:17,305 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:17,349 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 00:07:17,350 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 00:07:18,306 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:18,345 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 00:07:18,346 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 00:07:19,296 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:19,338 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 00:07:19,338 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 00:07:20,276 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:20,320 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 00:07:20,321 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 00:07:21,297 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:21,381 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 00:07:21,382 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 00:07:22,373 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:22,442 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10059.758199990029, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:16.209Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:22,443 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:22,455 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 00:07:22,456 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 00:07:23,418 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:23,459 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 00:07:23,460 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 00:07:24,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:24,494 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 00:07:24,494 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 00:07:25,402 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:25,449 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 00:07:25,450 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 00:07:26,352 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:26,390 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 00:07:26,391 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 00:07:27,286 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:27,332 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 00:07:27,332 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 00:07:28,227 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:28,273 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 00:07:28,274 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 00:07:29,206 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:29,246 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 00:07:29,246 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 00:07:30,154 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:30,194 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 00:07:30,194 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 00:07:31,057 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:31,096 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 00:07:31,096 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 00:07:31,959 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:31,999 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 00:07:31,999 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 00:07:32,406 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9962.505499977851, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:26.218Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:32,408 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:32,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:32,877 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 00:07:32,877 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 00:07:33,718 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:33,764 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 00:07:33,764 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 00:07:34,618 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:34,663 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 00:07:34,664 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 00:07:35,507 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:35,552 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 00:07:35,553 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 00:07:36,378 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:36,417 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 00:07:36,417 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 00:07:37,232 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:37,275 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 00:07:37,275 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 00:07:38,210 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:38,254 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 00:07:38,255 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 00:07:39,084 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:39,123 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 00:07:39,123 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 00:07:39,937 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:39,974 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 00:07:39,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 00:07:40,792 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:40,833 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 00:07:40,834 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 00:07:41,646 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:41,686 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 00:07:41,687 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 00:07:42,414 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10004.185300000245, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:36.226Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:42,415 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:42,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:42,549 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 00:07:42,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 00:07:43,359 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:43,400 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 00:07:43,401 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 00:07:44,202 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:44,244 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 00:07:44,244 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 00:07:45,036 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:45,126 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 00:07:45,130 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 00:07:45,925 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:45,967 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 00:07:45,968 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 00:07:46,763 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:46,804 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 00:07:46,805 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 00:07:47,591 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:47,630 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 00:07:47,630 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 00:07:48,404 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:48,442 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 00:07:48,443 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 00:07:49,218 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:49,264 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 00:07:49,264 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 00:07:50,037 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:50,075 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 00:07:50,075 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 00:07:50,839 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:50,892 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 00:07:50,893 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 00:07:51,655 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:51,697 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 00:07:51,697 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 00:07:52,425 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10009.212200006004, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:46.235Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:52,427 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:52,449 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:52,493 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 00:07:52,493 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 00:07:53,244 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:53,293 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 00:07:53,294 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 00:07:54,038 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:54,076 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 00:07:54,076 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 00:07:54,833 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:54,869 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 00:07:54,870 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 00:07:55,607 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:55,647 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 00:07:55,647 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 00:07:56,366 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:56,409 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 00:07:56,409 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 00:07:57,124 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:57,166 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 00:07:57,167 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 00:07:57,870 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:57,912 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 00:07:57,913 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 00:07:58,611 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:58,655 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 00:07:58,655 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 00:07:59,332 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:59,378 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-19 00:07:59,379 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-19 00:08:00,050 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:00,092 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-19 00:08:00,092 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-19 00:08:00,762 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:00,802 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-19 00:08:00,802 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-19 00:08:01,463 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:01,504 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-19 00:08:01,505 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-19 00:08:02,170 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:02,246 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-19 00:08:02,247 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-19 00:08:02,433 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10004.625500005204, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:56.245Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:08:02,434 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:08:02,909 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:02,958 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-19 00:08:02,958 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-19 00:08:03,577 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:03,607 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-19 00:08:03,607 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-19 00:08:04,328 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:04,367 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-19 00:08:04,368 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-19 00:08:04,969 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:05,000 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-19 00:08:05,000 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-19 00:08:05,601 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:05,639 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-19 00:08:05,640 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-19 00:08:06,238 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:06,279 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-19 00:08:06,280 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-19 00:08:06,933 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:06,975 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-19 00:08:06,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-19 00:08:07,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:07,638 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-19 00:08:07,638 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-19 00:08:08,310 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:08,362 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-19 00:08:08,363 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-19 00:08:08,925 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:08,957 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-19 00:08:08,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-19 00:08:09,550 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:09,584 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-19 00:08:09,585 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-19 00:08:10,150 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:10,185 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-19 00:08:10,185 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-19 00:08:10,753 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:10,787 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-19 00:08:10,787 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-19 00:08:11,322 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:11,354 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-19 00:08:11,354 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-19 00:08:11,884 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:11,918 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-19 00:08:11,918 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-19 00:08:12,402 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:12,447 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-19 00:08:12,448 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-19 00:08:12,670 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10235.267100011697, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:08:06.246Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:08:12,671 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:08:12,947 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:12,992 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-19 00:08:12,993 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-19 00:08:13,480 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:13,524 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-19 00:08:13,524 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-19 00:08:14,005 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:14,042 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-19 00:08:14,043 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-19 00:08:14,492 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:14,540 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-19 00:08:14,540 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-19 00:08:14,991 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:15,025 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-19 00:08:15,025 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-19 00:08:15,459 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:15,505 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-19 00:08:15,506 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-19 00:08:15,953 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:15,989 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-19 00:08:15,990 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-19 00:08:16,439 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:16,592 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-19 00:08:16,595 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-19 00:08:17,043 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:17,110 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-19 00:08:17,112 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-19 00:08:17,576 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:17,613 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-19 00:08:17,614 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-19 00:08:17,993 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:18,022 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-19 00:08:18,022 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-19 00:08:18,386 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:18,425 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-19 00:08:18,426 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-19 00:08:18,736 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:18,765 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-19 00:08:18,766 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-19 00:08:19,063 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:19,089 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-19 00:08:19,090 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-19 00:08:19,388 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:19,408 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-19 00:08:19,409 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-19 00:08:19,688 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:19,729 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-19 00:08:19,730 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-19 00:08:19,996 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,019 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-19 00:08:20,019 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-19 00:08:20,273 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,307 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-19 00:08:20,308 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-19 00:08:20,585 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,619 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-19 00:08:20,620 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-19 00:08:20,874 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,936 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-19 00:08:20,937 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-19 00:08:21,175 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,203 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-19 00:08:21,204 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-19 00:08:21,430 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,452 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-19 00:08:21,452 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-19 00:08:21,639 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,670 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-19 00:08:21,671 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-19 00:08:21,851 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,875 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-19 00:08:21,876 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-19 00:08:22,046 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,070 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-19 00:08:22,070 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-19 00:08:22,231 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,251 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-19 00:08:22,251 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-19 00:08:22,406 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,432 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-19 00:08:22,434 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-19 00:08:22,446 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9774.586199986516, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:08:16.257Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:08:22,447 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:08:22,597 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,633 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-19 00:08:22,634 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-19 00:08:22,766 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,879 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-19 00:08:22,879 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-19 00:08:23,007 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,033 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-19 00:08:23,033 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-19 00:08:23,111 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,130 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-19 00:08:23,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-19 00:08:23,185 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,205 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-19 00:08:23,206 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-19 00:08:23,251 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,258 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-19 00:08:23,258 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-19 00:08:23,300 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-19 00:08:23,301 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-19 00:08:23,302 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-19 00:08:23,302 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-19 00:08:23,302 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-19 00:08:23,303 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-19 00:08:23,303 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-19 00:08:23,304 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-19 00:08:23,304 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-19 00:08:23,305 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-19 00:08:23,305 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-19 00:08:23,306 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-19 00:08:23,306 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-19 00:08:23,307 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-19 00:08:23,307 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-19 00:08:23,308 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-19 00:08:23,308 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-19 00:08:23,309 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-19 00:08:23,309 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-19 00:08:23,310 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-19 00:08:23,310 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-19 00:08:23,311 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-19 00:08:23,311 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-19 00:08:23,312 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-19 00:08:23,312 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-19 00:08:23,313 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-19 00:08:23,313 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-19 00:08:23,314 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-19 00:08:23,314 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-19 00:08:23,315 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-19 00:08:23,315 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-19 00:08:23,316 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-19 00:08:23,316 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-19 00:08:23,317 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-19 00:08:23,317 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-19 00:08:23,318 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-19 00:08:23,318 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-19 00:08:23,319 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-19 00:08:23,319 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-19 00:08:23,319 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-19 00:08:23,320 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-19 00:08:23,321 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-19 00:08:23,321 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-19 00:08:23,321 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-19 00:08:23,322 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-19 00:08:23,322 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-19 00:08:23,323 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-19 00:08:23,323 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-19 00:08:23,324 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-19 00:08:23,324 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-19 00:08:23,325 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-19 00:08:23,325 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-19 00:08:23,326 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-19 00:08:23,326 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-19 00:08:23,327 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-19 00:08:23,328 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-19 00:08:23,328 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-19 00:08:23,328 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-19 00:08:23,329 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-19 00:08:23,329 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-19 00:08:23,330 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-19 00:08:23,330 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-19 00:08:23,331 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-19 00:08:23,331 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-19 00:08:23,332 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-19 00:08:23,332 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-19 00:08:23,332 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-19 00:08:23,333 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-19 00:08:23,333 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-19 00:08:23,334 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-19 00:08:23,334 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-19 00:08:23,334 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-19 00:08:23,335 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-19 00:08:23,335 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-19 00:08:23,335 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-19 00:08:23,336 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-19 00:08:23,336 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-19 00:08:23,337 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-19 00:08:23,337 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-19 00:08:23,338 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-19 00:08:23,338 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-19 00:08:23,338 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-19 00:08:23,339 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-19 00:08:23,339 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-19 00:08:23,340 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-19 00:08:23,340 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-19 00:08:23,341 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-19 00:08:23,341 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-19 00:08:23,341 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-19 00:08:23,342 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-19 00:08:23,342 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-19 00:08:23,343 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-19 00:08:23,343 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-19 00:08:23,343 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-19 00:08:23,344 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-19 00:08:23,344 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-19 00:08:23,345 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-19 00:08:23,345 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-19 00:08:23,345 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-19 00:08:23,346 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-19 00:08:23,346 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-19 00:08:23,346 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-19 00:08:23,347 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-19 00:08:23,347 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-19 00:08:23,347 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-19 00:08:23,349 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-19 00:08:23,349 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 00:08:24,210 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1648 条记录
2025-10-19 00:08:24,233 - data_loader - DEBUG - Loaded 1648 records from API
2025-10-19 00:08:24,233 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 00:08:24,234 - __main__ - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-19 00:08:24,234 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:08:24,234 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:08:24,235 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:08:24,236 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:08:24,237 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:08:24,237 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:08:24,237 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:08:24,248 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-19 00:08:24,248 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:08:24,248 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:08:24,248 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:08:24,256 - __main__ - INFO - Inserted 1648 records into table 光模块在线总数量统计表
2025-10-19 00:08:24,299 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 00:08:24,514 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2066.7651999974623, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:01:10,154 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:01:10,154 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 01:01:10,155 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:01:10,156 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x00000149DACACD70>
2025-10-19 01:01:10,156 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:01:10,430 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,430 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "previousDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:01:10,431 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,431 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:01:10,433 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,434 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "remainingTimeMS": 4999}
2025-10-19 01:01:10,459 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:01:10,470 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.661400010576472, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:04.326Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:10,471 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,471 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "previousDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>"}
2025-10-19 01:01:10,472 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,472 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:10,473 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,474 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,547 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05329229999915697}
2025-10-19 01:01:10,548 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07507910000276752}
2025-10-19 01:01:10,549 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,560 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 11.154, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,561 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,561 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:01:10,561 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:01:10.561810
2025-10-19 01:01:10,562 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,562 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,563 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,563 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00028160001966170967}
2025-10-19 01:01:10,563 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:01:10.561Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,583 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 19.417, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,584 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,584 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,585 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,586 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,586 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00037059999885968864}
2025-10-19 01:01:10,586 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:01:10.561Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,653 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 67.043, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,659 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,660 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000149DAF7F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,660 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000149DAF7F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,660 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,661 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002919000107795}
2025-10-19 01:01:10,661 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"getMore\": 7690299585613915506, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,969 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 308.36400000000003, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,971 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,972 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:01:10,994 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:01:10,998 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:01:10,999 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:01:10,999 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:01:11,000 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:01:11,003 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:01:11,003 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:01:11,004 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:01:11,004 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:01:11,005 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:01:11,005 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:01:11,005 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:01:11,006 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:01:11,006 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:01:11,007 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:01:11,007 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:01:11,008 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:01:11,009 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:01:11,009 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:01:11,010 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:01:11,010 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:01:11,054 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:01:11,055 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:01:11,055 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:01:11,055 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:01:11,056 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:01:11,056 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:01:11,057 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:01:11,057 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:01:11,057 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:01:11,058 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:01:11,058 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:01:11,058 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:01:11,060 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:01:11,060 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:01:11,073 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:01:11,074 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x00000149DACACEC0>
2025-10-19 01:01:11,074 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 01:01:11,120 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 01:01:11,451 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 01:01:11,506 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.024551400012569502}
2025-10-19 01:01:11,507 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 01:01:11,541 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.023022999987006187}
2025-10-19 01:01:11,542 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 01:01:11,574 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.020814699993934482}
2025-10-19 01:01:11,575 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 01:01:11,606 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.021219999995082617}
2025-10-19 01:01:12,329 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:12,362 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 01:01:12,365 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 01:01:13,531 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:13,569 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 01:01:13,570 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 01:01:14,684 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:14,731 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 01:01:14,732 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 01:01:15,896 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:16,036 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 01:01:16,057 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 01:01:17,257 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:17,311 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 01:01:17,312 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 01:01:18,418 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:18,460 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 01:01:18,461 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 01:01:19,596 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:19,647 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 01:01:19,648 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 01:01:20,498 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10024.285999999847, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:14.352Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:20,499 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:20,723 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:20,764 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 01:01:20,765 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 01:01:21,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:21,914 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 01:01:21,915 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 01:01:23,074 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:23,154 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 01:01:23,154 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 01:01:24,220 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:24,286 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 01:01:24,286 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 01:01:25,319 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:25,365 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 01:01:25,366 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 01:01:26,370 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:26,436 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 01:01:26,439 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 01:01:27,491 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:27,533 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 01:01:27,534 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 01:01:28,636 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:28,676 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 01:01:28,677 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 01:01:29,826 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:29,866 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 01:01:29,867 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 01:01:30,509 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10009.411400009412, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:24.362Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:30,511 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:30,891 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:30,941 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 01:01:30,941 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 01:01:31,968 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:32,003 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 01:01:32,004 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 01:01:32,962 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:32,997 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 01:01:32,998 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 01:01:33,954 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:33,997 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 01:01:33,998 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 01:01:34,954 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:35,009 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 01:01:35,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 01:01:35,963 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:36,005 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 01:01:36,006 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 01:01:36,952 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:36,988 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 01:01:36,989 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 01:01:37,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:37,972 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 01:01:37,973 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 01:01:38,914 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:38,955 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 01:01:38,955 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 01:01:39,883 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:39,921 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 01:01:39,922 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 01:01:40,517 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10005.183499975828, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:34.372Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:40,518 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:40,839 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:40,878 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 01:01:40,878 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 01:01:41,793 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:41,834 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 01:01:41,835 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 01:01:42,743 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:42,786 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 01:01:42,787 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 01:01:43,690 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:43,728 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 01:01:43,728 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 01:01:44,624 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:44,666 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 01:01:44,666 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 01:01:45,562 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:45,606 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 01:01:45,606 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 01:01:46,493 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:46,550 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 01:01:46,550 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 01:01:47,437 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:47,475 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 01:01:47,475 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 01:01:48,351 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:48,398 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 01:01:48,398 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 01:01:49,266 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:49,309 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 01:01:49,309 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 01:01:50,162 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:50,213 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 01:01:50,214 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 01:01:50,529 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10010.035199986305, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:44.383Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:50,530 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:51,085 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:51,127 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 01:01:51,127 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 01:01:51,966 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:52,010 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 01:01:52,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 01:01:53,096 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:53,138 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 01:01:53,138 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 01:01:54,003 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:54,055 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 01:01:54,055 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 01:01:54,905 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:54,943 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 01:01:54,943 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 01:01:55,789 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:55,828 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 01:01:55,828 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 01:01:56,666 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:56,702 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 01:01:56,702 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 01:01:57,544 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:57,607 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 01:01:57,607 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 01:01:58,432 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:58,470 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 01:01:58,470 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 01:01:59,282 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:59,322 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 01:01:59,323 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 01:02:00,117 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:00,156 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 01:02:00,157 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 01:02:00,548 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10018.259800010128, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:54.399Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:02:00,551 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:02:00,946 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:00,981 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 01:02:00,981 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 01:02:01,762 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:01,803 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 01:02:01,803 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 01:02:02,572 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:02,613 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 01:02:02,613 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 01:02:03,377 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:03,424 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-19 01:02:03,425 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-19 01:02:04,191 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:04,236 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-19 01:02:04,237 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-19 01:02:04,973 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:05,028 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-19 01:02:05,029 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-19 01:02:05,754 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:05,797 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-19 01:02:05,797 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-19 01:02:06,518 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:06,568 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-19 01:02:06,568 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-19 01:02:07,265 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:07,304 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-19 01:02:07,305 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-19 01:02:07,988 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:08,031 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-19 01:02:08,031 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-19 01:02:08,711 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:08,753 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-19 01:02:08,754 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-19 01:02:09,419 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:09,461 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-19 01:02:09,461 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-19 01:02:10,102 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:10,142 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-19 01:02:10,142 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-19 01:02:10,554 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10002.825399977155, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:02:04.409Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:02:10,555 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:02:10,769 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:10,805 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-19 01:02:10,806 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-19 01:02:11,430 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:11,466 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-19 01:02:11,467 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-19 01:02:12,069 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:12,106 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-19 01:02:12,106 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-19 01:02:12,707 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:12,741 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-19 01:02:12,742 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-19 01:02:13,327 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:13,360 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-19 01:02:13,360 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-19 01:02:13,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:13,973 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-19 01:02:13,973 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-19 01:02:14,534 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:14,566 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-19 01:02:14,566 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-19 01:02:15,115 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:15,149 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-19 01:02:15,150 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-19 01:02:15,688 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:15,726 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-19 01:02:15,726 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-19 01:02:16,260 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:16,357 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-19 01:02:16,358 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-19 01:02:16,874 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:16,910 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-19 01:02:16,910 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-19 01:02:17,409 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:17,441 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-19 01:02:17,442 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-19 01:02:17,973 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:18,006 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-19 01:02:18,007 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-19 01:02:18,567 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:18,605 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-19 01:02:18,605 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-19 01:02:19,090 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:19,128 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-19 01:02:19,129 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-19 01:02:19,615 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:19,654 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-19 01:02:19,654 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-19 01:02:20,109 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:20,146 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-19 01:02:20,147 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-19 01:02:20,568 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10012.134099990362, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:02:14.419Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:02:20,570 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:02:20,607 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:20,639 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-19 01:02:20,639 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-19 01:02:21,070 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:21,103 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-19 01:02:21,103 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-19 01:02:21,519 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:21,548 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-19 01:02:21,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-19 01:02:21,943 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:21,980 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-19 01:02:21,981 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-19 01:02:22,352 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:22,380 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-19 01:02:22,380 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-19 01:02:22,724 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:22,751 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-19 01:02:22,751 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-19 01:02:23,076 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:23,111 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-19 01:02:23,112 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-19 01:02:23,427 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:23,459 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-19 01:02:23,460 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-19 01:02:23,767 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:23,802 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-19 01:02:23,802 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-19 01:02:24,096 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:24,131 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-19 01:02:24,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-19 01:02:24,416 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:24,440 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-19 01:02:24,440 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-19 01:02:24,712 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:24,736 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-19 01:02:24,736 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-19 01:02:24,989 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,021 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-19 01:02:25,022 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-19 01:02:25,267 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,292 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-19 01:02:25,293 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-19 01:02:25,521 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,549 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-19 01:02:25,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-19 01:02:25,761 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,784 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-19 01:02:25,784 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-19 01:02:25,989 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,008 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-19 01:02:26,009 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-19 01:02:26,201 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,220 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-19 01:02:26,220 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-19 01:02:26,401 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,421 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-19 01:02:26,421 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-19 01:02:26,593 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,614 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-19 01:02:26,614 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-19 01:02:26,775 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,794 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-19 01:02:26,794 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-19 01:02:26,941 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,957 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-19 01:02:26,958 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-19 01:02:27,091 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,148 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-19 01:02:27,149 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-19 01:02:27,270 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,289 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-19 01:02:27,289 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-19 01:02:27,393 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,413 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-19 01:02:27,413 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-19 01:02:27,484 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,494 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-19 01:02:27,495 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-19 01:02:27,547 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,553 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-19 01:02:27,553 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-19 01:02:27,600 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-19 01:02:27,601 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-19 01:02:27,602 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-19 01:02:27,602 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-19 01:02:27,603 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-19 01:02:27,603 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-19 01:02:27,603 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-19 01:02:27,604 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-19 01:02:27,604 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-19 01:02:27,605 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-19 01:02:27,605 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-19 01:02:27,605 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-19 01:02:27,606 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-19 01:02:27,606 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-19 01:02:27,606 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-19 01:02:27,607 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-19 01:02:27,607 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-19 01:02:27,608 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-19 01:02:27,608 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-19 01:02:27,608 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-19 01:02:27,609 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-19 01:02:27,609 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-19 01:02:27,609 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-19 01:02:27,610 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-19 01:02:27,610 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-19 01:02:27,611 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-19 01:02:27,611 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-19 01:02:27,612 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-19 01:02:27,612 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-19 01:02:27,612 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-19 01:02:27,613 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-19 01:02:27,613 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-19 01:02:27,614 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-19 01:02:27,614 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-19 01:02:27,615 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-19 01:02:27,616 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-19 01:02:27,616 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-19 01:02:27,617 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-19 01:02:27,617 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-19 01:02:27,617 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-19 01:02:27,618 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-19 01:02:27,618 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-19 01:02:27,618 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-19 01:02:27,619 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-19 01:02:27,620 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-19 01:02:27,620 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-19 01:02:27,620 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-19 01:02:27,621 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-19 01:02:27,621 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-19 01:02:27,622 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-19 01:02:27,622 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-19 01:02:27,622 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-19 01:02:27,623 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-19 01:02:27,623 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-19 01:02:27,623 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-19 01:02:27,624 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-19 01:02:27,624 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-19 01:02:27,625 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-19 01:02:27,625 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-19 01:02:27,625 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-19 01:02:27,626 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-19 01:02:27,626 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-19 01:02:27,627 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-19 01:02:27,627 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-19 01:02:27,628 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-19 01:02:27,628 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-19 01:02:27,628 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-19 01:02:27,629 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-19 01:02:27,629 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-19 01:02:27,629 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-19 01:02:27,630 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-19 01:02:27,630 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-19 01:02:27,631 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-19 01:02:27,631 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-19 01:02:27,632 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-19 01:02:27,632 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-19 01:02:27,633 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-19 01:02:27,633 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-19 01:02:27,634 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-19 01:02:27,634 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-19 01:02:27,635 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-19 01:02:27,635 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-19 01:02:27,635 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-19 01:02:27,636 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-19 01:02:27,636 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-19 01:02:27,636 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-19 01:02:27,637 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-19 01:02:27,637 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-19 01:02:27,637 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-19 01:02:27,638 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-19 01:02:27,638 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-19 01:02:27,639 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-19 01:02:27,639 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-19 01:02:27,639 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-19 01:02:27,640 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-19 01:02:27,640 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-19 01:02:27,640 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-19 01:02:27,641 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-19 01:02:27,641 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-19 01:02:27,642 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-19 01:02:27,642 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-19 01:02:27,642 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-19 01:02:27,643 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-19 01:02:27,643 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-19 01:02:27,644 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-19 01:02:27,644 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-19 01:02:27,644 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-19 01:02:27,645 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-19 01:02:27,645 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-19 01:02:27,655 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-19 01:02:27,655 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 01:02:28,643 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1131 条记录
2025-10-19 01:02:28,668 - data_loader - DEBUG - Loaded 1131 records from API
2025-10-19 01:02:28,668 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 01:02:28,669 - __main__ - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-19 01:02:28,670 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 01:02:28,670 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:02:28,671 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:02:28,672 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:02:28,672 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:02:28,673 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:02:28,674 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 01:02:28,677 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-19 01:02:28,677 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 01:02:28,678 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:02:28,678 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:02:28,679 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:02:28,679 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:02:28,679 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:02:28,680 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 01:02:28,689 - __main__ - INFO - Inserted 1131 records into table 光模块在线总数量统计表
2025-10-19 01:02:28,713 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 01:02:28,793 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 8222.534200001974, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:46:37,705 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:46:37,705 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:46:38,388 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,389 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:46:38,390 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,391 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:46:38,398 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,399 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "remainingTimeMS": 4998}
2025-10-19 01:46:38,426 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:46:38,438 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "driverConnectionId": 1, "serverConnectionId": 45820, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.948399994755164, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:46:32.327Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45820, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:46:38,439 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,440 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>"}
2025-10-19 01:46:38,441 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,443 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,444 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "driverConnectionId": 1, "serverConnectionId": 45820, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:46:38,445 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,532 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07246399999712594}
2025-10-19 01:46:38,533 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08973090001381934}
2025-10-19 01:46:38,534 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ghpsrqy4Rv6Arlcc59up+w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,546 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "durationMS": 11.551, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,547 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,548 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:46:38,553 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:46:38.552881
2025-10-19 01:46:38,554 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,556 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,558 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,560 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001292400003876537}
2025-10-19 01:46:38,561 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ghpsrqy4Rv6Arlcc59up+w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,573 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "durationMS": 12.215, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,575 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,576 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,577 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,578 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,578 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006297999934758991}
2025-10-19 01:46:38,579 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ghpsrqy4Rv6Arlcc59up+w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,591 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "durationMS": 11.859, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,592 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,593 - backend.dataSources.roce_event - INFO - 查询到 0 条记录，返回 0 条
2025-10-19 01:46:38,594 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 01:46:38,594 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 01:46:38,594 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:46:38,595 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:46:38,596 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 01:46:38,613 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x000001DDA5D42E90>
2025-10-19 01:46:38,614 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:46:38,617 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,618 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:46:38,618 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,619 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:46:38,622 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,623 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "remainingTimeMS": 4998}
2025-10-19 01:46:38,633 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:46:38,644 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "driverConnectionId": 1, "serverConnectionId": 45823, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.902299992972985, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:46:32.534Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45823, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:46:38,646 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,647 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>"}
2025-10-19 01:46:38,648 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,649 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "driverConnectionId": 1, "serverConnectionId": 45823, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:46:38,650 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,651 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,743 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0684973000024911}
2025-10-19 01:46:38,744 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09438120000413619}
2025-10-19 01:46:38,745 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+skbhrxuRdW3bLqsXOztlw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,755 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "durationMS": 10.27, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,756 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,758 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:46:38,758 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:46:38.758807
2025-10-19 01:46:38,759 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,761 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,762 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,763 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009633000008761883}
2025-10-19 01:46:38,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+skbhrxuRdW3bLqsXOztlw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,777 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "durationMS": 12.966999999999999, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,778 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,779 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,782 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,784 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002233899984275922}
2025-10-19 01:46:38,785 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+skbhrxuRdW3bLqsXOztlw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,797 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "durationMS": 11.568, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,798 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,800 - backend.dataSources.roce_event - INFO - 查询到 0 条记录，返回 0 条
2025-10-19 01:46:38,801 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 01:46:38,801 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 01:46:38,802 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:46:38,803 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 01:46:39,158 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 509.5201999938581, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:47:36,758 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:47:36,759 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:47:37,084 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,085 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:47:37,085 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,086 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:47:37,089 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,090 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "remainingTimeMS": 4999}
2025-10-19 01:47:37,115 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:47:37,126 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "driverConnectionId": 1, "serverConnectionId": 45826, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.45709999743849, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:47:31.015Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45826, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:47:37,127 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,127 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>"}
2025-10-19 01:47:37,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,129 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "driverConnectionId": 1, "serverConnectionId": 45826, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:47:37,129 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,130 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,194 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.052689600008307025}
2025-10-19 01:47:37,195 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06598869999288581}
2025-10-19 01:47:37,196 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,208 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 11.977, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,210 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,211 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:47:37,212 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:47:37.212269
2025-10-19 01:47:37,213 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,213 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,214 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,215 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005193999968469143}
2025-10-19 01:47:37,216 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,227 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 11.192, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 160}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,228 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,228 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,229 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,230 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,230 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005296000163070858}
2025-10-19 01:47:37,231 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,291 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 59.816, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f3cad3e563a8974deeb387\"}, \"event_id\": \"38400362\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"NXLT01\", \"hostname\": \"NX-LT-DC-ROCE_TOR-105_01.NX\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"NXLT012F05-B-14-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4911194\", \"server_name\": \"k2-gpu-57\", \"instance_id\": \"9cd500ba-28da-4cc6-9f99-20ad084c5a24\", \"server_user\": \"\u5317\u4eac\u6708\u4e4b\u6697\u9762\u79d1\u6280\u6709\u9650\u516c\u53f8\", \"server_uid\": \"2000169742\", \"server_rack\": \"NXLT012F05-A-06-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.248.16.49\", \"private_ip\": \"10.35.100.29\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_0\", \"optical_model_sn\": \"MY2426050407-1\", \"optical_model_name\": \"400G_BASE_SR4_QSFPDD\", \"optical_model_vendor\": \"TRILIGHT\", \"first_alarm\": \"2025-10-19 01:13:21\", \"first_...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,298 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,298 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,299 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,367 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,369 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0023382999934256077}
2025-10-19 01:47:37,370 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"getMore\": 2714353000932349629, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,397 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 27.27, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68cbad7278be70bd3047bb11\"}, \"event_id\": \"2727771869\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_03_07.QH\", \"portname\": \"FourHundredGigE1/0/17\", \"rack\": \"QHDX013F04-09-06-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"S514359X4C04797\", \"server_name\": \"hd1-g8-gm403rs-v7-151370-vxnvgvw8.kscn.idc.xiaomi.com\", \"instance_id\": \"67d9e024-1cbd-4c67-ab0c-4766f9579e79\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-10-02-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.11.46\", \"private_ip\": \"10.44.141.5\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_6\", \"first_alarm\": \"2025-09-18 14:57:21\", \"first_ts\": 1758178641838, \"last_alarm\": \"2025-09-18 14:57:21\", \"last_ts\": 1758178641838...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,399 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,400 - backend.dataSources.roce_event - INFO - 查询到 160 条记录，返回 160 条
2025-10-19 01:47:37,402 - backend.dataSources.roce_event - INFO - 处理完成，共生成 160 条记录
2025-10-19 01:47:37,403 - backend.data_loader - DEBUG - Loaded 160 records from MongoDB
2025-10-19 01:47:37,403 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:47:37,407 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:47:37,407 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 01:47:37,409 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x0000016F94993390>
2025-10-19 01:47:37,410 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:47:37,417 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,417 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:47:37,418 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,421 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:47:37,424 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,425 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "remainingTimeMS": 4998}
2025-10-19 01:47:37,450 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:47:37,468 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "driverConnectionId": 1, "serverConnectionId": 45829, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 17.068999994080514, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:47:31.357Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45829, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:47:37,469 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,470 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>"}
2025-10-19 01:47:37,471 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,471 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "driverConnectionId": 1, "serverConnectionId": 45829, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:47:37,472 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,473 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,537 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05147829998168163}
2025-10-19 01:47:37,538 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06554670000332408}
2025-10-19 01:47:37,559 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,607 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 48.342000000000006, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,609 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,610 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:47:37,611 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:47:37.611286
2025-10-19 01:47:37,611 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,681 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,683 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,684 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007759000000078231}
2025-10-19 01:47:37,684 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,697 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 12.276, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 160}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,698 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,699 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,700 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,701 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,701 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005727999960072339}
2025-10-19 01:47:37,702 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,775 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 73.519, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f3cad3e563a8974deeb387\"}, \"event_id\": \"38400362\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"NXLT01\", \"hostname\": \"NX-LT-DC-ROCE_TOR-105_01.NX\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"NXLT012F05-B-14-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4911194\", \"server_name\": \"k2-gpu-57\", \"instance_id\": \"9cd500ba-28da-4cc6-9f99-20ad084c5a24\", \"server_user\": \"\u5317\u4eac\u6708\u4e4b\u6697\u9762\u79d1\u6280\u6709\u9650\u516c\u53f8\", \"server_uid\": \"2000169742\", \"server_rack\": \"NXLT012F05-A-06-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.248.16.49\", \"private_ip\": \"10.35.100.29\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_0\", \"optical_model_sn\": \"MY2426050407-1\", \"optical_model_name\": \"400G_BASE_SR4_QSFPDD\", \"optical_model_vendor\": \"TRILIGHT\", \"first_alarm\": \"2025-10-19 01:13:21\", \"first_...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,778 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,779 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,781 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,781 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006067999929655343}
2025-10-19 01:47:37,782 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"getMore\": 4228974682212664188, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,810 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 27.929, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68cbad7278be70bd3047bb11\"}, \"event_id\": \"2727771869\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_03_07.QH\", \"portname\": \"FourHundredGigE1/0/17\", \"rack\": \"QHDX013F04-09-06-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"S514359X4C04797\", \"server_name\": \"hd1-g8-gm403rs-v7-151370-vxnvgvw8.kscn.idc.xiaomi.com\", \"instance_id\": \"67d9e024-1cbd-4c67-ab0c-4766f9579e79\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-10-02-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.11.46\", \"private_ip\": \"10.44.141.5\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_6\", \"first_alarm\": \"2025-09-18 14:57:21\", \"first_ts\": 1758178641838, \"last_alarm\": \"2025-09-18 14:57:21\", \"last_ts\": 1758178641838...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,812 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,814 - backend.dataSources.roce_event - INFO - 查询到 160 条记录，返回 160 条
2025-10-19 01:47:37,817 - backend.dataSources.roce_event - INFO - 处理完成，共生成 160 条记录
2025-10-19 01:47:37,818 - backend.data_loader - DEBUG - Loaded 160 records from MongoDB
2025-10-19 01:47:37,819 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:47:37,819 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 01:47:37,820 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:47:37,828 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:47:37,830 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:47:37,831 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:47:37,832 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:47:37,833 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:47:37,833 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:47:37,834 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:47:37,835 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:47:37,836 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:47:37,837 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:47:37,838 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:47:37,838 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:47:37,839 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:47:37,840 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:47:37,874 - backend.database_builder - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 01:47:37,877 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:47:37,878 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:47:37,880 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:47:37,880 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:47:37,881 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:47:37,881 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:47:37,882 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:47:37,882 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:47:37,883 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:47:37,883 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:47:37,884 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:47:37,884 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:47:37,884 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:47:37,885 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:47:37,885 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:47:37,889 - backend.database_builder - INFO - Inserted 160 records into table ROCE网络事件-光模块故障表
2025-10-19 01:47:37,915 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 01:47:37,984 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 512.7061999810394, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:48:27,642 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:48:27,643 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 01:48:27,643 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:48:27,644 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:48:27,647 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x000001BF9EE34C20>
2025-10-19 01:48:27,648 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:48:27,940 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:27,940 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "previousDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:48:27,941 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,942 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:48:27,944 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:27,945 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "remainingTimeMS": 4999}
2025-10-19 01:48:27,978 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:48:27,990 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.094399989815429, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:21.879Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:27,991 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,992 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "previousDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>"}
2025-10-19 01:48:27,992 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,993 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:27,993 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,994 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,063 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0588817999814637}
2025-10-19 01:48:28,152 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1591760000155773}
2025-10-19 01:48:28,153 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,189 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 35.295, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,190 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,190 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:48:28,190 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:48:28.190920
2025-10-19 01:48:28,191 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:28,193 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,199 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,201 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001726700022118166}
2025-10-19 01:48:28,202 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:48:28.190Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,241 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 39.379, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,242 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,243 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:28,243 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,244 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,244 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004670000053010881}
2025-10-19 01:48:28,245 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:48:28.190Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,331 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 86.06, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,342 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,342 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BF9F0DF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:28,343 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BF9F0DF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,344 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,344 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00046549999387934804}
2025-10-19 01:48:28,345 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"getMore\": 6418431684034829798, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,726 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 381.798, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,729 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,730 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:48:28,781 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:48:28,790 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:48:28,791 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:48:28,791 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:48:28,792 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:48:28,797 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:48:28,798 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:48:28,799 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:48:28,802 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:48:28,803 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:48:28,804 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:48:28,806 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:48:28,806 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:48:28,807 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:48:28,808 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:48:28,809 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:48:28,810 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:48:28,811 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:48:28,811 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:48:28,812 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:48:28,813 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:48:28,891 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:48:28,892 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:48:28,893 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:48:28,894 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:48:28,895 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:48:28,895 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:48:28,896 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:48:28,896 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:48:28,897 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:48:28,897 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:48:28,898 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:48:28,898 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:48:28,899 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:48:28,900 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:48:28,901 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:48:28,902 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:48:28,902 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:48:28,903 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:48:28,928 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:48:28,929 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x000001BF9EE34D70>
2025-10-19 01:48:28,929 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 01:48:28,946 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 01:48:28,982 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 01:48:28,983 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.025399899983312935}
2025-10-19 01:48:28,985 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 01:48:29,018 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.023195399990072474}
2025-10-19 01:48:29,020 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 01:48:29,053 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.020676600019214675}
2025-10-19 01:48:29,054 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 01:48:29,088 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.022528299974510446}
2025-10-19 01:48:30,063 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:30,109 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 01:48:30,112 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 01:48:31,152 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:31,234 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 01:48:31,235 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 01:48:32,271 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:32,319 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 01:48:32,320 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 01:48:33,359 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:33,411 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 01:48:33,412 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 01:48:34,462 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:34,533 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 01:48:34,534 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 01:48:35,585 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:35,756 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 01:48:35,759 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 01:48:36,781 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:36,888 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 01:48:36,888 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 01:48:37,884 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:37,924 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 01:48:37,925 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 01:48:38,016 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10021.683200000552, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:31.904Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:38,017 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:38,907 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:38,955 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 01:48:38,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 01:48:39,927 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:39,967 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 01:48:39,967 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 01:48:40,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:40,982 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 01:48:40,983 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 01:48:41,957 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:42,009 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 01:48:42,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 01:48:43,113 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:43,151 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 01:48:43,151 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 01:48:44,141 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:44,188 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 01:48:44,189 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 01:48:45,117 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:45,154 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 01:48:45,155 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 01:48:46,070 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:46,107 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 01:48:46,107 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 01:48:47,022 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:47,069 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 01:48:47,070 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 01:48:48,019 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:48,027 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10008.631400007289, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:41.915Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:48,030 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:48,061 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 01:48:48,062 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 01:48:48,957 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:49,003 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 01:48:49,004 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 01:48:49,920 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:49,956 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 01:48:49,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 01:48:50,849 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:50,891 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 01:48:50,891 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 01:48:51,772 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:51,815 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 01:48:51,816 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 01:48:52,683 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:52,726 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 01:48:52,726 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 01:48:53,585 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:53,631 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 01:48:53,632 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 01:48:54,483 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:54,523 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 01:48:54,524 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 01:48:55,365 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:55,409 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 01:48:55,410 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 01:48:56,244 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:56,281 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 01:48:56,281 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 01:48:57,114 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:57,158 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 01:48:57,159 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 01:48:57,990 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:58,030 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 01:48:58,031 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 01:48:58,041 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10009.770199976629, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:51.926Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:58,043 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:58,856 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:58,903 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 01:48:58,903 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 01:48:59,717 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:59,758 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 01:48:59,759 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 01:49:00,606 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:00,652 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 01:49:00,652 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 01:49:01,478 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:01,525 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 01:49:01,525 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 01:49:02,345 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:02,389 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 01:49:02,390 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 01:49:03,188 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:03,239 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 01:49:03,240 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 01:49:04,099 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:04,158 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 01:49:04,159 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 01:49:05,024 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:05,062 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 01:49:05,063 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 01:49:05,844 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:05,889 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 01:49:05,890 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 01:49:06,717 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:06,756 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 01:49:06,757 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 01:49:07,598 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:07,638 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 01:49:07,639 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 01:49:08,069 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10024.575499992352, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:49:01.936Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:49:08,083 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:49:08,439 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:08,495 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 01:49:08,496 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 01:49:09,315 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:09,355 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 01:49:09,356 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 01:49:10,134 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:10,173 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 01:49:10,174 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 01:49:10,937 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:10,981 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 01:49:10,982 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 01:49:11,737 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:11,777 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 01:49:11,777 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 01:49:12,523 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:12,569 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 01:49:12,569 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 01:49:13,307 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:13,355 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 01:49:13,356 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 01:49:14,084 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:14,127 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 01:49:14,127 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 01:49:14,853 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:14,892 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 01:49:14,893 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 01:49:15,604 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:15,646 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 01:49:15,647 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 01:49:16,350 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:16,396 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 01:49:16,397 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 01:49:17,104 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 01:49:17,295 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9211.830800020834, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:49:34,393 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:49:34,394 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:49:34,394 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:49:34,396 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000027888694C20>
2025-10-19 01:49:34,397 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:49:34,948 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:34,949 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "previousDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:49:34,950 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:34,951 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:49:34,955 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:34,956 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "remainingTimeMS": 4999}
2025-10-19 01:49:34,984 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:49:35,000 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "driverConnectionId": 1, "serverConnectionId": 45840, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 13.821500004269183, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:49:28.887Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45840, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:49:35,003 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,005 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "previousDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>"}
2025-10-19 01:49:35,006 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,008 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "driverConnectionId": 1, "serverConnectionId": 45840, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:49:35,009 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,013 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,089 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06170149997342378}
2025-10-19 01:49:35,089 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07991000000038184}
2025-10-19 01:49:35,090 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,101 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 11.093, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,102 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,103 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:49:35,103 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:49:35.103674
2025-10-19 01:49:35,104 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:35,105 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,106 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,106 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00050970001029782}
2025-10-19 01:49:35,107 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:49:35.103Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,128 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 21.456, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,129 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,130 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:35,131 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,133 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,134 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001124100002925843}
2025-10-19 01:49:35,134 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:49:35.103Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,204 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 69.823, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,207 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,208 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:35,209 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,210 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,211 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006693000032100827}
2025-10-19 01:49:35,212 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"getMore\": 5855557928888166629, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,510 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 298.211, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,511 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,513 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:49:35,543 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:49:35,548 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:49:35,549 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:49:35,549 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:49:35,550 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,553 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:49:35,554 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,555 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:49:35,556 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:49:35,556 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:49:35,557 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:49:35,557 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:49:35,558 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,559 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,559 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,560 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,560 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:49:35,561 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:49:35,562 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:49:35,563 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:49:35,563 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:49:35,610 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:49:35,611 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,612 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:49:35,613 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,613 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:49:35,614 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:49:35,614 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:49:35,615 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:49:35,615 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:49:35,615 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,616 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,616 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,616 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,617 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:49:35,617 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:49:35,618 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:49:35,618 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:49:35,618 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:49:35,637 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:49:35,638 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000027888694D70>
2025-10-19 01:49:35,638 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:49:35,642 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,643 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "previousDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:49:35,644 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,645 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:49:35,648 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,650 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "remainingTimeMS": 4998}
2025-10-19 01:49:35,659 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:49:35,671 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "driverConnectionId": 1, "serverConnectionId": 45843, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.85120000061579, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:49:29.559Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45843, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:49:35,672 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,672 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "previousDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>"}
2025-10-19 01:49:35,673 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,674 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "driverConnectionId": 1, "serverConnectionId": 45843, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:49:35,674 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,675 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,735 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04888439999194816}
2025-10-19 01:49:35,736 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06161560001783073}
2025-10-19 01:49:35,737 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,747 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 10.097999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,748 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,748 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:49:35,749 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:49:35.749366
2025-10-19 01:49:35,750 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,751 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,752 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,753 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007989000005181879}
2025-10-19 01:49:35,754 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809775}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,766 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 12.548, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 160}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,767 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,768 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,769 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,771 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,772 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008448000007774681}
2025-10-19 01:49:35,773 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809775}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,833 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 60.262, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f3cad3e563a8974deeb387\"}, \"event_id\": \"38400362\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"NXLT01\", \"hostname\": \"NX-LT-DC-ROCE_TOR-105_01.NX\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"NXLT012F05-B-14-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4911194\", \"server_name\": \"k2-gpu-57\", \"instance_id\": \"9cd500ba-28da-4cc6-9f99-20ad084c5a24\", \"server_user\": \"\u5317\u4eac\u6708\u4e4b\u6697\u9762\u79d1\u6280\u6709\u9650\u516c\u53f8\", \"server_uid\": \"2000169742\", \"server_rack\": \"NXLT012F05-A-06-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.248.16.49\", \"private_ip\": \"10.35.100.29\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_0\", \"optical_model_sn\": \"MY2426050407-1\", \"optical_model_name\": \"400G_BASE_SR4_QSFPDD\", \"optical_model_vendor\": \"TRILIGHT\", \"first_alarm\": \"2025-10-19 01:13:21\", \"first_...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,834 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,835 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,836 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,837 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,837 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007019999902695417}
2025-10-19 01:49:35,838 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"getMore\": 9017833390748816960, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,860 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 21.602, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68cbad7278be70bd3047bb11\"}, \"event_id\": \"2727771869\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_03_07.QH\", \"portname\": \"FourHundredGigE1/0/17\", \"rack\": \"QHDX013F04-09-06-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"S514359X4C04797\", \"server_name\": \"hd1-g8-gm403rs-v7-151370-vxnvgvw8.kscn.idc.xiaomi.com\", \"instance_id\": \"67d9e024-1cbd-4c67-ab0c-4766f9579e79\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-10-02-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.11.46\", \"private_ip\": \"10.44.141.5\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_6\", \"first_alarm\": \"2025-09-18 14:57:21\", \"first_ts\": 1758178641838, \"last_alarm\": \"2025-09-18 14:57:21\", \"last_ts\": 1758178641838...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,861 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,863 - backend.dataSources.roce_event - INFO - 查询到 160 条记录，返回 160 条
2025-10-19 01:49:35,865 - backend.dataSources.roce_event - INFO - 处理完成，共生成 160 条记录
2025-10-19 01:49:35,866 - data_loader - DEBUG - Loaded 160 records from MongoDB
2025-10-19 01:49:35,866 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:49:35,867 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 01:49:35,868 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,868 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,869 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:49:35,870 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:49:35,871 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:49:35,872 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,873 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,873 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,874 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:49:35,875 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:49:35,875 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,876 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:49:35,877 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:49:35,879 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:49:35,880 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:49:35,890 - __main__ - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 01:49:35,891 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,891 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,892 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:49:35,892 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:49:35,892 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:49:35,893 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,893 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,894 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,894 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:49:35,895 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:49:35,896 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,897 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:49:35,897 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:49:35,898 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:49:35,898 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:49:35,902 - __main__ - INFO - Inserted 160 records into table ROCE网络事件-光模块故障表
2025-10-19 01:49:35,931 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 01:49:36,190 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 515.8074999926612, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:51:38,573 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:51:38,574 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:51:38,574 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:51:38,575 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000015526934C20>
2025-10-19 01:51:38,576 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:51:38,885 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:38,886 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "previousDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:51:38,886 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,887 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:51:38,890 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:38,890 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "remainingTimeMS": 4999}
2025-10-19 01:51:38,900 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:51:38,911 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "driverConnectionId": 1, "serverConnectionId": 45848, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.100999992573634, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:51:32.804Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45848, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:51:38,912 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,913 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "previousDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>"}
2025-10-19 01:51:38,913 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,914 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,914 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "driverConnectionId": 1, "serverConnectionId": 45848, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:51:38,915 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:38,975 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0491436000156682}
2025-10-19 01:51:38,976 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06218859998625703}
2025-10-19 01:51:38,977 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,989 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 11.888, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,990 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:38,990 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:51:38,991 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:51:38.990963
2025-10-19 01:51:38,991 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:38,992 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,992 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,993 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005557000113185495}
2025-10-19 01:51:38,993 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:51:38.990Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,012 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 18.787000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,013 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,014 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:39,014 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,015 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,016 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005109999910928309}
2025-10-19 01:51:39,016 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:51:38.990Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,088 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 71.54299999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,091 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:39,092 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,092 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,093 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006219999922905117}
2025-10-19 01:51:39,094 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"getMore\": 1487922067613449280, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,359 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 265.223, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,360 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,361 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:51:39,384 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:51:39,388 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:51:39,388 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:51:39,389 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:51:39,389 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,392 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:51:39,393 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,394 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:51:39,394 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:51:39,395 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:51:39,396 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:51:39,396 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:51:39,397 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,398 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,398 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,399 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,399 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:51:39,400 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:51:39,400 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:51:39,401 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:51:39,401 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:51:39,440 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:51:39,440 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,440 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:51:39,441 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,441 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:51:39,441 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:51:39,442 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:51:39,442 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:51:39,442 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:51:39,443 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,443 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,443 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,444 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,444 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:51:39,445 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:51:39,445 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:51:39,445 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:51:39,446 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:51:39,460 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:51:39,460 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000015526934D70>
2025-10-19 01:51:39,461 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:51:39,499 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,502 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "previousDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:51:39,503 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,580 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:51:39,608 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,610 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "remainingTimeMS": 4998}
2025-10-19 01:51:39,619 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:51:39,637 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "driverConnectionId": 1, "serverConnectionId": 45851, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.80290000513196, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:51:33.524Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45851, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:51:39,644 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,651 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "previousDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>"}
2025-10-19 01:51:39,652 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,653 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,654 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,654 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "driverConnectionId": 1, "serverConnectionId": 45851, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:51:39,713 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04563830001279712}
2025-10-19 01:51:39,713 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.060567300010006875}
2025-10-19 01:51:39,714 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,726 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 11.494000000000002, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,727 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,728 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:51:39,728 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:51:39.728426
2025-10-19 01:51:39,729 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,729 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,730 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,730 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004674999800045043}
2025-10-19 01:51:39,731 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809899}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,742 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 11.280999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,743 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,744 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,745 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,746 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,747 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005870999884791672}
2025-10-19 01:51:39,747 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809899}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,798 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 50.856, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,799 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,800 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,800 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,801 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,801 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00036540001747198403}
2025-10-19 01:51:39,802 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"getMore\": 2560297683458713375, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,812 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 10.576, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,813 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,814 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 01:51:39,815 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-19 01:51:39,816 - data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-19 01:51:39,817 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:51:39,818 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 01:51:39,818 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,819 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,820 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:51:39,820 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:51:39,821 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:51:39,822 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,822 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,823 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,823 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:51:39,824 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:51:39,824 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,825 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:51:39,826 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:51:39,826 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:51:39,827 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:51:39,828 - __main__ - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 01:51:39,828 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,829 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,829 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:51:39,829 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:51:39,830 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:51:39,830 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,831 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,831 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,831 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:51:39,832 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:51:39,832 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,832 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:51:39,833 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:51:39,833 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:51:39,833 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:51:39,836 - __main__ - INFO - Inserted 106 records into table ROCE网络事件-光模块故障表
2025-10-19 01:51:39,867 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 01:51:40,160 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 505.5825999879744, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:58:53,009 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:58:53,010 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:58:53,826 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d55df25b78526cb184ee"}}
2025-10-19 01:58:53,828 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d55df25b78526cb184ee"}, "previousDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:58:53,829 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:53,831 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:58:53,837 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}}
2025-10-19 01:58:53,838 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "remainingTimeMS": 4998}
2025-10-19 01:58:53,864 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d55df25b78526cb184ee"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:58:53,877 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d55df25b78526cb184ee"}, "driverConnectionId": 1, "serverConnectionId": 45857, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.472400015918538, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:58:47.773Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45857, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:58:53,879 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:53,880 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d55df25b78526cb184ee"}, "previousDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>"}
2025-10-19 01:58:53,882 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:53,883 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d55df25b78526cb184ee"}, "driverConnectionId": 1, "serverConnectionId": 45857, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:58:53,886 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:53,888 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,054 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1277657999889925}
2025-10-19 01:58:54,055 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.16993179998826236}
2025-10-19 01:58:54,057 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tIDTTgNyTfqZIKc4bZMXfw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,071 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "durationMS": 13.725, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,072 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,073 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:58:54,074 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:58:54.074370
2025-10-19 01:58:54,075 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}}
2025-10-19 01:58:54,077 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,079 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,081 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002111000008881092}
2025-10-19 01:58:54,087 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760810334}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tIDTTgNyTfqZIKc4bZMXfw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,104 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "durationMS": 16.674999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,106 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,109 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}}
2025-10-19 01:58:54,111 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,112 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,113 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011272999981883913}
2025-10-19 01:58:54,116 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760810334}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tIDTTgNyTfqZIKc4bZMXfw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,192 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "durationMS": 76.486, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,200 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,203 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001F8F0E22F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}}
2025-10-19 01:58:54,205 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001F8F0E22F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d55df25b78526cb184ee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011472400015918538>]>", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,206 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,208 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0015971999964676797}
2025-10-19 01:58:54,209 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "command": "{\"getMore\": 5564727701762406511, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tIDTTgNyTfqZIKc4bZMXfw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,226 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "durationMS": 17.19, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45859, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,229 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55df25b78526cb184ee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,230 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 01:58:54,233 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-19 01:58:54,237 - backend.data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-19 01:58:54,238 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:58:54,249 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:58:54,251 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 01:58:54,275 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x000001F8F1223390>
2025-10-19 01:58:54,278 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:58:54,285 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}}
2025-10-19 01:58:54,289 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}, "previousDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:58:54,291 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,296 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:58:54,313 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}}
2025-10-19 01:58:54,319 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "remainingTimeMS": 4994}
2025-10-19 01:58:54,321 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:58:54,339 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}, "driverConnectionId": 1, "serverConnectionId": 45860, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 15.4634999926202, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:58:48.233Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45860, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:58:54,344 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,353 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}, "previousDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>"}
2025-10-19 01:58:54,358 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,359 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,362 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,374 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}, "driverConnectionId": 1, "serverConnectionId": 45860, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:58:54,525 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.12726359997759573}
2025-10-19 01:58:54,526 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1670899000018835}
2025-10-19 01:58:54,528 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QWMNglYLQ5qyzh5/prHXzg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,540 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "durationMS": 11.892, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,544 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,546 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:58:54,546 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:58:54.546716
2025-10-19 01:58:54,547 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}}
2025-10-19 01:58:54,549 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,562 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,564 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001602899981662631}
2025-10-19 01:58:54,567 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760810334}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QWMNglYLQ5qyzh5/prHXzg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,588 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "durationMS": 21.041, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,591 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,593 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}}
2025-10-19 01:58:54,595 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,597 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,598 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001233099988894537}
2025-10-19 01:58:54,601 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760810334}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QWMNglYLQ5qyzh5/prHXzg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,725 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "durationMS": 124.18700000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,728 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,729 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001F8F0E22F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}}
2025-10-19 01:58:54,731 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001F8F0E22F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d55ef25b78526cb184ef, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0154634999926202>]>", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,732 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,733 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009203000226989388}
2025-10-19 01:58:54,740 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "command": "{\"getMore\": 5871016556656533069, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QWMNglYLQ5qyzh5/prHXzg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,755 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "durationMS": 15.486, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45862, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:58:54,761 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:58:54,762 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 01:58:54,765 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-19 01:58:54,769 - backend.data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-19 01:58:54,774 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:58:54,777 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 01:58:54,778 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:58:54,793 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:58:54,794 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:58:54,796 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:58:54,797 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:58:54,803 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:58:54,805 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:58:54,807 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:58:54,809 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:58:54,810 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:58:54,812 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:58:54,814 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:58:54,815 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:58:54,817 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:58:54,823 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:58:54,887 - backend.database_builder - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 01:58:54,889 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:58:54,893 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:58:54,910 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:58:54,914 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:58:54,920 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:58:54,922 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:58:54,924 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:58:54,926 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:58:54,927 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:58:54,927 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:58:54,928 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:58:54,929 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:58:54,932 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:58:54,940 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:58:54,941 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:58:54,951 - backend.database_builder - INFO - Inserted 106 records into table ROCE网络事件-光模块故障表
2025-10-19 01:58:55,030 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 01:58:55,405 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d55ef25b78526cb184ef"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1031.3459000026342, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 11:48:43,181 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 11:48:43,181 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 11:48:44,287 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f45f9c6e2704cd596acb89"}}
2025-10-19 11:48:44,288 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f45f9c6e2704cd596acb89"}, "previousDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 11:48:44,288 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,289 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 11:48:44,291 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}}
2025-10-19 11:48:44,292 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "remainingTimeMS": 4999}
2025-10-19 11:48:44,322 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f45f9c6e2704cd596acb89"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 11:48:44,381 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f45f9c6e2704cd596acb89"}, "driverConnectionId": 1, "serverConnectionId": 46247, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 58.41399997007102, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T03:48:44.389Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46247, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 11:48:44,382 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,382 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f45f9c6e2704cd596acb89"}, "previousDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>"}
2025-10-19 11:48:44,383 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,384 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f45f9c6e2704cd596acb89"}, "driverConnectionId": 1, "serverConnectionId": 46247, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 11:48:44,384 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,385 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:44,496 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08489670004928485}
2025-10-19 11:48:44,496 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11215579998679459}
2025-10-19 11:48:44,497 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KBxdR0aaS2qapLAC16/50A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,585 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "durationMS": 87.902, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,585 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:44,586 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 11:48:44,586 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 11:48:44.586508
2025-10-19 11:48:44,587 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}}
2025-10-19 11:48:44,587 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,588 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,588 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003646999830380082}
2025-10-19 11:48:44,589 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760845724}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KBxdR0aaS2qapLAC16/50A==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,611 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "durationMS": 22.630999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,612 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:44,613 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}}
2025-10-19 11:48:44,613 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,614 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,614 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003019999712705612}
2025-10-19 11:48:44,614 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760845724}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KBxdR0aaS2qapLAC16/50A==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,833 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "durationMS": 218.433, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,838 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:44,839 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001D54DD42F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}}
2025-10-19 11:48:44,839 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001D54DD42F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb89, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05841399997007102>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,840 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,840 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003074000123888254}
2025-10-19 11:48:44,840 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "command": "{\"getMore\": 7214383765273528653, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KBxdR0aaS2qapLAC16/50A==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,886 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "durationMS": 45.521, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46248, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,887 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb89"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:44,887 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 11:48:44,888 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 11:48:44,888 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 11:48:44,889 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 11:48:44,889 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 11:48:44,890 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 11:48:44,898 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x000001D54E143390>
2025-10-19 11:48:44,899 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 11:48:44,920 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}}
2025-10-19 11:48:44,921 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "previousDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 11:48:44,921 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,922 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 11:48:44,923 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}}
2025-10-19 11:48:44,924 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "remainingTimeMS": 4999}
2025-10-19 11:48:44,957 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 11:48:44,986 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "driverConnectionId": 1, "serverConnectionId": 46250, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 28.127600031439215, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T03:48:44.995Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46250, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 11:48:44,986 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,987 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "previousDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>"}
2025-10-19 11:48:44,987 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,987 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "driverConnectionId": 1, "serverConnectionId": 46250, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 11:48:44,988 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:44,988 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:45,073 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05181919998722151}
2025-10-19 11:48:45,074 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08607660001143813}
2025-10-19 11:48:45,074 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"euhuz+vATpKOwRA05DfWjw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,136 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "durationMS": 61.933, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,170 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:45,185 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 11:48:45,186 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 11:48:45.186171
2025-10-19 11:48:45,186 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}}
2025-10-19 11:48:45,187 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,187 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,188 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000387399981264025}
2025-10-19 11:48:45,188 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760845725}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"euhuz+vATpKOwRA05DfWjw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,227 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "durationMS": 39.093999999999994, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,228 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:45,228 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}}
2025-10-19 11:48:45,229 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,229 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,230 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003964999923482537}
2025-10-19 11:48:45,230 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760845725}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"euhuz+vATpKOwRA05DfWjw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,421 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "durationMS": 191.325, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,423 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:45,423 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001D54DD42F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}}
2025-10-19 11:48:45,424 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001D54DD42F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f45f9c6e2704cd596acb8a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.028127600031439215>]>", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,424 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,424 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002861999673768878}
2025-10-19 11:48:45,425 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "command": "{\"getMore\": 251110575485420097, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"euhuz+vATpKOwRA05DfWjw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,459 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "durationMS": 34.397, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46251, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 11:48:45,460 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 11:48:45,461 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 11:48:45,461 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 11:48:45,462 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 11:48:45,462 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 11:48:45,463 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 11:48:45,498 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f45f9c6e2704cd596acb8a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 510.6056000222452, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 14:44:12,777 - backend.data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 14:44:12,778 - backend.data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 14:44:12,800 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 14:44:13,025 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:13,107 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 14:44:13,108 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 14:44:13,248 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:13,370 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 14:44:13,370 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 14:44:13,494 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:13,573 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 14:44:13,573 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 14:44:13,689 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:13,842 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 14:44:13,843 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 14:44:13,955 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:14,229 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 14:44:14,230 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 14:44:14,343 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:14,406 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 14:44:14,408 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 14:44:14,509 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:14,587 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 14:44:14,588 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 14:44:14,683 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:14,847 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 14:44:14,850 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 14:44:14,962 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:15,034 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 14:44:15,036 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 14:44:15,128 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:15,192 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 14:44:15,193 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 14:44:15,275 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:15,347 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 14:44:15,348 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 14:44:15,465 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:15,718 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 14:44:15,719 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 14:44:15,795 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:15,873 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 14:44:15,874 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 14:44:15,952 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:16,274 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 14:44:16,285 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 14:44:16,372 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:16,443 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 14:44:16,444 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 14:44:16,506 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:16,566 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 14:44:16,567 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 14:44:16,616 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:16,647 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 14:44:16,648 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 14:44:16,694 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 14:44:16,697 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 14:44:16,698 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 14:44:16,700 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 14:44:16,702 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 14:44:16,770 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 14:44:16,783 - backend.data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 14:44:16,785 - backend.data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 14:44:16,807 - backend.data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 14:44:16,808 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_inventory.db
2025-10-19 14:44:16,832 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x000002BC5605DF90>
2025-10-19 14:44:16,832 - backend.data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 14:44:16,836 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 14:44:17,007 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:17,117 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 14:44:17,118 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 14:44:17,253 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:17,330 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 14:44:17,332 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 14:44:17,457 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:17,531 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 14:44:17,532 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 14:44:17,652 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:17,717 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 14:44:17,718 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 14:44:17,851 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:17,902 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 14:44:17,902 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 14:44:18,015 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:18,063 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 14:44:18,064 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 14:44:18,177 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:18,239 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 14:44:18,240 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 14:44:18,340 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:18,407 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 14:44:18,408 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 14:44:18,545 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:19,009 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 14:44:19,010 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 14:44:19,107 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:19,186 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 14:44:19,187 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 14:44:19,274 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:19,343 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 14:44:19,344 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 14:44:19,422 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:19,491 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 14:44:19,491 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 14:44:19,563 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:19,635 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 14:44:19,636 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 14:44:19,704 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:19,770 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 14:44:19,771 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 14:44:19,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:19,903 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 14:44:19,904 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 14:44:19,968 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:20,035 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 14:44:20,036 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 14:44:20,225 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:44:20,301 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 14:44:20,313 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 14:44:20,360 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 14:44:20,361 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 14:44:20,362 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 14:44:20,362 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 14:44:20,363 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 14:44:20,417 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 14:44:20,425 - backend.data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 14:44:20,425 - backend.data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 14:44:20,426 - backend.database_builder - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-19 14:44:20,427 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 14:44:20,436 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 14:44:20,438 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 14:44:20,440 - backend.database_builder - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 14:44:20,441 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 14:44:20,442 - backend.database_builder - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 14:44:20,443 - backend.database_builder - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 14:44:20,444 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 14:44:20,445 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 14:44:20,446 - backend.database_builder - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 14:44:20,447 - backend.database_builder - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 14:44:20,447 - backend.database_builder - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 14:44:20,448 - backend.database_builder - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 14:44:20,496 - backend.database_builder - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-19 14:44:20,497 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 14:44:20,497 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 14:44:20,498 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 14:44:20,498 - backend.database_builder - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 14:44:20,499 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 14:44:20,499 - backend.database_builder - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 14:44:20,500 - backend.database_builder - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 14:44:20,501 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 14:44:20,503 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 14:44:20,504 - backend.database_builder - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 14:44:20,505 - backend.database_builder - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 14:44:20,507 - backend.database_builder - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 14:44:20,507 - backend.database_builder - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 14:44:20,761 - backend.database_builder - INFO - Inserted 16446 records into table 网络设备总数量表
2025-10-19 14:44:20,801 - backend.database_builder - INFO - Database built/updated at test_network_device_inventory.db (rebuild=True, status=0)
2025-10-19 14:48:09,395 - backend.data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 14:48:09,395 - backend.data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 14:48:09,399 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 14:48:09,621 - backend.data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 14:56:18,924 - backend.data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 14:56:18,930 - backend.data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 14:56:18,986 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 14:56:19,157 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:19,297 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 14:56:19,298 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 14:56:19,439 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:19,565 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 14:56:19,566 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 14:56:19,723 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:19,797 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 14:56:19,798 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 14:56:19,964 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:20,585 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 14:56:20,587 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 14:56:20,715 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:21,364 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 14:56:21,365 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 14:56:21,526 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:21,682 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 14:56:21,683 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 14:56:21,789 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:21,891 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 14:56:21,906 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 14:56:22,061 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:22,182 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 14:56:22,183 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 14:56:22,303 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:22,557 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 14:56:22,559 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 14:56:22,650 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:22,723 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 14:56:22,724 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 14:56:22,814 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:22,899 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 14:56:22,900 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 14:56:23,010 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:23,170 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 14:56:23,171 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 14:56:23,251 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:23,353 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 14:56:23,354 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 14:56:23,431 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:23,561 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 14:56:23,567 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 14:56:23,661 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:23,798 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 14:56:23,799 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 14:56:23,879 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:24,011 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 14:56:24,012 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 14:56:24,063 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:24,189 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 14:56:24,219 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 14:56:24,324 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 14:56:24,328 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 14:56:24,344 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 14:56:24,347 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 14:56:24,347 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 14:56:24,930 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 14:56:24,937 - backend.data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 14:56:24,941 - backend.data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 14:56:24,967 - backend.data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 14:56:24,967 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_inventory.db
2025-10-19 14:56:24,990 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x000001CDCD04A0D0>
2025-10-19 14:56:24,991 - backend.data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 14:56:24,994 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 14:56:25,163 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:25,449 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 14:56:25,497 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 14:56:25,639 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:25,717 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 14:56:25,718 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 14:56:25,836 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:25,911 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 14:56:25,912 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 14:56:26,030 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:26,082 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 14:56:26,082 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 14:56:26,187 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:26,252 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 14:56:26,254 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 14:56:26,361 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:26,409 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 14:56:26,410 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 14:56:26,520 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:26,563 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 14:56:26,564 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 14:56:26,655 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:26,700 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 14:56:26,700 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 14:56:26,802 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:26,840 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 14:56:26,841 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 14:56:26,932 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:26,976 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 14:56:26,978 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 14:56:27,065 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:27,107 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 14:56:27,108 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 14:56:27,193 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:27,323 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 14:56:27,329 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 14:56:27,507 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:27,828 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 14:56:27,848 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 14:56:28,033 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:28,159 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 14:56:28,163 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 14:56:28,247 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:28,329 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 14:56:28,330 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 14:56:28,444 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:28,702 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 14:56:28,704 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 14:56:28,758 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 14:56:28,789 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 14:56:28,790 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 14:56:28,831 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 14:56:28,833 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 14:56:28,834 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 14:56:28,835 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 14:56:28,835 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 14:56:29,176 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 14:56:29,181 - backend.data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 14:56:29,182 - backend.data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 14:56:29,183 - backend.database_builder - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-19 14:56:29,185 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 14:56:29,191 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 14:56:29,192 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 14:56:29,193 - backend.database_builder - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 14:56:29,194 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 14:56:29,195 - backend.database_builder - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 14:56:29,196 - backend.database_builder - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 14:56:29,197 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 14:56:29,199 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 14:56:29,201 - backend.database_builder - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 14:56:29,202 - backend.database_builder - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 14:56:29,203 - backend.database_builder - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 14:56:29,205 - backend.database_builder - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 14:56:29,295 - backend.database_builder - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-19 14:56:29,295 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 14:56:29,296 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 14:56:29,297 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 14:56:29,297 - backend.database_builder - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 14:56:29,298 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 14:56:29,298 - backend.database_builder - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 14:56:29,299 - backend.database_builder - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 14:56:29,300 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 14:56:29,301 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 14:56:29,302 - backend.database_builder - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 14:56:29,302 - backend.database_builder - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 14:56:29,303 - backend.database_builder - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 14:56:29,304 - backend.database_builder - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 14:56:29,531 - backend.database_builder - INFO - Inserted 16446 records into table 网络设备总数量表
2025-10-19 14:56:29,566 - backend.database_builder - INFO - Database built/updated at test_network_device_inventory.db (rebuild=True, status=0)
2025-10-19 15:02:49,702 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 15:02:49,702 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 15:02:49,703 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 15:02:49,703 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 15:02:49,705 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000018DAF65CC20>
2025-10-19 15:02:49,705 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 15:02:50,006 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f48d191eef85d10f3c2ae5"}}
2025-10-19 15:02:50,007 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "previousDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:02:50,008 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,008 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:02:50,011 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}}
2025-10-19 15:02:50,011 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "remainingTimeMS": 4999}
2025-10-19 15:02:50,060 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:02:50,073 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "driverConnectionId": 1, "serverConnectionId": 46374, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.393400025554001, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:02:49.862Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46374, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:02:50,073 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,074 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "previousDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>"}
2025-10-19 15:02:50,074 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,075 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "driverConnectionId": 1, "serverConnectionId": 46374, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:02:50,075 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,076 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:50,148 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.058436600025743246}
2025-10-19 15:02:50,148 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0731738000176847}
2025-10-19 15:02:50,149 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"1NvXVJOvQ0Cay0Trr7LP6A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,159 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "durationMS": 9.872, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,160 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:50,160 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:02:50,161 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:02:50.161117
2025-10-19 15:02:50,161 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}}
2025-10-19 15:02:50,162 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,162 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,163 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004358000005595386}
2025-10-19 15:02:50,163 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:02:50.161Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"1NvXVJOvQ0Cay0Trr7LP6A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,184 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "durationMS": 20.729999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,185 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:50,185 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}}
2025-10-19 15:02:50,186 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,187 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,187 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00037049996899440885}
2025-10-19 15:02:50,188 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:02:50.161Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"1NvXVJOvQ0Cay0Trr7LP6A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,291 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "durationMS": 103.211, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,296 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:50,297 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000018DAF91F880>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}}
2025-10-19 15:02:50,297 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000018DAF91F880>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f48d191eef85d10f3c2ae5, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011393400025554001>]>", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,298 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,298 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004366999492049217}
2025-10-19 15:02:50,299 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "command": "{\"getMore\": 3075775368305466994, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"1NvXVJOvQ0Cay0Trr7LP6A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,755 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "durationMS": 456.46999999999997, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46376, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,757 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d191eef85d10f3c2ae5"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:50,759 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 15:02:50,798 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 15:02:50,805 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 15:02:50,806 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 15:02:50,807 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 15:02:50,808 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:02:50,815 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:02:50,816 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:02:50,821 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:02:50,822 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 15:02:50,823 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:02:50,824 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:02:50,825 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 15:02:50,826 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 15:02:50,828 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 15:02:50,831 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:02:50,833 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:02:50,835 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:02:50,837 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 15:02:50,838 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:02:50,839 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:02:50,839 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 15:02:50,914 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 15:02:50,915 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:02:50,915 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:02:50,916 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:02:50,916 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:02:50,917 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 15:02:50,917 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:02:50,919 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:02:50,920 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 15:02:50,921 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 15:02:50,921 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 15:02:50,922 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:02:50,922 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:02:50,923 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:02:50,923 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 15:02:50,923 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:02:50,924 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:02:50,924 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 15:02:50,949 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 15:02:50,949 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000018DAF65CD70>
2025-10-19 15:02:50,950 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 15:02:50,994 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}}
2025-10-19 15:02:50,995 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "previousDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:02:50,996 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:50,997 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:02:50,999 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}}
2025-10-19 15:02:50,999 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "remainingTimeMS": 4999}
2025-10-19 15:02:51,009 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:02:51,024 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "driverConnectionId": 1, "serverConnectionId": 46377, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 13.701999967452139, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:02:50.812Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46377, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:02:51,025 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,026 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "previousDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>"}
2025-10-19 15:02:51,027 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,028 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "driverConnectionId": 1, "serverConnectionId": 46377, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:02:51,029 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,030 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:51,092 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05020870000589639}
2025-10-19 15:02:51,092 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06342590000713244}
2025-10-19 15:02:51,093 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LpOojulhTiut8nusbQqazA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,104 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "durationMS": 10.74, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,105 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:51,105 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 15:02:51,106 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:02:51.106016
2025-10-19 15:02:51,106 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}}
2025-10-19 15:02:51,107 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,108 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,108 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005776999751105905}
2025-10-19 15:02:51,109 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760857371}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LpOojulhTiut8nusbQqazA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,122 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "durationMS": 12.484, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,123 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:51,124 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}}
2025-10-19 15:02:51,125 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,126 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,127 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000716300040949136}
2025-10-19 15:02:51,129 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760857371}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LpOojulhTiut8nusbQqazA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,195 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "durationMS": 66.305, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,196 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:51,197 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000018DAF91F880>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}}
2025-10-19 15:02:51,198 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000018DAF91F880>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f48d1a1eef85d10f3c2ae6, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013701999967452139>]>", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,199 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,200 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006852999795228243}
2025-10-19 15:02:51,201 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "command": "{\"getMore\": 4891482408335020693, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LpOojulhTiut8nusbQqazA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,214 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "durationMS": 12.915, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46379, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:02:51,215 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:02:51,217 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 15:02:51,217 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 15:02:51,218 - data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 15:02:51,219 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 15:02:51,219 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x0000018DAF65CEC0>
2025-10-19 15:02:51,220 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 15:02:51,224 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 15:02:51,368 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:51,464 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 15:02:51,465 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 15:02:51,593 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:51,681 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 15:02:51,681 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 15:02:51,803 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:51,865 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 15:02:51,865 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 15:02:51,990 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:52,000 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 15:02:52,054 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 15:02:52,054 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 15:02:52,088 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.030071399989537895}
2025-10-19 15:02:52,090 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 15:02:52,145 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.044022200047038496}
2025-10-19 15:02:52,146 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 15:02:52,162 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:52,216 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 15:02:52,216 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.03448309999657795}
2025-10-19 15:02:52,217 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 15:02:52,217 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 15:02:52,287 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04446089995326474}
2025-10-19 15:02:52,323 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:52,368 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 15:02:52,369 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 15:02:52,520 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:52,566 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 15:02:52,567 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 15:02:52,658 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:52,709 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 15:02:52,709 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 15:02:52,799 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:52,847 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 15:02:52,848 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 15:02:52,935 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:52,983 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 15:02:52,984 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 15:02:53,068 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:53,108 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 15:02:53,109 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 15:02:53,215 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:53,259 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 15:02:53,260 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 15:02:53,340 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:53,412 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 15:02:53,413 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 15:02:53,508 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:53,574 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 15:02:53,575 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 15:02:53,662 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:53,714 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 15:02:53,715 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 15:02:53,784 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:53,826 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 15:02:53,832 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 15:02:53,880 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:02:53,896 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 15:02:53,896 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 15:02:53,944 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 15:02:53,944 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 15:02:53,945 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 15:02:53,945 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 15:02:53,945 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 15:02:54,057 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 15:02:54,061 - data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 15:02:54,061 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 15:02:54,062 - __main__ - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-19 15:02:54,062 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:02:54,062 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 15:02:54,063 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 15:02:54,063 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 15:02:54,064 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:02:54,064 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 15:02:54,064 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 15:02:54,065 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:02:54,065 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:02:54,066 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 15:02:54,066 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 15:02:54,067 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 15:02:54,067 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 15:02:54,069 - __main__ - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-19 15:02:54,069 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:02:54,070 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 15:02:54,070 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 15:02:54,071 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 15:02:54,071 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:02:54,071 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 15:02:54,074 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 15:02:54,076 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:02:54,076 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:02:54,077 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 15:02:54,077 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 15:02:54,077 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 15:02:54,077 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 15:02:54,195 - __main__ - INFO - Inserted 16446 records into table 网络设备总数量表
2025-10-19 15:02:54,229 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 15:02:54,635 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f48d1a1eef85d10f3c2ae6"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 3606.6549999522977, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 15:22:08,245 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:22:08,245 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:22:08,605 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f491a0d144b00968cca7aa"}}
2025-10-19 15:22:08,606 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f491a0d144b00968cca7aa"}, "previousDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:22:08,606 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:08,608 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:22:08,610 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}}
2025-10-19 15:22:08,611 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "remainingTimeMS": 4999}
2025-10-19 15:22:08,638 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f491a0d144b00968cca7aa"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:22:08,711 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f491a0d144b00968cca7aa"}, "driverConnectionId": 1, "serverConnectionId": 46398, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 72.2294999868609, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:22:08.454Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46398, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:22:08,712 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:08,713 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f491a0d144b00968cca7aa"}, "previousDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>"}
2025-10-19 15:22:08,714 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:08,715 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:08,715 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f491a0d144b00968cca7aa"}, "driverConnectionId": 1, "serverConnectionId": 46398, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:22:08,715 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:09,101 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.2541625999729149}
2025-10-19 15:22:09,121 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.40604690002510324}
2025-10-19 15:22:09,125 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"j+wKx1huQpKytdOfIegrug==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,230 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "durationMS": 105.42999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,236 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:09,238 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:22:09,239 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:22:09.239644
2025-10-19 15:22:09,247 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}}
2025-10-19 15:22:09,254 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,266 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,287 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.02395629999227822}
2025-10-19 15:22:09,301 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:22:09.239Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"j+wKx1huQpKytdOfIegrug==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,344 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "durationMS": 43.272999999999996, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 305}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,345 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:09,349 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}}
2025-10-19 15:22:09,351 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,353 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,354 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0016317999688908458}
2025-10-19 15:22:09,356 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:22:09.239Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"j+wKx1huQpKytdOfIegrug==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,511 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "durationMS": 155.31300000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,520 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:09,522 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001EE602F3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}}
2025-10-19 15:22:09,524 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001EE602F3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f491a0d144b00968cca7aa, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0722294999868609>]>", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,527 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,528 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001122899993788451}
2025-10-19 15:22:09,530 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "command": "{\"getMore\": 1259809493047539908, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"j+wKx1huQpKytdOfIegrug==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,624 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 15:22:09,767 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "durationMS": 237.923, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec211ab63e6e0ad589682\"}, \"event_id\": \"1377858516025344\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-ROCE_AGG-01_01_01_03.KLMY\", \"device_rack\": \"KLYD012F02-N-12-23\", \"device_ip\": \"172.30.137.18\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:09.816Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, ...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46399, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,769 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.11215970001649112}
2025-10-19 15:22:09,772 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:09,774 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 15:22:09,775 - backend.dataSources.network_device_failure - INFO - 查询到 305 条记录，返回 305 条
2025-10-19 15:22:09,805 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 305 条记录
2025-10-19 15:22:09,818 - backend.data_loader - DEBUG - Loaded 305 records from MongoDB
2025-10-19 15:22:09,839 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:22:09,894 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.0848948999773711}
2025-10-19 15:22:09,896 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 15:22:09,925 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:22:09,938 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_failure.db
2025-10-19 15:22:09,945 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000001EE606F6AD0>
2025-10-19 15:22:09,948 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:22:09,968 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}}
2025-10-19 15:22:09,969 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.04805139999371022}
2025-10-19 15:22:09,974 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}, "previousDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:22:09,976 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 15:22:09,977 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:09,991 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:22:10,008 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}}
2025-10-19 15:22:10,009 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "remainingTimeMS": 4998}
2025-10-19 15:22:10,018 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:22:10,044 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f491a0d144b00968cca7aa"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.043653199973050505}
2025-10-19 15:22:10,044 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}, "driverConnectionId": 1, "serverConnectionId": 46405, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 23.604199988767505, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:22:09.839Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46405, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:22:10,057 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,064 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}, "previousDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>"}
2025-10-19 15:22:10,069 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,071 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,073 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:10,074 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}, "driverConnectionId": 1, "serverConnectionId": 46405, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:22:10,187 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08873170003062114}
2025-10-19 15:22:10,188 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11691129999235272}
2025-10-19 15:22:10,189 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6tfi/bJwQnOU4g0IxxdI0w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,204 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "durationMS": 14.181, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,205 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:10,205 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:22:10,206 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:22:10.206313
2025-10-19 15:22:10,206 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}}
2025-10-19 15:22:10,207 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,209 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,209 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007156000356189907}
2025-10-19 15:22:10,210 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:22:10.206Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6tfi/bJwQnOU4g0IxxdI0w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,230 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "durationMS": 20.393, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 305}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,232 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:10,233 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}}
2025-10-19 15:22:10,235 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,237 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,238 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0010446000378578901}
2025-10-19 15:22:10,239 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:22:10.206Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6tfi/bJwQnOU4g0IxxdI0w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,317 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "durationMS": 78.486, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,320 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:10,321 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001EE602F3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}}
2025-10-19 15:22:10,322 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001EE602F3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f491a1d144b00968cca7ab, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023604199988767505>]>", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,323 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,324 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006977999582886696}
2025-10-19 15:22:10,326 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "command": "{\"getMore\": 858742868088565040, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6tfi/bJwQnOU4g0IxxdI0w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,439 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "durationMS": 113.301, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec211ab63e6e0ad589682\"}, \"event_id\": \"1377858516025344\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-ROCE_AGG-01_01_01_03.KLMY\", \"device_rack\": \"KLYD012F02-N-12-23\", \"device_ip\": \"172.30.137.18\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:09.816Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, ...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46406, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:22:10,441 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:22:10,442 - backend.dataSources.network_device_failure - INFO - 查询到 305 条记录，返回 305 条
2025-10-19 15:22:10,457 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 305 条记录
2025-10-19 15:22:10,460 - backend.data_loader - DEBUG - Loaded 305 records from MongoDB
2025-10-19 15:22:10,460 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:22:10,461 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 15:22:10,462 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:22:10,470 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:22:10,472 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:22:10,473 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:22:10,474 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:22:10,475 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:22:10,475 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:22:10,476 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:22:10,477 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:22:10,478 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:22:10,480 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:22:10,483 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:22:10,484 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:22:10,486 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:22:10,487 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:22:10,489 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:22:10,532 - backend.database_builder - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 15:22:10,533 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:22:10,534 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:22:10,534 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:22:10,535 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:22:10,536 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:22:10,536 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:22:10,537 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:22:10,537 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:22:10,538 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:22:10,538 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:22:10,539 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:22:10,539 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:22:10,540 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:22:10,540 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:22:10,541 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:22:10,542 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:22:10,553 - backend.database_builder - INFO - Inserted 305 records into table 网络设备故障表
2025-10-19 15:22:10,600 - backend.database_builder - INFO - Database built/updated at test_network_device_failure.db (rebuild=True, status=0)
2025-10-19 15:22:11,099 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f491a1d144b00968cca7ab"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1024.9324000324123, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 15:29:20,277 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:29:20,277 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:29:20,636 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f493507b22d2233a68dd9b"}}
2025-10-19 15:29:20,637 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493507b22d2233a68dd9b"}, "previousDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:29:20,637 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,638 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:29:20,641 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}}
2025-10-19 15:29:20,642 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "remainingTimeMS": 4999}
2025-10-19 15:29:20,661 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493507b22d2233a68dd9b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:29:20,675 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f493507b22d2233a68dd9b"}, "driverConnectionId": 1, "serverConnectionId": 46415, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.674900004640222, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:29:20.483Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46415, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:29:20,677 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,678 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493507b22d2233a68dd9b"}, "previousDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>"}
2025-10-19 15:29:20,679 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,680 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493507b22d2233a68dd9b"}, "driverConnectionId": 1, "serverConnectionId": 46415, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:29:20,680 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,681 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:20,753 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05646350001916289}
2025-10-19 15:29:20,753 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07309499999973923}
2025-10-19 15:29:20,754 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"HGtOqgmIQuO05lNelj7ObQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,765 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "durationMS": 11.251000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,766 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:20,767 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:29:20,767 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:29:20.767582
2025-10-19 15:29:20,768 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}}
2025-10-19 15:29:20,768 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,769 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,769 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00038129999302327633}
2025-10-19 15:29:20,770 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:29:20.767Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"HGtOqgmIQuO05lNelj7ObQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,789 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "durationMS": 19.130000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 305}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,790 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:20,791 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}}
2025-10-19 15:29:20,792 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,792 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,793 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005329000414349139}
2025-10-19 15:29:20,794 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:29:20.767Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"HGtOqgmIQuO05lNelj7ObQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,919 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "durationMS": 125.79599999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,923 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:20,923 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000028B0C063100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}}
2025-10-19 15:29:20,924 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000028B0C063100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493507b22d2233a68dd9b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012674900004640222>]>", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,926 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:20,926 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006128000095486641}
2025-10-19 15:29:20,927 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "command": "{\"getMore\": 1992620890447238313, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"HGtOqgmIQuO05lNelj7ObQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,009 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "durationMS": 81.76400000000001, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec211ab63e6e0ad589682\"}, \"event_id\": \"1377858516025344\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-ROCE_AGG-01_01_01_03.KLMY\", \"device_rack\": \"KLYD012F02-N-12-23\", \"device_ip\": \"172.30.137.18\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:09.816Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, ...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46417, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,011 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493507b22d2233a68dd9b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:21,012 - backend.dataSources.network_device_failure - INFO - 查询到 305 条记录，返回 305 条
2025-10-19 15:29:21,024 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 305 条记录
2025-10-19 15:29:21,026 - backend.data_loader - DEBUG - Loaded 305 records from MongoDB
2025-10-19 15:29:21,026 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:29:21,030 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:29:21,030 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_failure.db
2025-10-19 15:29:21,032 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceFailureDataSourceLoader object at 0x0000028B0C463110>
2025-10-19 15:29:21,032 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:29:21,035 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}}
2025-10-19 15:29:21,036 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}, "previousDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:29:21,037 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,038 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:29:21,041 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}}
2025-10-19 15:29:21,042 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "remainingTimeMS": 4998}
2025-10-19 15:29:21,050 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:29:21,063 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}, "driverConnectionId": 1, "serverConnectionId": 46418, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.861199978739023, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:29:20.870Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46418, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:29:21,064 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,065 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}, "previousDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>"}
2025-10-19 15:29:21,066 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,066 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}, "driverConnectionId": 1, "serverConnectionId": 46418, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:29:21,067 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,068 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:21,145 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06345879996661097}
2025-10-19 15:29:21,145 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07822710002074018}
2025-10-19 15:29:21,146 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"lC+QG5K5RDedbQZecZISrQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,159 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "durationMS": 12.547, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,160 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:21,161 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:29:21,161 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:29:21.161799
2025-10-19 15:29:21,162 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}}
2025-10-19 15:29:21,163 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,163 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,164 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000417300034314394}
2025-10-19 15:29:21,164 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:29:21.161Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"lC+QG5K5RDedbQZecZISrQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,184 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "durationMS": 19.458, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 305}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,185 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:21,185 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}}
2025-10-19 15:29:21,186 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,188 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,189 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007605999708175659}
2025-10-19 15:29:21,189 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"status_code\": 100, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:29:21.161Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"lC+QG5K5RDedbQZecZISrQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,263 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "durationMS": 74.007, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,265 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:21,266 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000028B0C063100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}}
2025-10-19 15:29:21,266 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000028B0C063100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493517b22d2233a68dd9c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011861199978739023>]>", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,267 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,267 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00040310004260390997}
2025-10-19 15:29:21,268 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "command": "{\"getMore\": 8777036619673492432, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"lC+QG5K5RDedbQZecZISrQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,347 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "durationMS": 79.75999999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec211ab63e6e0ad589682\"}, \"event_id\": \"1377858516025344\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-ROCE_AGG-01_01_01_03.KLMY\", \"device_rack\": \"KLYD012F02-N-12-23\", \"device_ip\": \"172.30.137.18\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:09.816Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, ...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46420, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:29:21,349 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:29:21,350 - backend.dataSources.network_device_failure - INFO - 查询到 305 条记录，返回 305 条
2025-10-19 15:29:21,358 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 305 条记录
2025-10-19 15:29:21,360 - backend.data_loader - DEBUG - Loaded 305 records from MongoDB
2025-10-19 15:29:21,360 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:29:21,361 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 15:29:21,361 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:29:21,365 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:29:21,366 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:29:21,367 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:29:21,368 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:29:21,369 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:29:21,369 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:29:21,370 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:29:21,371 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:29:21,371 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:29:21,372 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:29:21,373 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:29:21,374 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:29:21,375 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:29:21,375 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:29:21,376 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:29:21,426 - backend.database_builder - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 15:29:21,427 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:29:21,428 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:29:21,428 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:29:21,428 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:29:21,429 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:29:21,429 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:29:21,430 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:29:21,430 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:29:21,431 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:29:21,431 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:29:21,431 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:29:21,432 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:29:21,432 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:29:21,433 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:29:21,433 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:29:21,433 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:29:21,439 - backend.database_builder - INFO - Inserted 305 records into table 网络设备故障表
2025-10-19 15:29:21,461 - backend.database_builder - INFO - Database built/updated at test_network_device_failure.db (rebuild=True, status=0)
2025-10-19 15:29:21,575 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f493517b22d2233a68dd9c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 508.532399951946, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 15:31:23,278 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:31:23,278 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:31:23,594 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f493cb922cd63a9c64e17f"}}
2025-10-19 15:31:23,595 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493cb922cd63a9c64e17f"}, "previousDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:31:23,596 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,596 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:31:23,599 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}}
2025-10-19 15:31:23,599 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "remainingTimeMS": 4999}
2025-10-19 15:31:23,622 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493cb922cd63a9c64e17f"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:31:23,636 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f493cb922cd63a9c64e17f"}, "driverConnectionId": 1, "serverConnectionId": 46424, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.717800040263683, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:31:23.447Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46424, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:31:23,637 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,637 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493cb922cd63a9c64e17f"}, "previousDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>"}
2025-10-19 15:31:23,638 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,639 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493cb922cd63a9c64e17f"}, "driverConnectionId": 1, "serverConnectionId": 46424, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:31:23,640 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,641 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:23,715 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.046626899973489344}
2025-10-19 15:31:23,715 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07537699997192249}
2025-10-19 15:31:23,716 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PVLiMZoLRTCrzggCanrz1w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,758 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "durationMS": 42.149, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,760 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:23,761 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:31:23,762 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:31:23.762017
2025-10-19 15:31:23,772 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}}
2025-10-19 15:31:23,773 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,774 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,775 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00040600000647827983}
2025-10-19 15:31:23,775 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:31:23.762Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PVLiMZoLRTCrzggCanrz1w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,829 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "durationMS": 53.513999999999996, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 306}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,833 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:23,834 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}}
2025-10-19 15:31:23,835 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,835 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,836 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005151999648660421}
2025-10-19 15:31:23,837 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:31:23.762Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PVLiMZoLRTCrzggCanrz1w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,917 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "durationMS": 80.398, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,921 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:23,922 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C701313100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}}
2025-10-19 15:31:23,923 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C701313100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493cb922cd63a9c64e17f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012717800040263683>]>", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,923 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:23,924 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006059999577701092}
2025-10-19 15:31:23,925 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "command": "{\"getMore\": 7911249930647539296, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PVLiMZoLRTCrzggCanrz1w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,002 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "durationMS": 76.986, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec212ab63e6e0ad589688\"}, \"event_id\": \"1377858535014400\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-AGG-01_04.KLMY\", \"device_rack\": \"KLYD012F02-N-04-22\", \"device_ip\": \"172.29.17.6\", \"device_role\": \"AZ-AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:10.975Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46426, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,003 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cb922cd63a9c64e17f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:24,004 - backend.dataSources.network_device_failure - INFO - 查询到 306 条记录，返回 306 条
2025-10-19 15:31:24,004 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDevice': 306}
2025-10-19 15:31:24,018 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 306 条记录
2025-10-19 15:31:24,019 - backend.data_loader - DEBUG - Loaded 306 records from MongoDB
2025-10-19 15:31:24,020 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:31:24,027 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:31:24,027 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_failure.db
2025-10-19 15:31:24,029 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000001C701693110>
2025-10-19 15:31:24,030 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:31:24,033 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}}
2025-10-19 15:31:24,034 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}, "previousDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:31:24,035 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,036 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:31:24,043 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}}
2025-10-19 15:31:24,045 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "remainingTimeMS": 4998}
2025-10-19 15:31:24,060 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:31:24,074 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}, "driverConnectionId": 1, "serverConnectionId": 46427, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 13.917899981606752, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:31:23.884Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46427, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:31:24,075 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,076 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}, "previousDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>"}
2025-10-19 15:31:24,077 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,078 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}, "driverConnectionId": 1, "serverConnectionId": 46427, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:31:24,079 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,080 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:24,145 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.051754399959463626}
2025-10-19 15:31:24,145 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06649850000394508}
2025-10-19 15:31:24,146 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TbZyGjUOSReZNLZZhuDfzg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,157 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "durationMS": 10.909, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,158 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:24,160 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:31:24,160 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:31:24.160659
2025-10-19 15:31:24,161 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}}
2025-10-19 15:31:24,162 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,163 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,163 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006938999867998064}
2025-10-19 15:31:24,164 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:31:24.160Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TbZyGjUOSReZNLZZhuDfzg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,186 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "durationMS": 22.07, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 306}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,187 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:24,187 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}}
2025-10-19 15:31:24,188 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,189 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,190 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007796999998390675}
2025-10-19 15:31:24,191 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:31:24.160Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TbZyGjUOSReZNLZZhuDfzg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,258 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "durationMS": 66.718, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,260 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:24,260 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C701313100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}}
2025-10-19 15:31:24,261 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C701313100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f493cc922cd63a9c64e180, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013917899981606752>]>", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,262 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,263 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000507200020365417}
2025-10-19 15:31:24,263 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "command": "{\"getMore\": 6982720314133188372, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TbZyGjUOSReZNLZZhuDfzg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,356 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "durationMS": 92.936, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec212ab63e6e0ad589688\"}, \"event_id\": \"1377858535014400\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-AGG-01_04.KLMY\", \"device_rack\": \"KLYD012F02-N-04-22\", \"device_ip\": \"172.29.17.6\", \"device_role\": \"AZ-AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:10.975Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46429, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:31:24,358 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:31:24,358 - backend.dataSources.network_device_failure - INFO - 查询到 306 条记录，返回 306 条
2025-10-19 15:31:24,359 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDevice': 306}
2025-10-19 15:31:24,365 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 306 条记录
2025-10-19 15:31:24,366 - backend.data_loader - DEBUG - Loaded 306 records from MongoDB
2025-10-19 15:31:24,366 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:31:24,367 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 15:31:24,368 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:31:24,371 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:31:24,372 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:31:24,373 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:31:24,374 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:31:24,375 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:31:24,376 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:31:24,377 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:31:24,378 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:31:24,379 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:31:24,379 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:31:24,380 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:31:24,381 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:31:24,382 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:31:24,382 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:31:24,383 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:31:24,435 - backend.database_builder - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 15:31:24,435 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:31:24,436 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:31:24,436 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:31:24,437 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:31:24,437 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:31:24,437 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:31:24,438 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:31:24,438 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:31:24,439 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:31:24,439 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:31:24,440 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:31:24,440 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:31:24,441 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:31:24,441 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:31:24,444 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:31:24,445 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:31:24,450 - backend.database_builder - INFO - Inserted 306 records into table 网络设备故障表
2025-10-19 15:31:24,472 - backend.database_builder - INFO - Database built/updated at test_network_device_failure.db (rebuild=True, status=0)
2025-10-19 15:31:24,583 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f493cc922cd63a9c64e180"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 505.3401999757625, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 15:33:46,023 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:33:46,024 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:33:46,665 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4945aa40202569886a900"}}
2025-10-19 15:33:46,665 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4945aa40202569886a900"}, "previousDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:33:46,666 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,667 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:33:46,672 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}}
2025-10-19 15:33:46,674 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}, "remainingTimeMS": 4998}
2025-10-19 15:33:46,702 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4945aa40202569886a900"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:33:46,719 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4945aa40202569886a900"}, "driverConnectionId": 1, "serverConnectionId": 46431, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 15.49770002020523, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:33:46.529Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46431, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:33:46,720 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,721 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4945aa40202569886a900"}, "previousDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>"}
2025-10-19 15:33:46,723 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,724 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4945aa40202569886a900"}, "driverConnectionId": 1, "serverConnectionId": 46431, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:33:46,725 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,726 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:46,811 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07204489997820929}
2025-10-19 15:33:46,812 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08767300000181422}
2025-10-19 15:33:46,814 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ODUGxjiRRnK363tH5ptlpg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,825 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945aa40202569886a900"}, "durationMS": 11.245, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,826 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:46,827 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:33:46,828 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:33:46.828261
2025-10-19 15:33:46,829 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}}
2025-10-19 15:33:46,830 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,831 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,831 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006054000114090741}
2025-10-19 15:33:46,832 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:33:46.828Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ODUGxjiRRnK363tH5ptlpg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,887 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945aa40202569886a900"}, "durationMS": 54.798, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 306}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,889 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:46,890 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}}
2025-10-19 15:33:46,891 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,892 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,893 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0012184000224806368}
2025-10-19 15:33:46,895 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:33:46.828Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ODUGxjiRRnK363tH5ptlpg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,983 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945aa40202569886a900"}, "durationMS": 88.824, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,990 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:46,991 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000023672BA3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}}
2025-10-19 15:33:46,992 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000023672BA3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4945aa40202569886a900, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01549770002020523>]>", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,993 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:46,994 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006733000045642257}
2025-10-19 15:33:46,995 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945aa40202569886a900"}, "command": "{\"getMore\": 7764498775510046354, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ODUGxjiRRnK363tH5ptlpg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,129 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945aa40202569886a900"}, "durationMS": 134.522, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec212ab63e6e0ad589688\"}, \"event_id\": \"1377858535014400\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-AGG-01_04.KLMY\", \"device_rack\": \"KLYD012F02-N-04-22\", \"device_ip\": \"172.29.17.6\", \"device_role\": \"AZ-AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:10.975Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46433, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,132 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945aa40202569886a900"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:47,133 - backend.dataSources.network_device_failure - INFO - 查询到 306 条记录，返回 306 条
2025-10-19 15:33:47,134 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDevice': 306}
2025-10-19 15:33:47,156 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 306 条记录
2025-10-19 15:33:47,159 - backend.data_loader - DEBUG - Loaded 306 records from MongoDB
2025-10-19 15:33:47,160 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:33:47,173 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:33:47,174 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_failure.db
2025-10-19 15:33:47,177 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceFailureDataSourceLoader object at 0x0000023672FA3390>
2025-10-19 15:33:47,178 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:33:47,186 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4945ba40202569886a901"}}
2025-10-19 15:33:47,189 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4945ba40202569886a901"}, "previousDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:33:47,192 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,200 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:33:47,207 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}}
2025-10-19 15:33:47,209 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}, "remainingTimeMS": 4998}
2025-10-19 15:33:47,218 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4945ba40202569886a901"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:33:47,234 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4945ba40202569886a901"}, "driverConnectionId": 1, "serverConnectionId": 46434, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.643499976955354, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:33:47.045Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46434, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:33:47,236 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,237 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4945ba40202569886a901"}, "previousDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>"}
2025-10-19 15:33:47,239 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,240 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4945ba40202569886a901"}, "driverConnectionId": 1, "serverConnectionId": 46434, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:33:47,242 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,244 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:47,335 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07709500001510605}
2025-10-19 15:33:47,336 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09489379997830838}
2025-10-19 15:33:47,340 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Op/hMWvDTamZzUjK2SyRAw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,354 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945ba40202569886a901"}, "durationMS": 14.097, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,357 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:47,358 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:33:47,359 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:33:47.359257
2025-10-19 15:33:47,362 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}}
2025-10-19 15:33:47,364 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,366 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,367 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0010961000225506723}
2025-10-19 15:33:47,368 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:33:47.359Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Op/hMWvDTamZzUjK2SyRAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,397 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945ba40202569886a901"}, "durationMS": 29.0, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 306}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,399 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:47,401 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}}
2025-10-19 15:33:47,404 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,407 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,414 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.007528899994213134}
2025-10-19 15:33:47,415 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"EventTypeNetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:33:47.359Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Op/hMWvDTamZzUjK2SyRAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,511 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945ba40202569886a901"}, "durationMS": 96.018, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68ba6472c0e8986065701791\"}, \"event_id\": \"1390350733182976\", \"policy_id\": \"35a23b1e-bd84-4314-b545-80f84020ef40\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"device_fault\", \"event_name\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"BJ-SC-DC-EPC_TOR-002.BJ\", \"device_rack\": \"BJSC011F07-D-02-25\", \"device_ip\": \"172.29.108.4\", \"device_role\": \"DC-TOR-EPC\", \"device_idc\": \"BJSC01\", \"link_status\": \"\u6545\u969c\u53d1\u751f\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-05T04:17:52Z\"}, \"description\": \"\u6d4b\u8bd5\u4ea4\u6362\u673a\u8bbe\u5907\u544a\u8b66\", \"starts_at\": {\"$date\": \"2025-09-05T04:17:54.242Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-6213559680...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,514 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:47,515 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000023672BA3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}}
2025-10-19 15:33:47,517 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000023672BA3100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4945ba40202569886a901, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014643499976955354>]>", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,518 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,519 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000923299987334758}
2025-10-19 15:33:47,521 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4945ba40202569886a901"}, "command": "{\"getMore\": 1197971432806041608, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Op/hMWvDTamZzUjK2SyRAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,627 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4945ba40202569886a901"}, "durationMS": 106.64800000000001, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec212ab63e6e0ad589688\"}, \"event_id\": \"1377858535014400\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"KLMY-YD-AZ-AGG-01_04.KLMY\", \"device_rack\": \"KLYD012F02-N-04-22\", \"device_ip\": \"172.29.17.6\", \"device_role\": \"AZ-AGG\", \"device_idc\": \"KLYD01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:10.975Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46436, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:33:47,631 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:33:47,632 - backend.dataSources.network_device_failure - INFO - 查询到 306 条记录，返回 306 条
2025-10-19 15:33:47,633 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDevice': 306}
2025-10-19 15:33:47,646 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 306 条记录
2025-10-19 15:33:47,649 - backend.data_loader - DEBUG - Loaded 306 records from MongoDB
2025-10-19 15:33:47,649 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:33:47,650 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 15:33:47,651 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:33:47,658 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:33:47,659 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:33:47,661 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:33:47,663 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:33:47,667 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:33:47,669 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:33:47,671 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:33:47,673 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:33:47,674 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:33:47,675 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:33:47,677 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:33:47,678 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:33:47,680 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:33:47,683 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:33:47,684 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:33:47,767 - backend.database_builder - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 15:33:47,768 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:33:47,769 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:33:47,770 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:33:47,771 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:33:47,772 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:33:47,773 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:33:47,776 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:33:47,777 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:33:47,778 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:33:47,779 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:33:47,781 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:33:47,783 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:33:47,784 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:33:47,784 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:33:47,785 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:33:47,786 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:33:47,799 - backend.database_builder - INFO - Inserted 306 records into table 网络设备故障表
2025-10-19 15:33:47,832 - backend.database_builder - INFO - Database built/updated at test_network_device_failure.db (rebuild=True, status=0)
2025-10-19 15:33:48,256 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f4945ba40202569886a901"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1016.1018000217155, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 15:47:35,133 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:47:35,133 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:47:35,321 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4979797c574a68b3f9d04"}}
2025-10-19 15:47:35,321 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4979797c574a68b3f9d04"}, "previousDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:47:35,322 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,322 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:47:35,324 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}}
2025-10-19 15:47:35,324 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "remainingTimeMS": 4999}
2025-10-19 15:47:35,357 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4979797c574a68b3f9d04"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:47:35,371 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4979797c574a68b3f9d04"}, "driverConnectionId": 1, "serverConnectionId": 46445, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.007599987555295, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:47:35.194Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46445, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:47:35,372 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,374 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4979797c574a68b3f9d04"}, "previousDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>"}
2025-10-19 15:47:35,375 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,375 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4979797c574a68b3f9d04"}, "driverConnectionId": 1, "serverConnectionId": 46445, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:47:35,376 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,377 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:35,440 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.050237499992363155}
2025-10-19 15:47:35,441 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06494139996357262}
2025-10-19 15:47:35,441 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AZW21YnXSLik3TULgtzZUA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,458 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "durationMS": 16.708000000000002, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,459 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:35,459 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:47:35,459 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:47:35.459661
2025-10-19 15:47:35,459 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}}
2025-10-19 15:47:35,460 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,460 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,461 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000291300006210804}
2025-10-19 15:47:35,461 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:47:35.459Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AZW21YnXSLik3TULgtzZUA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,484 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "durationMS": 22.87, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 7180}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,484 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:35,485 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}}
2025-10-19 15:47:35,485 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,485 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,486 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00021500000730156898}
2025-10-19 15:47:35,486 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "command": "{\"find\": \"event\", \"filter\": {\"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:47:35.459Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AZW21YnXSLik3TULgtzZUA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,570 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "durationMS": 83.902, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f44dadd672c09a75f8e81f\"}, \"event_id\": \"1452532253657088\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"NX-DX-DC-ROCE_TOR-001_01.NX\", \"interface_name\": \"FourHundredGigE1/0/56\", \"device_rack\": \"NXDX01201F01-B01-11-25\", \"device_ip\": \"172.30.42.17\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"NX-DX-DC-ROCE_AGG-101_03.NX\", \"remote_interface_name\": \"FourHundredGigE1/0/17\", \"remote_device_rack\": \"NXDX01201F02-A02-13-25\", \"remote_device_ip\": \"172.30.42.182\", \"remote_device_role\": \"DC-ROCE_AGG\", \"remote_device_idc\": \"NXDX01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 4, \"last_alert_status\": \"fi...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,572 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:35,572 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000020CC9D33100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}}
2025-10-19 15:47:35,572 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000020CC9D33100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4979797c574a68b3f9d04, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012007599987555295>]>", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,573 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:35,573 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00020889996085315943}
2025-10-19 15:47:35,573 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "command": "{\"getMore\": 5873644265237011570, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AZW21YnXSLik3TULgtzZUA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:36,324 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 15:47:36,428 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.07056990003911778}
2025-10-19 15:47:36,428 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 15:47:36,541 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.08551180001813918}
2025-10-19 15:47:36,541 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 15:47:36,673 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.0857020000112243}
2025-10-19 15:47:36,674 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 15:47:36,783 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.06484779994934797}
2025-10-19 15:47:37,364 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "durationMS": 1790.434, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68ed5cb0d672c09a75f8d9e7\"}, \"event_id\": \"1445079039084544\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"NB-LT-AZ-AGG-03_03.NB\", \"interface_name\": \"100GE1/1/2\", \"device_rack\": \"NBLT012F03-J-01-25\", \"device_ip\": \"172.29.188.63\", \"device_role\": \"AZ-AGG\", \"device_idc\": \"NBLT01\", \"link_status\": \"bgpBackwardTransition_active\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"NB-LT-AZ-EPC_TOR-006.NB\", \"remote_interface_name\": \"100GE1/0/6\", \"remote_device_rack\": \"NBLT012F03-I-13-25\", \"remote_device_ip\": \"172.29.188.74\", \"remote_device_role\": \"AZ-TOR-EPC\", \"remote_device_idc\": \"NBLT01\", \"remote_link_status\": \"bgpBackwardTransition_active\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 6, \"last_alert_status\": \"...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46447, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,387 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979797c574a68b3f9d04"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:37,402 - backend.dataSources.network_device_failure - INFO - 查询到 7180 条记录，返回 7180 条
2025-10-19 15:47:37,414 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceInterface': 6871, 'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 15:47:37,516 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 7180 条记录
2025-10-19 15:47:37,529 - backend.data_loader - DEBUG - Loaded 7180 records from MongoDB
2025-10-19 15:47:37,530 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:47:37,542 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:47:37,542 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_failure.db
2025-10-19 15:47:37,544 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceFailureDataSourceLoader object at 0x0000020CCA133110>
2025-10-19 15:47:37,544 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:47:37,546 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}}
2025-10-19 15:47:37,546 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}, "previousDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:47:37,546 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,547 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:47:37,548 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}}
2025-10-19 15:47:37,548 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "remainingTimeMS": 4999}
2025-10-19 15:47:37,558 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:47:37,569 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}, "driverConnectionId": 1, "serverConnectionId": 46452, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.013800056185573, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:47:37.393Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46452, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:47:37,570 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,570 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}, "previousDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>"}
2025-10-19 15:47:37,570 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,571 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}, "driverConnectionId": 1, "serverConnectionId": 46452, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:47:37,571 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,572 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:37,620 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03696200001286343}
2025-10-19 15:47:37,621 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04928949999157339}
2025-10-19 15:47:37,621 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"22jiPqqCRNeyjtYzklqxLw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,632 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "durationMS": 11.078, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,632 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:37,633 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:47:37,633 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:47:37.633243
2025-10-19 15:47:37,633 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}}
2025-10-19 15:47:37,633 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,634 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,634 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00023579999106004834}
2025-10-19 15:47:37,634 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:47:37.633Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"22jiPqqCRNeyjtYzklqxLw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,655 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "durationMS": 21.263, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 7180}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,656 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:37,656 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}}
2025-10-19 15:47:37,657 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,657 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,658 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003380000125616789}
2025-10-19 15:47:37,658 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "command": "{\"find\": \"event\", \"filter\": {\"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:47:37.633Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"22jiPqqCRNeyjtYzklqxLw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,750 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "durationMS": 92.106, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f44dadd672c09a75f8e81f\"}, \"event_id\": \"1452532253657088\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"NX-DX-DC-ROCE_TOR-001_01.NX\", \"interface_name\": \"FourHundredGigE1/0/56\", \"device_rack\": \"NXDX01201F01-B01-11-25\", \"device_ip\": \"172.30.42.17\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"NX-DX-DC-ROCE_AGG-101_03.NX\", \"remote_interface_name\": \"FourHundredGigE1/0/17\", \"remote_device_rack\": \"NXDX01201F02-A02-13-25\", \"remote_device_ip\": \"172.30.42.182\", \"remote_device_role\": \"DC-ROCE_AGG\", \"remote_device_idc\": \"NXDX01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 4, \"last_alert_status\": \"fi...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,751 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:37,751 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000020CC9D33100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}}
2025-10-19 15:47:37,752 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000020CC9D33100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4979997c574a68b3f9d05, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010013800056185573>]>", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,752 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:37,752 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00031589996069669724}
2025-10-19 15:47:37,753 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "command": "{\"getMore\": 2145375295551353488, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"22jiPqqCRNeyjtYzklqxLw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:38,548 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 15:47:38,636 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.06689489999553189}
2025-10-19 15:47:38,636 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 15:47:38,748 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.07451850001234561}
2025-10-19 15:47:38,749 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 15:47:38,867 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.08173010003520176}
2025-10-19 15:47:38,867 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 15:47:38,999 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.09131239994894713}
2025-10-19 15:47:39,671 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "durationMS": 1918.3909999999998, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68ed5cb0d672c09a75f8d9e7\"}, \"event_id\": \"1445079039084544\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"NB-LT-AZ-AGG-03_03.NB\", \"interface_name\": \"100GE1/1/2\", \"device_rack\": \"NBLT012F03-J-01-25\", \"device_ip\": \"172.29.188.63\", \"device_role\": \"AZ-AGG\", \"device_idc\": \"NBLT01\", \"link_status\": \"bgpBackwardTransition_active\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"NB-LT-AZ-EPC_TOR-006.NB\", \"remote_interface_name\": \"100GE1/0/6\", \"remote_device_rack\": \"NBLT012F03-I-13-25\", \"remote_device_ip\": \"172.29.188.74\", \"remote_device_role\": \"AZ-TOR-EPC\", \"remote_device_idc\": \"NBLT01\", \"remote_link_status\": \"bgpBackwardTransition_active\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 6, \"last_alert_status\": \"...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46454, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:47:39,672 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:47:39,675 - backend.dataSources.network_device_failure - INFO - 查询到 7180 条记录，返回 7180 条
2025-10-19 15:47:39,678 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceInterface': 6871, 'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 15:47:39,756 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 7180 条记录
2025-10-19 15:47:39,769 - backend.data_loader - DEBUG - Loaded 7180 records from MongoDB
2025-10-19 15:47:39,770 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:47:39,770 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 15:47:39,770 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:47:39,772 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:47:39,773 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:47:39,773 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:47:39,774 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:47:39,774 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:47:39,775 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:47:39,775 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:47:39,776 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:47:39,776 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:47:39,776 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:47:39,777 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:47:39,777 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:47:39,777 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:47:39,778 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:47:39,778 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:47:39,796 - backend.database_builder - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 15:47:39,797 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:47:39,797 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:47:39,797 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:47:39,797 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:47:39,798 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:47:39,798 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:47:39,798 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:47:39,798 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:47:39,798 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:47:39,798 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:47:39,799 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:47:39,799 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:47:39,799 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:47:39,799 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:47:39,799 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:47:39,800 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:47:39,843 - backend.database_builder - INFO - Inserted 7180 records into table 网络设备故障表
2025-10-19 15:47:39,859 - backend.database_builder - INFO - Database built/updated at test_network_device_failure.db (rebuild=True, status=0)
2025-10-19 15:47:40,119 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f4979997c574a68b3f9d05"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2548.3827999560162, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 15:49:10,420 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:49:10,420 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:49:10,606 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}}
2025-10-19 15:49:10,607 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "previousDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:49:10,607 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,607 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:49:10,609 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}}
2025-10-19 15:49:10,610 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "remainingTimeMS": 4999}
2025-10-19 15:49:10,644 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:49:10,657 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "driverConnectionId": 1, "serverConnectionId": 46460, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.999100039247423, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:49:10.480Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46460, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:49:10,658 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,658 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "previousDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>"}
2025-10-19 15:49:10,659 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,660 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "driverConnectionId": 1, "serverConnectionId": 46460, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:49:10,661 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,662 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:10,717 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0434633000404574}
2025-10-19 15:49:10,718 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056780199985951185}
2025-10-19 15:49:10,718 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/t2tKWaQQQuxtQvrJtpcqA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,729 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "durationMS": 10.822, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,730 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:10,730 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:49:10,730 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:49:10.730747
2025-10-19 15:49:10,731 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}}
2025-10-19 15:49:10,731 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,732 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,732 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00029009999707341194}
2025-10-19 15:49:10,732 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:49:10.730Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/t2tKWaQQQuxtQvrJtpcqA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,755 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "durationMS": 23.217000000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,756 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:10,757 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}}
2025-10-19 15:49:10,757 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,757 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,758 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002978999982587993}
2025-10-19 15:49:10,758 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:49:10.730Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/t2tKWaQQQuxtQvrJtpcqA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,824 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "durationMS": 65.853, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,826 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:10,826 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BF7C573100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}}
2025-10-19 15:49:10,827 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BF7C573100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6e, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011999100039247423>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,827 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,827 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00020089995814487338}
2025-10-19 15:49:10,828 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "command": "{\"getMore\": 4766211970315465779, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/t2tKWaQQQuxtQvrJtpcqA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,900 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "durationMS": 72.706, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46462, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,901 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6e"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:10,902 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-19 15:49:10,902 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 15:49:10,907 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-19 15:49:10,907 - backend.data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-19 15:49:10,908 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:49:10,910 - backend.data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:49:10,910 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_network_device_failure.db
2025-10-19 15:49:10,911 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000001BF7C973390>
2025-10-19 15:49:10,912 - backend.data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:49:10,913 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}}
2025-10-19 15:49:10,914 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "previousDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:49:10,914 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,915 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:49:10,916 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}}
2025-10-19 15:49:10,916 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "remainingTimeMS": 4999}
2025-10-19 15:49:10,924 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:49:10,934 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "driverConnectionId": 1, "serverConnectionId": 46463, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.275200020056218, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:49:10.757Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46463, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:49:10,934 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,935 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "previousDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>"}
2025-10-19 15:49:10,935 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,935 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "driverConnectionId": 1, "serverConnectionId": 46463, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:49:10,935 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,936 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:10,986 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03974969999399036}
2025-10-19 15:49:10,986 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05056410003453493}
2025-10-19 15:49:10,986 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"4m2gHOsVSMuaMim5DiYPLg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,998 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "durationMS": 11.119, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,998 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:10,998 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:49:10,998 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:49:10.998896
2025-10-19 15:49:10,999 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}}
2025-10-19 15:49:10,999 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:10,999 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,000 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002817999920807779}
2025-10-19 15:49:11,000 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:49:10.998Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"4m2gHOsVSMuaMim5DiYPLg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,024 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "durationMS": 23.741000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,024 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:11,025 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}}
2025-10-19 15:49:11,025 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,026 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,026 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002586999908089638}
2025-10-19 15:49:11,026 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:49:10.998Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"4m2gHOsVSMuaMim5DiYPLg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,098 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "durationMS": 72.313, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,099 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:11,100 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BF7C573100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}}
2025-10-19 15:49:11,100 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BF7C573100>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f497f6e2ccce3b6eee3b6f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009275200020056218>]>", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,101 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,101 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002818999928422272}
2025-10-19 15:49:11,101 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "command": "{\"getMore\": 1577903432008533987, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"4m2gHOsVSMuaMim5DiYPLg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,180 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "durationMS": 78.88499999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46464, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:49:11,181 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:49:11,182 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-19 15:49:11,182 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 15:49:11,185 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-19 15:49:11,186 - backend.data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-19 15:49:11,187 - backend.data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:49:11,187 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 15:49:11,187 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:49:11,190 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:49:11,190 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:49:11,191 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:49:11,191 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:49:11,192 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:49:11,193 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:49:11,193 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:49:11,194 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:49:11,194 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:49:11,195 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:49:11,195 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:49:11,196 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:49:11,196 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:49:11,197 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:49:11,197 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:49:11,234 - backend.database_builder - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 15:49:11,234 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:49:11,235 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:49:11,235 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:49:11,235 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:49:11,235 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:49:11,236 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:49:11,236 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:49:11,236 - backend.database_builder - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:49:11,236 - backend.database_builder - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:49:11,236 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:49:11,237 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:49:11,237 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:49:11,237 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:49:11,237 - backend.database_builder - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:49:11,238 - backend.database_builder - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:49:11,238 - backend.database_builder - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:49:11,241 - backend.database_builder - INFO - Inserted 309 records into table 网络设备故障表
2025-10-19 15:49:11,259 - backend.database_builder - INFO - Database built/updated at test_network_device_failure.db (rebuild=True, status=0)
2025-10-19 15:49:11,438 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f497f6e2ccce3b6eee3b6f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 502.4411999620497, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 15:51:25,893 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 15:51:25,893 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 15:51:25,893 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 15:51:25,894 - data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 15:51:25,894 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 15:51:25,894 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x000001DCEEE78C20>
2025-10-19 15:51:25,895 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 15:51:26,086 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4987e24557849103c5ded"}}
2025-10-19 15:51:26,086 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4987e24557849103c5ded"}, "previousDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:51:26,087 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,087 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:51:26,089 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}}
2025-10-19 15:51:26,089 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "remainingTimeMS": 4999}
2025-10-19 15:51:26,113 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4987e24557849103c5ded"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:51:26,125 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4987e24557849103c5ded"}, "driverConnectionId": 1, "serverConnectionId": 46467, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.9966000309214, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:51:25.953Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46467, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:51:26,126 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,126 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4987e24557849103c5ded"}, "previousDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>"}
2025-10-19 15:51:26,127 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,128 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4987e24557849103c5ded"}, "driverConnectionId": 1, "serverConnectionId": 46467, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:51:26,128 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,129 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,183 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04444959998363629}
2025-10-19 15:51:26,184 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05638690001796931}
2025-10-19 15:51:26,185 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"mKnIbtSqQH6wC9K8bWQzuA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,195 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "durationMS": 9.865, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,195 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,196 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:51:26,196 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:51:26.196352
2025-10-19 15:51:26,196 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}}
2025-10-19 15:51:26,197 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,197 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,198 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004050999996252358}
2025-10-19 15:51:26,198 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:51:26.196Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"mKnIbtSqQH6wC9K8bWQzuA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,220 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "durationMS": 21.816, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,221 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,221 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}}
2025-10-19 15:51:26,222 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,223 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,223 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00038330000825226307}
2025-10-19 15:51:26,224 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:51:26.196Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"mKnIbtSqQH6wC9K8bWQzuA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,300 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "durationMS": 76.57, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,303 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,303 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001DCEF123B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}}
2025-10-19 15:51:26,304 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001DCEF123B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5ded, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0109966000309214>]>", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,304 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,305 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00031809997744858265}
2025-10-19 15:51:26,305 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "command": "{\"getMore\": 7853636417664429355, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"mKnIbtSqQH6wC9K8bWQzuA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,629 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "durationMS": 324.366, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46469, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,631 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5ded"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,632 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 15:51:26,657 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 15:51:26,660 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 15:51:26,661 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 15:51:26,661 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 15:51:26,662 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:51:26,664 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:51:26,665 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:51:26,665 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:51:26,666 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 15:51:26,667 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:51:26,668 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:51:26,668 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 15:51:26,669 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 15:51:26,670 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 15:51:26,670 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:51:26,671 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:51:26,671 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:51:26,672 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 15:51:26,672 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:51:26,672 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:51:26,673 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 15:51:26,724 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 15:51:26,724 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:51:26,724 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:51:26,725 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:51:26,725 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:51:26,725 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 15:51:26,726 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:51:26,726 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:51:26,726 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 15:51:26,726 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 15:51:26,727 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 15:51:26,727 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:51:26,727 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:51:26,728 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:51:26,728 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 15:51:26,728 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:51:26,729 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:51:26,729 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 15:51:26,744 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 15:51:26,744 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x000001DCEEE78D70>
2025-10-19 15:51:26,745 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 15:51:26,749 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4987e24557849103c5dee"}}
2025-10-19 15:51:26,749 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4987e24557849103c5dee"}, "previousDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:51:26,750 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,751 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:51:26,753 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}}
2025-10-19 15:51:26,754 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "remainingTimeMS": 4999}
2025-10-19 15:51:26,763 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4987e24557849103c5dee"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:51:26,809 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4987e24557849103c5dee"}, "driverConnectionId": 1, "serverConnectionId": 46470, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 45.151099970098585, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:51:26.604Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46470, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:51:26,811 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,812 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4987e24557849103c5dee"}, "previousDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>"}
2025-10-19 15:51:26,814 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,815 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4987e24557849103c5dee"}, "driverConnectionId": 1, "serverConnectionId": 46470, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:51:26,816 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,818 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,872 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.042082600004505366}
2025-10-19 15:51:26,873 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05685629998333752}
2025-10-19 15:51:26,874 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+uKS7OCcSOq8Q6nolOfTPw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,886 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "durationMS": 12.539, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,887 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,887 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 15:51:26,888 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:51:26.888182
2025-10-19 15:51:26,888 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}}
2025-10-19 15:51:26,889 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,889 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,890 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004123999970033765}
2025-10-19 15:51:26,890 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760860286}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+uKS7OCcSOq8Q6nolOfTPw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,902 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "durationMS": 11.901, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,902 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,903 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}}
2025-10-19 15:51:26,903 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,904 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,904 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00033220002660527825}
2025-10-19 15:51:26,905 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760860286}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+uKS7OCcSOq8Q6nolOfTPw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,972 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "durationMS": 67.665, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,974 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,974 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001DCEF123B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}}
2025-10-19 15:51:26,975 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001DCEF123B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4987e24557849103c5dee, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.045151099970098585>]>", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,976 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,976 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00041829998372122645}
2025-10-19 15:51:26,977 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "command": "{\"getMore\": 5492356217368787785, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+uKS7OCcSOq8Q6nolOfTPw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,989 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "durationMS": 12.014000000000001, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46471, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:26,990 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:26,991 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 15:51:26,991 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 15:51:26,992 - data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 15:51:26,992 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 15:51:26,993 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x000001DCEEE78EC0>
2025-10-19 15:51:26,993 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 15:51:26,997 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 15:51:27,232 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:27,305 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 15:51:27,305 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 15:51:27,438 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:27,493 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 15:51:27,493 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 15:51:27,619 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:27,662 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 15:51:27,662 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 15:51:27,753 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 15:51:27,776 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:27,811 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.04314969998085871}
2025-10-19 15:51:27,811 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 15:51:27,830 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 15:51:27,830 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 15:51:27,851 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.020953400002326816}
2025-10-19 15:51:27,852 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 15:51:27,888 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.024162399990018457}
2025-10-19 15:51:27,889 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 15:51:27,929 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4987e24557849103c5dee"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.029160300036892295}
2025-10-19 15:51:27,950 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:28,007 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 15:51:28,008 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 15:51:28,194 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:28,267 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 15:51:28,268 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 15:51:28,372 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:28,431 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 15:51:28,432 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 15:51:28,533 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:28,585 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 15:51:28,585 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 15:51:28,681 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:28,728 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 15:51:28,729 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 15:51:28,819 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:28,873 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 15:51:28,874 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 15:51:28,960 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:29,012 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 15:51:29,013 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 15:51:29,091 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:29,146 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 15:51:29,147 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 15:51:29,226 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:29,272 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 15:51:29,272 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 15:51:29,347 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:29,400 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 15:51:29,400 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 15:51:29,472 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:29,525 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 15:51:29,526 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 15:51:29,594 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:29,643 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 15:51:29,645 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 15:51:29,697 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 15:51:29,715 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 15:51:29,715 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 15:51:29,760 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 15:51:29,761 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 15:51:29,762 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 15:51:29,762 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 15:51:29,763 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 15:51:29,910 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 15:51:29,914 - data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 15:51:29,915 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 15:51:29,916 - __main__ - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-19 15:51:29,916 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:51:29,916 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 15:51:29,917 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 15:51:29,918 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 15:51:29,918 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:51:29,919 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 15:51:29,919 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 15:51:29,920 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:51:29,920 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:51:29,921 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 15:51:29,921 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 15:51:29,922 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 15:51:29,922 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 15:51:29,928 - __main__ - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-19 15:51:29,928 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:51:29,929 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 15:51:29,929 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 15:51:29,929 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 15:51:29,929 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:51:29,930 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 15:51:29,930 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 15:51:29,930 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:51:29,931 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:51:29,931 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 15:51:29,931 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 15:51:29,931 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 15:51:29,932 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 15:51:30,094 - __main__ - INFO - Inserted 16446 records into table 网络设备总数量表
2025-10-19 15:51:30,095 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000001DCEEE79010>
2025-10-19 15:51:30,095 - data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 15:51:30,098 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4988224557849103c5def"}}
2025-10-19 15:51:30,099 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4988224557849103c5def"}, "previousDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 15:51:30,099 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,100 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 15:51:30,102 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4988224557849103c5def"}}
2025-10-19 15:51:30,103 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4988224557849103c5def"}, "remainingTimeMS": 4999}
2025-10-19 15:51:30,112 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4988224557849103c5def"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 15:51:30,125 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4988224557849103c5def"}, "driverConnectionId": 1, "serverConnectionId": 46477, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.893499991856515, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T07:51:29.953Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46477, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 15:51:30,125 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,126 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4988224557849103c5def"}, "previousDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>"}
2025-10-19 15:51:30,126 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,127 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4988224557849103c5def"}, "driverConnectionId": 1, "serverConnectionId": 46477, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 15:51:30,128 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,129 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:30,197 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.042180700052995235}
2025-10-19 15:51:30,198 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06998149998253211}
2025-10-19 15:51:30,198 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4988224557849103c5def"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NY/fkQU0Sj+zm0BN/3g6EA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,210 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4988224557849103c5def"}, "durationMS": 12.0, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,211 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:30,211 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 15:51:30,212 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 15:51:30.212365
2025-10-19 15:51:30,212 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>", "clientId": {"$oid": "68f4988224557849103c5def"}}
2025-10-19 15:51:30,213 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,213 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,214 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004542000242508948}
2025-10-19 15:51:30,214 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4988224557849103c5def"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:51:30.212Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NY/fkQU0Sj+zm0BN/3g6EA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,237 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4988224557849103c5def"}, "durationMS": 22.122, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,237 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:30,238 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>", "clientId": {"$oid": "68f4988224557849103c5def"}}
2025-10-19 15:51:30,238 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,239 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,239 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004471999709494412}
2025-10-19 15:51:30,240 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4988224557849103c5def"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T15:51:30.212Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NY/fkQU0Sj+zm0BN/3g6EA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,310 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4988224557849103c5def"}, "durationMS": 69.867, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,311 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:30,311 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001DCEF123B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>", "clientId": {"$oid": "68f4988224557849103c5def"}}
2025-10-19 15:51:30,312 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001DCEF123B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4988224557849103c5def, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011893499991856515>]>", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,313 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,313 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00035099999513477087}
2025-10-19 15:51:30,313 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4988224557849103c5def"}, "command": "{\"getMore\": 866020312080429864, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NY/fkQU0Sj+zm0BN/3g6EA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,373 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4988224557849103c5def"}, "durationMS": 59.706, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 46479, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 15:51:30,374 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 15:51:30,375 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-19 15:51:30,375 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 15:51:30,380 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-19 15:51:30,382 - data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-19 15:51:30,382 - data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 15:51:30,386 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 15:51:30,386 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:51:30,387 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:51:30,387 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:51:30,388 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:51:30,388 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:51:30,389 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:51:30,389 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:51:30,390 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:51:30,390 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:51:30,391 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:51:30,391 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:51:30,392 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:51:30,392 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:51:30,392 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:51:30,393 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:51:30,393 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:51:30,394 - __main__ - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 15:51:30,394 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 15:51:30,395 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 15:51:30,395 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 15:51:30,395 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 15:51:30,395 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 15:51:30,396 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 15:51:30,396 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 15:51:30,396 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 15:51:30,396 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 15:51:30,397 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 15:51:30,397 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 15:51:30,397 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 15:51:30,398 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 15:51:30,398 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 15:51:30,398 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 15:51:30,399 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 15:51:30,406 - __main__ - INFO - Inserted 309 records into table 网络设备故障表
2025-10-19 15:51:30,443 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 15:51:30,634 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f4988224557849103c5def"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 506.6470999736339, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 22:43:22,542 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 22:43:22,564 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 22:43:22,564 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 22:43:22,564 - data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 22:43:22,564 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 22:43:22,565 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000016F6620CC20>
2025-10-19 22:43:22,565 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 22:43:22,768 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4f90a903c3fde4444fc2a"}}
2025-10-19 22:43:22,768 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4f90a903c3fde4444fc2a"}, "previousDescription": "<TopologyDescription id: 68f4f90a903c3fde4444fc2a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4f90a903c3fde4444fc2a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 22:43:22,768 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4f90a903c3fde4444fc2a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:43:22,769 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4f90a903c3fde4444fc2a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 22:43:22,770 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f90a903c3fde4444fc2a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f90a903c3fde4444fc2a"}}
2025-10-19 22:43:22,771 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f90a903c3fde4444fc2a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f90a903c3fde4444fc2a"}, "remainingTimeMS": 4999}
2025-10-19 22:43:27,873 - pymongo.serverSelection - DEBUG - {"message": "Server selection failed", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f90a903c3fde4444fc2a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f90a903c3fde4444fc2a"}, "failure": "\"No servers found yet\""}
2025-10-19 22:43:27,875 - backend.dataSources.mongodb_connector - ERROR - MongoDB连接失败: No servers found yet, Timeout: 5.0s, Topology Description: <TopologyDescription id: 68f4f90a903c3fde4444fc2a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>
2025-10-19 22:43:27,876 - backend.dataSources.optical_failure - ERROR - 事件监控数据库连接失败
2025-10-19 22:43:27,877 - data_loader - WARNING - No optical failure data retrieved (status=1)
2025-10-19 22:43:27,878 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 22:43:27,879 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000016F6620CD70>
2025-10-19 22:43:27,880 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 22:43:27,891 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}}
2025-10-19 22:43:27,892 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "previousDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 22:43:27,893 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:43:27,894 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 22:43:27,896 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}}
2025-10-19 22:43:27,897 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "remainingTimeMS": 4999}
2025-10-19 22:43:32,978 - pymongo.serverSelection - DEBUG - {"message": "Server selection failed", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "failure": "\"No servers found yet\""}
2025-10-19 22:43:32,980 - backend.dataSources.mongodb_connector - ERROR - MongoDB连接失败: No servers found yet, Timeout: 5.0s, Topology Description: <TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>
2025-10-19 22:43:32,981 - backend.dataSources.roce_event - ERROR - ROCE事件数据库连接失败
2025-10-19 22:43:32,982 - data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 22:43:32,983 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 22:43:32,984 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x0000016F6620CEC0>
2025-10-19 22:43:32,984 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 22:43:33,000 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 22:43:47,898 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 20002.371300011873, "failure": "\"NetworkTimeout('10.69.74.235:8526: timed out (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-10-19 22:43:47,898 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "previousDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None, error=NetworkTimeout('10.69.74.235:8526: timed out (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-10-19 22:43:54,045 - backend.dataSources.network_device_inventory - WARNING - 请求异常（第 1 次）: ConnectTimeout(MaxRetryError("HTTPConnectionPool(host='10.69.77.238', port=80): Max retries exceeded with url: /open-apis/netware/get-device-info (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000016F668EA270>, 'Connection to 10.69.77.238 timed out. (connect timeout=30)'))"))
2025-10-19 22:43:55,093 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (2): 10.69.77.238:80
2025-10-19 22:44:08,402 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 20002.773299987894, "failure": "\"NetworkTimeout('10.69.74.235:8526: timed out (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-10-19 22:44:08,403 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "previousDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None, error=NetworkTimeout('10.69.74.235:8526: timed out (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None, error=NetworkTimeout('10.69.74.235:8526: timed out (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-10-19 22:44:16,132 - backend.dataSources.network_device_inventory - WARNING - 请求异常（第 2 次）: ConnectTimeout(MaxRetryError("HTTPConnectionPool(host='10.69.77.238', port=80): Max retries exceeded with url: /open-apis/netware/get-device-info (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000016F66985810>, 'Connection to 10.69.77.238 timed out. (connect timeout=30)'))"))
2025-10-19 22:44:18,208 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (3): 10.69.77.238:80
2025-10-19 22:44:18,438 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "driverConnectionId": 3, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 22:44:18,456 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "driverConnectionId": 3, "serverConnectionId": 46655, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.560899966862053, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T14:44:18.773Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46655, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 22:44:18,457 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:18,458 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "previousDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None, error=NetworkTimeout('10.69.74.235:8526: timed out (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 68f4f90f903c3fde4444fc2b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016560899966862053>]>"}
2025-10-19 22:44:18,459 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "driverConnectionId": 3, "serverConnectionId": 46655, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 22:44:18,482 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:18,542 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 22:44:18,542 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 22:44:18,696 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:18,731 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 22:44:18,732 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 22:44:18,895 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:18,928 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 22:44:18,929 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 22:44:18,960 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:44:19,034 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.062506599992048}
2025-10-19 22:44:19,034 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 22:44:19,052 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:19,085 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 22:44:19,085 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.027758800017181784}
2025-10-19 22:44:19,085 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 22:44:19,086 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 22:44:19,141 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.02197240001987666}
2025-10-19 22:44:19,142 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 22:44:19,187 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.01997359999222681}
2025-10-19 22:44:19,187 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 22:44:19,212 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:19,247 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 22:44:19,247 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4f90f903c3fde4444fc2b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.03364450001390651}
2025-10-19 22:44:19,247 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 22:44:19,362 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:19,406 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 22:44:19,406 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 22:44:19,520 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:19,551 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 22:44:19,551 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 22:44:19,656 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:19,694 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 22:44:19,694 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 22:44:19,790 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:19,823 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 22:44:19,823 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 22:44:19,913 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:19,957 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 22:44:19,958 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 22:44:20,051 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:20,085 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 22:44:20,085 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 22:44:20,178 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:20,211 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 22:44:20,212 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 22:44:20,286 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:20,321 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 22:44:20,321 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 22:44:20,393 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:20,452 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 22:44:20,452 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 22:44:20,531 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:20,577 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 22:44:20,577 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 22:44:20,641 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:20,668 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 22:44:20,668 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 22:44:20,725 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:44:20,737 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 22:44:20,738 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 22:44:20,800 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 22:44:20,801 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 22:44:20,801 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 22:44:20,802 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 22:44:20,802 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 22:44:20,920 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 22:44:20,924 - data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 22:44:20,924 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 22:44:20,924 - __main__ - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-19 22:44:20,925 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:44:20,927 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 22:44:20,927 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 22:44:20,927 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 22:44:20,928 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:44:20,928 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 22:44:20,928 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 22:44:20,928 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:44:20,929 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:44:20,929 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 22:44:20,929 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 22:44:20,929 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 22:44:20,929 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 22:44:21,009 - __main__ - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-19 22:44:21,009 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:44:21,010 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 22:44:21,010 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 22:44:21,010 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 22:44:21,010 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:44:21,010 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 22:44:21,011 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 22:44:21,011 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:44:21,012 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:44:21,012 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 22:44:21,012 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 22:44:21,012 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 22:44:21,012 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 22:44:21,102 - __main__ - INFO - Inserted 16446 records into table 网络设备总数量表
2025-10-19 22:44:21,103 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x0000016F6620D010>
2025-10-19 22:44:21,103 - data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 22:44:21,106 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}}
2025-10-19 22:44:21,107 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}, "previousDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 22:44:21,107 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,108 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 22:44:21,109 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}}
2025-10-19 22:44:21,109 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "remainingTimeMS": 4999}
2025-10-19 22:44:21,122 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 22:44:21,135 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}, "driverConnectionId": 1, "serverConnectionId": 46662, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.246500002220273, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T14:44:21.453Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46662, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 22:44:21,136 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,136 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}, "previousDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>"}
2025-10-19 22:44:21,137 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,137 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}, "driverConnectionId": 1, "serverConnectionId": 46662, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 22:44:21,137 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,138 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:44:21,191 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.040857599989976734}
2025-10-19 22:44:21,191 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.053795000014360994}
2025-10-19 22:44:21,192 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"P02pFUNCSJWvQrlDsjDVBQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,207 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "durationMS": 15.144, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,208 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:44:21,208 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 22:44:21,209 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 22:44:21.209068
2025-10-19 22:44:21,209 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}}
2025-10-19 22:44:21,210 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,210 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,211 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004566999850794673}
2025-10-19 22:44:21,211 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T22:44:21.209Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"P02pFUNCSJWvQrlDsjDVBQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,235 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "durationMS": 23.956000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,236 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:44:21,237 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}}
2025-10-19 22:44:21,237 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,237 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,238 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003212000010535121}
2025-10-19 22:44:21,238 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T22:44:21.209Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"P02pFUNCSJWvQrlDsjDVBQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,313 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "durationMS": 74.851, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,319 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:44:21,320 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016F664B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}}
2025-10-19 22:44:21,321 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016F664B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4f945903c3fde4444fc2c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012246500002220273>]>", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,321 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,322 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004749000072479248}
2025-10-19 22:44:21,322 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "command": "{\"getMore\": 6863768772626342451, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"P02pFUNCSJWvQrlDsjDVBQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,422 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "durationMS": 99.726, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46663, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:44:21,423 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:44:21,423 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-19 22:44:21,424 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 22:44:21,427 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-19 22:44:21,428 - data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-19 22:44:21,428 - data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 22:44:21,431 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 22:44:21,432 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 22:44:21,432 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 22:44:21,432 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 22:44:21,433 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:44:21,433 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:44:21,433 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:44:21,434 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:44:21,434 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 22:44:21,435 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 22:44:21,435 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 22:44:21,435 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 22:44:21,436 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 22:44:21,436 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 22:44:21,436 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 22:44:21,437 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 22:44:21,437 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 22:44:21,441 - __main__ - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 22:44:21,441 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 22:44:21,441 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 22:44:21,442 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 22:44:21,442 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:44:21,442 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:44:21,443 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:44:21,443 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:44:21,443 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 22:44:21,443 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 22:44:21,444 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 22:44:21,444 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 22:44:21,444 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 22:44:21,444 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 22:44:21,445 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 22:44:21,445 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 22:44:21,445 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 22:44:21,450 - __main__ - INFO - Inserted 309 records into table 网络设备故障表
2025-10-19 22:44:21,469 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 22:44:21,646 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f4f945903c3fde4444fc2c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 509.366600017529, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 22:55:25,190 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 22:55:25,190 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 22:55:25,191 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 22:55:25,191 - data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 22:55:25,191 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 22:55:25,196 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x000002057F708C20>
2025-10-19 22:55:25,196 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 22:55:25,401 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4fbdd4149693448c64ce9"}}
2025-10-19 22:55:25,402 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4fbdd4149693448c64ce9"}, "previousDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 22:55:25,402 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,403 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 22:55:25,404 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}}
2025-10-19 22:55:25,404 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "remainingTimeMS": 4999}
2025-10-19 22:55:25,430 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4fbdd4149693448c64ce9"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 22:55:25,443 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4fbdd4149693448c64ce9"}, "driverConnectionId": 1, "serverConnectionId": 46669, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.79199997568503, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T14:55:25.775Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46669, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 22:55:25,444 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,444 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4fbdd4149693448c64ce9"}, "previousDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>"}
2025-10-19 22:55:25,445 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,445 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4fbdd4149693448c64ce9"}, "driverConnectionId": 1, "serverConnectionId": 46669, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 22:55:25,446 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,446 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:25,518 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04120630002580583}
2025-10-19 22:55:25,518 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07271779997972772}
2025-10-19 22:55:25,519 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"0aTOdDSCQF6KfDRtLu1AoQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,530 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "durationMS": 10.995, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,530 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:25,531 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 22:55:25,531 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 22:55:25.531650
2025-10-19 22:55:25,532 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}}
2025-10-19 22:55:25,532 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,532 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,533 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000270900025498122}
2025-10-19 22:55:25,533 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T22:55:25.531Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"0aTOdDSCQF6KfDRtLu1AoQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,553 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "durationMS": 19.446, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,553 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:25,554 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}}
2025-10-19 22:55:25,554 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,554 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,555 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00028819998260587454}
2025-10-19 22:55:25,555 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T22:55:25.531Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"0aTOdDSCQF6KfDRtLu1AoQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,635 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "durationMS": 80.36, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,637 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:25,638 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002057F9B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}}
2025-10-19 22:55:25,638 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002057F9B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4fbdd4149693448c64ce9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01179199997568503>]>", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,638 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:25,639 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00029960001120343804}
2025-10-19 22:55:25,639 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "command": "{\"getMore\": 3056882479517872135, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"0aTOdDSCQF6KfDRtLu1AoQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,078 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "durationMS": 438.96000000000004, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46671, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,079 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbdd4149693448c64ce9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:26,081 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 22:55:26,098 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 22:55:26,102 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 22:55:26,102 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 22:55:26,103 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 22:55:26,103 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 22:55:26,107 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 22:55:26,107 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 22:55:26,109 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 22:55:26,109 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 22:55:26,109 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 22:55:26,110 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:55:26,110 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 22:55:26,111 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 22:55:26,111 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 22:55:26,112 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:55:26,112 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:55:26,112 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:55:26,113 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 22:55:26,113 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 22:55:26,113 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 22:55:26,114 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 22:55:26,161 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 22:55:26,161 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 22:55:26,162 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 22:55:26,162 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 22:55:26,162 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 22:55:26,162 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 22:55:26,162 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 22:55:26,163 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:55:26,163 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 22:55:26,163 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 22:55:26,163 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 22:55:26,164 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:55:26,164 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:55:26,164 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:55:26,164 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 22:55:26,165 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 22:55:26,165 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 22:55:26,165 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 22:55:26,177 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 22:55:26,178 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x000002057F708D70>
2025-10-19 22:55:26,178 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 22:55:26,180 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4fbde4149693448c64cea"}}
2025-10-19 22:55:26,181 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4fbde4149693448c64cea"}, "previousDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 22:55:26,181 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,182 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 22:55:26,184 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}}
2025-10-19 22:55:26,185 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "remainingTimeMS": 4999}
2025-10-19 22:55:26,194 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4fbde4149693448c64cea"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 22:55:26,205 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4fbde4149693448c64cea"}, "driverConnectionId": 1, "serverConnectionId": 46672, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.741200007032603, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T14:55:26.537Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46672, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 22:55:26,206 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,206 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4fbde4149693448c64cea"}, "previousDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>"}
2025-10-19 22:55:26,207 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,207 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,207 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4fbde4149693448c64cea"}, "driverConnectionId": 1, "serverConnectionId": 46672, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 22:55:26,207 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:26,255 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.036588800023309886}
2025-10-19 22:55:26,255 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04800140002043918}
2025-10-19 22:55:26,255 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3vJvMswlTXmQy94YsL1QxQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,265 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "durationMS": 9.41, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,265 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:26,266 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 22:55:26,266 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 22:55:26.266361
2025-10-19 22:55:26,266 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}}
2025-10-19 22:55:26,267 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,267 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,267 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002536999527364969}
2025-10-19 22:55:26,268 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760885726}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3vJvMswlTXmQy94YsL1QxQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,278 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "durationMS": 9.976, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,278 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:26,278 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}}
2025-10-19 22:55:26,279 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,279 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,280 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00047850003466010094}
2025-10-19 22:55:26,282 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760885726}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3vJvMswlTXmQy94YsL1QxQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,356 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "durationMS": 74.08, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,357 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:26,357 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002057F9B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}}
2025-10-19 22:55:26,357 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002057F9B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4fbde4149693448c64cea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010741200007032603>]>", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,358 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,358 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022310001077130437}
2025-10-19 22:55:26,358 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "command": "{\"getMore\": 8835044095725747814, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3vJvMswlTXmQy94YsL1QxQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,372 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "durationMS": 13.551, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46673, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:26,372 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:26,373 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 22:55:26,373 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 22:55:26,373 - data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 22:55:26,374 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 22:55:26,374 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x000002057F708EC0>
2025-10-19 22:55:26,374 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 22:55:26,375 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 22:55:26,558 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:26,680 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 22:55:26,681 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 22:55:26,808 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:26,866 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 22:55:26,867 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 22:55:27,000 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:27,055 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 22:55:27,056 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 22:55:27,173 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:27,185 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 22:55:27,220 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 22:55:27,220 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 22:55:27,242 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02023279998684302}
2025-10-19 22:55:27,243 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 22:55:27,290 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.021638400037772954}
2025-10-19 22:55:27,290 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 22:55:27,323 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.020534600014798343}
2025-10-19 22:55:27,323 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 22:55:27,326 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:27,370 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 22:55:27,370 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 22:55:27,387 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4fbde4149693448c64cea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.027099600003566593}
2025-10-19 22:55:27,472 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:27,512 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 22:55:27,512 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 22:55:27,612 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:27,653 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 22:55:27,653 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 22:55:27,749 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:27,787 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 22:55:27,787 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 22:55:27,877 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:27,916 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 22:55:27,916 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 22:55:28,005 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,045 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 22:55:28,046 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 22:55:28,128 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,176 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 22:55:28,176 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 22:55:28,256 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,288 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 22:55:28,288 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 22:55:28,366 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,400 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 22:55:28,400 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 22:55:28,471 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,509 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 22:55:28,509 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 22:55:28,576 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,610 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 22:55:28,610 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 22:55:28,668 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,713 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 22:55:28,714 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 22:55:28,765 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 22:55:28,783 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 22:55:28,783 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 22:55:28,827 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 22:55:28,829 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 22:55:28,830 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 22:55:28,831 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 22:55:28,832 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 22:55:28,978 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 22:55:28,982 - data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 22:55:28,982 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 22:55:28,983 - __main__ - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-19 22:55:28,983 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:55:28,983 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 22:55:28,984 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 22:55:28,984 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 22:55:28,984 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:55:28,985 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 22:55:28,985 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 22:55:28,985 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:55:28,986 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:55:28,986 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 22:55:28,986 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 22:55:28,986 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 22:55:28,987 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 22:55:28,989 - __main__ - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-19 22:55:28,989 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:55:28,989 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 22:55:28,990 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 22:55:28,990 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 22:55:28,990 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:55:28,990 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 22:55:28,990 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 22:55:28,990 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:55:28,991 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:55:28,991 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 22:55:28,991 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 22:55:28,991 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 22:55:28,991 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 22:55:29,092 - __main__ - INFO - Inserted 16446 records into table 网络设备总数量表
2025-10-19 22:55:29,092 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000002057F709010>
2025-10-19 22:55:29,092 - data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 22:55:29,094 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}}
2025-10-19 22:55:29,094 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}, "previousDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 22:55:29,095 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,095 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 22:55:29,097 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}}
2025-10-19 22:55:29,097 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "remainingTimeMS": 4999}
2025-10-19 22:55:29,106 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 22:55:29,124 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}, "driverConnectionId": 1, "serverConnectionId": 46679, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 18.08889996027574, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T14:55:29.454Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46679, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 22:55:29,125 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,125 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}, "previousDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>"}
2025-10-19 22:55:29,126 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,126 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}, "driverConnectionId": 1, "serverConnectionId": 46679, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 22:55:29,126 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,127 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:29,177 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.039804200001526624}
2025-10-19 22:55:29,178 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.051729600003454834}
2025-10-19 22:55:29,179 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Z7fZcZ0EQGunbCnC9BD6Sw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,189 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "durationMS": 10.167, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,189 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:29,190 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 22:55:29,190 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 22:55:29.190488
2025-10-19 22:55:29,190 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}}
2025-10-19 22:55:29,191 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,191 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,191 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002874999772757292}
2025-10-19 22:55:29,192 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T22:55:29.190Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Z7fZcZ0EQGunbCnC9BD6Sw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,215 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "durationMS": 22.953999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,216 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:29,216 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}}
2025-10-19 22:55:29,217 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,217 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,218 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003391000209376216}
2025-10-19 22:55:29,218 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T22:55:29.190Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Z7fZcZ0EQGunbCnC9BD6Sw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,279 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "durationMS": 60.73, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,280 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:29,280 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002057F9B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}}
2025-10-19 22:55:29,280 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002057F9B3B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f4fbe14149693448c64ceb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01808889996027574>]>", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,281 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,281 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00020209996728226542}
2025-10-19 22:55:29,281 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "command": "{\"getMore\": 5159983666933313877, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Z7fZcZ0EQGunbCnC9BD6Sw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,340 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "durationMS": 58.944, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 46681, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 22:55:29,341 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 22:55:29,342 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-19 22:55:29,342 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 22:55:29,346 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-19 22:55:29,347 - data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-19 22:55:29,347 - data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 22:55:29,352 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 22:55:29,352 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 22:55:29,352 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 22:55:29,353 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 22:55:29,353 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:55:29,354 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:55:29,354 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:55:29,354 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:55:29,355 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 22:55:29,355 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 22:55:29,355 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 22:55:29,356 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 22:55:29,356 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 22:55:29,356 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 22:55:29,357 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 22:55:29,357 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 22:55:29,357 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 22:55:29,358 - __main__ - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 22:55:29,359 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 22:55:29,359 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 22:55:29,359 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 22:55:29,359 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 22:55:29,359 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 22:55:29,360 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 22:55:29,360 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 22:55:29,360 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 22:55:29,360 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 22:55:29,360 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 22:55:29,360 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 22:55:29,361 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 22:55:29,361 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 22:55:29,361 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 22:55:29,361 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 22:55:29,362 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 22:55:29,368 - __main__ - INFO - Inserted 309 records into table 网络设备故障表
2025-10-19 22:55:29,416 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 22:55:29,632 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f4fbe14149693448c64ceb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 506.2518999911845, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 23:38:20,950 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 23:38:20,951 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 23:38:21,114 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f505eda494d588d715dbbb"}}
2025-10-19 23:38:21,115 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f505eda494d588d715dbbb"}, "previousDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 23:38:21,115 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,115 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 23:38:21,117 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}}
2025-10-19 23:38:21,117 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "remainingTimeMS": 4999}
2025-10-19 23:38:21,152 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f505eda494d588d715dbbb"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 23:38:21,163 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f505eda494d588d715dbbb"}, "driverConnectionId": 1, "serverConnectionId": 46697, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.432599985506386, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T15:38:21.524Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46697, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 23:38:21,165 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,166 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f505eda494d588d715dbbb"}, "previousDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>"}
2025-10-19 23:38:21,167 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,168 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f505eda494d588d715dbbb"}, "driverConnectionId": 1, "serverConnectionId": 46697, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 23:38:21,168 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,170 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,242 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04418550000991672}
2025-10-19 23:38:21,243 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07434519997332245}
2025-10-19 23:38:21,243 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"2K7KLKb9TLCJryPvVpM1CA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,254 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "durationMS": 11.234, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,255 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,255 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 23:38:21,255 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 23:38:21.255530
2025-10-19 23:38:21,255 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}}
2025-10-19 23:38:21,256 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,256 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,256 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022710004122927785}
2025-10-19 23:38:21,257 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888301}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"2K7KLKb9TLCJryPvVpM1CA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,280 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "durationMS": 23.461, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,281 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,281 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}}
2025-10-19 23:38:21,282 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,282 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,282 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00023370003327727318}
2025-10-19 23:38:21,282 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888301}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"2K7KLKb9TLCJryPvVpM1CA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,353 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "durationMS": 70.273, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,355 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,356 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000261E50F31A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}}
2025-10-19 23:38:21,356 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000261E50F31A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010432599985506386>]>", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,357 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,357 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00034820003202185035}
2025-10-19 23:38:21,357 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "command": "{\"getMore\": 529546498866943917, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"2K7KLKb9TLCJryPvVpM1CA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,368 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "durationMS": 10.985999999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46699, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,369 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,370 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 23:38:21,370 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 23:38:21,371 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 23:38:21,371 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 23:38:21,371 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 23:38:21,372 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 23:38:21,373 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x00000261E54F3110>
2025-10-19 23:38:21,373 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 23:38:21,374 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}}
2025-10-19 23:38:21,375 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}, "previousDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 23:38:21,375 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,376 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 23:38:21,377 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}}
2025-10-19 23:38:21,378 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "remainingTimeMS": 4999}
2025-10-19 23:38:21,387 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 23:38:21,400 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}, "driverConnectionId": 1, "serverConnectionId": 46700, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.577200017403811, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T15:38:21.759Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46700, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 23:38:21,401 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,401 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}, "previousDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>"}
2025-10-19 23:38:21,402 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,402 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,402 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}, "driverConnectionId": 1, "serverConnectionId": 46700, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 23:38:21,402 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,462 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03366970003116876}
2025-10-19 23:38:21,463 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.060719600005541}
2025-10-19 23:38:21,463 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gfbpvmOzTCOBdRNtpak2+A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,475 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "durationMS": 12.245000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,477 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,478 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 23:38:21,478 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 23:38:21.478842
2025-10-19 23:38:21,479 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}}
2025-10-19 23:38:21,480 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,481 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,482 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009342000121250749}
2025-10-19 23:38:21,483 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888301}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gfbpvmOzTCOBdRNtpak2+A==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,496 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "durationMS": 12.755, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,497 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,497 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}}
2025-10-19 23:38:21,497 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,497 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,498 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00023579999106004834}
2025-10-19 23:38:21,498 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888301}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gfbpvmOzTCOBdRNtpak2+A==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,563 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "durationMS": 65.288, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,564 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,564 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000261E50F31A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}}
2025-10-19 23:38:21,565 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000261E50F31A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f505eda494d588d715dbbc, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012577200017403811>]>", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,565 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,565 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00020619999850168824}
2025-10-19 23:38:21,565 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "command": "{\"getMore\": 7095267130698086080, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gfbpvmOzTCOBdRNtpak2+A==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,578 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "durationMS": 12.541, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46702, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:38:21,579 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:38:21,579 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 23:38:21,579 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 23:38:21,580 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 23:38:21,580 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 23:38:21,580 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 23:38:21,913 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f505eda494d588d715dbbc"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 510.75989997480065, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 23:40:43,968 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 23:40:43,969 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 23:40:44,225 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ad"}}
2025-10-19 23:40:44,225 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "previousDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 23:40:44,225 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,226 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 23:40:44,227 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}}
2025-10-19 23:40:44,228 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "remainingTimeMS": 4999}
2025-10-19 23:40:44,238 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 23:40:44,251 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "driverConnectionId": 1, "serverConnectionId": 46705, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.64550002431497, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T15:40:44.616Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46705, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 23:40:44,251 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,251 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "previousDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>"}
2025-10-19 23:40:44,252 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,252 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "driverConnectionId": 1, "serverConnectionId": 46705, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 23:40:44,253 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,253 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,302 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03730859997449443}
2025-10-19 23:40:44,302 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04945920000318438}
2025-10-19 23:40:44,303 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PlMhfGQuQASpubISKA8pxg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,317 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "durationMS": 14.946, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,318 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,318 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 23:40:44,319 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 23:40:44.318987
2025-10-19 23:40:44,319 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}}
2025-10-19 23:40:44,319 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,319 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,320 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002579999854788184}
2025-10-19 23:40:44,320 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888444}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PlMhfGQuQASpubISKA8pxg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,335 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "durationMS": 14.624, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,335 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,336 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}}
2025-10-19 23:40:44,336 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,336 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,337 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00026810000417754054}
2025-10-19 23:40:44,337 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888444}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PlMhfGQuQASpubISKA8pxg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,519 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "durationMS": 181.792, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,520 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,521 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000293C28031A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}}
2025-10-19 23:40:44,522 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000293C28031A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ad, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01164550002431497>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,522 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,522 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00029630004428327084}
2025-10-19 23:40:44,523 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "command": "{\"getMore\": 3140087534046198150, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"PlMhfGQuQASpubISKA8pxg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,536 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "durationMS": 13.048, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46707, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,537 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ad"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,537 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 23:40:44,539 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-19 23:40:44,540 - backend.data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-19 23:40:44,540 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 23:40:44,545 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 23:40:44,545 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 23:40:44,546 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x00000293C2C03390>
2025-10-19 23:40:44,547 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 23:40:44,549 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}}
2025-10-19 23:40:44,550 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "previousDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 23:40:44,551 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,552 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 23:40:44,553 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}}
2025-10-19 23:40:44,553 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "remainingTimeMS": 4999}
2025-10-19 23:40:44,562 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 23:40:44,573 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "driverConnectionId": 1, "serverConnectionId": 46708, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.673100012354553, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T15:40:44.939Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46708, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 23:40:44,574 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,574 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "previousDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>"}
2025-10-19 23:40:44,575 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,576 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "driverConnectionId": 1, "serverConnectionId": 46708, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 23:40:44,576 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,578 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,636 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04678650002460927}
2025-10-19 23:40:44,636 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06008749996544793}
2025-10-19 23:40:44,637 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"DUILdUbdQyikh6TTpB7uyg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,649 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "durationMS": 12.253, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,650 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,651 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 23:40:44,651 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 23:40:44.651343
2025-10-19 23:40:44,651 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}}
2025-10-19 23:40:44,652 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,652 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,652 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00025859999004751444}
2025-10-19 23:40:44,653 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888444}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"DUILdUbdQyikh6TTpB7uyg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,665 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "durationMS": 12.097999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,665 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,667 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}}
2025-10-19 23:40:44,668 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,668 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,668 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00034389999927952886}
2025-10-19 23:40:44,669 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888444}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"DUILdUbdQyikh6TTpB7uyg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,751 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "durationMS": 82.03, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,752 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,752 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000293C28031A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}}
2025-10-19 23:40:44,752 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000293C28031A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f5067c0d37a5b6430ea0ae, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010673100012354553>]>", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,753 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,753 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002440999960526824}
2025-10-19 23:40:44,753 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "command": "{\"getMore\": 1726664030565002184, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"DUILdUbdQyikh6TTpB7uyg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,763 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "durationMS": 9.994, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46710, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:40:44,764 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:40:44,764 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 23:40:44,765 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-19 23:40:44,765 - backend.data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-19 23:40:44,766 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 23:40:44,766 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 23:40:44,766 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:40:44,768 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:40:44,769 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 23:40:44,769 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 23:40:44,769 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 23:40:44,770 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:40:44,770 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 23:40:44,770 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 23:40:44,770 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 23:40:44,771 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 23:40:44,771 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:40:44,772 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 23:40:44,772 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 23:40:44,772 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 23:40:44,772 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 23:40:44,797 - backend.database_builder - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 23:40:44,797 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:40:44,798 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:40:44,798 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 23:40:44,798 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 23:40:44,798 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 23:40:44,799 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:40:44,799 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 23:40:44,799 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 23:40:44,799 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 23:40:44,800 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 23:40:44,800 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:40:44,800 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 23:40:44,800 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 23:40:44,800 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 23:40:44,801 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 23:40:44,803 - backend.database_builder - INFO - Inserted 106 records into table ROCE网络事件-光模块故障表
2025-10-19 23:40:44,818 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 23:40:45,088 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f5067c0d37a5b6430ea0ae"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 511.9020999991335, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 23:44:37,564 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 23:44:37,565 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 23:44:37,565 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-19 23:44:37,565 - data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-19 23:44:37,565 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 23:44:37,566 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000023C0E3ECC20>
2025-10-19 23:44:37,567 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 23:44:37,834 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f50765848593155468ad97"}}
2025-10-19 23:44:37,835 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f50765848593155468ad97"}, "previousDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 23:44:37,835 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,836 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 23:44:37,837 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f50765848593155468ad97"}}
2025-10-19 23:44:37,838 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f50765848593155468ad97"}, "remainingTimeMS": 4999}
2025-10-19 23:44:37,858 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f50765848593155468ad97"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 23:44:37,868 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f50765848593155468ad97"}, "driverConnectionId": 1, "serverConnectionId": 46712, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.327299998607486, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T15:44:38.233Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46712, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 23:44:37,869 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,869 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f50765848593155468ad97"}, "previousDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>"}
2025-10-19 23:44:37,870 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,870 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f50765848593155468ad97"}, "driverConnectionId": 1, "serverConnectionId": 46712, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 23:44:37,871 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,871 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:37,944 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0397029000450857}
2025-10-19 23:44:37,944 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07375449995743111}
2025-10-19 23:44:37,945 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50765848593155468ad97"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NqEB9898SveQ/QfxfrZCyg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,956 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50765848593155468ad97"}, "durationMS": 11.742, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,957 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:37,957 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 23:44:37,957 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 23:44:37.957795
2025-10-19 23:44:37,958 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>", "clientId": {"$oid": "68f50765848593155468ad97"}}
2025-10-19 23:44:37,958 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,958 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,959 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022950000129640102}
2025-10-19 23:44:37,959 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50765848593155468ad97"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T23:44:37.957Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NqEB9898SveQ/QfxfrZCyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,980 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50765848593155468ad97"}, "durationMS": 21.073, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,980 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:37,981 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>", "clientId": {"$oid": "68f50765848593155468ad97"}}
2025-10-19 23:44:37,981 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,982 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:37,982 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00030069996137171984}
2025-10-19 23:44:37,983 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50765848593155468ad97"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T23:44:37.957Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NqEB9898SveQ/QfxfrZCyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,054 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50765848593155468ad97"}, "durationMS": 71.282, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,055 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:38,056 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000023C0E693B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>", "clientId": {"$oid": "68f50765848593155468ad97"}}
2025-10-19 23:44:38,056 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000023C0E693B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f50765848593155468ad97, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010327299998607486>]>", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,056 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,057 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00016789999790489674}
2025-10-19 23:44:38,057 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50765848593155468ad97"}, "command": "{\"getMore\": 2269756789227857827, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NqEB9898SveQ/QfxfrZCyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,523 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50765848593155468ad97"}, "durationMS": 465.863, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 46714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,523 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50765848593155468ad97"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:38,524 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 23:44:38,538 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 23:44:38,541 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 23:44:38,541 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 23:44:38,541 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 23:44:38,542 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:44:38,544 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 23:44:38,544 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:44:38,545 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 23:44:38,545 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 23:44:38,545 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 23:44:38,546 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 23:44:38,546 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 23:44:38,546 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 23:44:38,547 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 23:44:38,547 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:38,547 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:38,547 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 23:44:38,547 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 23:44:38,547 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 23:44:38,548 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 23:44:38,548 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 23:44:38,584 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 23:44:38,584 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:44:38,584 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 23:44:38,584 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:44:38,585 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 23:44:38,585 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 23:44:38,585 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 23:44:38,585 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 23:44:38,585 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 23:44:38,586 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 23:44:38,586 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 23:44:38,586 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:38,586 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:38,586 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 23:44:38,587 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 23:44:38,587 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 23:44:38,587 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 23:44:38,587 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 23:44:38,597 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 23:44:38,597 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000023C0E3ECD70>
2025-10-19 23:44:38,598 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 23:44:38,601 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f50766848593155468ad98"}}
2025-10-19 23:44:38,602 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f50766848593155468ad98"}, "previousDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 23:44:38,602 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,603 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 23:44:38,604 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f50766848593155468ad98"}}
2025-10-19 23:44:38,604 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f50766848593155468ad98"}, "remainingTimeMS": 4999}
2025-10-19 23:44:38,614 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f50766848593155468ad98"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 23:44:38,628 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f50766848593155468ad98"}, "driverConnectionId": 1, "serverConnectionId": 46715, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.944299960508943, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T15:44:38.992Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46715, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 23:44:38,628 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,629 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f50766848593155468ad98"}, "previousDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>"}
2025-10-19 23:44:38,629 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,630 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f50766848593155468ad98"}, "driverConnectionId": 1, "serverConnectionId": 46715, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 23:44:38,630 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,631 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:38,700 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.038864500005729496}
2025-10-19 23:44:38,701 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07032100000651553}
2025-10-19 23:44:38,701 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50766848593155468ad98"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KtdMbzh0R+qOcywvTGNmYw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,712 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50766848593155468ad98"}, "durationMS": 10.405, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,712 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:38,713 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 23:44:38,713 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 23:44:38.713310
2025-10-19 23:44:38,713 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>", "clientId": {"$oid": "68f50766848593155468ad98"}}
2025-10-19 23:44:38,714 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,714 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,715 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003833999508060515}
2025-10-19 23:44:38,715 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50766848593155468ad98"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888678}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KtdMbzh0R+qOcywvTGNmYw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,729 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50766848593155468ad98"}, "durationMS": 13.769, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,729 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:38,730 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>", "clientId": {"$oid": "68f50766848593155468ad98"}}
2025-10-19 23:44:38,730 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,730 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,731 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022059999173507094}
2025-10-19 23:44:38,731 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50766848593155468ad98"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760888678}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KtdMbzh0R+qOcywvTGNmYw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,797 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50766848593155468ad98"}, "durationMS": 66.302, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,798 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:38,798 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000023C0E693B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>", "clientId": {"$oid": "68f50766848593155468ad98"}}
2025-10-19 23:44:38,799 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000023C0E693B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f50766848593155468ad98, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012944299960508943>]>", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,799 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,799 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00027409999165683985}
2025-10-19 23:44:38,800 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50766848593155468ad98"}, "command": "{\"getMore\": 2668018974562436654, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"KtdMbzh0R+qOcywvTGNmYw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,811 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50766848593155468ad98"}, "durationMS": 11.006, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 46717, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:38,812 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:38,812 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 23:44:38,813 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-19 23:44:38,813 - data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-19 23:44:38,814 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 23:44:38,814 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 23:44:38,814 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:44:38,815 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:44:38,815 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 23:44:38,815 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 23:44:38,815 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 23:44:38,816 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:38,816 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 23:44:38,816 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 23:44:38,816 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 23:44:38,816 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 23:44:38,817 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:38,817 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 23:44:38,817 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 23:44:38,818 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 23:44:38,818 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 23:44:38,822 - __main__ - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 23:44:38,822 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:44:38,822 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:44:38,822 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 23:44:38,822 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 23:44:38,823 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 23:44:38,823 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:38,823 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 23:44:38,823 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 23:44:38,823 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 23:44:38,823 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 23:44:38,823 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:38,824 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 23:44:38,824 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 23:44:38,824 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 23:44:38,824 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 23:44:38,825 - __main__ - INFO - Inserted 106 records into table ROCE网络事件-光模块故障表
2025-10-19 23:44:38,825 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x0000023C0E3ECEC0>
2025-10-19 23:44:38,825 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-19 23:44:38,827 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 23:44:39,105 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:39,229 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16446
2025-10-19 23:44:39,230 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16446)
2025-10-19 23:44:39,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:39,484 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15446（变化，之前=16446）
2025-10-19 23:44:39,485 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15446)
2025-10-19 23:44:39,606 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 23:44:39,627 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:39,710 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.08975429995916784}
2025-10-19 23:44:39,711 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 23:44:39,733 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14446（变化，之前=15446）
2025-10-19 23:44:39,734 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14446)
2025-10-19 23:44:39,756 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.022330300009343773}
2025-10-19 23:44:39,756 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 23:44:39,803 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.024491199990734458}
2025-10-19 23:44:39,804 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 23:44:39,858 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:39,869 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f50766848593155468ad98"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.028223600005730987}
2025-10-19 23:44:39,906 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13446（变化，之前=14446）
2025-10-19 23:44:39,906 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13446)
2025-10-19 23:44:40,023 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:40,059 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12446（变化，之前=13446）
2025-10-19 23:44:40,059 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12446)
2025-10-19 23:44:40,171 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:40,208 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11446（变化，之前=12446）
2025-10-19 23:44:40,209 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11446)
2025-10-19 23:44:40,317 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:40,356 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10446（变化，之前=11446）
2025-10-19 23:44:40,356 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10446)
2025-10-19 23:44:40,458 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:40,508 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9446（变化，之前=10446）
2025-10-19 23:44:40,509 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9446)
2025-10-19 23:44:40,597 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:40,629 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8446（变化，之前=9446）
2025-10-19 23:44:40,630 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8446)
2025-10-19 23:44:40,711 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:40,751 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7446（变化，之前=8446）
2025-10-19 23:44:40,752 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7446)
2025-10-19 23:44:40,836 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:40,879 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6446（变化，之前=7446）
2025-10-19 23:44:40,879 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6446)
2025-10-19 23:44:40,959 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:41,045 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5446（变化，之前=6446）
2025-10-19 23:44:41,046 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5446)
2025-10-19 23:44:41,118 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:41,149 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4446（变化，之前=5446）
2025-10-19 23:44:41,149 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4446)
2025-10-19 23:44:41,253 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:41,289 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3446（变化，之前=4446）
2025-10-19 23:44:41,290 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3446)
2025-10-19 23:44:41,380 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:41,437 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2446（变化，之前=3446）
2025-10-19 23:44:41,438 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2446)
2025-10-19 23:44:41,552 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:41,581 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1446（变化，之前=2446）
2025-10-19 23:44:41,581 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1446)
2025-10-19 23:44:41,633 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-19 23:44:41,648 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 446（变化，之前=1446）
2025-10-19 23:44:41,649 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 446 条，累计 16446 条 (reported total=446)
2025-10-19 23:44:41,708 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-19 23:44:41,709 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=446）
2025-10-19 23:44:41,709 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-19 23:44:41,709 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16446
2025-10-19 23:44:41,709 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 23:44:41,794 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16446 条记录
2025-10-19 23:44:41,797 - data_loader - DEBUG - Loaded 16446 records from API
2025-10-19 23:44:41,797 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-19 23:44:41,798 - __main__ - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-19 23:44:41,798 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 23:44:41,798 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 23:44:41,798 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 23:44:41,799 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 23:44:41,799 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:41,799 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 23:44:41,800 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 23:44:41,800 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:41,800 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 23:44:41,800 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 23:44:41,801 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 23:44:41,801 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 23:44:41,801 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 23:44:41,804 - __main__ - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-19 23:44:41,804 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 23:44:41,804 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-19 23:44:41,805 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-19 23:44:41,805 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-19 23:44:41,805 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:41,805 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-19 23:44:41,805 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-19 23:44:41,805 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:41,805 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 23:44:41,806 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-19 23:44:41,806 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-19 23:44:41,806 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-19 23:44:41,806 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-19 23:44:41,910 - __main__ - INFO - Inserted 16446 records into table 网络设备总数量表
2025-10-19 23:44:41,910 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x0000023C0E3ED010>
2025-10-19 23:44:41,910 - data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-19 23:44:41,913 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f50769848593155468ad99"}}
2025-10-19 23:44:41,913 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f50769848593155468ad99"}, "previousDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 23:44:41,913 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:41,914 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 23:44:41,915 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f50769848593155468ad99"}}
2025-10-19 23:44:41,915 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f50769848593155468ad99"}, "remainingTimeMS": 4999}
2025-10-19 23:44:41,925 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f50769848593155468ad99"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 23:44:41,977 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f50769848593155468ad99"}, "driverConnectionId": 1, "serverConnectionId": 46722, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 51.21329997200519, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-19T15:44:42.300Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 46722, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 23:44:41,977 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:41,978 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f50769848593155468ad99"}, "previousDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>"}
2025-10-19 23:44:41,978 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:41,979 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f50769848593155468ad99"}, "driverConnectionId": 1, "serverConnectionId": 46722, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 23:44:41,979 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:41,979 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:42,181 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07450839999364689}
2025-10-19 23:44:42,181 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.20242309995228425}
2025-10-19 23:44:42,181 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50769848593155468ad99"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"59IcqoiFQSCPJujuLQllRQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,221 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50769848593155468ad99"}, "durationMS": 39.527, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,222 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:42,222 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 23:44:42,223 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 23:44:42.223181
2025-10-19 23:44:42,223 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>", "clientId": {"$oid": "68f50769848593155468ad99"}}
2025-10-19 23:44:42,224 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,224 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,224 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00032130000181496143}
2025-10-19 23:44:42,225 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50769848593155468ad99"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T23:44:42.223Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"59IcqoiFQSCPJujuLQllRQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,386 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50769848593155468ad99"}, "durationMS": 160.689, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,386 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:42,387 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>", "clientId": {"$oid": "68f50769848593155468ad99"}}
2025-10-19 23:44:42,387 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,387 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,388 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002455000067129731}
2025-10-19 23:44:42,388 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50769848593155468ad99"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T23:44:42.223Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"59IcqoiFQSCPJujuLQllRQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,450 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50769848593155468ad99"}, "durationMS": 62.593999999999994, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,451 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:42,452 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000023C0E693B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>", "clientId": {"$oid": "68f50769848593155468ad99"}}
2025-10-19 23:44:42,452 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000023C0E693B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f50769848593155468ad99, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.05121329997200519>]>", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,452 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,452 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002742000506259501}
2025-10-19 23:44:42,453 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f50769848593155468ad99"}, "command": "{\"getMore\": 4123578407520681750, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"59IcqoiFQSCPJujuLQllRQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,645 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f50769848593155468ad99"}, "durationMS": 191.975, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 46724, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 23:44:42,646 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 23:44:42,646 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-19 23:44:42,646 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-19 23:44:42,656 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-19 23:44:42,657 - data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-19 23:44:42,657 - data_loader - INFO - Network device failure data load completed (status=0)
2025-10-19 23:44:42,661 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-19 23:44:42,661 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:44:42,662 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 23:44:42,663 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:44:42,663 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 23:44:42,664 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:42,664 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:42,664 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 23:44:42,665 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 23:44:42,665 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 23:44:42,665 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 23:44:42,666 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 23:44:42,666 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 23:44:42,666 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 23:44:42,666 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 23:44:42,666 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 23:44:42,667 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 23:44:42,667 - __main__ - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-19 23:44:42,668 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 23:44:42,668 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 23:44:42,668 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 23:44:42,668 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 23:44:42,668 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 23:44:42,668 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 23:44:42,669 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 23:44:42,669 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-19 23:44:42,669 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-19 23:44:42,669 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 23:44:42,669 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 23:44:42,669 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 23:44:42,670 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 23:44:42,670 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-19 23:44:42,670 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-19 23:44:42,670 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-19 23:44:42,676 - __main__ - INFO - Inserted 309 records into table 网络设备故障表
2025-10-19 23:44:42,756 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 23:44:42,998 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f50769848593155468ad99"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1019.5101000135764, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-21 23:27:00,047 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:27:00,048 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:27:02,319 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a6467f140322d5904ce2"}}
2025-10-21 23:27:02,320 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a6467f140322d5904ce2"}, "previousDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:27:02,321 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,322 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:27:02,326 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}}
2025-10-21 23:27:02,327 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "remainingTimeMS": 4998}
2025-10-21 23:27:02,354 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a6467f140322d5904ce2"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:27:02,367 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a6467f140322d5904ce2"}, "driverConnectionId": 1, "serverConnectionId": 48258, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.299500009045005, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:27:01.849Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48258, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:27:02,368 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,369 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a6467f140322d5904ce2"}, "previousDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>"}
2025-10-21 23:27:02,373 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,374 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a6467f140322d5904ce2"}, "driverConnectionId": 1, "serverConnectionId": 48258, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:27:02,375 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,377 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,461 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07190249999985099}
2025-10-21 23:27:02,461 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08586660004220903}
2025-10-21 23:27:02,463 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"fg1fYvyUSH2gp+/AOOFNfA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,474 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "durationMS": 10.46, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,474 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,475 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:27:02,476 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-23 00:00:00 至 2025-10-21 23:27:02.476205
2025-10-21 23:27:02,476 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}}
2025-10-21 23:27:02,477 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,478 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,479 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009514999692328274}
2025-10-21 23:27:02,480 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060422}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"fg1fYvyUSH2gp+/AOOFNfA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,493 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "durationMS": 13.603, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,495 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,496 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}}
2025-10-21 23:27:02,497 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,500 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,500 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008200999582186341}
2025-10-21 23:27:02,501 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060422}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"fg1fYvyUSH2gp+/AOOFNfA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,567 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "durationMS": 66.253, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,572 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,573 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002038348F1A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}}
2025-10-21 23:27:02,574 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002038348F1A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011299500009045005>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,575 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,575 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005054000066593289}
2025-10-21 23:27:02,576 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "command": "{\"getMore\": 4953207247032145939, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"fg1fYvyUSH2gp+/AOOFNfA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,590 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "durationMS": 14.437, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48260, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,592 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,593 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-21 23:27:02,593 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-21 23:27:02,594 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-21 23:27:02,595 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:27:02,596 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:27:02,596 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-21 23:27:02,608 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x0000020383896FD0>
2025-10-21 23:27:02,609 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:27:02,611 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}}
2025-10-21 23:27:02,612 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}, "previousDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:27:02,612 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,614 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:27:02,616 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}}
2025-10-21 23:27:02,617 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "remainingTimeMS": 4998}
2025-10-21 23:27:02,649 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:27:02,661 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}, "driverConnectionId": 1, "serverConnectionId": 48261, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.888800024986267, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:27:02.145Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48261, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:27:02,663 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,663 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}, "previousDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>"}
2025-10-21 23:27:02,664 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,666 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}, "driverConnectionId": 1, "serverConnectionId": 48261, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:27:02,667 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,669 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,742 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.060922999982722104}
2025-10-21 23:27:02,743 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07648060005158186}
2025-10-21 23:27:02,744 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"y4W12mBaSNenp8F4jOofCQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,762 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "durationMS": 17.512, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,763 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,764 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:27:02,764 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-23 00:00:00 至 2025-10-21 23:27:02.764497
2025-10-21 23:27:02,765 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}}
2025-10-21 23:27:02,766 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,767 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,768 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006609000265598297}
2025-10-21 23:27:02,769 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060422}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"y4W12mBaSNenp8F4jOofCQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,782 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "durationMS": 13.422, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,783 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,784 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}}
2025-10-21 23:27:02,785 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,786 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,787 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007310000364668667}
2025-10-21 23:27:02,788 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060422}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"y4W12mBaSNenp8F4jOofCQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,859 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "durationMS": 71.155, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,860 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,861 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002038348F1A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}}
2025-10-21 23:27:02,862 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002038348F1A0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a6467f140322d5904ce3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010888800024986267>]>", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,863 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,864 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006134000141173601}
2025-10-21 23:27:02,865 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "command": "{\"getMore\": 192988424477868804, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"y4W12mBaSNenp8F4jOofCQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,879 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "durationMS": 13.719999999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48263, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:27:02,880 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:27:02,881 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-21 23:27:02,883 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-21 23:27:02,884 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-21 23:27:02,885 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:27:02,885 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-21 23:27:03,179 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7a6467f140322d5904ce3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 513.0792999989353, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-21 23:31:37,315 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:31:37,315 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:31:37,474 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a75971186dafe8631846"}}
2025-10-21 23:31:37,474 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a75971186dafe8631846"}, "previousDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:31:37,474 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,475 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:31:37,476 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}}
2025-10-21 23:31:37,477 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "remainingTimeMS": 4999}
2025-10-21 23:31:37,503 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a75971186dafe8631846"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:31:37,515 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a75971186dafe8631846"}, "driverConnectionId": 1, "serverConnectionId": 48264, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.902800015173852, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:31:37.002Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48264, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:31:37,518 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,519 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a75971186dafe8631846"}, "previousDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>"}
2025-10-21 23:31:37,519 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,520 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,520 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a75971186dafe8631846"}, "driverConnectionId": 1, "serverConnectionId": 48264, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:31:37,520 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,574 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04093650000868365}
2025-10-21 23:31:37,574 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05423509998945519}
2025-10-21 23:31:37,575 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LskLHClfQe6Vr+kWkdC3zg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,590 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "durationMS": 15.159, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,593 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,594 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:31:37,595 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-23 00:00:00 至 2025-10-21 23:31:37.595585
2025-10-21 23:31:37,596 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}}
2025-10-21 23:31:37,597 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,598 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,599 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007230000337585807}
2025-10-21 23:31:37,600 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060697}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LskLHClfQe6Vr+kWkdC3zg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,614 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "durationMS": 13.754999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,614 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,615 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}}
2025-10-21 23:31:37,615 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,616 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,616 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00036070001078769565}
2025-10-21 23:31:37,639 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060697}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LskLHClfQe6Vr+kWkdC3zg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,729 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "durationMS": 90.52000000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,732 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,732 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001E02429F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}}
2025-10-21 23:31:37,733 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001E02429F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631846, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010902800015173852>]>", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,733 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,733 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003006000188179314}
2025-10-21 23:31:37,734 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "command": "{\"getMore\": 6541903641642180977, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"LskLHClfQe6Vr+kWkdC3zg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,746 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "durationMS": 12.316, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48266, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,747 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631846"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,747 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-21 23:31:37,748 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-21 23:31:37,748 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-21 23:31:37,748 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:31:37,749 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:31:37,749 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-21 23:31:37,750 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x000001E0246A6E90>
2025-10-21 23:31:37,750 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:31:37,752 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a75971186dafe8631847"}}
2025-10-21 23:31:37,752 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a75971186dafe8631847"}, "previousDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:31:37,753 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,754 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:31:37,757 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}}
2025-10-21 23:31:37,757 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "remainingTimeMS": 4999}
2025-10-21 23:31:37,765 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a75971186dafe8631847"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:31:37,776 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a75971186dafe8631847"}, "driverConnectionId": 1, "serverConnectionId": 48267, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.767400031909347, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:31:37.264Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48267, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:31:37,777 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,777 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a75971186dafe8631847"}, "previousDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>"}
2025-10-21 23:31:37,778 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,779 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,780 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,780 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a75971186dafe8631847"}, "driverConnectionId": 1, "serverConnectionId": 48267, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:31:37,829 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03886530001182109}
2025-10-21 23:31:37,829 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.050006399978883564}
2025-10-21 23:31:37,830 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zRA02Nz1Rr+5exgd7Yfdog==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,841 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "durationMS": 10.969, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,841 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,841 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:31:37,841 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-23 00:00:00 至 2025-10-21 23:31:37.841881
2025-10-21 23:31:37,842 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}}
2025-10-21 23:31:37,842 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,842 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,843 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002126000472344458}
2025-10-21 23:31:37,843 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060697}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zRA02Nz1Rr+5exgd7Yfdog==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,854 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "durationMS": 11.148, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,854 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,855 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}}
2025-10-21 23:31:37,855 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,855 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,856 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002949000336229801}
2025-10-21 23:31:37,856 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060697}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zRA02Nz1Rr+5exgd7Yfdog==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,922 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "durationMS": 66.223, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,923 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,923 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001E02429F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}}
2025-10-21 23:31:37,924 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001E02429F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a75971186dafe8631847, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010767400031909347>]>", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,924 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,924 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002597999991849065}
2025-10-21 23:31:37,925 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "command": "{\"getMore\": 7473907110549814709, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zRA02Nz1Rr+5exgd7Yfdog==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,936 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "durationMS": 11.036000000000001, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48269, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:31:37,936 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:31:37,937 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-21 23:31:37,937 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-21 23:31:37,938 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-21 23:31:37,938 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:31:37,938 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-21 23:31:38,289 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7a75971186dafe8631847"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 509.17309999931604, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-21 23:32:36,414 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:32:36,414 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:32:36,611 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a794dee5669d07c78d02"}}
2025-10-21 23:32:36,611 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a794dee5669d07c78d02"}, "previousDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:32:36,612 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,612 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:32:36,614 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}}
2025-10-21 23:32:36,615 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "remainingTimeMS": 4999}
2025-10-21 23:32:36,623 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a794dee5669d07c78d02"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:32:36,635 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a794dee5669d07c78d02"}, "driverConnectionId": 1, "serverConnectionId": 48271, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.584200023207814, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:32:36.122Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48271, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:32:36,636 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,636 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a794dee5669d07c78d02"}, "previousDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>"}
2025-10-21 23:32:36,636 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,637 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a794dee5669d07c78d02"}, "driverConnectionId": 1, "serverConnectionId": 48271, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:32:36,637 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,638 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:36,684 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03544569999212399}
2025-10-21 23:32:36,684 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04715040000155568}
2025-10-21 23:32:36,685 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"wBshMEz5SpimHODO5oPYoA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,694 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "durationMS": 9.229, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,694 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:36,695 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:32:36,695 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-23 00:00:00 至 2025-10-21 23:32:36.695247
2025-10-21 23:32:36,695 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}}
2025-10-21 23:32:36,695 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,696 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,696 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00019880000036209822}
2025-10-21 23:32:36,696 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060756}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"wBshMEz5SpimHODO5oPYoA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,707 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "durationMS": 10.895, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,708 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:36,708 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}}
2025-10-21 23:32:36,709 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,709 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,709 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002761000068858266}
2025-10-21 23:32:36,710 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060756}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"wBshMEz5SpimHODO5oPYoA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,779 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "durationMS": 69.795, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,781 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:36,781 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022FB777F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}}
2025-10-21 23:32:36,782 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022FB777F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a794dee5669d07c78d02, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011584200023207814>]>", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,782 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,782 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00025509996339678764}
2025-10-21 23:32:36,783 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "command": "{\"getMore\": 1421636463342573049, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"wBshMEz5SpimHODO5oPYoA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,795 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "durationMS": 12.862, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48273, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:36,796 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a794dee5669d07c78d02"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:36,796 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-21 23:32:36,797 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-21 23:32:36,800 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-21 23:32:37,273 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-21 23:32:37,274 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 0 条记录
2025-10-21 23:32:37,277 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-21 23:32:37,278 - backend.data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-21 23:32:37,278 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:32:37,281 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:32:37,281 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-21 23:32:37,282 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x0000022FB7B82C10>
2025-10-21 23:32:37,282 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:32:37,284 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}}
2025-10-21 23:32:37,284 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}, "previousDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:32:37,285 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,286 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:32:37,287 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}}
2025-10-21 23:32:37,287 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "remainingTimeMS": 4999}
2025-10-21 23:32:37,295 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:32:37,312 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}, "driverConnectionId": 1, "serverConnectionId": 48274, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.56149997143075, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:32:36.794Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48274, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:32:37,312 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,313 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}, "previousDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>"}
2025-10-21 23:32:37,313 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,314 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}, "driverConnectionId": 1, "serverConnectionId": 48274, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:32:37,314 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,315 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:37,362 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.035062999988440424}
2025-10-21 23:32:37,363 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.048375000013038516}
2025-10-21 23:32:37,363 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8/iqO5O3Ri2B6FNBc8y56Q==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,372 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "durationMS": 9.371, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,373 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:37,374 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:32:37,374 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-23 00:00:00 至 2025-10-21 23:32:37.374637
2025-10-21 23:32:37,375 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}}
2025-10-21 23:32:37,375 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,376 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,376 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003218000056222081}
2025-10-21 23:32:37,376 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060757}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8/iqO5O3Ri2B6FNBc8y56Q==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,388 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "durationMS": 11.853000000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,389 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:37,390 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}}
2025-10-21 23:32:37,391 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,392 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,392 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007538000354543328}
2025-10-21 23:32:37,394 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1753200000, \"$lte\": 1761060757}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8/iqO5O3Ri2B6FNBc8y56Q==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,459 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "durationMS": 64.709, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,460 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:37,460 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022FB777F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}}
2025-10-21 23:32:37,460 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022FB777F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a795dee5669d07c78d03, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01656149997143075>]>", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,461 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,461 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00037429999792948365}
2025-10-21 23:32:37,462 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "command": "{\"getMore\": 269497109515835042, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8/iqO5O3Ri2B6FNBc8y56Q==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,472 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "durationMS": 10.721, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48276, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:32:37,474 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:32:37,474 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-21 23:32:37,475 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-21 23:32:37,476 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-21 23:32:37,954 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-21 23:32:37,956 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 0 条记录
2025-10-21 23:32:37,964 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-21 23:32:37,966 - backend.data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-21 23:32:37,967 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:32:37,968 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间']
2025-10-21 23:32:37,969 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-21 23:32:37,976 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-21 23:32:37,977 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-21 23:32:37,978 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-21 23:32:37,979 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-21 23:32:37,979 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-21 23:32:37,980 - backend.database_builder - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-21 23:32:37,981 - backend.database_builder - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-21 23:32:37,982 - backend.database_builder - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-21 23:32:37,983 - backend.database_builder - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-21 23:32:37,984 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-21 23:32:37,984 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-21 23:32:37,985 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-21 23:32:37,986 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-21 23:32:38,013 - backend.database_builder - INFO - Rebuilt table ROCE网络事件-网络零件（光模块+AOC）故障表 from ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:32:38,016 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-21 23:32:38,017 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-21 23:32:38,018 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-21 23:32:38,019 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-21 23:32:38,020 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-21 23:32:38,021 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-21 23:32:38,022 - backend.database_builder - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-21 23:32:38,022 - backend.database_builder - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-21 23:32:38,023 - backend.database_builder - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-21 23:32:38,023 - backend.database_builder - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-21 23:32:38,023 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-21 23:32:38,023 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-21 23:32:38,024 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-21 23:32:38,024 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-21 23:32:38,026 - backend.database_builder - INFO - Inserted 106 records into table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:32:38,049 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-21 23:32:38,318 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7a795dee5669d07c78d03"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1004.5386999845505, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-21 23:34:53,449 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:34:53,449 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:34:53,609 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a81d42c7ed8b78b74836"}}
2025-10-21 23:34:53,609 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "previousDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:34:53,609 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,610 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:34:53,612 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}}
2025-10-21 23:34:53,613 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "remainingTimeMS": 4999}
2025-10-21 23:34:53,643 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:34:53,661 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "driverConnectionId": 1, "serverConnectionId": 48277, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 15.508699987549335, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:34:53.145Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48277, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:34:53,662 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,663 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "previousDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>"}
2025-10-21 23:34:53,663 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,664 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "driverConnectionId": 1, "serverConnectionId": 48277, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:34:53,664 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,665 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:53,750 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04514409997500479}
2025-10-21 23:34:53,750 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08614630001829937}
2025-10-21 23:34:53,751 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"WlPJxNXzRUuR8VS9LQ/b2w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,764 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "durationMS": 12.962, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,764 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:53,765 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:34:53,765 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-04-24 00:00:00 至 2025-10-21 23:34:53.765251
2025-10-21 23:34:53,765 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}}
2025-10-21 23:34:53,765 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,766 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,766 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00017259997548535466}
2025-10-21 23:34:53,766 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1745424000, \"$lte\": 1761060893}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"WlPJxNXzRUuR8VS9LQ/b2w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,778 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "durationMS": 12.063, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 109}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,779 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:53,779 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}}
2025-10-21 23:34:53,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,780 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,780 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002502999850548804}
2025-10-21 23:34:53,780 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1745424000, \"$lte\": 1761060893}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"WlPJxNXzRUuR8VS9LQ/b2w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,847 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "durationMS": 66.251, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,848 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:53,848 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000028BBD21F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}}
2025-10-21 23:34:53,849 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000028BBD21F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a81d42c7ed8b78b74836, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.015508699987549335>]>", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,849 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,849 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00027269998099654913}
2025-10-21 23:34:53,850 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "command": "{\"getMore\": 4766807353574914542, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"WlPJxNXzRUuR8VS9LQ/b2w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,863 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "durationMS": 13.684999999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48279, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:53,864 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81d42c7ed8b78b74836"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:53,865 - backend.dataSources.roce_event - INFO - 查询到 109 条记录，返回 109 条
2025-10-21 23:34:53,866 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-21 23:34:53,868 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-21 23:34:54,254 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-21 23:34:54,254 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 0 条记录
2025-10-21 23:34:54,256 - backend.dataSources.roce_event - INFO - 处理完成，共生成 109 条记录
2025-10-21 23:34:54,257 - backend.data_loader - DEBUG - Loaded 109 records from MongoDB
2025-10-21 23:34:54,257 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:34:54,258 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:34:54,259 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-21 23:34:54,260 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x0000028BBD6239D0>
2025-10-21 23:34:54,260 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:34:54,262 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}}
2025-10-21 23:34:54,262 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "previousDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:34:54,263 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,263 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:34:54,264 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}}
2025-10-21 23:34:54,264 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "remainingTimeMS": 4999}
2025-10-21 23:34:54,283 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:34:54,294 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "driverConnectionId": 1, "serverConnectionId": 48280, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.950100026093423, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:34:53.781Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48280, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:34:54,295 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,295 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "previousDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>"}
2025-10-21 23:34:54,296 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,296 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "driverConnectionId": 1, "serverConnectionId": 48280, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:34:54,297 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,297 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:54,342 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.035846799961291254}
2025-10-21 23:34:54,343 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04591589997289702}
2025-10-21 23:34:54,343 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zxI2XKGDRV6NGnhPPTF3kA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,354 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "durationMS": 10.718, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,355 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:54,355 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:34:54,355 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-04-24 00:00:00 至 2025-10-21 23:34:54.355793
2025-10-21 23:34:54,356 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}}
2025-10-21 23:34:54,356 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,357 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,357 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000318199978210032}
2025-10-21 23:34:54,357 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1745424000, \"$lte\": 1761060894}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zxI2XKGDRV6NGnhPPTF3kA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,369 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "durationMS": 11.562, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 109}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,370 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:54,370 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}}
2025-10-21 23:34:54,371 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,371 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,371 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00029559998074546456}
2025-10-21 23:34:54,372 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1745424000, \"$lte\": 1761060894}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zxI2XKGDRV6NGnhPPTF3kA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,445 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "durationMS": 73.01599999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,445 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:54,446 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000028BBD21F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}}
2025-10-21 23:34:54,446 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000028BBD21F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a81e42c7ed8b78b74837, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010950100026093423>]>", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,446 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,447 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002742999931797385}
2025-10-21 23:34:54,447 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "command": "{\"getMore\": 8283702216231144164, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"zxI2XKGDRV6NGnhPPTF3kA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,462 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "durationMS": 15.093, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48282, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:34:54,463 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:34:54,463 - backend.dataSources.roce_event - INFO - 查询到 109 条记录，返回 109 条
2025-10-21 23:34:54,464 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-21 23:34:54,465 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-21 23:34:54,888 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-21 23:34:54,889 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 0 条记录
2025-10-21 23:34:54,892 - backend.dataSources.roce_event - INFO - 处理完成，共生成 109 条记录
2025-10-21 23:34:54,893 - backend.data_loader - DEBUG - Loaded 109 records from MongoDB
2025-10-21 23:34:54,893 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:34:54,893 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间']
2025-10-21 23:34:54,894 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-21 23:34:54,897 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-21 23:34:54,898 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-21 23:34:54,898 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-21 23:34:54,899 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-21 23:34:54,899 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-21 23:34:54,900 - backend.database_builder - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-21 23:34:54,900 - backend.database_builder - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-21 23:34:54,901 - backend.database_builder - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-21 23:34:54,901 - backend.database_builder - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-21 23:34:54,902 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-21 23:34:54,902 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-21 23:34:54,902 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-21 23:34:54,903 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-21 23:34:54,934 - backend.database_builder - INFO - Rebuilt table ROCE网络事件-网络零件（光模块+AOC）故障表 from ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:34:54,935 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-21 23:34:54,935 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-21 23:34:54,935 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-21 23:34:54,935 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-21 23:34:54,936 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-21 23:34:54,936 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-21 23:34:54,936 - backend.database_builder - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-21 23:34:54,936 - backend.database_builder - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-21 23:34:54,937 - backend.database_builder - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-21 23:34:54,937 - backend.database_builder - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-21 23:34:54,937 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-21 23:34:54,937 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-21 23:34:54,937 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-21 23:34:54,938 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-21 23:34:54,939 - backend.database_builder - INFO - Inserted 109 records into table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:34:54,951 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-21 23:34:55,308 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7a81e42c7ed8b78b74837"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1011.3488000351936, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-21 23:37:52,512 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:37:52,512 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:37:52,660 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}}
2025-10-21 23:37:52,660 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "previousDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:37:52,660 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,661 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:37:52,662 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}}
2025-10-21 23:37:52,663 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "remainingTimeMS": 4999}
2025-10-21 23:37:52,688 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:37:52,708 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "driverConnectionId": 1, "serverConnectionId": 48283, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.394099994096905, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:37:52.199Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48283, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:37:52,709 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,709 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "previousDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>"}
2025-10-21 23:37:52,710 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,710 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "driverConnectionId": 1, "serverConnectionId": 48283, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:37:52,710 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,711 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:52,758 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03619369998341426}
2025-10-21 23:37:52,759 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04828879999695346}
2025-10-21 23:37:52,759 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/O4QXCaESzWiDdmOfNWtNg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,768 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "durationMS": 8.971, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,769 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:52,769 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:37:52,769 - backend.dataSources.roce_event - INFO - 查询时间范围: 2024-10-26 00:00:00 至 2025-10-21 23:37:52.769801
2025-10-21 23:37:52,770 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}}
2025-10-21 23:37:52,770 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,771 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,771 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00028520001797005534}
2025-10-21 23:37:52,771 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729872000, \"$lte\": 1761061072}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/O4QXCaESzWiDdmOfNWtNg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,787 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "durationMS": 16.088, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 883}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,788 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:52,788 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}}
2025-10-21 23:37:52,789 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,789 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,790 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003330999752506614}
2025-10-21 23:37:52,790 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729872000, \"$lte\": 1761061072}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/O4QXCaESzWiDdmOfNWtNg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,850 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "durationMS": 59.971999999999994, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,851 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:52,852 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000026CA711F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}}
2025-10-21 23:37:52,852 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000026CA711F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a8d0f56ed2537ccc8f86, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009394099994096905>]>", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,853 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:52,853 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00039469997864216566}
2025-10-21 23:37:52,854 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "command": "{\"getMore\": 4702939586898162867, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/O4QXCaESzWiDdmOfNWtNg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,111 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "durationMS": 257.69100000000003, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48285, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,112 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d0f56ed2537ccc8f86"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:53,113 - backend.dataSources.roce_event - INFO - 查询到 883 条记录，返回 883 条
2025-10-21 23:37:53,117 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-21 23:37:53,119 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-21 23:37:53,588 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-21 23:37:53,590 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 6 条记录
2025-10-21 23:37:53,595 - backend.dataSources.roce_event - INFO - 处理完成，共生成 883 条记录
2025-10-21 23:37:53,604 - backend.data_loader - DEBUG - Loaded 883 records from MongoDB
2025-10-21 23:37:53,605 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:37:53,611 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:37:53,612 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-21 23:37:53,614 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x0000026CA7523250>
2025-10-21 23:37:53,614 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-21 23:37:53,618 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}}
2025-10-21 23:37:53,619 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "previousDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-21 23:37:53,619 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,620 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-21 23:37:53,622 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}}
2025-10-21 23:37:53,623 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "remainingTimeMS": 4999}
2025-10-21 23:37:53,667 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-21 23:37:53,691 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "driverConnectionId": 1, "serverConnectionId": 48286, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 23.964299994986504, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T15:37:53.168Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48286, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-21 23:37:53,692 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,692 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "previousDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>"}
2025-10-21 23:37:53,692 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,693 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "driverConnectionId": 1, "serverConnectionId": 48286, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-21 23:37:53,693 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,693 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:53,772 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03213479998521507}
2025-10-21 23:37:53,772 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07937950000632554}
2025-10-21 23:37:53,773 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"JJmgAwRASpySUvvOpE2kuQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,782 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "durationMS": 9.411, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,783 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:53,783 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-21 23:37:53,783 - backend.dataSources.roce_event - INFO - 查询时间范围: 2024-10-26 00:00:00 至 2025-10-21 23:37:53.783514
2025-10-21 23:37:53,783 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}}
2025-10-21 23:37:53,784 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,784 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,785 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00030210003023967147}
2025-10-21 23:37:53,785 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729872000, \"$lte\": 1761061073}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"JJmgAwRASpySUvvOpE2kuQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,804 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "durationMS": 19.012, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 883}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,804 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:53,805 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}}
2025-10-21 23:37:53,805 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,806 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,806 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022280000848695636}
2025-10-21 23:37:53,806 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729872000, \"$lte\": 1761061073}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"JJmgAwRASpySUvvOpE2kuQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,868 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "durationMS": 62.113, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,869 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:53,869 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000026CA711F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}}
2025-10-21 23:37:53,869 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000026CA711F2E0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7a8d1f56ed2537ccc8f87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.023964299994986504>]>", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,870 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:53,870 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00027249997947365046}
2025-10-21 23:37:53,870 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "command": "{\"getMore\": 3075268437670195234, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"JJmgAwRASpySUvvOpE2kuQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:54,052 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "durationMS": 181.41199999999998, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48288, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-21 23:37:54,052 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-21 23:37:54,062 - backend.dataSources.roce_event - INFO - 查询到 883 条记录，返回 883 条
2025-10-21 23:37:54,066 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-21 23:37:54,067 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-21 23:37:54,529 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-21 23:37:54,532 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 6 条记录
2025-10-21 23:37:54,536 - backend.dataSources.roce_event - INFO - 处理完成，共生成 883 条记录
2025-10-21 23:37:54,543 - backend.data_loader - DEBUG - Loaded 883 records from MongoDB
2025-10-21 23:37:54,544 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-21 23:37:54,544 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间']
2025-10-21 23:37:54,546 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-21 23:37:54,550 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-21 23:37:54,551 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-21 23:37:54,551 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-21 23:37:54,552 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-21 23:37:54,552 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-21 23:37:54,553 - backend.database_builder - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-21 23:37:54,553 - backend.database_builder - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-21 23:37:54,554 - backend.database_builder - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-21 23:37:54,555 - backend.database_builder - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-21 23:37:54,555 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-21 23:37:54,556 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-21 23:37:54,556 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-21 23:37:54,557 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-21 23:37:54,587 - backend.database_builder - INFO - Rebuilt table ROCE网络事件-网络零件（光模块+AOC）故障表 from ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:37:54,588 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-21 23:37:54,588 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-21 23:37:54,588 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-21 23:37:54,589 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-21 23:37:54,589 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-21 23:37:54,589 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-21 23:37:54,589 - backend.database_builder - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-21 23:37:54,590 - backend.database_builder - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-21 23:37:54,590 - backend.database_builder - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-21 23:37:54,590 - backend.database_builder - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-21 23:37:54,590 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-21 23:37:54,591 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-21 23:37:54,591 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-21 23:37:54,591 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-21 23:37:54,598 - backend.database_builder - INFO - Inserted 883 records into table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-21 23:37:54,611 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-21 23:37:54,702 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7a8d1f56ed2537ccc8f87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1008.9353999937885, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-22 00:51:08,453 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-22 00:51:08,454 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-22 00:51:08,454 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 00:51:08,454 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-22 00:51:08,454 - data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-22 00:51:08,454 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-22 00:51:08,462 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x000001BC07698C20>
2025-10-22 00:51:08,462 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-22 00:51:08,643 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}}
2025-10-22 00:51:08,643 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "previousDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 00:51:08,644 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,644 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 00:51:08,646 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}}
2025-10-22 00:51:08,646 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "remainingTimeMS": 4999}
2025-10-22 00:51:08,671 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 00:51:08,683 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.02759997593239, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:51:08.231Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:51:08,683 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,684 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "previousDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>"}
2025-10-22 00:51:08,684 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,685 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:51:08,685 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,686 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:51:08,762 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04418259998783469}
2025-10-22 00:51:08,763 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07752719998825341}
2025-10-22 00:51:08,763 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AT0LmMV/QG6vVirfHb+xeA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,774 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "durationMS": 10.534, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,774 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:51:08,775 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-22 00:51:08,775 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-24 00:00:00 至 2025-10-22 00:51:08.775653
2025-10-22 00:51:08,776 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}}
2025-10-22 00:51:08,776 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,776 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,777 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00026320002507418394}
2025-10-22 00:51:08,777 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:51:08.775Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AT0LmMV/QG6vVirfHb+xeA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,800 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "durationMS": 23.021, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,801 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:51:08,801 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}}
2025-10-22 00:51:08,802 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,802 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,803 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004081000224687159}
2025-10-22 00:51:08,803 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:51:08.775Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AT0LmMV/QG6vVirfHb+xeA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,923 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "durationMS": 119.435, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,924 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:51:08,925 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BC07943B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}}
2025-10-22 00:51:08,925 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BC07943B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7b9fcc7369075e97c7f27, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01102759997593239>]>", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,925 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:08,926 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00027379998937249184}
2025-10-22 00:51:08,926 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "command": "{\"getMore\": 8728345239554292840, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"AT0LmMV/QG6vVirfHb+xeA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:09,278 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "durationMS": 351.695, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48324, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:51:09,279 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:51:09,279 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-22 00:51:09,294 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-22 00:51:09,297 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-22 00:51:09,297 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-22 00:51:09,298 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-22 00:51:09,299 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:51:09,301 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 00:51:09,301 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:51:09,301 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 00:51:09,302 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-22 00:51:09,302 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 00:51:09,303 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:51:09,303 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-22 00:51:09,303 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 00:51:09,304 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 00:51:09,304 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:51:09,304 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:51:09,305 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:51:09,305 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-22 00:51:09,305 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 00:51:09,306 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 00:51:09,306 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-22 00:51:09,334 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-22 00:51:09,335 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:51:09,335 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 00:51:09,335 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:51:09,335 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 00:51:09,336 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-22 00:51:09,336 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 00:51:09,336 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:51:09,336 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-22 00:51:09,337 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 00:51:09,337 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 00:51:09,337 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:51:09,337 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:51:09,338 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:51:09,338 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-22 00:51:09,338 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 00:51:09,338 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 00:51:09,338 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-22 00:51:09,347 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-22 00:51:09,347 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x000001BC07698D70>
2025-10-22 00:51:09,347 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-22 00:51:09,377 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-22 00:51:09,647 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 00:51:09,696 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.01909169997088611}
2025-10-22 00:51:09,697 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 00:51:09,726 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.01894220005488023}
2025-10-22 00:51:09,726 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 00:51:09,763 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.026815199991688132}
2025-10-22 00:51:09,763 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 00:51:09,799 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02503630000865087}
2025-10-22 00:51:10,504 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:10,554 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104338
2025-10-22 00:51:10,556 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104338)
2025-10-22 00:51:11,631 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:11,671 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103338（变化，之前=104338）
2025-10-22 00:51:11,671 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103338)
2025-10-22 00:51:12,736 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:12,783 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102338（变化，之前=103338）
2025-10-22 00:51:12,784 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102338)
2025-10-22 00:51:13,818 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:13,859 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101338（变化，之前=102338）
2025-10-22 00:51:13,859 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101338)
2025-10-22 00:51:14,908 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:14,952 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100338（变化，之前=101338）
2025-10-22 00:51:14,953 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100338)
2025-10-22 00:51:16,021 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:16,058 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99338（变化，之前=100338）
2025-10-22 00:51:16,058 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99338)
2025-10-22 00:51:17,074 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:17,118 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98338（变化，之前=99338）
2025-10-22 00:51:17,118 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98338)
2025-10-22 00:51:18,124 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:18,168 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97338（变化，之前=98338）
2025-10-22 00:51:18,168 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97338)
2025-10-22 00:51:18,708 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10022.173799981829, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:51:18.254Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:51:18,710 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:51:19,169 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:19,216 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96338（变化，之前=97338）
2025-10-22 00:51:19,216 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96338)
2025-10-22 00:51:20,230 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:20,270 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95338（变化，之前=96338）
2025-10-22 00:51:20,270 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95338)
2025-10-22 00:51:21,265 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:21,307 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94338（变化，之前=95338）
2025-10-22 00:51:21,307 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94338)
2025-10-22 00:51:22,294 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:22,336 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93338（变化，之前=94338）
2025-10-22 00:51:22,336 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93338)
2025-10-22 00:51:23,301 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:23,343 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92338（变化，之前=93338）
2025-10-22 00:51:23,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92338)
2025-10-22 00:51:24,282 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:24,321 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91338（变化，之前=92338）
2025-10-22 00:51:24,322 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91338)
2025-10-22 00:51:25,246 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:25,284 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90338（变化，之前=91338）
2025-10-22 00:51:25,284 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90338)
2025-10-22 00:51:26,217 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:26,259 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89338（变化，之前=90338）
2025-10-22 00:51:26,260 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89338)
2025-10-22 00:51:27,181 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:27,226 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88338（变化，之前=89338）
2025-10-22 00:51:27,226 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88338)
2025-10-22 00:51:28,156 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:28,195 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87338（变化，之前=88338）
2025-10-22 00:51:28,196 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87338)
2025-10-22 00:51:28,709 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9997.437100042589, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:51:28.257Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:51:28,711 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:51:29,103 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:29,144 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86338（变化，之前=87338）
2025-10-22 00:51:29,144 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86338)
2025-10-22 00:51:30,045 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:30,087 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85338（变化，之前=86338）
2025-10-22 00:51:30,087 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85338)
2025-10-22 00:51:31,173 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:31,211 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84338（变化，之前=85338）
2025-10-22 00:51:31,211 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84338)
2025-10-22 00:51:32,123 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:32,169 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83338（变化，之前=84338）
2025-10-22 00:51:32,170 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83338)
2025-10-22 00:51:33,081 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:33,125 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82338（变化，之前=83338）
2025-10-22 00:51:33,125 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82338)
2025-10-22 00:51:34,049 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:34,092 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81338（变化，之前=82338）
2025-10-22 00:51:34,093 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81338)
2025-10-22 00:51:35,012 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:35,057 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80338（变化，之前=81338）
2025-10-22 00:51:35,057 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80338)
2025-10-22 00:51:35,913 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:35,957 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79338（变化，之前=80338）
2025-10-22 00:51:35,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79338)
2025-10-22 00:51:36,830 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:36,876 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78338（变化，之前=79338）
2025-10-22 00:51:36,876 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78338)
2025-10-22 00:51:37,745 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:37,791 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77338（变化，之前=78338）
2025-10-22 00:51:37,791 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77338)
2025-10-22 00:51:38,652 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:38,693 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76338（变化，之前=77338）
2025-10-22 00:51:38,694 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76338)
2025-10-22 00:51:38,729 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10017.806899966672, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:51:38.268Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:51:38,730 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:51:39,550 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:39,593 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75338（变化，之前=76338）
2025-10-22 00:51:39,594 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75338)
2025-10-22 00:51:40,534 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:40,574 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74338（变化，之前=75338）
2025-10-22 00:51:40,575 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74338)
2025-10-22 00:51:41,473 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:41,518 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73338（变化，之前=74338）
2025-10-22 00:51:41,519 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73338)
2025-10-22 00:51:42,370 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:42,410 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72338（变化，之前=73338）
2025-10-22 00:51:42,411 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72338)
2025-10-22 00:51:43,277 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:43,317 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71338（变化，之前=72338）
2025-10-22 00:51:43,317 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71338)
2025-10-22 00:51:44,156 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:44,197 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70338（变化，之前=71338）
2025-10-22 00:51:44,198 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70338)
2025-10-22 00:51:45,039 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:45,084 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69338（变化，之前=70338）
2025-10-22 00:51:45,084 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69338)
2025-10-22 00:51:45,913 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:45,954 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68338（变化，之前=69338）
2025-10-22 00:51:45,955 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68338)
2025-10-22 00:51:46,771 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:46,810 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67338（变化，之前=68338）
2025-10-22 00:51:46,811 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67338)
2025-10-22 00:51:47,626 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:47,667 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66338（变化，之前=67338）
2025-10-22 00:51:47,667 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66338)
2025-10-22 00:51:48,529 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:48,620 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65338（变化，之前=66338）
2025-10-22 00:51:48,620 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65338)
2025-10-22 00:51:48,774 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10043.46189997159, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:51:48.275Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:51:48,776 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:51:49,430 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:49,466 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64338（变化，之前=65338）
2025-10-22 00:51:49,467 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64338)
2025-10-22 00:51:50,268 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:50,312 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63338（变化，之前=64338）
2025-10-22 00:51:50,312 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63338)
2025-10-22 00:51:51,104 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:51,149 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62338（变化，之前=63338）
2025-10-22 00:51:51,149 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62338)
2025-10-22 00:51:51,933 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:51,974 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61338（变化，之前=62338）
2025-10-22 00:51:51,974 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61338)
2025-10-22 00:51:52,753 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:52,794 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60338（变化，之前=61338）
2025-10-22 00:51:52,795 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60338)
2025-10-22 00:51:53,563 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:53,603 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59338（变化，之前=60338）
2025-10-22 00:51:53,603 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59338)
2025-10-22 00:51:54,353 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:54,392 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58338（变化，之前=59338）
2025-10-22 00:51:54,392 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58338)
2025-10-22 00:51:55,143 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:55,186 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57338（变化，之前=58338）
2025-10-22 00:51:55,187 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57338)
2025-10-22 00:51:55,945 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:55,985 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56338（变化，之前=57338）
2025-10-22 00:51:55,985 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56338)
2025-10-22 00:51:56,733 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:56,779 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55338（变化，之前=56338）
2025-10-22 00:51:56,779 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55338)
2025-10-22 00:51:57,519 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:57,575 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54338（变化，之前=55338）
2025-10-22 00:51:57,575 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54338)
2025-10-22 00:51:58,325 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:58,368 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53338（变化，之前=54338）
2025-10-22 00:51:58,368 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53338)
2025-10-22 00:51:58,737 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9959.27379996283, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:51:58.285Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:51:58,737 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:51:59,146 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:59,187 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52338（变化，之前=53338）
2025-10-22 00:51:59,187 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52338)
2025-10-22 00:51:59,897 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:51:59,940 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51338（变化，之前=52338）
2025-10-22 00:51:59,940 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51338)
2025-10-22 00:52:00,638 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:00,674 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50338（变化，之前=51338）
2025-10-22 00:52:00,675 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50338)
2025-10-22 00:52:01,370 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:01,416 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49338（变化，之前=50338）
2025-10-22 00:52:01,416 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49338)
2025-10-22 00:52:02,093 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:02,135 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48338（变化，之前=49338）
2025-10-22 00:52:02,136 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48338)
2025-10-22 00:52:02,803 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:02,843 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47338（变化，之前=48338）
2025-10-22 00:52:02,843 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47338)
2025-10-22 00:52:03,490 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:03,531 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46338（变化，之前=47338）
2025-10-22 00:52:03,532 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46338)
2025-10-22 00:52:04,169 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:04,203 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45338（变化，之前=46338）
2025-10-22 00:52:04,204 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45338)
2025-10-22 00:52:04,832 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:04,869 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44338（变化，之前=45338）
2025-10-22 00:52:04,869 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44338)
2025-10-22 00:52:05,502 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:05,539 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43338（变化，之前=44338）
2025-10-22 00:52:05,539 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43338)
2025-10-22 00:52:06,152 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:06,187 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42338（变化，之前=43338）
2025-10-22 00:52:06,187 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42338)
2025-10-22 00:52:06,780 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:06,815 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41338（变化，之前=42338）
2025-10-22 00:52:06,815 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41338)
2025-10-22 00:52:07,404 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:07,448 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40338（变化，之前=41338）
2025-10-22 00:52:07,449 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40338)
2025-10-22 00:52:08,029 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:08,065 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39338（变化，之前=40338）
2025-10-22 00:52:08,065 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39338)
2025-10-22 00:52:08,636 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:08,670 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38338（变化，之前=39338）
2025-10-22 00:52:08,670 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38338)
2025-10-22 00:52:08,747 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10008.970999973826, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:52:08.293Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:52:08,749 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:52:09,225 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:09,259 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37338（变化，之前=38338）
2025-10-22 00:52:09,260 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37338)
2025-10-22 00:52:09,802 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:09,831 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36338（变化，之前=37338）
2025-10-22 00:52:09,832 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36338)
2025-10-22 00:52:10,366 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:10,399 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35338（变化，之前=36338）
2025-10-22 00:52:10,399 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35338)
2025-10-22 00:52:10,943 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:10,975 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34338（变化，之前=35338）
2025-10-22 00:52:10,976 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34338)
2025-10-22 00:52:11,502 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:11,537 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33338（变化，之前=34338）
2025-10-22 00:52:11,538 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33338)
2025-10-22 00:52:12,046 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:12,085 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32338（变化，之前=33338）
2025-10-22 00:52:12,086 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32338)
2025-10-22 00:52:12,576 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:12,609 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31338（变化，之前=32338）
2025-10-22 00:52:12,610 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31338)
2025-10-22 00:52:13,093 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:13,131 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30338（变化，之前=31338）
2025-10-22 00:52:13,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30338)
2025-10-22 00:52:13,600 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:13,655 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29338（变化，之前=30338）
2025-10-22 00:52:13,656 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29338)
2025-10-22 00:52:14,127 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:14,165 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28338（变化，之前=29338）
2025-10-22 00:52:14,165 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28338)
2025-10-22 00:52:14,611 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:14,642 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27338（变化，之前=28338）
2025-10-22 00:52:14,642 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27338)
2025-10-22 00:52:15,075 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:15,107 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26338（变化，之前=27338）
2025-10-22 00:52:15,108 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26338)
2025-10-22 00:52:15,521 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:15,549 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25338（变化，之前=26338）
2025-10-22 00:52:15,550 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25338)
2025-10-22 00:52:15,953 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:15,978 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24338（变化，之前=25338）
2025-10-22 00:52:15,979 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24338)
2025-10-22 00:52:16,366 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:16,393 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23338（变化，之前=24338）
2025-10-22 00:52:16,393 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23338)
2025-10-22 00:52:16,752 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:16,778 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22338（变化，之前=23338）
2025-10-22 00:52:16,779 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22338)
2025-10-22 00:52:17,118 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:17,150 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21338（变化，之前=22338）
2025-10-22 00:52:17,150 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21338)
2025-10-22 00:52:17,484 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:17,508 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20338（变化，之前=21338）
2025-10-22 00:52:17,509 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20338)
2025-10-22 00:52:17,820 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:17,851 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19338（变化，之前=20338）
2025-10-22 00:52:17,852 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19338)
2025-10-22 00:52:18,168 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:18,211 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18338（变化，之前=19338）
2025-10-22 00:52:18,212 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18338)
2025-10-22 00:52:18,501 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:18,528 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17338（变化，之前=18338）
2025-10-22 00:52:18,528 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17338)
2025-10-22 00:52:18,756 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10006.479499978013, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:52:18.304Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48323, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:52:18,757 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7b9fcc7369075e97c7f27"}, "driverConnectionId": 1, "serverConnectionId": 48323, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:52:18,808 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:18,831 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16338（变化，之前=17338）
2025-10-22 00:52:18,832 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16338)
2025-10-22 00:52:19,107 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:19,131 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15338（变化，之前=16338）
2025-10-22 00:52:19,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15338)
2025-10-22 00:52:19,388 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:19,413 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14338（变化，之前=15338）
2025-10-22 00:52:19,413 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14338)
2025-10-22 00:52:19,664 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:19,694 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13338（变化，之前=14338）
2025-10-22 00:52:19,694 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13338)
2025-10-22 00:52:19,929 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:19,957 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12338（变化，之前=13338）
2025-10-22 00:52:19,958 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12338)
2025-10-22 00:52:20,176 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:20,206 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11338（变化，之前=12338）
2025-10-22 00:52:20,206 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11338)
2025-10-22 00:52:20,411 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:20,436 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10338（变化，之前=11338）
2025-10-22 00:52:20,437 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10338)
2025-10-22 00:52:20,626 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:20,648 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9338（变化，之前=10338）
2025-10-22 00:52:20,649 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9338)
2025-10-22 00:52:20,835 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:20,857 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8338（变化，之前=9338）
2025-10-22 00:52:20,858 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8338)
2025-10-22 00:52:21,027 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,052 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7338（变化，之前=8338）
2025-10-22 00:52:21,052 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7338)
2025-10-22 00:52:21,214 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,234 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6338（变化，之前=7338）
2025-10-22 00:52:21,235 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6338)
2025-10-22 00:52:21,386 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,404 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5338（变化，之前=6338）
2025-10-22 00:52:21,404 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5338)
2025-10-22 00:52:21,542 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,586 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4338（变化，之前=5338）
2025-10-22 00:52:21,586 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4338)
2025-10-22 00:52:21,713 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,731 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3338（变化，之前=4338）
2025-10-22 00:52:21,731 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3338)
2025-10-22 00:52:21,827 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,846 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2338（变化，之前=3338）
2025-10-22 00:52:21,847 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2338)
2025-10-22 00:52:21,910 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,928 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1338（变化，之前=2338）
2025-10-22 00:52:21,929 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1338)
2025-10-22 00:52:21,981 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:52:21,988 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 338（变化，之前=1338）
2025-10-22 00:52:21,989 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 338 条，累计已去重 104000 条 (reported total=338)
2025-10-22 00:52:22,034 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-22 00:52:22,035 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=338）
2025-10-22 00:52:22,035 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-22 00:52:22,036 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-22 00:52:22,036 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-22 00:52:22,037 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-22 00:52:22,037 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-22 00:52:22,038 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-22 00:52:22,038 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-22 00:52:22,038 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-22 00:52:22,039 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-22 00:52:22,039 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-22 00:52:22,040 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-22 00:52:22,040 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-22 00:52:22,040 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-22 00:52:22,041 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-22 00:52:22,041 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-22 00:52:22,041 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-22 00:52:22,041 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-22 00:52:22,042 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-22 00:52:22,042 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-22 00:52:22,042 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-22 00:52:22,042 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-22 00:52:22,043 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-22 00:52:22,043 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-22 00:52:22,043 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-22 00:52:22,043 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-22 00:52:22,043 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-22 00:52:22,044 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-22 00:52:22,044 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-22 00:52:22,044 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-22 00:52:22,044 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-22 00:52:22,044 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-22 00:52:22,044 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-22 00:52:22,045 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-22 00:52:22,045 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-22 00:52:22,045 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-22 00:52:22,046 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-22 00:52:22,046 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-22 00:52:22,046 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-22 00:52:22,046 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-22 00:52:22,047 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-22 00:52:22,047 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-22 00:52:22,047 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-22 00:52:22,047 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-22 00:52:22,047 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-22 00:52:22,048 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-22 00:52:22,048 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-22 00:52:22,048 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-22 00:52:22,048 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-22 00:52:22,048 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-22 00:52:22,048 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-22 00:52:22,049 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-22 00:52:22,049 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-22 00:52:22,049 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-22 00:52:22,049 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-22 00:52:22,049 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-22 00:52:22,049 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-22 00:52:22,049 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-22 00:52:22,050 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-22 00:52:22,050 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-22 00:52:22,050 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-22 00:52:22,050 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-22 00:52:22,050 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-22 00:52:22,050 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-22 00:52:22,050 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-22 00:52:22,051 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-22 00:52:22,052 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-22 00:52:22,053 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-22 00:52:22,053 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-22 00:52:22,053 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-22 00:52:22,053 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-22 00:52:22,053 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-22 00:52:22,053 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-22 00:52:22,053 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-22 00:52:22,054 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-22 00:52:22,055 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-22 00:52:22,055 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-22 00:52:22,055 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-22 00:52:22,055 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-22 00:52:22,055 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-22 00:52:22,055 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-22 00:52:22,055 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-22 00:52:22,056 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-22 00:52:22,056 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-22 00:52:22,056 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-22 00:52:22,056 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-22 00:52:22,056 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 338 条
2025-10-22 00:52:22,057 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104338
2025-10-22 00:52:22,057 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-22 00:52:22,063 - data_loader - ERROR - Failed to load optical module inventory data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\data_loader.py", line 215, in load_data
    data = query_optical_module_inventory()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\optical_module_inventory.py", line 298, in query_optical_module_inventory
    return fetch_all_optical_module_inventory()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\optical_module_inventory.py", line 267, in fetch_all_optical_module_inventory
    cluster, customer = get_cluster_info_from_hostname(hostname,is_roce_event=False)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\cluster_info.py", line 151, in get_cluster_info_from_hostname
    score_match = re.match(r'^(^([A-Z]+)-([A-Z0-9]+)-[A-Z0-9-]*SROCE_CORE-(\d+)_(\d+)_(\d+)_(\d+)(\.[A-Z0-9]+)?$', hostname)
  File "D:\python\Lib\re\__init__.py", line 167, in match
    return _compile(pattern, flags).match(string)
           ~~~~~~~~^^^^^^^^^^^^^^^^
  File "D:\python\Lib\re\__init__.py", line 350, in _compile
    p = _compiler.compile(pattern, flags)
  File "D:\python\Lib\re\_compiler.py", line 748, in compile
    p = _parser.parse(p, flags)
  File "D:\python\Lib\re\_parser.py", line 980, in parse
    p = _parse_sub(source, state, flags & SRE_FLAG_VERBOSE, 0)
  File "D:\python\Lib\re\_parser.py", line 459, in _parse_sub
    itemsappend(_parse(source, state, verbose, nested + 1,
                ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                       not nested and not items))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\re\_parser.py", line 865, in _parse
    raise source.error("missing ), unterminated subpattern",
                       source.tell() - start)
re.PatternError: missing ), unterminated subpattern at position 1
 (status=1)
2025-10-22 00:52:22,063 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-22 00:52:22,063 - __main__ - ERROR - Failed to process data source <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x000001BC07698D70>: missing ), unterminated subpattern at position 1 (status=1)
2025-10-22 00:52:22,075 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x000001BC07698EC0>
2025-10-22 00:52:22,076 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-22 00:52:22,094 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7ba46c7369075e97c7f28"}}
2025-10-22 00:52:22,095 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7ba46c7369075e97c7f28"}, "previousDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 00:52:22,096 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,096 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 00:52:22,098 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}}
2025-10-22 00:52:22,098 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "remainingTimeMS": 4999}
2025-10-22 00:52:22,125 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7ba46c7369075e97c7f28"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 00:52:22,136 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7ba46c7369075e97c7f28"}, "driverConnectionId": 1, "serverConnectionId": 48330, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.673899970948696, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:52:21.684Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48330, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:52:22,137 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,138 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7ba46c7369075e97c7f28"}, "previousDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>"}
2025-10-22 00:52:22,139 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,139 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,139 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7ba46c7369075e97c7f28"}, "driverConnectionId": 1, "serverConnectionId": 48330, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:52:22,140 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:22,201 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.050172200019005686}
2025-10-22 00:52:22,201 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06193160003749654}
2025-10-22 00:52:22,202 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"I2t+811eSQmeE50UbkMpYw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,212 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "durationMS": 10.811, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,213 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:22,213 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-22 00:52:22,214 - backend.dataSources.roce_event - INFO - 查询时间范围: 2024-10-27 00:00:00 至 2025-10-22 00:52:22.214156
2025-10-22 00:52:22,214 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}}
2025-10-22 00:52:22,215 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,215 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,215 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002929000183939934}
2025-10-22 00:52:22,216 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761065542}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"I2t+811eSQmeE50UbkMpYw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,230 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "durationMS": 14.654, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 883}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,231 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:22,231 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}}
2025-10-22 00:52:22,231 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,232 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,232 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00028450001263991}
2025-10-22 00:52:22,233 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761065542}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"I2t+811eSQmeE50UbkMpYw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,289 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "durationMS": 56.149, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,289 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:22,290 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BC07943B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}}
2025-10-22 00:52:22,290 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BC07943B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7ba46c7369075e97c7f28, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009673899970948696>]>", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,290 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,291 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00021689996356144547}
2025-10-22 00:52:22,291 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "command": "{\"getMore\": 2252514195767960201, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"I2t+811eSQmeE50UbkMpYw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,467 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "durationMS": 175.956, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48332, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:22,468 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:22,468 - backend.dataSources.roce_event - INFO - 查询到 883 条记录，返回 883 条
2025-10-22 00:52:22,472 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-22 00:52:22,478 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 00:52:23,008 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 00:52:23,009 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 6 条记录
2025-10-22 00:52:23,014 - backend.dataSources.roce_event - INFO - 处理完成，共生成 883 条记录
2025-10-22 00:52:23,019 - data_loader - DEBUG - Loaded 883 records from MongoDB
2025-10-22 00:52:23,020 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-22 00:52:23,020 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间']
2025-10-22 00:52:23,021 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:52:23,022 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:52:23,022 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 00:52:23,023 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 00:52:23,023 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 00:52:23,024 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:52:23,024 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 00:52:23,024 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 00:52:23,025 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 00:52:23,025 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 00:52:23,026 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:52:23,026 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 00:52:23,027 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 00:52:23,027 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 00:52:23,028 - __main__ - INFO - Rebuilt table ROCE网络事件-网络零件（光模块+AOC）故障表 from ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 00:52:23,028 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:52:23,028 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:52:23,029 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 00:52:23,029 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 00:52:23,029 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 00:52:23,029 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:52:23,030 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 00:52:23,030 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 00:52:23,030 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 00:52:23,030 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 00:52:23,030 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:52:23,031 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 00:52:23,031 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 00:52:23,031 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 00:52:23,037 - __main__ - INFO - Inserted 883 records into table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 00:52:23,037 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x000001BC07699010>
2025-10-22 00:52:23,037 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-22 00:52:23,052 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-22 00:52:23,098 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 00:52:23,154 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.024317200004588813}
2025-10-22 00:52:23,155 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 00:52:23,197 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.020332800049800426}
2025-10-22 00:52:23,198 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 00:52:23,248 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023464799975045025}
2025-10-22 00:52:23,248 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 00:52:23,279 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7ba46c7369075e97c7f28"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.021756300004199147}
2025-10-22 00:52:23,283 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:23,366 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16453
2025-10-22 00:52:23,366 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16453)
2025-10-22 00:52:23,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:23,560 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15453（变化，之前=16453）
2025-10-22 00:52:23,561 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15453)
2025-10-22 00:52:23,690 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:23,734 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14453（变化，之前=15453）
2025-10-22 00:52:23,734 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14453)
2025-10-22 00:52:23,858 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:23,909 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13453（变化，之前=14453）
2025-10-22 00:52:23,909 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13453)
2025-10-22 00:52:24,031 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:24,062 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12453（变化，之前=13453）
2025-10-22 00:52:24,062 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12453)
2025-10-22 00:52:24,174 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:24,216 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11453（变化，之前=12453）
2025-10-22 00:52:24,217 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11453)
2025-10-22 00:52:24,323 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:24,363 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10453（变化，之前=11453）
2025-10-22 00:52:24,364 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10453)
2025-10-22 00:52:24,520 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:24,553 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9453（变化，之前=10453）
2025-10-22 00:52:24,554 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9453)
2025-10-22 00:52:24,680 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:24,717 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8453（变化，之前=9453）
2025-10-22 00:52:24,717 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8453)
2025-10-22 00:52:24,811 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:24,844 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7453（变化，之前=8453）
2025-10-22 00:52:24,844 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7453)
2025-10-22 00:52:24,935 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:24,973 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6453（变化，之前=7453）
2025-10-22 00:52:24,974 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6453)
2025-10-22 00:52:25,059 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:25,097 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5453（变化，之前=6453）
2025-10-22 00:52:25,098 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5453)
2025-10-22 00:52:25,180 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:25,211 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4453（变化，之前=5453）
2025-10-22 00:52:25,211 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4453)
2025-10-22 00:52:25,287 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:25,317 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3453（变化，之前=4453）
2025-10-22 00:52:25,317 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3453)
2025-10-22 00:52:25,392 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:25,421 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2453（变化，之前=3453）
2025-10-22 00:52:25,421 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2453)
2025-10-22 00:52:25,507 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:25,538 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1453（变化，之前=2453）
2025-10-22 00:52:25,539 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1453)
2025-10-22 00:52:25,606 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:52:25,627 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 453（变化，之前=1453）
2025-10-22 00:52:25,627 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 453 条，累计 16453 条 (reported total=453)
2025-10-22 00:52:25,676 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-22 00:52:25,677 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=453）
2025-10-22 00:52:25,677 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-22 00:52:25,678 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16453
2025-10-22 00:52:25,678 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-22 00:52:25,683 - data_loader - ERROR - Failed to load network device inventory data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\data_loader.py", line 281, in load_data
    data = query_network_device_inventory()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\network_device_inventory.py", line 210, in query_network_device_inventory
    return fetch_all_network_device_inventory()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\network_device_inventory.py", line 182, in fetch_all_network_device_inventory
    cluster, customer = get_cluster_info_from_hostname(hostname,is_roce_event=False)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\cluster_info.py", line 151, in get_cluster_info_from_hostname
    score_match = re.match(r'^(^([A-Z]+)-([A-Z0-9]+)-[A-Z0-9-]*SROCE_CORE-(\d+)_(\d+)_(\d+)_(\d+)(\.[A-Z0-9]+)?$', hostname)
  File "D:\python\Lib\re\__init__.py", line 167, in match
    return _compile(pattern, flags).match(string)
           ~~~~~~~~^^^^^^^^^^^^^^^^
  File "D:\python\Lib\re\__init__.py", line 350, in _compile
    p = _compiler.compile(pattern, flags)
  File "D:\python\Lib\re\_compiler.py", line 748, in compile
    p = _parser.parse(p, flags)
  File "D:\python\Lib\re\_parser.py", line 980, in parse
    p = _parse_sub(source, state, flags & SRE_FLAG_VERBOSE, 0)
  File "D:\python\Lib\re\_parser.py", line 459, in _parse_sub
    itemsappend(_parse(source, state, verbose, nested + 1,
                ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                       not nested and not items))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\re\_parser.py", line 865, in _parse
    raise source.error("missing ), unterminated subpattern",
                       source.tell() - start)
re.PatternError: missing ), unterminated subpattern at position 1
 (status=1)
2025-10-22 00:52:25,685 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-22 00:52:25,685 - __main__ - ERROR - Failed to process data source <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x000001BC07699010>: missing ), unterminated subpattern at position 1 (status=1)
2025-10-22 00:52:25,692 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000001BC07699160>
2025-10-22 00:52:25,692 - data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-22 00:52:25,718 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}}
2025-10-22 00:52:25,719 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}, "previousDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 00:52:25,719 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,720 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 00:52:25,722 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}}
2025-10-22 00:52:25,723 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "remainingTimeMS": 4999}
2025-10-22 00:52:25,731 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 00:52:25,742 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}, "driverConnectionId": 1, "serverConnectionId": 48337, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.692100040614605, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:52:25.290Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48337, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:52:25,743 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,743 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}, "previousDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>"}
2025-10-22 00:52:25,744 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,744 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}, "driverConnectionId": 1, "serverConnectionId": 48337, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:52:25,745 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,745 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:25,800 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04517409997060895}
2025-10-22 00:52:25,800 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05557210004189983}
2025-10-22 00:52:25,801 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"grUMPf43RcWewGIgfHBhWg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,813 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "durationMS": 12.094000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,814 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:25,814 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-22 00:52:25,815 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-24 00:00:00 至 2025-10-22 00:52:25.815336
2025-10-22 00:52:25,815 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}}
2025-10-22 00:52:25,816 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,817 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,817 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00044709997018799186}
2025-10-22 00:52:25,818 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:52:25.815Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"grUMPf43RcWewGIgfHBhWg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,840 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "durationMS": 21.909000000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,841 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:25,841 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}}
2025-10-22 00:52:25,842 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,843 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,843 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005387000273913145}
2025-10-22 00:52:25,844 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:52:25.815Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"grUMPf43RcWewGIgfHBhWg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,904 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "durationMS": 60.275000000000006, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,905 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:25,906 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BC07943B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}}
2025-10-22 00:52:25,906 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BC07943B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7ba49c7369075e97c7f29, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010692100040614605>]>", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,907 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,907 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003735999925993383}
2025-10-22 00:52:25,907 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "command": "{\"getMore\": 6247003552038314651, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"grUMPf43RcWewGIgfHBhWg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,954 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "durationMS": 46.747, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 48338, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:52:25,955 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:52:25,955 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-22 00:52:25,956 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-22 00:52:25,958 - data_loader - ERROR - Failed to load network device failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\data_loader.py", line 314, in load_data
    data = query_network_device_failure()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\network_device_failure.py", line 168, in query_network_device_failure
    cluster, customer = get_cluster_info_from_hostname(hostname,is_roce_event=False)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\dataSources\cluster_info.py", line 151, in get_cluster_info_from_hostname
    score_match = re.match(r'^(^([A-Z]+)-([A-Z0-9]+)-[A-Z0-9-]*SROCE_CORE-(\d+)_(\d+)_(\d+)_(\d+)(\.[A-Z0-9]+)?$', hostname)
  File "D:\python\Lib\re\__init__.py", line 167, in match
    return _compile(pattern, flags).match(string)
           ~~~~~~~~^^^^^^^^^^^^^^^^
  File "D:\python\Lib\re\__init__.py", line 350, in _compile
    p = _compiler.compile(pattern, flags)
  File "D:\python\Lib\re\_compiler.py", line 748, in compile
    p = _parser.parse(p, flags)
  File "D:\python\Lib\re\_parser.py", line 980, in parse
    p = _parse_sub(source, state, flags & SRE_FLAG_VERBOSE, 0)
  File "D:\python\Lib\re\_parser.py", line 459, in _parse_sub
    itemsappend(_parse(source, state, verbose, nested + 1,
                ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                       not nested and not items))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\re\_parser.py", line 865, in _parse
    raise source.error("missing ), unterminated subpattern",
                       source.tell() - start)
re.PatternError: missing ), unterminated subpattern at position 1
 (status=1)
2025-10-22 00:52:25,959 - data_loader - INFO - Network device failure data load completed (status=0)
2025-10-22 00:52:25,959 - __main__ - ERROR - Failed to process data source <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000001BC07699160>: missing ), unterminated subpattern at position 1 (status=1)
2025-10-22 00:52:25,983 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=1)
2025-10-22 00:52:26,247 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7ba49c7369075e97c7f29"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 501.94260000716895, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-22 00:53:59,572 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-22 00:53:59,573 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-22 00:53:59,573 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 00:53:59,573 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-22 00:53:59,573 - data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-22 00:53:59,573 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-22 00:53:59,575 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x000002D1FB9A8C20>
2025-10-22 00:53:59,575 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-22 00:53:59,727 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}}
2025-10-22 00:53:59,728 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "previousDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 00:53:59,728 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,728 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 00:53:59,730 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}}
2025-10-22 00:53:59,731 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "remainingTimeMS": 4999}
2025-10-22 00:53:59,765 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 00:53:59,775 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.433900006115437, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:53:59.322Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:53:59,776 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,776 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "previousDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>"}
2025-10-22 00:53:59,777 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,777 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:53:59,777 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,778 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:53:59,850 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03763420000905171}
2025-10-22 00:53:59,850 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07282850000774488}
2025-10-22 00:53:59,851 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VUGlyQkJRVW0qnDOvivosg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,860 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "durationMS": 9.187000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,860 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:53:59,861 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-22 00:53:59,861 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-24 00:00:00 至 2025-10-22 00:53:59.861346
2025-10-22 00:53:59,861 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}}
2025-10-22 00:53:59,862 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,862 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,862 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022039999021217227}
2025-10-22 00:53:59,863 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:53:59.861Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VUGlyQkJRVW0qnDOvivosg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,882 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "durationMS": 19.605, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,883 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:53:59,883 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}}
2025-10-22 00:53:59,884 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,884 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:53:59,884 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00021079997532069683}
2025-10-22 00:53:59,884 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:53:59.861Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VUGlyQkJRVW0qnDOvivosg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:54:00,019 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "durationMS": 135.074, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:54:00,023 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:54:00,024 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D1FBC53B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}}
2025-10-22 00:54:00,025 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D1FBC53B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7baa75fab2263780d905b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009433900006115437>]>", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:54:00,026 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:54:00,026 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005597000126726925}
2025-10-22 00:54:00,027 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "command": "{\"getMore\": 6407407735243160812, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VUGlyQkJRVW0qnDOvivosg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:54:00,527 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "durationMS": 500.04400000000004, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48342, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:54:00,528 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:54:00,529 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-22 00:54:00,545 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-22 00:54:00,548 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-22 00:54:00,548 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-22 00:54:00,549 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-22 00:54:00,549 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:54:00,551 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 00:54:00,552 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:54:00,552 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 00:54:00,553 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-22 00:54:00,553 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 00:54:00,554 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:54:00,554 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-22 00:54:00,555 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 00:54:00,555 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 00:54:00,555 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:54:00,555 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:54:00,556 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:54:00,556 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-22 00:54:00,556 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 00:54:00,556 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 00:54:00,556 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-22 00:54:00,583 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-22 00:54:00,583 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:54:00,583 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 00:54:00,584 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:54:00,584 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 00:54:00,584 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-22 00:54:00,584 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 00:54:00,584 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:54:00,585 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-22 00:54:00,585 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 00:54:00,585 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 00:54:00,585 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:54:00,585 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:54:00,586 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:54:00,586 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-22 00:54:00,586 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 00:54:00,586 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 00:54:00,586 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-22 00:54:00,595 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-22 00:54:00,596 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x000002D1FB9A8D70>
2025-10-22 00:54:00,596 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-22 00:54:00,617 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-22 00:54:00,731 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 00:54:00,783 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02230389998294413}
2025-10-22 00:54:00,783 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 00:54:00,813 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.020831699948757887}
2025-10-22 00:54:00,814 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 00:54:00,845 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.02144159999443218}
2025-10-22 00:54:00,845 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 00:54:00,877 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baa75fab2263780d905b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.021046600013505667}
2025-10-22 00:54:01,613 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:01,657 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104338
2025-10-22 00:54:01,658 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104338)
2025-10-22 00:54:02,684 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:02,721 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103338（变化，之前=104338）
2025-10-22 00:54:02,721 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103338)
2025-10-22 00:54:03,703 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:03,743 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102338（变化，之前=103338）
2025-10-22 00:54:03,743 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102338)
2025-10-22 00:54:04,721 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:04,762 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101338（变化，之前=102338）
2025-10-22 00:54:04,763 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101338)
2025-10-22 00:54:05,740 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:05,777 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100338（变化，之前=101338）
2025-10-22 00:54:05,777 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100338)
2025-10-22 00:54:06,729 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:06,766 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99338（变化，之前=100338）
2025-10-22 00:54:06,766 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99338)
2025-10-22 00:54:07,731 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:07,769 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98338（变化，之前=99338）
2025-10-22 00:54:07,769 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98338)
2025-10-22 00:54:08,729 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:08,765 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97338（变化，之前=98338）
2025-10-22 00:54:08,765 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97338)
2025-10-22 00:54:09,719 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:09,759 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96338（变化，之前=97338）
2025-10-22 00:54:09,759 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96338)
2025-10-22 00:54:09,797 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10019.031999981962, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:54:09.344Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:54:09,798 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:54:10,708 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:10,746 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95338（变化，之前=96338）
2025-10-22 00:54:10,747 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95338)
2025-10-22 00:54:11,717 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:11,760 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94338（变化，之前=95338）
2025-10-22 00:54:11,760 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94338)
2025-10-22 00:54:12,747 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:12,804 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93338（变化，之前=94338）
2025-10-22 00:54:12,806 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93338)
2025-10-22 00:54:13,851 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:13,919 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92338（变化，之前=93338）
2025-10-22 00:54:13,920 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92338)
2025-10-22 00:54:14,878 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:14,923 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91338（变化，之前=92338）
2025-10-22 00:54:14,925 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91338)
2025-10-22 00:54:15,839 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:15,879 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90338（变化，之前=91338）
2025-10-22 00:54:15,880 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90338)
2025-10-22 00:54:16,789 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:16,825 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89338（变化，之前=90338）
2025-10-22 00:54:16,826 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89338)
2025-10-22 00:54:17,733 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:17,828 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88338（变化，之前=89338）
2025-10-22 00:54:17,829 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88338)
2025-10-22 00:54:18,754 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:18,808 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87338（变化，之前=88338）
2025-10-22 00:54:18,809 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87338)
2025-10-22 00:54:19,711 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:19,825 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86338（变化，之前=87338）
2025-10-22 00:54:19,826 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10027.244199998677, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:54:19.353Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:54:19,832 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:54:19,827 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86338)
2025-10-22 00:54:20,775 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:20,980 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85338（变化，之前=86338）
2025-10-22 00:54:20,988 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85338)
2025-10-22 00:54:21,956 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:21,998 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84338（变化，之前=85338）
2025-10-22 00:54:21,999 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84338)
2025-10-22 00:54:22,907 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:22,948 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83338（变化，之前=84338）
2025-10-22 00:54:22,949 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83338)
2025-10-22 00:54:23,847 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:23,892 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82338（变化，之前=83338）
2025-10-22 00:54:23,893 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82338)
2025-10-22 00:54:24,789 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:24,849 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81338（变化，之前=82338）
2025-10-22 00:54:24,862 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81338)
2025-10-22 00:54:25,816 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:25,860 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80338（变化，之前=81338）
2025-10-22 00:54:25,860 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80338)
2025-10-22 00:54:26,777 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:26,831 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79338（变化，之前=80338）
2025-10-22 00:54:26,834 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79338)
2025-10-22 00:54:27,704 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:27,747 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78338（变化，之前=79338）
2025-10-22 00:54:27,747 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78338)
2025-10-22 00:54:28,590 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:28,636 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77338（变化，之前=78338）
2025-10-22 00:54:28,637 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77338)
2025-10-22 00:54:29,476 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:29,535 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76338（变化，之前=77338）
2025-10-22 00:54:29,536 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76338)
2025-10-22 00:54:29,817 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9983.457499998622, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:54:29.364Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:54:29,818 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:54:30,406 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:30,456 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75338（变化，之前=76338）
2025-10-22 00:54:30,456 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75338)
2025-10-22 00:54:31,337 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:31,378 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74338（变化，之前=75338）
2025-10-22 00:54:31,378 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74338)
2025-10-22 00:54:32,217 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:32,267 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73338（变化，之前=74338）
2025-10-22 00:54:32,268 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73338)
2025-10-22 00:54:33,149 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:33,206 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72338（变化，之前=73338）
2025-10-22 00:54:33,207 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72338)
2025-10-22 00:54:34,054 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:34,096 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71338（变化，之前=72338）
2025-10-22 00:54:34,097 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71338)
2025-10-22 00:54:34,925 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:34,968 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70338（变化，之前=71338）
2025-10-22 00:54:34,968 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70338)
2025-10-22 00:54:35,869 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:35,908 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69338（变化，之前=70338）
2025-10-22 00:54:35,909 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69338)
2025-10-22 00:54:36,736 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:36,781 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68338（变化，之前=69338）
2025-10-22 00:54:36,782 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68338)
2025-10-22 00:54:37,605 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:37,647 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67338（变化，之前=68338）
2025-10-22 00:54:37,647 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67338)
2025-10-22 00:54:38,463 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:38,498 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66338（变化，之前=67338）
2025-10-22 00:54:38,499 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66338)
2025-10-22 00:54:39,308 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:39,353 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65338（变化，之前=66338）
2025-10-22 00:54:39,353 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65338)
2025-10-22 00:54:39,824 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10004.968799999915, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:54:39.371Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:54:39,826 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:54:40,173 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:40,210 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64338（变化，之前=65338）
2025-10-22 00:54:40,210 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64338)
2025-10-22 00:54:41,060 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:41,102 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63338（变化，之前=64338）
2025-10-22 00:54:41,103 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63338)
2025-10-22 00:54:41,958 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:41,998 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62338（变化，之前=63338）
2025-10-22 00:54:41,999 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62338)
2025-10-22 00:54:42,862 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:42,900 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61338（变化，之前=62338）
2025-10-22 00:54:42,901 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61338)
2025-10-22 00:54:43,715 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:43,751 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60338（变化，之前=61338）
2025-10-22 00:54:43,752 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60338)
2025-10-22 00:54:44,511 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:44,559 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59338（变化，之前=60338）
2025-10-22 00:54:44,559 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59338)
2025-10-22 00:54:45,333 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:45,411 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58338（变化，之前=59338）
2025-10-22 00:54:45,412 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58338)
2025-10-22 00:54:46,221 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:46,289 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57338（变化，之前=58338）
2025-10-22 00:54:46,291 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57338)
2025-10-22 00:54:47,094 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:47,136 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56338（变化，之前=57338）
2025-10-22 00:54:47,136 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56338)
2025-10-22 00:54:47,910 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:47,952 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55338（变化，之前=56338）
2025-10-22 00:54:47,955 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55338)
2025-10-22 00:54:48,723 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:48,766 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54338（变化，之前=55338）
2025-10-22 00:54:48,766 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54338)
2025-10-22 00:54:49,502 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:49,540 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53338（变化，之前=54338）
2025-10-22 00:54:49,541 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53338)
2025-10-22 00:54:49,833 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10006.080699968152, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:54:49.380Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:54:49,834 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:54:50,255 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:50,343 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52338（变化，之前=53338）
2025-10-22 00:54:50,387 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52338)
2025-10-22 00:54:51,158 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:51,304 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51338（变化，之前=52338）
2025-10-22 00:54:51,306 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51338)
2025-10-22 00:54:52,015 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:52,075 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50338（变化，之前=51338）
2025-10-22 00:54:52,079 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50338)
2025-10-22 00:54:52,824 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:52,884 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49338（变化，之前=50338）
2025-10-22 00:54:52,885 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49338)
2025-10-22 00:54:53,556 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:53,602 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48338（变化，之前=49338）
2025-10-22 00:54:53,604 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48338)
2025-10-22 00:54:54,259 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:54,304 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47338（变化，之前=48338）
2025-10-22 00:54:54,305 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47338)
2025-10-22 00:54:54,982 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:55,040 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46338（变化，之前=47338）
2025-10-22 00:54:55,042 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46338)
2025-10-22 00:54:55,704 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:55,755 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45338（变化，之前=46338）
2025-10-22 00:54:55,756 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45338)
2025-10-22 00:54:56,382 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:56,417 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44338（变化，之前=45338）
2025-10-22 00:54:56,418 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44338)
2025-10-22 00:54:57,032 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:57,065 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43338（变化，之前=44338）
2025-10-22 00:54:57,065 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43338)
2025-10-22 00:54:57,695 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:57,785 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42338（变化，之前=43338）
2025-10-22 00:54:57,785 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42338)
2025-10-22 00:54:58,380 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:58,415 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41338（变化，之前=42338）
2025-10-22 00:54:58,418 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41338)
2025-10-22 00:54:59,010 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:59,040 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40338（变化，之前=41338）
2025-10-22 00:54:59,041 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40338)
2025-10-22 00:54:59,623 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:54:59,685 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39338（变化，之前=40338）
2025-10-22 00:54:59,692 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39338)
2025-10-22 00:54:59,843 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10008.936099999119, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:54:59.389Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:54:59,844 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:55:00,269 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:00,305 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38338（变化，之前=39338）
2025-10-22 00:55:00,306 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38338)
2025-10-22 00:55:00,861 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:00,899 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37338（变化，之前=38338）
2025-10-22 00:55:00,900 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37338)
2025-10-22 00:55:01,445 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:01,480 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36338（变化，之前=37338）
2025-10-22 00:55:01,481 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36338)
2025-10-22 00:55:02,019 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:02,060 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35338（变化，之前=36338）
2025-10-22 00:55:02,061 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35338)
2025-10-22 00:55:02,615 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:02,654 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34338（变化，之前=35338）
2025-10-22 00:55:02,655 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34338)
2025-10-22 00:55:03,169 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:03,204 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33338（变化，之前=34338）
2025-10-22 00:55:03,205 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33338)
2025-10-22 00:55:03,721 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:03,774 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32338（变化，之前=33338）
2025-10-22 00:55:03,780 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32338)
2025-10-22 00:55:04,294 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:04,343 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31338（变化，之前=32338）
2025-10-22 00:55:04,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31338)
2025-10-22 00:55:04,842 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:04,889 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30338（变化，之前=31338）
2025-10-22 00:55:04,890 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30338)
2025-10-22 00:55:05,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:05,418 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29338（变化，之前=30338）
2025-10-22 00:55:05,419 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29338)
2025-10-22 00:55:05,882 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:05,921 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28338（变化，之前=29338）
2025-10-22 00:55:05,922 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28338)
2025-10-22 00:55:06,381 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:06,418 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27338（变化，之前=28338）
2025-10-22 00:55:06,419 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27338)
2025-10-22 00:55:06,877 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:06,912 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26338（变化，之前=27338）
2025-10-22 00:55:06,913 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26338)
2025-10-22 00:55:07,379 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:07,419 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25338（变化，之前=26338）
2025-10-22 00:55:07,420 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25338)
2025-10-22 00:55:07,883 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:07,920 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24338（变化，之前=25338）
2025-10-22 00:55:07,921 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24338)
2025-10-22 00:55:08,365 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:08,478 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23338（变化，之前=24338）
2025-10-22 00:55:08,479 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23338)
2025-10-22 00:55:08,885 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:08,917 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22338（变化，之前=23338）
2025-10-22 00:55:08,918 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22338)
2025-10-22 00:55:09,272 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:09,302 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21338（变化，之前=22338）
2025-10-22 00:55:09,304 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21338)
2025-10-22 00:55:09,632 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:09,663 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20338（变化，之前=21338）
2025-10-22 00:55:09,664 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20338)
2025-10-22 00:55:09,853 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10007.283799990546, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:55:09.399Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48340, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:55:09,856 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baa75fab2263780d905b"}, "driverConnectionId": 1, "serverConnectionId": 48340, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:55:10,002 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:10,039 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19338（变化，之前=20338）
2025-10-22 00:55:10,043 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19338)
2025-10-22 00:55:10,367 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:10,412 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18338（变化，之前=19338）
2025-10-22 00:55:10,413 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18338)
2025-10-22 00:55:10,719 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:10,749 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17338（变化，之前=18338）
2025-10-22 00:55:10,751 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17338)
2025-10-22 00:55:11,039 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:11,073 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16338（变化，之前=17338）
2025-10-22 00:55:11,075 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16338)
2025-10-22 00:55:11,343 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:11,376 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15338（变化，之前=16338）
2025-10-22 00:55:11,377 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15338)
2025-10-22 00:55:11,628 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:11,817 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14338（变化，之前=15338）
2025-10-22 00:55:11,818 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14338)
2025-10-22 00:55:12,060 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:12,092 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13338（变化，之前=14338）
2025-10-22 00:55:12,149 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13338)
2025-10-22 00:55:12,469 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:12,498 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12338（变化，之前=13338）
2025-10-22 00:55:12,499 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12338)
2025-10-22 00:55:12,724 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:12,807 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11338（变化，之前=12338）
2025-10-22 00:55:12,808 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11338)
2025-10-22 00:55:13,031 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:13,150 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10338（变化，之前=11338）
2025-10-22 00:55:13,151 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10338)
2025-10-22 00:55:13,353 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:13,411 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9338（变化，之前=10338）
2025-10-22 00:55:13,412 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9338)
2025-10-22 00:55:13,593 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:13,636 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8338（变化，之前=9338）
2025-10-22 00:55:13,637 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8338)
2025-10-22 00:55:13,807 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:13,861 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7338（变化，之前=8338）
2025-10-22 00:55:13,864 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7338)
2025-10-22 00:55:14,027 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:14,065 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6338（变化，之前=7338）
2025-10-22 00:55:14,066 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6338)
2025-10-22 00:55:14,220 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:14,255 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5338（变化，之前=6338）
2025-10-22 00:55:14,257 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5338)
2025-10-22 00:55:14,396 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:14,507 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4338（变化，之前=5338）
2025-10-22 00:55:14,509 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4338)
2025-10-22 00:55:14,639 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:14,674 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3338（变化，之前=4338）
2025-10-22 00:55:14,675 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3338)
2025-10-22 00:55:14,759 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:14,796 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2338（变化，之前=3338）
2025-10-22 00:55:14,801 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2338)
2025-10-22 00:55:14,874 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:14,915 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1338（变化，之前=2338）
2025-10-22 00:55:14,916 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1338)
2025-10-22 00:55:15,006 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 00:55:15,014 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 338（变化，之前=1338）
2025-10-22 00:55:15,016 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 338 条，累计已去重 104000 条 (reported total=338)
2025-10-22 00:55:15,065 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-22 00:55:15,067 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=338）
2025-10-22 00:55:15,069 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-22 00:55:15,070 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-22 00:55:15,071 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-22 00:55:15,072 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-22 00:55:15,074 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-22 00:55:15,075 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-22 00:55:15,076 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-22 00:55:15,077 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-22 00:55:15,078 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-22 00:55:15,078 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-22 00:55:15,079 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-22 00:55:15,080 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-22 00:55:15,083 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-22 00:55:15,084 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-22 00:55:15,087 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-22 00:55:15,088 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-22 00:55:15,092 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-22 00:55:15,096 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-22 00:55:15,097 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-22 00:55:15,099 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-22 00:55:15,101 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-22 00:55:15,102 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-22 00:55:15,103 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-22 00:55:15,105 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-22 00:55:15,106 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-22 00:55:15,107 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-22 00:55:15,108 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-22 00:55:15,110 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-22 00:55:15,111 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-22 00:55:15,113 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-22 00:55:15,114 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-22 00:55:15,115 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-22 00:55:15,116 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-22 00:55:15,118 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-22 00:55:15,119 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-22 00:55:15,123 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-22 00:55:15,129 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-22 00:55:15,130 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-22 00:55:15,132 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-22 00:55:15,135 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-22 00:55:15,137 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-22 00:55:15,140 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-22 00:55:15,141 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-22 00:55:15,142 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-22 00:55:15,146 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-22 00:55:15,147 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-22 00:55:15,148 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-22 00:55:15,157 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-22 00:55:15,160 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-22 00:55:15,164 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-22 00:55:15,166 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-22 00:55:15,169 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-22 00:55:15,174 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-22 00:55:15,176 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-22 00:55:15,179 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-22 00:55:15,181 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-22 00:55:15,183 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-22 00:55:15,185 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-22 00:55:15,190 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-22 00:55:15,194 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-22 00:55:15,197 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-22 00:55:15,204 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-22 00:55:15,208 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-22 00:55:15,211 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-22 00:55:15,213 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-22 00:55:15,214 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-22 00:55:15,222 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-22 00:55:15,224 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-22 00:55:15,230 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-22 00:55:15,239 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-22 00:55:15,244 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-22 00:55:15,247 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-22 00:55:15,255 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-22 00:55:15,261 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-22 00:55:15,265 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-22 00:55:15,275 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-22 00:55:15,280 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-22 00:55:15,284 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-22 00:55:15,292 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-22 00:55:15,295 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-22 00:55:15,296 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-22 00:55:15,299 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-22 00:55:15,301 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-22 00:55:15,302 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-22 00:55:15,308 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-22 00:55:15,309 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-22 00:55:15,313 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-22 00:55:15,315 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-22 00:55:15,327 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-22 00:55:15,329 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-22 00:55:15,331 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-22 00:55:15,333 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-22 00:55:15,339 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-22 00:55:15,343 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-22 00:55:15,344 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-22 00:55:15,346 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-22 00:55:15,347 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-22 00:55:15,347 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-22 00:55:15,360 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-22 00:55:15,365 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-22 00:55:15,368 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-22 00:55:15,374 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-22 00:55:15,376 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-22 00:55:15,377 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-22 00:55:15,378 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-22 00:55:15,379 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-22 00:55:15,382 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 338 条
2025-10-22 00:55:15,389 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104338
2025-10-22 00:55:15,393 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-22 00:55:17,854 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1133 条记录
2025-10-22 00:55:17,898 - data_loader - DEBUG - Loaded 1133 records from API
2025-10-22 00:55:17,899 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-22 00:55:17,900 - __main__ - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-22 00:55:17,901 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-22 00:55:17,902 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 00:55:17,903 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 00:55:17,904 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:17,906 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:17,908 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:55:17,909 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-22 00:55:17,919 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-22 00:55:17,921 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-22 00:55:17,921 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 00:55:17,922 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 00:55:17,923 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:17,924 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:17,924 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:55:17,925 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-22 00:55:17,940 - __main__ - INFO - Inserted 1133 records into table 光模块在线总数量统计表
2025-10-22 00:55:17,941 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x000002D1FB9A8EC0>
2025-10-22 00:55:17,942 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-22 00:55:17,951 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7baf55fab2263780d905c"}}
2025-10-22 00:55:17,953 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7baf55fab2263780d905c"}, "previousDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 00:55:17,954 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:17,956 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 00:55:17,959 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}}
2025-10-22 00:55:17,961 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "remainingTimeMS": 4997}
2025-10-22 00:55:17,970 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baf55fab2263780d905c"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 00:55:17,984 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7baf55fab2263780d905c"}, "driverConnectionId": 1, "serverConnectionId": 48349, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.977099988143891, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:55:17.535Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48349, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:55:17,985 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:17,987 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7baf55fab2263780d905c"}, "previousDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>"}
2025-10-22 00:55:17,988 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:17,989 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7baf55fab2263780d905c"}, "driverConnectionId": 1, "serverConnectionId": 48349, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:55:17,991 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:17,993 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:18,097 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09149650001199916}
2025-10-22 00:55:18,098 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.10732070001540706}
2025-10-22 00:55:18,099 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9DHCetTrQeyDym3uUwAjSA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,115 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "durationMS": 15.082999999999998, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,116 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:18,120 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-22 00:55:18,120 - backend.dataSources.roce_event - INFO - 查询时间范围: 2024-10-27 00:00:00 至 2025-10-22 00:55:18.120733
2025-10-22 00:55:18,121 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}}
2025-10-22 00:55:18,123 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,126 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,127 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009813000215217471}
2025-10-22 00:55:18,128 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761065718}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9DHCetTrQeyDym3uUwAjSA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,147 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "durationMS": 18.772000000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 883}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,150 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:18,151 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}}
2025-10-22 00:55:18,153 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,155 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,157 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002509400015696883}
2025-10-22 00:55:18,159 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761065718}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9DHCetTrQeyDym3uUwAjSA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,224 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "durationMS": 64.97699999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,227 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:18,228 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D1FBC53B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}}
2025-10-22 00:55:18,229 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D1FBC53B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7baf55fab2263780d905c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011977099988143891>]>", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,230 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,232 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001233500021044165}
2025-10-22 00:55:18,233 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "command": "{\"getMore\": 7892903777121605082, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9DHCetTrQeyDym3uUwAjSA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,442 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "durationMS": 209.649, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48351, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:18,445 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:18,448 - backend.dataSources.roce_event - INFO - 查询到 883 条记录，返回 883 条
2025-10-22 00:55:18,464 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-22 00:55:18,477 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 00:55:18,964 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 00:55:19,030 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02328920003492385}
2025-10-22 00:55:19,032 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 00:55:19,078 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.025060900021344423}
2025-10-22 00:55:19,080 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 00:55:19,143 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.027010600024368614}
2025-10-22 00:55:19,144 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 00:55:19,183 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7baf55fab2263780d905c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.023520099988672882}
2025-10-22 00:55:20,092 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 00:55:20,093 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 6 条记录
2025-10-22 00:55:20,101 - backend.dataSources.roce_event - INFO - 处理完成，共生成 883 条记录
2025-10-22 00:55:20,109 - data_loader - DEBUG - Loaded 883 records from MongoDB
2025-10-22 00:55:20,111 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-22 00:55:20,116 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间']
2025-10-22 00:55:20,120 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:55:20,126 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:55:20,127 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 00:55:20,128 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 00:55:20,132 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 00:55:20,136 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:20,139 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 00:55:20,141 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 00:55:20,142 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 00:55:20,144 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 00:55:20,145 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:20,148 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 00:55:20,152 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 00:55:20,154 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 00:55:20,160 - __main__ - INFO - Rebuilt table ROCE网络事件-网络零件（光模块+AOC）故障表 from ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 00:55:20,162 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:55:20,165 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:55:20,166 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 00:55:20,168 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 00:55:20,171 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 00:55:20,174 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:20,175 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 00:55:20,176 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 00:55:20,177 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 00:55:20,178 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 00:55:20,185 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:20,187 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 00:55:20,189 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 00:55:20,192 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 00:55:20,225 - __main__ - INFO - Inserted 883 records into table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 00:55:20,314 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x000002D1FB9A9010>
2025-10-22 00:55:20,369 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-22 00:55:20,405 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-22 00:55:20,653 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:20,748 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16453
2025-10-22 00:55:20,748 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16453)
2025-10-22 00:55:20,887 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:20,958 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15453（变化，之前=16453）
2025-10-22 00:55:20,959 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15453)
2025-10-22 00:55:21,095 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:21,163 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14453（变化，之前=15453）
2025-10-22 00:55:21,164 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14453)
2025-10-22 00:55:21,293 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:21,366 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13453（变化，之前=14453）
2025-10-22 00:55:21,368 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13453)
2025-10-22 00:55:21,503 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:21,569 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12453（变化，之前=13453）
2025-10-22 00:55:21,571 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12453)
2025-10-22 00:55:21,692 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:21,805 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11453（变化，之前=12453）
2025-10-22 00:55:21,806 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11453)
2025-10-22 00:55:21,945 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:22,016 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10453（变化，之前=11453）
2025-10-22 00:55:22,017 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10453)
2025-10-22 00:55:22,142 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:22,212 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9453（变化，之前=10453）
2025-10-22 00:55:22,214 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9453)
2025-10-22 00:55:22,333 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:22,400 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8453（变化，之前=9453）
2025-10-22 00:55:22,401 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8453)
2025-10-22 00:55:22,525 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:22,680 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7453（变化，之前=8453）
2025-10-22 00:55:22,681 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7453)
2025-10-22 00:55:22,815 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:22,962 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6453（变化，之前=7453）
2025-10-22 00:55:22,964 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6453)
2025-10-22 00:55:23,061 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:23,133 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5453（变化，之前=6453）
2025-10-22 00:55:23,134 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5453)
2025-10-22 00:55:23,237 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:23,308 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4453（变化，之前=5453）
2025-10-22 00:55:23,308 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4453)
2025-10-22 00:55:23,395 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:23,466 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3453（变化，之前=4453）
2025-10-22 00:55:23,469 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3453)
2025-10-22 00:55:23,541 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:23,627 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2453（变化，之前=3453）
2025-10-22 00:55:23,628 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2453)
2025-10-22 00:55:23,696 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:23,762 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1453（变化，之前=2453）
2025-10-22 00:55:23,764 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1453)
2025-10-22 00:55:23,823 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 00:55:23,850 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 453（变化，之前=1453）
2025-10-22 00:55:23,851 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 453 条，累计 16453 条 (reported total=453)
2025-10-22 00:55:23,897 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-22 00:55:23,898 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=453）
2025-10-22 00:55:23,899 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-22 00:55:23,900 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16453
2025-10-22 00:55:23,902 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-22 00:55:24,341 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16453 条记录
2025-10-22 00:55:24,352 - data_loader - DEBUG - Loaded 16453 records from API
2025-10-22 00:55:24,356 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-22 00:55:24,360 - __main__ - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-22 00:55:24,366 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:55:24,368 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-22 00:55:24,370 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-22 00:55:24,374 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-22 00:55:24,381 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:24,384 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-22 00:55:24,386 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-22 00:55:24,391 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:24,400 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:55:24,404 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-22 00:55:24,407 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-22 00:55:24,408 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-22 00:55:24,411 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-22 00:55:24,434 - __main__ - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-22 00:55:24,435 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:55:24,435 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-22 00:55:24,438 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-22 00:55:24,440 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-22 00:55:24,442 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:24,446 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-22 00:55:24,448 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-22 00:55:24,449 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:24,450 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:55:24,451 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-22 00:55:24,451 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-22 00:55:24,453 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-22 00:55:24,455 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-22 00:55:24,909 - __main__ - INFO - Inserted 16453 records into table 网络设备总数量表
2025-10-22 00:55:24,910 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x000002D1FB9A9160>
2025-10-22 00:55:24,912 - data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-22 00:55:24,946 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}}
2025-10-22 00:55:24,947 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}, "previousDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 00:55:24,948 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:24,951 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 00:55:24,955 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}}
2025-10-22 00:55:24,959 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "remainingTimeMS": 4996}
2025-10-22 00:55:24,965 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 00:55:24,978 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}, "driverConnectionId": 1, "serverConnectionId": 48356, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.836799967568368, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T16:55:24.530Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48356, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 00:55:24,981 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:24,982 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}, "previousDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>"}
2025-10-22 00:55:24,984 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:24,985 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}, "driverConnectionId": 1, "serverConnectionId": 48356, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 00:55:24,987 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:24,991 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:25,082 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0780928999884054}
2025-10-22 00:55:25,083 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09626309998566285}
2025-10-22 00:55:25,084 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bjzH3FMGQg2PymWn3YHxag==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,095 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "durationMS": 10.728, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,096 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:25,098 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-22 00:55:25,099 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-24 00:00:00 至 2025-10-22 00:55:25.099844
2025-10-22 00:55:25,101 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}}
2025-10-22 00:55:25,105 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,107 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,108 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011591000366024673}
2025-10-22 00:55:25,110 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:55:25.099Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bjzH3FMGQg2PymWn3YHxag==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,139 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "durationMS": 29.796, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,141 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:25,144 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}}
2025-10-22 00:55:25,149 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,151 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,152 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009425000171177089}
2025-10-22 00:55:25,153 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T00:55:25.099Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bjzH3FMGQg2PymWn3YHxag==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,226 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "durationMS": 73.26599999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,230 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:25,231 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D1FBC53B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}}
2025-10-22 00:55:25,232 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D1FBC53B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bafc5fab2263780d905d, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011836799967568368>]>", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,234 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011235999991185963}
2025-10-22 00:55:25,236 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "command": "{\"getMore\": 1967403147933930805, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bjzH3FMGQg2PymWn3YHxag==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,313 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "durationMS": 76.89, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 48358, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 00:55:25,316 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 00:55:25,317 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-22 00:55:25,318 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-22 00:55:25,328 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-22 00:55:25,331 - data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-22 00:55:25,332 - data_loader - INFO - Network device failure data load completed (status=0)
2025-10-22 00:55:25,338 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-22 00:55:25,339 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:55:25,340 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 00:55:25,342 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:55:25,343 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:55:25,344 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:25,346 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:25,349 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:55:25,351 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-22 00:55:25,352 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-22 00:55:25,353 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 00:55:25,355 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 00:55:25,356 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 00:55:25,357 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 00:55:25,358 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-22 00:55:25,359 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-22 00:55:25,361 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-22 00:55:25,367 - __main__ - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-22 00:55:25,369 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 00:55:25,370 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 00:55:25,371 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 00:55:25,372 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 00:55:25,372 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 00:55:25,373 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 00:55:25,374 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 00:55:25,375 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-22 00:55:25,376 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-22 00:55:25,377 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 00:55:25,378 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 00:55:25,383 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 00:55:25,383 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 00:55:25,385 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-22 00:55:25,385 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-22 00:55:25,386 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-22 00:55:25,410 - __main__ - INFO - Inserted 309 records into table 网络设备故障表
2025-10-22 00:55:25,462 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-22 00:55:25,489 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7bafc5fab2263780d905d"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 503.67430003825575, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-22 01:06:15,149 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-22 01:06:15,150 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-22 01:06:15,150 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 01:06:15,150 - data_loader - DEBUG - Initialized NetworkDeviceInventoryDataSourceLoader with table 网络设备总数量表
2025-10-22 01:06:15,150 - data_loader - DEBUG - Initialized NetworkDeviceFailureDataSourceLoader with table 网络设备故障表
2025-10-22 01:06:15,150 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-22 01:06:15,151 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000013EE4AD8C20>
2025-10-22 01:06:15,151 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-22 01:06:15,411 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}}
2025-10-22 01:06:15,412 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "previousDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 01:06:15,412 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,412 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 01:06:15,414 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}}
2025-10-22 01:06:15,414 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "remainingTimeMS": 4999}
2025-10-22 01:06:15,446 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 01:06:15,460 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.936599960085005, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:06:15.020Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:06:15,461 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,462 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "previousDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>"}
2025-10-22 01:06:15,462 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,463 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,464 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:06:15,464 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:06:15,513 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03906360000837594}
2025-10-22 01:06:15,513 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04979069996625185}
2025-10-22 01:06:15,513 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8755eX3oQKaeTS+W/llDpQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,523 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "durationMS": 9.280999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,523 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:06:15,524 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-22 01:06:15,524 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-24 00:00:00 至 2025-10-22 01:06:15.524671
2025-10-22 01:06:15,525 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}}
2025-10-22 01:06:15,525 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,526 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,526 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022079999325796962}
2025-10-22 01:06:15,526 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T01:06:15.524Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8755eX3oQKaeTS+W/llDpQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,544 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "durationMS": 17.968, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,545 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:06:15,545 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}}
2025-10-22 01:06:15,545 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,546 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,546 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022869999520480633}
2025-10-22 01:06:15,546 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T01:06:15.524Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8755eX3oQKaeTS+W/llDpQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,611 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "durationMS": 64.477, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,613 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:06:15,614 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000013EE4D83B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}}
2025-10-22 01:06:15,614 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000013EE4D83B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bd87ea84e7630fd443e1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012936599960085005>]>", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,615 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,615 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00029469997389242053}
2025-10-22 01:06:15,615 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "command": "{\"getMore\": 925446431776030101, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8755eX3oQKaeTS+W/llDpQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,870 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "durationMS": 254.96999999999997, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48365, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:06:15,871 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:06:15,872 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-22 01:06:15,885 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-22 01:06:15,888 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-22 01:06:15,888 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-22 01:06:15,888 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-22 01:06:15,889 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:06:15,890 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 01:06:15,891 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:06:15,891 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 01:06:15,891 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-22 01:06:15,892 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 01:06:15,892 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 01:06:15,893 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-22 01:06:15,893 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 01:06:15,893 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 01:06:15,893 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:06:15,894 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:06:15,894 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:06:15,894 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-22 01:06:15,894 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 01:06:15,895 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 01:06:15,895 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-22 01:06:15,932 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-22 01:06:15,932 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:06:15,933 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 01:06:15,933 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:06:15,933 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 01:06:15,933 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-22 01:06:15,933 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 01:06:15,934 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 01:06:15,934 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-22 01:06:15,934 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 01:06:15,934 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 01:06:15,935 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:06:15,935 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:06:15,935 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:06:15,935 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-22 01:06:15,935 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 01:06:15,935 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 01:06:15,935 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-22 01:06:15,944 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-22 01:06:15,944 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x0000013EE4AD8D70>
2025-10-22 01:06:15,945 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-22 01:06:15,960 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-22 01:06:16,415 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 01:06:16,466 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.021110600035171956}
2025-10-22 01:06:16,467 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 01:06:16,499 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.022303000034298748}
2025-10-22 01:06:16,499 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 01:06:16,534 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.02354000002378598}
2025-10-22 01:06:16,534 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 01:06:16,578 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.0346060999436304}
2025-10-22 01:06:17,012 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:17,157 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104338
2025-10-22 01:06:17,159 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104338)
2025-10-22 01:06:18,305 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:18,349 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103338（变化，之前=104338）
2025-10-22 01:06:18,349 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103338)
2025-10-22 01:06:19,453 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:19,498 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102338（变化，之前=103338）
2025-10-22 01:06:19,498 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102338)
2025-10-22 01:06:20,624 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:20,667 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101338（变化，之前=102338）
2025-10-22 01:06:20,668 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101338)
2025-10-22 01:06:21,761 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:21,801 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100338（变化，之前=101338）
2025-10-22 01:06:21,802 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100338)
2025-10-22 01:06:22,926 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:22,974 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99338（变化，之前=100338）
2025-10-22 01:06:22,974 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99338)
2025-10-22 01:06:24,037 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:24,078 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98338（变化，之前=99338）
2025-10-22 01:06:24,079 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98338)
2025-10-22 01:06:25,175 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:25,218 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97338（变化，之前=98338）
2025-10-22 01:06:25,219 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97338)
2025-10-22 01:06:25,476 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10011.907499982044, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:06:25.036Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:06:25,478 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:06:26,324 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:26,369 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96338（变化，之前=97338）
2025-10-22 01:06:26,370 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96338)
2025-10-22 01:06:27,411 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:27,457 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95338（变化，之前=96338）
2025-10-22 01:06:27,458 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95338)
2025-10-22 01:06:28,497 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:28,535 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94338（变化，之前=95338）
2025-10-22 01:06:28,535 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94338)
2025-10-22 01:06:29,666 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:29,710 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93338（变化，之前=94338）
2025-10-22 01:06:29,711 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93338)
2025-10-22 01:06:30,713 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:30,761 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92338（变化，之前=93338）
2025-10-22 01:06:30,761 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92338)
2025-10-22 01:06:31,855 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:31,918 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91338（变化，之前=92338）
2025-10-22 01:06:31,919 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91338)
2025-10-22 01:06:32,958 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:33,000 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90338（变化，之前=91338）
2025-10-22 01:06:33,001 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90338)
2025-10-22 01:06:33,999 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:34,038 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89338（变化，之前=90338）
2025-10-22 01:06:34,039 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89338)
2025-10-22 01:06:34,998 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:35,037 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88338（变化，之前=89338）
2025-10-22 01:06:35,037 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88338)
2025-10-22 01:06:35,481 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10002.769500017166, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:06:35.041Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:06:35,482 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:06:36,003 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:36,042 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87338（变化，之前=88338）
2025-10-22 01:06:36,042 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87338)
2025-10-22 01:06:36,988 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:37,029 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86338（变化，之前=87338）
2025-10-22 01:06:37,030 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86338)
2025-10-22 01:06:37,972 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:38,026 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85338（变化，之前=86338）
2025-10-22 01:06:38,027 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85338)
2025-10-22 01:06:38,969 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:39,012 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84338（变化，之前=85338）
2025-10-22 01:06:39,013 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84338)
2025-10-22 01:06:39,936 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:39,979 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83338（变化，之前=84338）
2025-10-22 01:06:39,980 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83338)
2025-10-22 01:06:40,882 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:40,956 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82338（变化，之前=83338）
2025-10-22 01:06:40,960 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82338)
2025-10-22 01:06:41,919 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:42,004 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81338（变化，之前=82338）
2025-10-22 01:06:42,009 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81338)
2025-10-22 01:06:42,942 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:42,989 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80338（变化，之前=81338）
2025-10-22 01:06:42,990 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80338)
2025-10-22 01:06:43,907 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:43,970 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79338（变化，之前=80338）
2025-10-22 01:06:43,971 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79338)
2025-10-22 01:06:44,894 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:44,946 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78338（变化，之前=79338）
2025-10-22 01:06:44,947 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78338)
2025-10-22 01:06:45,493 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10010.18560002558, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:06:45.051Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:06:45,496 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:06:45,868 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:45,911 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77338（变化，之前=78338）
2025-10-22 01:06:45,912 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77338)
2025-10-22 01:06:46,809 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:46,850 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76338（变化，之前=77338）
2025-10-22 01:06:46,850 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76338)
2025-10-22 01:06:47,744 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:47,783 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75338（变化，之前=76338）
2025-10-22 01:06:47,783 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75338)
2025-10-22 01:06:48,627 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:48,673 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74338（变化，之前=75338）
2025-10-22 01:06:48,673 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74338)
2025-10-22 01:06:49,548 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:49,591 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73338（变化，之前=74338）
2025-10-22 01:06:49,592 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73338)
2025-10-22 01:06:50,428 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:50,468 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72338（变化，之前=73338）
2025-10-22 01:06:50,469 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72338)
2025-10-22 01:06:51,338 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:51,389 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71338（变化，之前=72338）
2025-10-22 01:06:51,390 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71338)
2025-10-22 01:06:52,235 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:52,283 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70338（变化，之前=71338）
2025-10-22 01:06:52,284 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70338)
2025-10-22 01:06:53,133 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:53,174 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69338（变化，之前=70338）
2025-10-22 01:06:53,174 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69338)
2025-10-22 01:06:54,151 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:54,198 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68338（变化，之前=69338）
2025-10-22 01:06:54,198 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68338)
2025-10-22 01:06:55,039 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:55,089 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67338（变化，之前=68338）
2025-10-22 01:06:55,091 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67338)
2025-10-22 01:06:55,502 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10004.373799951281, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:06:55.061Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:06:55,502 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:06:55,957 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:56,030 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66338（变化，之前=67338）
2025-10-22 01:06:56,030 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66338)
2025-10-22 01:06:56,912 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:57,127 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65338（变化，之前=66338）
2025-10-22 01:06:57,129 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65338)
2025-10-22 01:06:58,028 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:58,162 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64338（变化，之前=65338）
2025-10-22 01:06:58,163 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64338)
2025-10-22 01:06:59,031 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:06:59,120 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63338（变化，之前=64338）
2025-10-22 01:06:59,121 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63338)
2025-10-22 01:06:59,988 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:00,108 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62338（变化，之前=63338）
2025-10-22 01:07:00,109 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62338)
2025-10-22 01:07:00,930 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:00,974 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61338（变化，之前=62338）
2025-10-22 01:07:00,974 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61338)
2025-10-22 01:07:01,824 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:01,889 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60338（变化，之前=61338）
2025-10-22 01:07:01,889 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60338)
2025-10-22 01:07:02,711 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:02,760 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59338（变化，之前=60338）
2025-10-22 01:07:02,760 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59338)
2025-10-22 01:07:03,595 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:03,636 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58338（变化，之前=59338）
2025-10-22 01:07:03,637 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58338)
2025-10-22 01:07:04,445 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:04,488 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57338（变化，之前=58338）
2025-10-22 01:07:04,489 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57338)
2025-10-22 01:07:05,262 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:05,313 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56338（变化，之前=57338）
2025-10-22 01:07:05,314 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56338)
2025-10-22 01:07:05,512 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10008.959700004198, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:07:05.071Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:07:05,513 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:07:06,106 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:06,148 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55338（变化，之前=56338）
2025-10-22 01:07:06,149 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55338)
2025-10-22 01:07:06,914 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:06,959 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54338（变化，之前=55338）
2025-10-22 01:07:06,960 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54338)
2025-10-22 01:07:07,718 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:07,765 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53338（变化，之前=54338）
2025-10-22 01:07:07,765 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53338)
2025-10-22 01:07:08,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:08,554 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52338（变化，之前=53338）
2025-10-22 01:07:08,554 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52338)
2025-10-22 01:07:09,299 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:09,346 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51338（变化，之前=52338）
2025-10-22 01:07:09,347 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51338)
2025-10-22 01:07:10,074 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:10,120 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50338（变化，之前=51338）
2025-10-22 01:07:10,120 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50338)
2025-10-22 01:07:10,833 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:10,875 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49338（变化，之前=50338）
2025-10-22 01:07:10,876 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49338)
2025-10-22 01:07:11,555 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:11,597 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48338（变化，之前=49338）
2025-10-22 01:07:11,597 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48338)
2025-10-22 01:07:12,297 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:12,347 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47338（变化，之前=48338）
2025-10-22 01:07:12,347 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47338)
2025-10-22 01:07:13,016 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:13,068 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46338（变化，之前=47338）
2025-10-22 01:07:13,068 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46338)
2025-10-22 01:07:13,746 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:13,795 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45338（变化，之前=46338）
2025-10-22 01:07:13,795 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45338)
2025-10-22 01:07:14,441 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:14,490 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44338（变化，之前=45338）
2025-10-22 01:07:14,491 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44338)
2025-10-22 01:07:15,109 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:15,141 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43338（变化，之前=44338）
2025-10-22 01:07:15,142 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43338)
2025-10-22 01:07:15,516 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10002.80409998959, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:07:15.075Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:07:15,518 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:07:15,760 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:15,793 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42338（变化，之前=43338）
2025-10-22 01:07:15,793 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42338)
2025-10-22 01:07:16,402 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:16,439 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41338（变化，之前=42338）
2025-10-22 01:07:16,440 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41338)
2025-10-22 01:07:17,182 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:17,225 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40338（变化，之前=41338）
2025-10-22 01:07:17,226 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40338)
2025-10-22 01:07:17,946 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:18,000 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39338（变化，之前=40338）
2025-10-22 01:07:18,001 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39338)
2025-10-22 01:07:18,669 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:18,708 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38338（变化，之前=39338）
2025-10-22 01:07:18,708 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38338)
2025-10-22 01:07:19,303 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:19,341 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37338（变化，之前=38338）
2025-10-22 01:07:19,341 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37338)
2025-10-22 01:07:19,959 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:19,997 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36338（变化，之前=37338）
2025-10-22 01:07:19,997 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36338)
2025-10-22 01:07:20,590 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:20,625 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35338（变化，之前=36338）
2025-10-22 01:07:20,626 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35338)
2025-10-22 01:07:21,214 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:21,248 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34338（变化，之前=35338）
2025-10-22 01:07:21,249 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34338)
2025-10-22 01:07:21,826 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:21,865 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33338（变化，之前=34338）
2025-10-22 01:07:21,866 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33338)
2025-10-22 01:07:22,403 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:22,440 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32338（变化，之前=33338）
2025-10-22 01:07:22,440 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32338)
2025-10-22 01:07:22,967 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:22,999 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31338（变化，之前=32338）
2025-10-22 01:07:23,000 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31338)
2025-10-22 01:07:23,608 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:23,643 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30338（变化，之前=31338）
2025-10-22 01:07:23,644 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30338)
2025-10-22 01:07:24,175 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:24,212 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29338（变化，之前=30338）
2025-10-22 01:07:24,213 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29338)
2025-10-22 01:07:24,746 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:24,784 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28338（变化，之前=29338）
2025-10-22 01:07:24,785 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28338)
2025-10-22 01:07:25,327 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:25,369 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27338（变化，之前=28338）
2025-10-22 01:07:25,371 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27338)
2025-10-22 01:07:25,527 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10008.165400009602, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:07:25.085Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48363, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:07:25,529 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bd87ea84e7630fd443e1"}, "driverConnectionId": 1, "serverConnectionId": 48363, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:07:25,846 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:25,884 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26338（变化，之前=27338）
2025-10-22 01:07:25,884 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26338)
2025-10-22 01:07:26,335 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:26,378 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25338（变化，之前=26338）
2025-10-22 01:07:26,378 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25338)
2025-10-22 01:07:26,809 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:26,843 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24338（变化，之前=25338）
2025-10-22 01:07:26,843 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24338)
2025-10-22 01:07:27,265 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:27,315 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23338（变化，之前=24338）
2025-10-22 01:07:27,316 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23338)
2025-10-22 01:07:27,703 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:27,732 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22338（变化，之前=23338）
2025-10-22 01:07:27,733 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22338)
2025-10-22 01:07:28,098 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:28,131 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21338（变化，之前=22338）
2025-10-22 01:07:28,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21338)
2025-10-22 01:07:28,479 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:28,503 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20338（变化，之前=21338）
2025-10-22 01:07:28,503 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20338)
2025-10-22 01:07:28,867 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:28,892 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19338（变化，之前=20338）
2025-10-22 01:07:28,892 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19338)
2025-10-22 01:07:29,203 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:29,241 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18338（变化，之前=19338）
2025-10-22 01:07:29,241 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18338)
2025-10-22 01:07:29,544 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:29,575 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17338（变化，之前=18338）
2025-10-22 01:07:29,576 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17338)
2025-10-22 01:07:29,904 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:29,943 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16338（变化，之前=17338）
2025-10-22 01:07:29,944 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16338)
2025-10-22 01:07:30,235 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:30,281 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15338（变化，之前=16338）
2025-10-22 01:07:30,282 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15338)
2025-10-22 01:07:30,549 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:30,586 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14338（变化，之前=15338）
2025-10-22 01:07:30,586 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14338)
2025-10-22 01:07:30,859 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:30,987 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13338（变化，之前=14338）
2025-10-22 01:07:30,988 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13338)
2025-10-22 01:07:31,393 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:31,430 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12338（变化，之前=13338）
2025-10-22 01:07:31,431 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12338)
2025-10-22 01:07:31,655 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:31,690 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11338（变化，之前=12338）
2025-10-22 01:07:31,690 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11338)
2025-10-22 01:07:31,903 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:31,942 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10338（变化，之前=11338）
2025-10-22 01:07:31,943 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10338)
2025-10-22 01:07:32,144 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:32,179 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9338（变化，之前=10338）
2025-10-22 01:07:32,179 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9338)
2025-10-22 01:07:32,357 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:32,397 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8338（变化，之前=9338）
2025-10-22 01:07:32,398 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8338)
2025-10-22 01:07:32,569 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:32,602 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7338（变化，之前=8338）
2025-10-22 01:07:32,602 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7338)
2025-10-22 01:07:32,765 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:32,794 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6338（变化，之前=7338）
2025-10-22 01:07:32,795 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6338)
2025-10-22 01:07:32,942 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:32,962 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5338（变化，之前=6338）
2025-10-22 01:07:32,965 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5338)
2025-10-22 01:07:33,217 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:33,286 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4338（变化，之前=5338）
2025-10-22 01:07:33,286 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4338)
2025-10-22 01:07:33,433 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:33,491 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3338（变化，之前=4338）
2025-10-22 01:07:33,492 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3338)
2025-10-22 01:07:33,588 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:33,617 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2338（变化，之前=3338）
2025-10-22 01:07:33,618 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2338)
2025-10-22 01:07:33,681 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:33,707 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1338（变化，之前=2338）
2025-10-22 01:07:33,708 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1338)
2025-10-22 01:07:33,773 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-22 01:07:33,785 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 338（变化，之前=1338）
2025-10-22 01:07:33,787 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 338 条，累计已去重 104000 条 (reported total=338)
2025-10-22 01:07:33,830 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-22 01:07:33,832 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=338）
2025-10-22 01:07:33,833 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-22 01:07:33,834 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-22 01:07:33,836 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-22 01:07:33,837 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-22 01:07:33,839 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-22 01:07:33,840 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-22 01:07:33,841 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-22 01:07:33,843 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-22 01:07:33,844 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-22 01:07:33,845 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-22 01:07:33,846 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-22 01:07:33,848 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-22 01:07:33,849 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-22 01:07:33,850 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-22 01:07:33,854 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-22 01:07:33,855 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-22 01:07:33,856 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-22 01:07:33,858 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-22 01:07:33,860 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-22 01:07:33,861 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-22 01:07:33,862 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-22 01:07:33,863 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-22 01:07:33,864 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-22 01:07:33,866 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-22 01:07:33,868 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-22 01:07:33,869 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-22 01:07:33,870 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-22 01:07:33,871 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-22 01:07:33,872 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-22 01:07:33,873 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-22 01:07:33,875 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-22 01:07:33,876 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-22 01:07:33,877 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-22 01:07:33,878 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-22 01:07:33,880 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-22 01:07:33,881 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-22 01:07:33,882 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-22 01:07:33,885 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-22 01:07:33,887 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-22 01:07:33,888 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-22 01:07:33,889 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-22 01:07:33,890 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-22 01:07:33,891 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-22 01:07:33,892 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-22 01:07:33,893 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-22 01:07:33,894 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-22 01:07:33,895 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-22 01:07:33,895 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-22 01:07:33,896 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-22 01:07:33,897 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-22 01:07:33,899 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-22 01:07:33,899 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-22 01:07:33,900 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-22 01:07:33,900 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-22 01:07:33,901 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-22 01:07:33,901 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-22 01:07:33,902 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-22 01:07:33,902 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-22 01:07:33,903 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-22 01:07:33,903 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-22 01:07:33,904 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-22 01:07:33,904 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-22 01:07:33,905 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-22 01:07:33,905 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-22 01:07:33,906 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-22 01:07:33,907 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-22 01:07:33,907 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-22 01:07:33,908 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-22 01:07:33,908 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-22 01:07:33,909 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-22 01:07:33,910 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-22 01:07:33,910 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-22 01:07:33,911 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-22 01:07:33,911 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-22 01:07:33,913 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-22 01:07:33,913 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-22 01:07:33,914 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-22 01:07:33,914 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-22 01:07:33,915 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-22 01:07:33,915 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-22 01:07:33,916 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-22 01:07:33,917 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-22 01:07:33,917 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-22 01:07:33,918 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-22 01:07:33,919 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-22 01:07:33,919 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-22 01:07:33,920 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-22 01:07:33,920 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-22 01:07:33,921 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-22 01:07:33,922 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-22 01:07:33,922 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-22 01:07:33,923 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-22 01:07:33,923 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-22 01:07:33,924 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-22 01:07:33,924 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-22 01:07:33,925 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-22 01:07:33,926 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-22 01:07:33,927 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-22 01:07:33,927 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-22 01:07:33,928 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-22 01:07:33,929 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-22 01:07:33,929 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-22 01:07:33,930 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-22 01:07:33,930 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-22 01:07:33,931 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-22 01:07:33,931 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-22 01:07:33,932 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 338 条
2025-10-22 01:07:33,933 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104338
2025-10-22 01:07:33,933 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-22 01:07:34,638 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1133 条记录
2025-10-22 01:07:34,654 - data_loader - DEBUG - Loaded 1133 records from API
2025-10-22 01:07:34,654 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-22 01:07:34,655 - __main__ - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-22 01:07:34,655 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-22 01:07:34,655 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 01:07:34,656 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 01:07:34,656 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:34,657 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:34,657 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:07:34,657 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-22 01:07:34,660 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-22 01:07:34,661 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-22 01:07:34,661 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 01:07:34,661 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 01:07:34,661 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:34,662 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:34,662 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:07:34,662 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-22 01:07:34,669 - __main__ - INFO - Inserted 1133 records into table 光模块在线总数量统计表
2025-10-22 01:07:34,670 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000013EE4AD8EC0>
2025-10-22 01:07:34,670 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-22 01:07:34,673 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7bdd6ea84e7630fd443e2"}}
2025-10-22 01:07:34,673 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "previousDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 01:07:34,674 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,674 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 01:07:34,676 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}}
2025-10-22 01:07:34,677 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "remainingTimeMS": 4999}
2025-10-22 01:07:34,710 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 01:07:34,721 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "driverConnectionId": 1, "serverConnectionId": 48372, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.486400045920163, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:07:34.280Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48372, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:07:34,722 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,723 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "previousDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>"}
2025-10-22 01:07:34,724 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,724 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,725 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "driverConnectionId": 1, "serverConnectionId": 48372, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:07:34,725 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:34,767 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.032738399982918054}
2025-10-22 01:07:34,767 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0429532999987714}
2025-10-22 01:07:34,768 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"UqHel4UARLeW04YM4zTDpg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,778 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "durationMS": 10.131, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,779 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:34,779 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-22 01:07:34,779 - backend.dataSources.roce_event - INFO - 查询时间范围: 2024-10-27 00:00:00 至 2025-10-22 01:07:34.779642
2025-10-22 01:07:34,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}}
2025-10-22 01:07:34,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,780 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,781 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00032900000223889947}
2025-10-22 01:07:34,781 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761066454}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"UqHel4UARLeW04YM4zTDpg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,796 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "durationMS": 15.025, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 883}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,797 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:34,797 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}}
2025-10-22 01:07:34,798 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,798 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,799 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00039739999920129776}
2025-10-22 01:07:34,799 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761066454}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"UqHel4UARLeW04YM4zTDpg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,870 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "durationMS": 70.58200000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,870 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:34,871 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000013EE4D83B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}}
2025-10-22 01:07:34,871 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000013EE4D83B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bdd6ea84e7630fd443e2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010486400045920163>]>", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,872 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:34,872 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003111000405624509}
2025-10-22 01:07:34,873 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "command": "{\"getMore\": 1171497149091714075, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"UqHel4UARLeW04YM4zTDpg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:35,105 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "durationMS": 232.24800000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 48373, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:35,106 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:35,107 - backend.dataSources.roce_event - INFO - 查询到 883 条记录，返回 883 条
2025-10-22 01:07:35,113 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-22 01:07:35,125 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 01:07:35,676 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 01:07:35,716 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 01:07:35,718 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 6 条记录
2025-10-22 01:07:35,721 - backend.dataSources.roce_event - INFO - 处理完成，共生成 883 条记录
2025-10-22 01:07:35,727 - data_loader - DEBUG - Loaded 883 records from MongoDB
2025-10-22 01:07:35,728 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.03483540000161156}
2025-10-22 01:07:35,728 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-22 01:07:35,729 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 01:07:35,730 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间']
2025-10-22 01:07:35,731 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:07:35,732 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:07:35,733 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 01:07:35,736 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 01:07:35,736 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 01:07:35,737 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:35,738 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 01:07:35,738 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 01:07:35,739 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 01:07:35,740 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 01:07:35,741 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:35,742 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 01:07:35,743 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 01:07:35,744 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 01:07:35,745 - __main__ - INFO - Rebuilt table ROCE网络事件-网络零件（光模块+AOC）故障表 from ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 01:07:35,745 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:07:35,746 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:07:35,746 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 01:07:35,746 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 01:07:35,747 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 01:07:35,747 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:35,747 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 01:07:35,748 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 01:07:35,748 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 01:07:35,748 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 01:07:35,749 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:35,749 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 01:07:35,749 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 01:07:35,750 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 01:07:35,758 - __main__ - INFO - Inserted 883 records into table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 01:07:35,759 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceInventoryDataSourceLoader object at 0x0000013EE4AD9010>
2025-10-22 01:07:35,759 - data_loader - DEBUG - Loading network device inventory data from API
2025-10-22 01:07:35,764 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-22 01:07:35,765 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.021876799990423024}
2025-10-22 01:07:35,766 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 01:07:35,815 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.019405299972277135}
2025-10-22 01:07:35,816 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 01:07:35,868 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bdd6ea84e7630fd443e2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.024777099955826998}
2025-10-22 01:07:35,963 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:36,051 - backend.dataSources.network_device_inventory - INFO - 首次返回 total = 16453
2025-10-22 01:07:36,051 - backend.dataSources.network_device_inventory - INFO - 已请求页 1，返回 1000 条，累计 1000 条 (reported total=16453)
2025-10-22 01:07:36,218 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:36,291 - backend.dataSources.network_device_inventory - INFO - 第 2 页返回 total = 15453（变化，之前=16453）
2025-10-22 01:07:36,291 - backend.dataSources.network_device_inventory - INFO - 已请求页 2，返回 1000 条，累计 2000 条 (reported total=15453)
2025-10-22 01:07:36,452 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:36,518 - backend.dataSources.network_device_inventory - INFO - 第 3 页返回 total = 14453（变化，之前=15453）
2025-10-22 01:07:36,519 - backend.dataSources.network_device_inventory - INFO - 已请求页 3，返回 1000 条，累计 3000 条 (reported total=14453)
2025-10-22 01:07:36,678 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:36,771 - backend.dataSources.network_device_inventory - INFO - 第 4 页返回 total = 13453（变化，之前=14453）
2025-10-22 01:07:36,772 - backend.dataSources.network_device_inventory - INFO - 已请求页 4，返回 1000 条，累计 4000 条 (reported total=13453)
2025-10-22 01:07:36,963 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:37,110 - backend.dataSources.network_device_inventory - INFO - 第 5 页返回 total = 12453（变化，之前=13453）
2025-10-22 01:07:37,110 - backend.dataSources.network_device_inventory - INFO - 已请求页 5，返回 1000 条，累计 5000 条 (reported total=12453)
2025-10-22 01:07:37,245 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:37,335 - backend.dataSources.network_device_inventory - INFO - 第 6 页返回 total = 11453（变化，之前=12453）
2025-10-22 01:07:37,337 - backend.dataSources.network_device_inventory - INFO - 已请求页 6，返回 1000 条，累计 6000 条 (reported total=11453)
2025-10-22 01:07:37,449 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:37,515 - backend.dataSources.network_device_inventory - INFO - 第 7 页返回 total = 10453（变化，之前=11453）
2025-10-22 01:07:37,515 - backend.dataSources.network_device_inventory - INFO - 已请求页 7，返回 1000 条，累计 7000 条 (reported total=10453)
2025-10-22 01:07:37,671 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:37,772 - backend.dataSources.network_device_inventory - INFO - 第 8 页返回 total = 9453（变化，之前=10453）
2025-10-22 01:07:37,773 - backend.dataSources.network_device_inventory - INFO - 已请求页 8，返回 1000 条，累计 8000 条 (reported total=9453)
2025-10-22 01:07:37,897 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:37,975 - backend.dataSources.network_device_inventory - INFO - 第 9 页返回 total = 8453（变化，之前=9453）
2025-10-22 01:07:37,976 - backend.dataSources.network_device_inventory - INFO - 已请求页 9，返回 1000 条，累计 9000 条 (reported total=8453)
2025-10-22 01:07:38,080 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:38,121 - backend.dataSources.network_device_inventory - INFO - 第 10 页返回 total = 7453（变化，之前=8453）
2025-10-22 01:07:38,122 - backend.dataSources.network_device_inventory - INFO - 已请求页 10，返回 1000 条，累计 10000 条 (reported total=7453)
2025-10-22 01:07:38,215 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:38,250 - backend.dataSources.network_device_inventory - INFO - 第 11 页返回 total = 6453（变化，之前=7453）
2025-10-22 01:07:38,250 - backend.dataSources.network_device_inventory - INFO - 已请求页 11，返回 1000 条，累计 11000 条 (reported total=6453)
2025-10-22 01:07:38,332 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:38,367 - backend.dataSources.network_device_inventory - INFO - 第 12 页返回 total = 5453（变化，之前=6453）
2025-10-22 01:07:38,367 - backend.dataSources.network_device_inventory - INFO - 已请求页 12，返回 1000 条，累计 12000 条 (reported total=5453)
2025-10-22 01:07:38,495 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:38,606 - backend.dataSources.network_device_inventory - INFO - 第 13 页返回 total = 4453（变化，之前=5453）
2025-10-22 01:07:38,606 - backend.dataSources.network_device_inventory - INFO - 已请求页 13，返回 1000 条，累计 13000 条 (reported total=4453)
2025-10-22 01:07:38,714 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:38,781 - backend.dataSources.network_device_inventory - INFO - 第 14 页返回 total = 3453（变化，之前=4453）
2025-10-22 01:07:38,782 - backend.dataSources.network_device_inventory - INFO - 已请求页 14，返回 1000 条，累计 14000 条 (reported total=3453)
2025-10-22 01:07:38,864 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:39,031 - backend.dataSources.network_device_inventory - INFO - 第 15 页返回 total = 2453（变化，之前=3453）
2025-10-22 01:07:39,031 - backend.dataSources.network_device_inventory - INFO - 已请求页 15，返回 1000 条，累计 15000 条 (reported total=2453)
2025-10-22 01:07:39,121 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:39,223 - backend.dataSources.network_device_inventory - INFO - 第 16 页返回 total = 1453（变化，之前=2453）
2025-10-22 01:07:39,224 - backend.dataSources.network_device_inventory - INFO - 已请求页 16，返回 1000 条，累计 16000 条 (reported total=1453)
2025-10-22 01:07:39,302 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 None
2025-10-22 01:07:39,328 - backend.dataSources.network_device_inventory - INFO - 第 17 页返回 total = 453（变化，之前=1453）
2025-10-22 01:07:39,329 - backend.dataSources.network_device_inventory - INFO - 已请求页 17，返回 453 条，累计 16453 条 (reported total=453)
2025-10-22 01:07:39,380 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-device-info HTTP/1.1" 200 71
2025-10-22 01:07:39,382 - backend.dataSources.network_device_inventory - INFO - 第 18 页返回 total = 0（变化，之前=453）
2025-10-22 01:07:39,383 - backend.dataSources.network_device_inventory - INFO - 第 18 页无数据，结束
2025-10-22 01:07:39,384 - backend.dataSources.network_device_inventory - INFO - 抓取结束。总记录数: 16453
2025-10-22 01:07:39,385 - backend.dataSources.network_device_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-22 01:07:39,551 - backend.dataSources.network_device_inventory - INFO - 处理完成，共生成 16453 条记录
2025-10-22 01:07:39,555 - data_loader - DEBUG - Loaded 16453 records from API
2025-10-22 01:07:39,555 - data_loader - INFO - Network device inventory data load completed (status=0)
2025-10-22 01:07:39,555 - __main__ - DEBUG - Sample record columns: ['设备主机名', '厂商', '型号', '设备SN', '机房', '机柜位', '管理IP', '集群', '客户', '状态', '是否过保', '维保到期时间', '更新时间']
2025-10-22 01:07:39,556 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 01:07:39,556 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-22 01:07:39,556 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-22 01:07:39,557 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-22 01:07:39,557 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:39,557 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-22 01:07:39,558 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-22 01:07:39,558 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:39,558 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:07:39,559 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-22 01:07:39,559 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-22 01:07:39,560 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-22 01:07:39,560 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-22 01:07:39,618 - __main__ - INFO - Rebuilt table 网络设备总数量表 from 网络设备总数量表
2025-10-22 01:07:39,618 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 01:07:39,619 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-22 01:07:39,619 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-10-22 01:07:39,619 - __main__ - DEBUG - Sanitized name: 设备SN -> 设备SN
2025-10-22 01:07:39,619 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:39,619 - __main__ - DEBUG - Sanitized name: 机柜位 -> 机柜位
2025-10-22 01:07:39,620 - __main__ - DEBUG - Sanitized name: 管理IP -> 管理IP
2025-10-22 01:07:39,620 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:39,620 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:07:39,620 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-22 01:07:39,620 - __main__ - DEBUG - Sanitized name: 是否过保 -> 是否过保
2025-10-22 01:07:39,621 - __main__ - DEBUG - Sanitized name: 维保到期时间 -> 维保到期时间
2025-10-22 01:07:39,621 - __main__ - DEBUG - Sanitized name: 更新时间 -> 更新时间
2025-10-22 01:07:39,794 - __main__ - INFO - Inserted 16453 records into table 网络设备总数量表
2025-10-22 01:07:39,795 - __main__ - DEBUG - Processing data source: <data_loader.NetworkDeviceFailureDataSourceLoader object at 0x0000013EE4AD9160>
2025-10-22 01:07:39,795 - data_loader - DEBUG - Loading network device failure data from MongoDB
2025-10-22 01:07:39,797 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}}
2025-10-22 01:07:39,797 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}, "previousDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 01:07:39,798 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:39,798 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 01:07:39,799 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}}
2025-10-22 01:07:39,800 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "remainingTimeMS": 4999}
2025-10-22 01:07:39,859 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 01:07:39,873 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}, "driverConnectionId": 1, "serverConnectionId": 48379, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 13.410300016403198, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:07:39.428Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48379, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:07:39,874 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:39,874 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}, "previousDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>"}
2025-10-22 01:07:39,875 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:39,875 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}, "driverConnectionId": 1, "serverConnectionId": 48379, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:07:39,876 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:39,877 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:40,013 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1154547999612987}
2025-10-22 01:07:40,014 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1378454000223428}
2025-10-22 01:07:40,014 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"XwOVyB14Q7af2/nmK70TCg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,050 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "durationMS": 35.144, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,051 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:40,051 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-22 01:07:40,051 - backend.dataSources.network_device_failure - INFO - 查询时间范围: 2025-07-24 00:00:00 至 2025-10-22 01:07:40.051887
2025-10-22 01:07:40,052 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}}
2025-10-22 01:07:40,053 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,054 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,054 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005406999844126403}
2025-10-22 01:07:40,055 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T01:07:40.051Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"XwOVyB14Q7af2/nmK70TCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,215 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "durationMS": 160.78400000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 309}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,217 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:40,219 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}}
2025-10-22 01:07:40,221 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,223 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,226 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002698299998883158}
2025-10-22 01:07:40,227 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": {\"$in\": [\"NetworkDevice\", \"NetworkDeviceBoard\"]}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-24T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-22T01:07:40.051Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"XwOVyB14Q7af2/nmK70TCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,424 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "durationMS": 196.957, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d4f73618b99eb113ff5729\"}, \"event_id\": \"1418883597680640\", \"policy_id\": \"c8143ad4-f0e9-4024-a9eb-e3bcfc2519f1\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceBoard\", \"event_code\": \"DEVICE_POWER_FAULT\", \"event_name\": \"\u4ea4\u6362\u673a\u7535\u6e90\u6545\u969c\u4e8b\u4ef6\", \"event_status\": \"\u5f85\u8ba4\u9886\", \"hostname\": \"TJ-WQ-AZ-TOR-271.BJ\", \"device_rack\": \"TJWQ01HD07-04-11-25\", \"device_ip\": \"172.29.60.15\", \"device_role\": \"AZ-TOR\", \"device_idc\": \"TJWQ01\", \"product_type\": \"\u4ea4\u6362\u673a\", \"device_slot\": \"4\", \"alert_count\": 2, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-09-25T08:07:03.199Z\"}, \"description\": \"\u8bbe\u5907\u53d1\u751f\u4e86\u7535\u6e90\u6545\u969c\", \"starts_at\": {\"$date\": \"2025-09-25T08:03:02.085Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"operation_at\": {\"$date\": {\"$numberLong\": \"-62...", "commandName": "find", "databaseName": "network_event", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,425 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:40,425 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000013EE4D83B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}}
2025-10-22 01:07:40,426 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000013EE4D83B00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7bddbea84e7630fd443e3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013410300016403198>]>", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,426 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,427 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003296000068075955}
2025-10-22 01:07:40,427 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "command": "{\"getMore\": 1386016183623618143, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"XwOVyB14Q7af2/nmK70TCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,763 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "durationMS": 336.137, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aec213b16b8a00e7bf6a54\"}, \"event_id\": \"1377858535571456\", \"policy_id\": \"bf506b08-0d65-40d1-84c4-dd813c970539\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDevice\", \"event_code\": \"SWITCH_PING_OFFLINE\", \"event_name\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\u4e8b\u4ef6\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"NX-LT-DC-ROCE_TOR-106_01.NX\", \"device_rack\": \"NXLT012F05-E-14-22\", \"device_ip\": \"172.30.90.73\", \"device_role\": \"DC-ROCE_TOR\", \"device_idc\": \"NXLT01\", \"link_status\": \"DOWN\", \"product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firing\", \"last_alert_at\": {\"$date\": \"2025-08-27T08:29:33Z\"}, \"description\": \"\u4ea4\u6362\u673aPING\u4e0d\u901a\uff0c\u53ef\u80fd\u5b95\u673a\u6216\u91cd\u542f\uff0c\u6216\u7ba1\u7406\u7f51\u4e0d\u901a\u3002\", \"starts_at\": {\"$date\": \"2025-08-27T08:30:11.009Z\"}, \"claimed_at\": {\"$date\": {\"$numberLong\": \"-62135596800000\"}}, \"case_at\":...", "commandName": "getMore", "databaseName": "network_event", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 48381, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:07:40,766 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:07:40,767 - backend.dataSources.network_device_failure - INFO - 查询到 309 条记录，返回 309 条
2025-10-22 01:07:40,769 - backend.dataSources.network_device_failure - INFO - 事件类型分布: {'NetworkDeviceBoard': 3, 'NetworkDevice': 306}
2025-10-22 01:07:40,791 - backend.dataSources.network_device_failure - INFO - 处理完成，共生成 309 条记录
2025-10-22 01:07:40,792 - data_loader - DEBUG - Loaded 309 records from MongoDB
2025-10-22 01:07:40,792 - data_loader - INFO - Network device failure data load completed (status=0)
2025-10-22 01:07:40,795 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '设备主机名', '机房', '集群', '客户', '设备槽位', '描述', '开始时间', '认领时间', '建单时间', '结束时间', 'NOC工单ID', '外包工单ID', '工单故障类型']
2025-10-22 01:07:40,796 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:07:40,796 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 01:07:40,797 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:07:40,797 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 01:07:40,798 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:40,798 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:40,799 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:07:40,799 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-22 01:07:40,800 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-22 01:07:40,800 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 01:07:40,800 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 01:07:40,801 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 01:07:40,802 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 01:07:40,803 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 01:07:40,803 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-22 01:07:40,804 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-22 01:07:40,805 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-22 01:07:40,806 - __main__ - INFO - Rebuilt table 网络设备故障表 from 网络设备故障表
2025-10-22 01:07:40,806 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:07:40,807 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-22 01:07:40,807 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:07:40,808 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-22 01:07:40,808 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:07:40,808 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:07:40,809 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 01:07:40,809 - __main__ - DEBUG - Sanitized name: 设备槽位 -> 设备槽位
2025-10-22 01:07:40,809 - __main__ - DEBUG - Sanitized name: 描述 -> 描述
2025-10-22 01:07:40,810 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-22 01:07:40,810 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-22 01:07:40,810 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-22 01:07:40,810 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-22 01:07:40,811 - __main__ - DEBUG - Sanitized name: NOC工单ID -> NOC工单ID
2025-10-22 01:07:40,811 - __main__ - DEBUG - Sanitized name: 外包工单ID -> 外包工单ID
2025-10-22 01:07:40,811 - __main__ - DEBUG - Sanitized name: 工单故障类型 -> 工单故障类型
2025-10-22 01:07:40,823 - __main__ - INFO - Inserted 309 records into table 网络设备故障表
2025-10-22 01:07:40,863 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-22 01:07:40,882 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1006.1354999779724, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-22 01:07:40,888 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.06610759999603033}
2025-10-22 01:07:40,888 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 01:07:40,928 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.026710900012403727}
2025-10-22 01:07:40,928 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 01:07:40,964 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.02384330000495538}
2025-10-22 01:07:40,965 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 01:07:41,098 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7bddbea84e7630fd443e3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.12263070000335574}
2025-10-22 01:22:38,203 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-22 01:22:38,233 - backend.database_builder - INFO - Dropped table ROCE网络事件-光模块故障表
2025-10-22 01:22:38,234 - backend.database_builder - INFO - Dropped tables: ['ROCE网络事件-光模块故障表'] (status=0)
2025-10-22 01:39:36,799 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-22 01:39:36,813 - backend.database_builder - INFO - Dropped table ROCE网络事件-网络零件（光模块+AOC）故障表
2025-10-22 01:39:36,814 - backend.database_builder - INFO - Dropped tables: ['ROCE网络事件-网络零件（光模块+AOC）故障表'] (status=0)
2025-10-22 01:40:09,737 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE下联-网络零件（光模块+AOC）故障表
2025-10-22 01:40:09,737 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-22 01:40:09,738 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x000001D09C308C20>
2025-10-22 01:40:09,738 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-22 01:40:09,987 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}}
2025-10-22 01:40:09,987 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}, "previousDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-22 01:40:09,988 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:09,988 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-22 01:40:09,990 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}}
2025-10-22 01:40:09,990 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "remainingTimeMS": 4999}
2025-10-22 01:40:10,016 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-22 01:40:10,029 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}, "driverConnectionId": 1, "serverConnectionId": 48398, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.245699996128678, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-21T17:40:09.610Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 48398, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-22 01:40:10,029 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,030 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}, "previousDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>"}
2025-10-22 01:40:10,030 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,031 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,032 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}, "driverConnectionId": 1, "serverConnectionId": 48398, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-22 01:40:10,032 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:40:10,089 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04618449998088181}
2025-10-22 01:40:10,089 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.057698899996466935}
2025-10-22 01:40:10,090 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3kMfG+u/R4+mJoPx7Q0bZg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,098 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "durationMS": 8.784, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,099 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:40:10,099 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-22 01:40:10,100 - backend.dataSources.roce_event - INFO - 查询时间范围: 2024-10-27 00:00:00 至 2025-10-22 01:40:10.100011
2025-10-22 01:40:10,100 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}}
2025-10-22 01:40:10,101 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,101 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,102 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00044079998042434454}
2025-10-22 01:40:10,102 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761068410}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3kMfG+u/R4+mJoPx7Q0bZg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,119 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "durationMS": 17.267, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 883}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,120 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:40:10,120 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}}
2025-10-22 01:40:10,121 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,121 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,122 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003285999991931021}
2025-10-22 01:40:10,122 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": {\"$nin\": [\"GPU_ABNORMAL\", \"SWITCH_DOWN\"]}, \"process_code\": 40, \"create_ts\": {\"$gte\": 1729958400, \"$lte\": 1761068410}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3kMfG+u/R4+mJoPx7Q0bZg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,182 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "durationMS": 60.158, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,186 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:40:10,187 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001D09C5D3C40>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}}
2025-10-22 01:40:10,187 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001D09C5D3C40>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f7c579880de1d14b69fed9, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012245699996128678>]>", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,188 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,188 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00036070001078769565}
2025-10-22 01:40:10,189 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "command": "{\"getMore\": 1887534806200188616, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"3kMfG+u/R4+mJoPx7Q0bZg==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,403 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "durationMS": 214.23700000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 48400, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-22 01:40:10,404 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-22 01:40:10,404 - backend.dataSources.roce_event - INFO - 查询到 883 条记录，返回 883 条
2025-10-22 01:40:10,410 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-22 01:40:10,416 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 01:40:10,992 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-22 01:40:11,031 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.023917199985589832}
2025-10-22 01:40:11,032 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-22 01:40:11,037 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 01:40:11,039 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 6 条记录
2025-10-22 01:40:11,042 - backend.dataSources.roce_event - INFO - 处理完成，共生成 883 条记录
2025-10-22 01:40:11,046 - data_loader - DEBUG - Loaded 883 records from MongoDB
2025-10-22 01:40:11,047 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-22 01:40:11,047 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间']
2025-10-22 01:40:11,048 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:40:11,052 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:40:11,052 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 01:40:11,053 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 01:40:11,054 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 01:40:11,054 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:40:11,055 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 01:40:11,055 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 01:40:11,056 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 01:40:11,057 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 01:40:11,057 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:40:11,058 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 01:40:11,059 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 01:40:11,059 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 01:40:11,066 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.020019000046886504}
2025-10-22 01:40:11,067 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-22 01:40:11,083 - __main__ - INFO - Rebuilt table ROCE下联-网络零件（光模块+AOC）故障表 from ROCE下联-网络零件（光模块+AOC）故障表
2025-10-22 01:40:11,083 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 01:40:11,085 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 01:40:11,085 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 01:40:11,086 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 01:40:11,086 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 01:40:11,086 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 01:40:11,087 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 01:40:11,087 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 01:40:11,088 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 01:40:11,088 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 01:40:11,088 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 01:40:11,089 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 01:40:11,089 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 01:40:11,089 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 01:40:11,101 - __main__ - INFO - Inserted 883 records into table ROCE下联-网络零件（光模块+AOC）故障表
2025-10-22 01:40:11,106 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.02730449999216944}
2025-10-22 01:40:11,106 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-22 01:40:11,126 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-22 01:40:11,141 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.023397999990265816}
2025-10-22 01:40:11,547 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f7c579880de1d14b69fed9"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1515.1185999857262, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-22 18:41:18,690 - data_loader - DEBUG - Initialized NOCOpticalModuleFullDataSourceLoader with table 光模块在线总数量统计表
2025-10-22 18:41:18,699 - data_loader - DEBUG - Initialized XLSXRoceNetworkPartFaultDataSourceLoader with file D:\Code\KC-SQLAgent-Visualization-v1.8\roce事件列表_2025-10-22 18_18_28.xlsx_1761128309.xlsx and table ROCE-TOR下联-网络零件（光模块+AOC）故障表
2025-10-22 18:41:18,700 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: real_database.db
2025-10-22 18:41:18,700 - __main__ - DEBUG - Processing data source: <data_loader.NOCOpticalModuleFullDataSourceLoader object at 0x00000121706F4C20>
2025-10-22 18:41:18,701 - data_loader - DEBUG - Loading NOC optical module full data
2025-10-22 18:41:18,705 - backend.dataSources.api_optical_module_full_query - INFO - 开始拉取NOC光模块全量数据...
2025-10-22 18:41:18,706 - backend.dataSources.noc_asset_query - INFO - 发送第 1 页请求，起始ID: 0
2025-10-22 18:41:18,707 - backend.dataSources.noc_asset_query - INFO - 发送第 2 页请求，起始ID: 1000
2025-10-22 18:41:18,707 - backend.dataSources.noc_asset_query - INFO - 发送第 3 页请求，起始ID: 2000
2025-10-22 18:41:18,707 - backend.dataSources.noc_asset_query - INFO - 发送第 4 页请求，起始ID: 3000
2025-10-22 18:41:18,708 - backend.dataSources.noc_asset_query - INFO - 发送第 5 页请求，起始ID: 4000
2025-10-22 18:41:18,708 - backend.dataSources.noc_asset_query - INFO - 发送第 6 页请求，起始ID: 5000
2025-10-22 18:41:18,708 - backend.dataSources.noc_asset_query - INFO - 发送第 7 页请求，起始ID: 6000
2025-10-22 18:41:18,709 - backend.dataSources.noc_asset_query - INFO - 发送第 8 页请求，起始ID: 7000
2025-10-22 18:41:18,720 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:18,721 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:18,721 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:18,721 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:18,721 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:18,722 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:18,722 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:18,723 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:22,252 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,287 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,313 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,314 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,407 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,438 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,561 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,562 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:22,564 - backend.dataSources.noc_asset_query - INFO - 第 3 页请求成功，返回 1000 条记录
2025-10-22 18:41:22,570 - backend.dataSources.noc_asset_query - INFO - 发送第 9 页请求，起始ID: 8000
2025-10-22 18:41:22,570 - backend.dataSources.noc_asset_query - INFO - 第 3 页数据已添加，当前总计 1000 条记录
2025-10-22 18:41:22,574 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:22,617 - backend.dataSources.noc_asset_query - INFO - 第 4 页请求成功，返回 1000 条记录
2025-10-22 18:41:22,625 - backend.dataSources.noc_asset_query - INFO - 发送第 10 页请求，起始ID: 9000
2025-10-22 18:41:22,625 - backend.dataSources.noc_asset_query - INFO - 第 4 页数据已添加，当前总计 2000 条记录
2025-10-22 18:41:22,631 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:22,681 - backend.dataSources.noc_asset_query - INFO - 第 7 页请求成功，返回 1000 条记录
2025-10-22 18:41:22,689 - backend.dataSources.noc_asset_query - INFO - 发送第 11 页请求，起始ID: 10000
2025-10-22 18:41:22,690 - backend.dataSources.noc_asset_query - INFO - 第 7 页数据已添加，当前总计 3000 条记录
2025-10-22 18:41:22,695 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:22,755 - backend.dataSources.noc_asset_query - INFO - 第 2 页请求成功，返回 1000 条记录
2025-10-22 18:41:22,782 - backend.dataSources.noc_asset_query - INFO - 第 8 页请求成功，返回 1000 条记录
2025-10-22 18:41:22,788 - backend.dataSources.noc_asset_query - INFO - 发送第 12 页请求，起始ID: 11000
2025-10-22 18:41:22,791 - backend.dataSources.noc_asset_query - INFO - 第 2 页数据已添加，当前总计 4000 条记录
2025-10-22 18:41:22,796 - backend.dataSources.noc_asset_query - INFO - 发送第 13 页请求，起始ID: 12000
2025-10-22 18:41:22,798 - backend.dataSources.noc_asset_query - INFO - 第 8 页数据已添加，当前总计 5000 条记录
2025-10-22 18:41:22,803 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:22,809 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:22,833 - backend.dataSources.noc_asset_query - INFO - 第 1 页请求成功，返回 1000 条记录
2025-10-22 18:41:22,841 - backend.dataSources.noc_asset_query - INFO - 发送第 14 页请求，起始ID: 13000
2025-10-22 18:41:22,844 - backend.dataSources.noc_asset_query - INFO - 第 1 页数据已添加，当前总计 6000 条记录
2025-10-22 18:41:22,847 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:23,022 - backend.dataSources.noc_asset_query - INFO - 第 5 页请求成功，返回 1000 条记录
2025-10-22 18:41:23,031 - backend.dataSources.noc_asset_query - INFO - 发送第 15 页请求，起始ID: 14000
2025-10-22 18:41:23,031 - backend.dataSources.noc_asset_query - INFO - 第 5 页数据已添加，当前总计 7000 条记录
2025-10-22 18:41:23,037 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:23,199 - backend.dataSources.noc_asset_query - INFO - 第 6 页请求成功，返回 1000 条记录
2025-10-22 18:41:23,212 - backend.dataSources.noc_asset_query - INFO - 发送第 16 页请求，起始ID: 15000
2025-10-22 18:41:23,212 - backend.dataSources.noc_asset_query - INFO - 第 6 页数据已添加，当前总计 8000 条记录
2025-10-22 18:41:23,222 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:26,493 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:26,713 - backend.dataSources.noc_asset_query - INFO - 第 9 页请求成功，返回 1000 条记录
2025-10-22 18:41:26,715 - backend.dataSources.noc_asset_query - INFO - 发送第 17 页请求，起始ID: 16000
2025-10-22 18:41:26,716 - backend.dataSources.noc_asset_query - INFO - 第 9 页数据已添加，当前总计 9000 条记录
2025-10-22 18:41:26,718 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:26,758 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:26,778 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:26,997 - backend.dataSources.noc_asset_query - INFO - 第 11 页请求成功，返回 1000 条记录
2025-10-22 18:41:27,000 - backend.dataSources.noc_asset_query - INFO - 发送第 18 页请求，起始ID: 17000
2025-10-22 18:41:27,000 - backend.dataSources.noc_asset_query - INFO - 第 11 页数据已添加，当前总计 10000 条记录
2025-10-22 18:41:27,002 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:27,012 - backend.dataSources.noc_asset_query - INFO - 第 10 页请求成功，返回 1000 条记录
2025-10-22 18:41:27,014 - backend.dataSources.noc_asset_query - INFO - 发送第 19 页请求，起始ID: 18000
2025-10-22 18:41:27,015 - backend.dataSources.noc_asset_query - INFO - 第 10 页数据已添加，当前总计 11000 条记录
2025-10-22 18:41:27,017 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:27,116 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:27,128 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:27,241 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:27,270 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:27,270 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:27,400 - backend.dataSources.noc_asset_query - INFO - 第 12 页请求成功，返回 1000 条记录
2025-10-22 18:41:27,403 - backend.dataSources.noc_asset_query - INFO - 发送第 20 页请求，起始ID: 19000
2025-10-22 18:41:27,403 - backend.dataSources.noc_asset_query - INFO - 第 12 页数据已添加，当前总计 12000 条记录
2025-10-22 18:41:27,405 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:27,479 - backend.dataSources.noc_asset_query - INFO - 第 13 页请求成功，返回 1000 条记录
2025-10-22 18:41:27,482 - backend.dataSources.noc_asset_query - INFO - 发送第 21 页请求，起始ID: 20000
2025-10-22 18:41:27,482 - backend.dataSources.noc_asset_query - INFO - 第 13 页数据已添加，当前总计 13000 条记录
2025-10-22 18:41:27,485 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:27,563 - backend.dataSources.noc_asset_query - INFO - 第 14 页请求成功，返回 1000 条记录
2025-10-22 18:41:27,568 - backend.dataSources.noc_asset_query - INFO - 发送第 22 页请求，起始ID: 21000
2025-10-22 18:41:27,568 - backend.dataSources.noc_asset_query - INFO - 第 14 页数据已添加，当前总计 14000 条记录
2025-10-22 18:41:27,583 - backend.dataSources.noc_asset_query - INFO - 第 15 页请求成功，返回 1000 条记录
2025-10-22 18:41:27,585 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:27,589 - backend.dataSources.noc_asset_query - INFO - 发送第 23 页请求，起始ID: 22000
2025-10-22 18:41:27,590 - backend.dataSources.noc_asset_query - INFO - 第 15 页数据已添加，当前总计 15000 条记录
2025-10-22 18:41:27,606 - backend.dataSources.noc_asset_query - INFO - 第 16 页请求成功，返回 1000 条记录
2025-10-22 18:41:27,609 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:27,615 - backend.dataSources.noc_asset_query - INFO - 发送第 24 页请求，起始ID: 23000
2025-10-22 18:41:27,616 - backend.dataSources.noc_asset_query - INFO - 第 16 页数据已添加，当前总计 16000 条记录
2025-10-22 18:41:27,625 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:27,943 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:28,342 - backend.dataSources.noc_asset_query - INFO - 第 17 页请求成功，返回 1000 条记录
2025-10-22 18:41:28,346 - backend.dataSources.noc_asset_query - INFO - 发送第 25 页请求，起始ID: 24000
2025-10-22 18:41:28,346 - backend.dataSources.noc_asset_query - INFO - 第 17 页数据已添加，当前总计 17000 条记录
2025-10-22 18:41:28,349 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:28,862 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:28,888 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:29,144 - backend.dataSources.noc_asset_query - INFO - 第 18 页请求成功，返回 1000 条记录
2025-10-22 18:41:29,147 - backend.dataSources.noc_asset_query - INFO - 发送第 26 页请求，起始ID: 25000
2025-10-22 18:41:29,147 - backend.dataSources.noc_asset_query - INFO - 第 18 页数据已添加，当前总计 18000 条记录
2025-10-22 18:41:29,150 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:29,202 - backend.dataSources.noc_asset_query - INFO - 第 19 页请求成功，返回 1000 条记录
2025-10-22 18:41:29,206 - backend.dataSources.noc_asset_query - INFO - 发送第 27 页请求，起始ID: 26000
2025-10-22 18:41:29,206 - backend.dataSources.noc_asset_query - INFO - 第 19 页数据已添加，当前总计 19000 条记录
2025-10-22 18:41:29,209 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:30,404 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:30,405 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:30,672 - backend.dataSources.noc_asset_query - INFO - 第 21 页请求成功，返回 1000 条记录
2025-10-22 18:41:30,675 - backend.dataSources.noc_asset_query - INFO - 发送第 28 页请求，起始ID: 27000
2025-10-22 18:41:30,675 - backend.dataSources.noc_asset_query - INFO - 第 21 页数据已添加，当前总计 20000 条记录
2025-10-22 18:41:30,677 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:30,700 - backend.dataSources.noc_asset_query - INFO - 第 20 页请求成功，返回 1000 条记录
2025-10-22 18:41:30,704 - backend.dataSources.noc_asset_query - INFO - 发送第 29 页请求，起始ID: 28000
2025-10-22 18:41:30,704 - backend.dataSources.noc_asset_query - INFO - 第 20 页数据已添加，当前总计 21000 条记录
2025-10-22 18:41:30,706 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:30,823 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:30,838 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:30,885 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:31,078 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:31,127 - backend.dataSources.noc_asset_query - INFO - 第 22 页请求成功，返回 1000 条记录
2025-10-22 18:41:31,131 - backend.dataSources.noc_asset_query - INFO - 发送第 30 页请求，起始ID: 29000
2025-10-22 18:41:31,132 - backend.dataSources.noc_asset_query - INFO - 第 22 页数据已添加，当前总计 22000 条记录
2025-10-22 18:41:31,135 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:31,194 - backend.dataSources.noc_asset_query - INFO - 第 24 页请求成功，返回 1000 条记录
2025-10-22 18:41:31,198 - backend.dataSources.noc_asset_query - INFO - 发送第 31 页请求，起始ID: 30000
2025-10-22 18:41:31,199 - backend.dataSources.noc_asset_query - INFO - 第 24 页数据已添加，当前总计 23000 条记录
2025-10-22 18:41:31,202 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:31,244 - backend.dataSources.noc_asset_query - INFO - 第 23 页请求成功，返回 1000 条记录
2025-10-22 18:41:31,251 - backend.dataSources.noc_asset_query - INFO - 发送第 32 页请求，起始ID: 31000
2025-10-22 18:41:31,251 - backend.dataSources.noc_asset_query - INFO - 第 23 页数据已添加，当前总计 24000 条记录
2025-10-22 18:41:31,257 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:31,514 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:31,534 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:31,604 - backend.dataSources.noc_asset_query - INFO - 第 25 页请求成功，返回 1000 条记录
2025-10-22 18:41:31,609 - backend.dataSources.noc_asset_query - INFO - 发送第 33 页请求，起始ID: 32000
2025-10-22 18:41:31,609 - backend.dataSources.noc_asset_query - INFO - 第 25 页数据已添加，当前总计 25000 条记录
2025-10-22 18:41:31,614 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:31,898 - backend.dataSources.noc_asset_query - INFO - 第 26 页请求成功，返回 1000 条记录
2025-10-22 18:41:31,917 - backend.dataSources.noc_asset_query - INFO - 第 27 页请求成功，返回 1000 条记录
2025-10-22 18:41:31,923 - backend.dataSources.noc_asset_query - INFO - 发送第 34 页请求，起始ID: 33000
2025-10-22 18:41:31,923 - backend.dataSources.noc_asset_query - INFO - 第 26 页数据已添加，当前总计 26000 条记录
2025-10-22 18:41:31,929 - backend.dataSources.noc_asset_query - INFO - 发送第 35 页请求，起始ID: 34000
2025-10-22 18:41:31,941 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:31,945 - backend.dataSources.noc_asset_query - INFO - 第 27 页数据已添加，当前总计 27000 条记录
2025-10-22 18:41:31,963 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:32,784 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:33,005 - backend.dataSources.noc_asset_query - INFO - 第 28 页请求成功，返回 1000 条记录
2025-10-22 18:41:33,009 - backend.dataSources.noc_asset_query - INFO - 发送第 36 页请求，起始ID: 35000
2025-10-22 18:41:33,009 - backend.dataSources.noc_asset_query - INFO - 第 28 页数据已添加，当前总计 28000 条记录
2025-10-22 18:41:33,012 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:33,142 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:33,365 - backend.dataSources.noc_asset_query - INFO - 第 29 页请求成功，返回 1000 条记录
2025-10-22 18:41:33,369 - backend.dataSources.noc_asset_query - INFO - 发送第 37 页请求，起始ID: 36000
2025-10-22 18:41:33,370 - backend.dataSources.noc_asset_query - INFO - 第 29 页数据已添加，当前总计 29000 条记录
2025-10-22 18:41:33,372 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:34,542 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:34,756 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:34,771 - backend.dataSources.noc_asset_query - INFO - 第 30 页请求成功，返回 1000 条记录
2025-10-22 18:41:34,774 - backend.dataSources.noc_asset_query - INFO - 发送第 38 页请求，起始ID: 37000
2025-10-22 18:41:34,774 - backend.dataSources.noc_asset_query - INFO - 第 30 页数据已添加，当前总计 30000 条记录
2025-10-22 18:41:34,777 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:34,958 - backend.dataSources.noc_asset_query - INFO - 第 31 页请求成功，返回 1000 条记录
2025-10-22 18:41:34,960 - backend.dataSources.noc_asset_query - INFO - 发送第 39 页请求，起始ID: 38000
2025-10-22 18:41:34,960 - backend.dataSources.noc_asset_query - INFO - 第 31 页数据已添加，当前总计 31000 条记录
2025-10-22 18:41:34,963 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:35,034 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:35,161 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:35,271 - backend.dataSources.noc_asset_query - INFO - 第 32 页请求成功，返回 1000 条记录
2025-10-22 18:41:35,274 - backend.dataSources.noc_asset_query - INFO - 发送第 40 页请求，起始ID: 39000
2025-10-22 18:41:35,274 - backend.dataSources.noc_asset_query - INFO - 第 32 页数据已添加，当前总计 32000 条记录
2025-10-22 18:41:35,277 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:35,436 - backend.dataSources.noc_asset_query - INFO - 第 33 页请求成功，返回 1000 条记录
2025-10-22 18:41:35,440 - backend.dataSources.noc_asset_query - INFO - 发送第 41 页请求，起始ID: 40000
2025-10-22 18:41:35,440 - backend.dataSources.noc_asset_query - INFO - 第 33 页数据已添加，当前总计 33000 条记录
2025-10-22 18:41:35,443 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:35,502 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:35,507 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:35,743 - backend.dataSources.noc_asset_query - INFO - 第 35 页请求成功，返回 1000 条记录
2025-10-22 18:41:35,747 - backend.dataSources.noc_asset_query - INFO - 发送第 42 页请求，起始ID: 41000
2025-10-22 18:41:35,747 - backend.dataSources.noc_asset_query - INFO - 第 35 页数据已添加，当前总计 34000 条记录
2025-10-22 18:41:35,750 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:35,771 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:35,816 - backend.dataSources.noc_asset_query - INFO - 第 34 页请求成功，返回 1000 条记录
2025-10-22 18:41:35,824 - backend.dataSources.noc_asset_query - INFO - 发送第 43 页请求，起始ID: 42000
2025-10-22 18:41:35,824 - backend.dataSources.noc_asset_query - INFO - 第 34 页数据已添加，当前总计 35000 条记录
2025-10-22 18:41:35,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:35,872 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:36,126 - backend.dataSources.noc_asset_query - INFO - 第 36 页请求成功，返回 1000 条记录
2025-10-22 18:41:36,134 - backend.dataSources.noc_asset_query - INFO - 发送第 44 页请求，起始ID: 43000
2025-10-22 18:41:36,134 - backend.dataSources.noc_asset_query - INFO - 第 36 页数据已添加，当前总计 36000 条记录
2025-10-22 18:41:36,138 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:36,195 - backend.dataSources.noc_asset_query - INFO - 第 37 页请求成功，返回 1000 条记录
2025-10-22 18:41:36,209 - backend.dataSources.noc_asset_query - INFO - 发送第 45 页请求，起始ID: 44000
2025-10-22 18:41:36,209 - backend.dataSources.noc_asset_query - INFO - 第 37 页数据已添加，当前总计 37000 条记录
2025-10-22 18:41:36,217 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:36,528 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:37,073 - backend.dataSources.noc_asset_query - INFO - 第 38 页请求成功，返回 1000 条记录
2025-10-22 18:41:37,074 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:37,078 - backend.dataSources.noc_asset_query - INFO - 发送第 46 页请求，起始ID: 45000
2025-10-22 18:41:37,079 - backend.dataSources.noc_asset_query - INFO - 第 38 页数据已添加，当前总计 38000 条记录
2025-10-22 18:41:37,082 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:37,515 - backend.dataSources.noc_asset_query - INFO - 第 39 页请求成功，返回 1000 条记录
2025-10-22 18:41:37,519 - backend.dataSources.noc_asset_query - INFO - 发送第 47 页请求，起始ID: 46000
2025-10-22 18:41:37,519 - backend.dataSources.noc_asset_query - INFO - 第 39 页数据已添加，当前总计 39000 条记录
2025-10-22 18:41:37,521 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:37,862 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:38,364 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:38,542 - backend.dataSources.noc_asset_query - INFO - 第 40 页请求成功，返回 1000 条记录
2025-10-22 18:41:38,545 - backend.dataSources.noc_asset_query - INFO - 发送第 48 页请求，起始ID: 47000
2025-10-22 18:41:38,546 - backend.dataSources.noc_asset_query - INFO - 第 40 页数据已添加，当前总计 40000 条记录
2025-10-22 18:41:38,548 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:38,834 - backend.dataSources.noc_asset_query - INFO - 第 41 页请求成功，返回 1000 条记录
2025-10-22 18:41:38,838 - backend.dataSources.noc_asset_query - INFO - 发送第 49 页请求，起始ID: 48000
2025-10-22 18:41:38,838 - backend.dataSources.noc_asset_query - INFO - 第 41 页数据已添加，当前总计 41000 条记录
2025-10-22 18:41:38,840 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:39,295 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:39,297 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:39,496 - backend.dataSources.noc_asset_query - INFO - 第 42 页请求成功，返回 1000 条记录
2025-10-22 18:41:39,500 - backend.dataSources.noc_asset_query - INFO - 发送第 50 页请求，起始ID: 49000
2025-10-22 18:41:39,500 - backend.dataSources.noc_asset_query - INFO - 第 42 页数据已添加，当前总计 42000 条记录
2025-10-22 18:41:39,503 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:39,537 - backend.dataSources.noc_asset_query - INFO - 第 43 页请求成功，返回 1000 条记录
2025-10-22 18:41:39,541 - backend.dataSources.noc_asset_query - INFO - 发送第 51 页请求，起始ID: 50000
2025-10-22 18:41:39,541 - backend.dataSources.noc_asset_query - INFO - 第 43 页数据已添加，当前总计 43000 条记录
2025-10-22 18:41:39,544 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:39,711 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:39,713 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:39,923 - backend.dataSources.noc_asset_query - INFO - 第 45 页请求成功，返回 1000 条记录
2025-10-22 18:41:39,927 - backend.dataSources.noc_asset_query - INFO - 发送第 52 页请求，起始ID: 51000
2025-10-22 18:41:39,927 - backend.dataSources.noc_asset_query - INFO - 第 45 页数据已添加，当前总计 44000 条记录
2025-10-22 18:41:39,930 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:39,967 - backend.dataSources.noc_asset_query - INFO - 第 44 页请求成功，返回 1000 条记录
2025-10-22 18:41:39,971 - backend.dataSources.noc_asset_query - INFO - 发送第 53 页请求，起始ID: 52000
2025-10-22 18:41:39,971 - backend.dataSources.noc_asset_query - INFO - 第 44 页数据已添加，当前总计 45000 条记录
2025-10-22 18:41:39,975 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:40,307 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:40,334 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:40,677 - backend.dataSources.noc_asset_query - INFO - 第 46 页请求成功，返回 1000 条记录
2025-10-22 18:41:40,681 - backend.dataSources.noc_asset_query - INFO - 发送第 54 页请求，起始ID: 53000
2025-10-22 18:41:40,681 - backend.dataSources.noc_asset_query - INFO - 第 46 页数据已添加，当前总计 46000 条记录
2025-10-22 18:41:40,684 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:40,736 - backend.dataSources.noc_asset_query - INFO - 第 47 页请求成功，返回 1000 条记录
2025-10-22 18:41:40,742 - backend.dataSources.noc_asset_query - INFO - 发送第 55 页请求，起始ID: 54000
2025-10-22 18:41:40,742 - backend.dataSources.noc_asset_query - INFO - 第 47 页数据已添加，当前总计 47000 条记录
2025-10-22 18:41:40,750 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:40,797 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:40,888 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:41,161 - backend.dataSources.noc_asset_query - INFO - 第 48 页请求成功，返回 1000 条记录
2025-10-22 18:41:41,165 - backend.dataSources.noc_asset_query - INFO - 发送第 56 页请求，起始ID: 55000
2025-10-22 18:41:41,165 - backend.dataSources.noc_asset_query - INFO - 第 48 页数据已添加，当前总计 48000 条记录
2025-10-22 18:41:41,169 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:41,221 - backend.dataSources.noc_asset_query - INFO - 第 49 页请求成功，返回 1000 条记录
2025-10-22 18:41:41,227 - backend.dataSources.noc_asset_query - INFO - 发送第 57 页请求，起始ID: 56000
2025-10-22 18:41:41,228 - backend.dataSources.noc_asset_query - INFO - 第 49 页数据已添加，当前总计 49000 条记录
2025-10-22 18:41:41,233 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:42,045 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:42,080 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:42,933 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:42,959 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:43,092 - backend.dataSources.noc_asset_query - INFO - 第 50 页请求成功，返回 1000 条记录
2025-10-22 18:41:43,097 - backend.dataSources.noc_asset_query - INFO - 发送第 58 页请求，起始ID: 57000
2025-10-22 18:41:43,098 - backend.dataSources.noc_asset_query - INFO - 第 50 页数据已添加，当前总计 50000 条记录
2025-10-22 18:41:43,102 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:43,177 - backend.dataSources.noc_asset_query - INFO - 第 51 页请求成功，返回 1000 条记录
2025-10-22 18:41:43,183 - backend.dataSources.noc_asset_query - INFO - 发送第 59 页请求，起始ID: 58000
2025-10-22 18:41:43,183 - backend.dataSources.noc_asset_query - INFO - 第 51 页数据已添加，当前总计 51000 条记录
2025-10-22 18:41:43,188 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:43,249 - backend.dataSources.noc_asset_query - INFO - 第 52 页请求成功，返回 1000 条记录
2025-10-22 18:41:43,255 - backend.dataSources.noc_asset_query - INFO - 发送第 60 页请求，起始ID: 59000
2025-10-22 18:41:43,256 - backend.dataSources.noc_asset_query - INFO - 第 52 页数据已添加，当前总计 52000 条记录
2025-10-22 18:41:43,262 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:43,371 - backend.dataSources.noc_asset_query - INFO - 第 53 页请求成功，返回 1000 条记录
2025-10-22 18:41:43,375 - backend.dataSources.noc_asset_query - INFO - 发送第 61 页请求，起始ID: 60000
2025-10-22 18:41:43,375 - backend.dataSources.noc_asset_query - INFO - 第 53 页数据已添加，当前总计 53000 条记录
2025-10-22 18:41:43,379 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:44,922 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:44,938 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:44,955 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:44,959 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:45,205 - backend.dataSources.noc_asset_query - INFO - 第 54 页请求成功，返回 1000 条记录
2025-10-22 18:41:45,209 - backend.dataSources.noc_asset_query - INFO - 发送第 62 页请求，起始ID: 61000
2025-10-22 18:41:45,209 - backend.dataSources.noc_asset_query - INFO - 第 54 页数据已添加，当前总计 54000 条记录
2025-10-22 18:41:45,212 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:45,224 - backend.dataSources.noc_asset_query - INFO - 第 55 页请求成功，返回 1000 条记录
2025-10-22 18:41:45,228 - backend.dataSources.noc_asset_query - INFO - 发送第 63 页请求，起始ID: 62000
2025-10-22 18:41:45,228 - backend.dataSources.noc_asset_query - INFO - 第 55 页数据已添加，当前总计 55000 条记录
2025-10-22 18:41:45,232 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:45,266 - backend.dataSources.noc_asset_query - INFO - 第 57 页请求成功，返回 1000 条记录
2025-10-22 18:41:45,270 - backend.dataSources.noc_asset_query - INFO - 发送第 64 页请求，起始ID: 63000
2025-10-22 18:41:45,271 - backend.dataSources.noc_asset_query - INFO - 第 57 页数据已添加，当前总计 56000 条记录
2025-10-22 18:41:45,274 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:45,297 - backend.dataSources.noc_asset_query - INFO - 第 56 页请求成功，返回 1000 条记录
2025-10-22 18:41:45,302 - backend.dataSources.noc_asset_query - INFO - 发送第 65 页请求，起始ID: 64000
2025-10-22 18:41:45,302 - backend.dataSources.noc_asset_query - INFO - 第 56 页数据已添加，当前总计 57000 条记录
2025-10-22 18:41:45,306 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:46,286 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:46,291 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:46,497 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:46,523 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:46,572 - backend.dataSources.noc_asset_query - INFO - 第 58 页请求成功，返回 1000 条记录
2025-10-22 18:41:46,596 - backend.dataSources.noc_asset_query - INFO - 第 59 页请求成功，返回 1000 条记录
2025-10-22 18:41:46,601 - backend.dataSources.noc_asset_query - INFO - 发送第 66 页请求，起始ID: 65000
2025-10-22 18:41:46,602 - backend.dataSources.noc_asset_query - INFO - 第 58 页数据已添加，当前总计 58000 条记录
2025-10-22 18:41:46,607 - backend.dataSources.noc_asset_query - INFO - 发送第 67 页请求，起始ID: 66000
2025-10-22 18:41:46,611 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:46,612 - backend.dataSources.noc_asset_query - INFO - 第 59 页数据已添加，当前总计 59000 条记录
2025-10-22 18:41:46,618 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:46,801 - backend.dataSources.noc_asset_query - INFO - 第 61 页请求成功，返回 1000 条记录
2025-10-22 18:41:46,806 - backend.dataSources.noc_asset_query - INFO - 发送第 68 页请求，起始ID: 67000
2025-10-22 18:41:46,807 - backend.dataSources.noc_asset_query - INFO - 第 61 页数据已添加，当前总计 60000 条记录
2025-10-22 18:41:46,811 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:46,904 - backend.dataSources.noc_asset_query - INFO - 第 60 页请求成功，返回 1000 条记录
2025-10-22 18:41:46,910 - backend.dataSources.noc_asset_query - INFO - 发送第 69 页请求，起始ID: 68000
2025-10-22 18:41:46,910 - backend.dataSources.noc_asset_query - INFO - 第 60 页数据已添加，当前总计 61000 条记录
2025-10-22 18:41:46,913 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:48,257 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:48,272 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:48,364 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:48,420 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:48,507 - backend.dataSources.noc_asset_query - INFO - 第 63 页请求成功，返回 1000 条记录
2025-10-22 18:41:48,511 - backend.dataSources.noc_asset_query - INFO - 发送第 70 页请求，起始ID: 69000
2025-10-22 18:41:48,511 - backend.dataSources.noc_asset_query - INFO - 第 63 页数据已添加，当前总计 62000 条记录
2025-10-22 18:41:48,513 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:48,553 - backend.dataSources.noc_asset_query - INFO - 第 62 页请求成功，返回 1000 条记录
2025-10-22 18:41:48,556 - backend.dataSources.noc_asset_query - INFO - 发送第 71 页请求，起始ID: 70000
2025-10-22 18:41:48,556 - backend.dataSources.noc_asset_query - INFO - 第 62 页数据已添加，当前总计 63000 条记录
2025-10-22 18:41:48,560 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:48,613 - backend.dataSources.noc_asset_query - INFO - 第 64 页请求成功，返回 1000 条记录
2025-10-22 18:41:48,617 - backend.dataSources.noc_asset_query - INFO - 发送第 72 页请求，起始ID: 71000
2025-10-22 18:41:48,618 - backend.dataSources.noc_asset_query - INFO - 第 64 页数据已添加，当前总计 64000 条记录
2025-10-22 18:41:48,620 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:48,735 - backend.dataSources.noc_asset_query - INFO - 第 65 页请求成功，返回 1000 条记录
2025-10-22 18:41:48,738 - backend.dataSources.noc_asset_query - INFO - 发送第 73 页请求，起始ID: 72000
2025-10-22 18:41:48,738 - backend.dataSources.noc_asset_query - INFO - 第 65 页数据已添加，当前总计 65000 条记录
2025-10-22 18:41:48,740 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:50,183 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:50,196 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:50,199 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:50,200 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:50,419 - backend.dataSources.noc_asset_query - INFO - 第 66 页请求成功，返回 1000 条记录
2025-10-22 18:41:50,421 - backend.dataSources.noc_asset_query - INFO - 发送第 74 页请求，起始ID: 73000
2025-10-22 18:41:50,421 - backend.dataSources.noc_asset_query - INFO - 第 66 页数据已添加，当前总计 66000 条记录
2025-10-22 18:41:50,431 - backend.dataSources.noc_asset_query - INFO - 第 69 页请求成功，返回 1000 条记录
2025-10-22 18:41:50,442 - backend.dataSources.noc_asset_query - INFO - 第 68 页请求成功，返回 1000 条记录
2025-10-22 18:41:50,443 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:50,452 - backend.dataSources.noc_asset_query - INFO - 第 67 页请求成功，返回 1000 条记录
2025-10-22 18:41:50,455 - backend.dataSources.noc_asset_query - INFO - 发送第 75 页请求，起始ID: 74000
2025-10-22 18:41:50,460 - backend.dataSources.noc_asset_query - INFO - 发送第 76 页请求，起始ID: 75000
2025-10-22 18:41:50,460 - backend.dataSources.noc_asset_query - INFO - 第 69 页数据已添加，当前总计 67000 条记录
2025-10-22 18:41:50,465 - backend.dataSources.noc_asset_query - INFO - 发送第 77 页请求，起始ID: 76000
2025-10-22 18:41:50,469 - backend.dataSources.noc_asset_query - INFO - 第 68 页数据已添加，当前总计 68000 条记录
2025-10-22 18:41:50,471 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:50,471 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:50,471 - backend.dataSources.noc_asset_query - INFO - 第 67 页数据已添加，当前总计 69000 条记录
2025-10-22 18:41:50,475 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:51,408 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:51,632 - backend.dataSources.noc_asset_query - INFO - 第 70 页请求成功，返回 1000 条记录
2025-10-22 18:41:51,637 - backend.dataSources.noc_asset_query - INFO - 发送第 78 页请求，起始ID: 77000
2025-10-22 18:41:51,637 - backend.dataSources.noc_asset_query - INFO - 第 70 页数据已添加，当前总计 70000 条记录
2025-10-22 18:41:51,641 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:51,650 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:51,677 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:51,681 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:52,018 - backend.dataSources.noc_asset_query - INFO - 第 71 页请求成功，返回 1000 条记录
2025-10-22 18:41:52,022 - backend.dataSources.noc_asset_query - INFO - 发送第 79 页请求，起始ID: 78000
2025-10-22 18:41:52,022 - backend.dataSources.noc_asset_query - INFO - 第 71 页数据已添加，当前总计 71000 条记录
2025-10-22 18:41:52,038 - backend.dataSources.noc_asset_query - INFO - 第 73 页请求成功，返回 1000 条记录
2025-10-22 18:41:52,058 - backend.dataSources.noc_asset_query - INFO - 第 72 页请求成功，返回 1000 条记录
2025-10-22 18:41:52,061 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:52,064 - backend.dataSources.noc_asset_query - INFO - 发送第 80 页请求，起始ID: 79000
2025-10-22 18:41:52,068 - backend.dataSources.noc_asset_query - INFO - 发送第 81 页请求，起始ID: 80000
2025-10-22 18:41:52,068 - backend.dataSources.noc_asset_query - INFO - 第 73 页数据已添加，当前总计 72000 条记录
2025-10-22 18:41:52,071 - backend.dataSources.noc_asset_query - INFO - 第 72 页数据已添加，当前总计 73000 条记录
2025-10-22 18:41:52,075 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:52,076 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:53,907 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:53,997 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:54,022 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:54,025 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:54,231 - backend.dataSources.noc_asset_query - INFO - 第 75 页请求成功，返回 1000 条记录
2025-10-22 18:41:54,234 - backend.dataSources.noc_asset_query - INFO - 发送第 82 页请求，起始ID: 81000
2025-10-22 18:41:54,235 - backend.dataSources.noc_asset_query - INFO - 第 75 页数据已添加，当前总计 74000 条记录
2025-10-22 18:41:54,238 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:54,260 - backend.dataSources.noc_asset_query - INFO - 第 74 页请求成功，返回 1000 条记录
2025-10-22 18:41:54,265 - backend.dataSources.noc_asset_query - INFO - 发送第 83 页请求，起始ID: 82000
2025-10-22 18:41:54,265 - backend.dataSources.noc_asset_query - INFO - 第 74 页数据已添加，当前总计 75000 条记录
2025-10-22 18:41:54,283 - backend.dataSources.noc_asset_query - INFO - 第 77 页请求成功，返回 1000 条记录
2025-10-22 18:41:54,284 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:54,287 - backend.dataSources.noc_asset_query - INFO - 发送第 84 页请求，起始ID: 83000
2025-10-22 18:41:54,287 - backend.dataSources.noc_asset_query - INFO - 第 77 页数据已添加，当前总计 76000 条记录
2025-10-22 18:41:54,290 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:54,332 - backend.dataSources.noc_asset_query - INFO - 第 76 页请求成功，返回 1000 条记录
2025-10-22 18:41:54,336 - backend.dataSources.noc_asset_query - INFO - 发送第 85 页请求，起始ID: 84000
2025-10-22 18:41:54,336 - backend.dataSources.noc_asset_query - INFO - 第 76 页数据已添加，当前总计 77000 条记录
2025-10-22 18:41:54,338 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:55,022 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:55,286 - backend.dataSources.noc_asset_query - INFO - 第 78 页请求成功，返回 1000 条记录
2025-10-22 18:41:55,290 - backend.dataSources.noc_asset_query - INFO - 发送第 86 页请求，起始ID: 85000
2025-10-22 18:41:55,290 - backend.dataSources.noc_asset_query - INFO - 第 78 页数据已添加，当前总计 78000 条记录
2025-10-22 18:41:55,293 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:55,405 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:55,446 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:55,452 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:55,724 - backend.dataSources.noc_asset_query - INFO - 第 79 页请求成功，返回 1000 条记录
2025-10-22 18:41:55,729 - backend.dataSources.noc_asset_query - INFO - 发送第 87 页请求，起始ID: 86000
2025-10-22 18:41:55,729 - backend.dataSources.noc_asset_query - INFO - 第 79 页数据已添加，当前总计 79000 条记录
2025-10-22 18:41:55,733 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:55,756 - backend.dataSources.noc_asset_query - INFO - 第 80 页请求成功，返回 1000 条记录
2025-10-22 18:41:55,774 - backend.dataSources.noc_asset_query - INFO - 第 81 页请求成功，返回 1000 条记录
2025-10-22 18:41:55,782 - backend.dataSources.noc_asset_query - INFO - 发送第 88 页请求，起始ID: 87000
2025-10-22 18:41:55,786 - backend.dataSources.noc_asset_query - INFO - 发送第 89 页请求，起始ID: 88000
2025-10-22 18:41:55,786 - backend.dataSources.noc_asset_query - INFO - 第 80 页数据已添加，当前总计 80000 条记录
2025-10-22 18:41:55,790 - backend.dataSources.noc_asset_query - INFO - 第 81 页数据已添加，当前总计 81000 条记录
2025-10-22 18:41:55,792 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:55,794 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:57,267 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:57,472 - backend.dataSources.noc_asset_query - INFO - 第 82 页请求成功，返回 1000 条记录
2025-10-22 18:41:57,476 - backend.dataSources.noc_asset_query - INFO - 发送第 90 页请求，起始ID: 89000
2025-10-22 18:41:57,476 - backend.dataSources.noc_asset_query - INFO - 第 82 页数据已添加，当前总计 82000 条记录
2025-10-22 18:41:57,478 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:57,858 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:57,871 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:57,895 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:58,121 - backend.dataSources.noc_asset_query - INFO - 第 83 页请求成功，返回 1000 条记录
2025-10-22 18:41:58,124 - backend.dataSources.noc_asset_query - INFO - 发送第 91 页请求，起始ID: 90000
2025-10-22 18:41:58,125 - backend.dataSources.noc_asset_query - INFO - 第 83 页数据已添加，当前总计 83000 条记录
2025-10-22 18:41:58,138 - backend.dataSources.noc_asset_query - INFO - 第 85 页请求成功，返回 1000 条记录
2025-10-22 18:41:58,153 - backend.dataSources.noc_asset_query - INFO - 第 84 页请求成功，返回 1000 条记录
2025-10-22 18:41:58,157 - backend.dataSources.noc_asset_query - INFO - 发送第 92 页请求，起始ID: 91000
2025-10-22 18:41:58,157 - backend.dataSources.noc_asset_query - INFO - 第 85 页数据已添加，当前总计 84000 条记录
2025-10-22 18:41:58,158 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:58,162 - backend.dataSources.noc_asset_query - INFO - 发送第 93 页请求，起始ID: 92000
2025-10-22 18:41:58,163 - backend.dataSources.noc_asset_query - INFO - 第 84 页数据已添加，当前总计 85000 条记录
2025-10-22 18:41:58,167 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:58,170 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:58,971 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:59,236 - backend.dataSources.noc_asset_query - INFO - 第 86 页请求成功，返回 1000 条记录
2025-10-22 18:41:59,244 - backend.dataSources.noc_asset_query - INFO - 发送第 94 页请求，起始ID: 93000
2025-10-22 18:41:59,244 - backend.dataSources.noc_asset_query - INFO - 第 86 页数据已添加，当前总计 86000 条记录
2025-10-22 18:41:59,247 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:59,327 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:59,395 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:59,400 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:41:59,685 - backend.dataSources.noc_asset_query - INFO - 第 88 页请求成功，返回 1000 条记录
2025-10-22 18:41:59,704 - backend.dataSources.noc_asset_query - INFO - 第 89 页请求成功，返回 1000 条记录
2025-10-22 18:41:59,707 - backend.dataSources.noc_asset_query - INFO - 发送第 95 页请求，起始ID: 94000
2025-10-22 18:41:59,724 - backend.dataSources.noc_asset_query - INFO - 发送第 96 页请求，起始ID: 95000
2025-10-22 18:41:59,724 - backend.dataSources.noc_asset_query - INFO - 第 88 页数据已添加，当前总计 87000 条记录
2025-10-22 18:41:59,725 - backend.dataSources.noc_asset_query - INFO - 第 87 页请求成功，返回 1000 条记录
2025-10-22 18:41:59,727 - backend.dataSources.noc_asset_query - INFO - 第 89 页数据已添加，当前总计 88000 条记录
2025-10-22 18:41:59,735 - backend.dataSources.noc_asset_query - INFO - 发送第 97 页请求，起始ID: 96000
2025-10-22 18:41:59,736 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:59,736 - backend.dataSources.noc_asset_query - INFO - 第 87 页数据已添加，当前总计 89000 条记录
2025-10-22 18:41:59,737 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:59,741 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:41:59,937 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:00,236 - backend.dataSources.noc_asset_query - INFO - 第 90 页请求成功，返回 1000 条记录
2025-10-22 18:42:00,244 - backend.dataSources.noc_asset_query - INFO - 发送第 98 页请求，起始ID: 97000
2025-10-22 18:42:00,245 - backend.dataSources.noc_asset_query - INFO - 第 90 页数据已添加，当前总计 90000 条记录
2025-10-22 18:42:00,248 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:01,155 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:01,399 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:01,420 - backend.dataSources.noc_asset_query - INFO - 第 91 页请求成功，返回 1000 条记录
2025-10-22 18:42:01,429 - backend.dataSources.noc_asset_query - INFO - 发送第 99 页请求，起始ID: 98000
2025-10-22 18:42:01,429 - backend.dataSources.noc_asset_query - INFO - 第 91 页数据已添加，当前总计 91000 条记录
2025-10-22 18:42:01,435 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:01,445 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:01,668 - backend.dataSources.noc_asset_query - INFO - 第 93 页请求成功，返回 1000 条记录
2025-10-22 18:42:01,674 - backend.dataSources.noc_asset_query - INFO - 发送第 100 页请求，起始ID: 99000
2025-10-22 18:42:01,674 - backend.dataSources.noc_asset_query - INFO - 第 93 页数据已添加，当前总计 92000 条记录
2025-10-22 18:42:01,680 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:01,717 - backend.dataSources.noc_asset_query - INFO - 第 92 页请求成功，返回 1000 条记录
2025-10-22 18:42:01,724 - backend.dataSources.noc_asset_query - INFO - 发送第 101 页请求，起始ID: 100000
2025-10-22 18:42:01,724 - backend.dataSources.noc_asset_query - INFO - 第 92 页数据已添加，当前总计 93000 条记录
2025-10-22 18:42:01,731 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:02,812 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:02,991 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:03,089 - backend.dataSources.noc_asset_query - INFO - 第 94 页请求成功，返回 1000 条记录
2025-10-22 18:42:03,093 - backend.dataSources.noc_asset_query - INFO - 发送第 102 页请求，起始ID: 101000
2025-10-22 18:42:03,093 - backend.dataSources.noc_asset_query - INFO - 第 94 页数据已添加，当前总计 94000 条记录
2025-10-22 18:42:03,096 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:03,307 - backend.dataSources.noc_asset_query - INFO - 第 96 页请求成功，返回 1000 条记录
2025-10-22 18:42:03,311 - backend.dataSources.noc_asset_query - INFO - 发送第 103 页请求，起始ID: 102000
2025-10-22 18:42:03,311 - backend.dataSources.noc_asset_query - INFO - 第 96 页数据已添加，当前总计 95000 条记录
2025-10-22 18:42:03,315 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:03,416 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:03,534 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:03,711 - backend.dataSources.noc_asset_query - INFO - 第 97 页请求成功，返回 1000 条记录
2025-10-22 18:42:03,715 - backend.dataSources.noc_asset_query - INFO - 发送第 104 页请求，起始ID: 103000
2025-10-22 18:42:03,715 - backend.dataSources.noc_asset_query - INFO - 第 97 页数据已添加，当前总计 96000 条记录
2025-10-22 18:42:03,718 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:03,792 - backend.dataSources.noc_asset_query - INFO - 第 95 页请求成功，返回 1000 条记录
2025-10-22 18:42:03,796 - backend.dataSources.noc_asset_query - INFO - 发送第 105 页请求，起始ID: 104000
2025-10-22 18:42:03,796 - backend.dataSources.noc_asset_query - INFO - 第 95 页数据已添加，当前总计 97000 条记录
2025-10-22 18:42:03,799 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:04,139 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:04,363 - backend.dataSources.noc_asset_query - INFO - 第 98 页请求成功，返回 1000 条记录
2025-10-22 18:42:04,366 - backend.dataSources.noc_asset_query - INFO - 发送第 106 页请求，起始ID: 105000
2025-10-22 18:42:04,366 - backend.dataSources.noc_asset_query - INFO - 第 98 页数据已添加，当前总计 98000 条记录
2025-10-22 18:42:04,369 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:04,882 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:05,129 - backend.dataSources.noc_asset_query - INFO - 第 99 页请求成功，返回 1000 条记录
2025-10-22 18:42:05,135 - backend.dataSources.noc_asset_query - INFO - 发送第 107 页请求，起始ID: 106000
2025-10-22 18:42:05,136 - backend.dataSources.noc_asset_query - INFO - 第 99 页数据已添加，当前总计 99000 条记录
2025-10-22 18:42:05,139 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:05,516 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:05,628 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:05,992 - backend.dataSources.noc_asset_query - INFO - 第 100 页请求成功，返回 1000 条记录
2025-10-22 18:42:05,998 - backend.dataSources.noc_asset_query - INFO - 发送第 108 页请求，起始ID: 107000
2025-10-22 18:42:05,999 - backend.dataSources.noc_asset_query - INFO - 第 100 页数据已添加，当前总计 100000 条记录
2025-10-22 18:42:06,005 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:06,179 - backend.dataSources.noc_asset_query - INFO - 第 101 页请求成功，返回 1000 条记录
2025-10-22 18:42:06,185 - backend.dataSources.noc_asset_query - INFO - 发送第 109 页请求，起始ID: 108000
2025-10-22 18:42:06,185 - backend.dataSources.noc_asset_query - INFO - 第 101 页数据已添加，当前总计 101000 条记录
2025-10-22 18:42:06,190 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:06,564 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:06,836 - backend.dataSources.noc_asset_query - INFO - 第 102 页请求成功，返回 1000 条记录
2025-10-22 18:42:06,841 - backend.dataSources.noc_asset_query - INFO - 发送第 110 页请求，起始ID: 109000
2025-10-22 18:42:06,842 - backend.dataSources.noc_asset_query - INFO - 第 102 页数据已添加，当前总计 102000 条记录
2025-10-22 18:42:06,845 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:06,873 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:07,090 - backend.dataSources.noc_asset_query - INFO - 第 103 页请求成功，返回 1000 条记录
2025-10-22 18:42:07,094 - backend.dataSources.noc_asset_query - INFO - 发送第 111 页请求，起始ID: 110000
2025-10-22 18:42:07,094 - backend.dataSources.noc_asset_query - INFO - 第 103 页数据已添加，当前总计 103000 条记录
2025-10-22 18:42:07,097 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:07,213 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:07,260 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:07,401 - backend.dataSources.noc_asset_query - INFO - 第 105 页请求成功，返回 1000 条记录
2025-10-22 18:42:07,405 - backend.dataSources.noc_asset_query - INFO - 发送第 112 页请求，起始ID: 111000
2025-10-22 18:42:07,406 - backend.dataSources.noc_asset_query - INFO - 第 105 页数据已添加，当前总计 104000 条记录
2025-10-22 18:42:07,409 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:07,418 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:07,514 - backend.dataSources.noc_asset_query - INFO - 第 104 页请求成功，返回 1000 条记录
2025-10-22 18:42:07,520 - backend.dataSources.noc_asset_query - INFO - 发送第 113 页请求，起始ID: 112000
2025-10-22 18:42:07,520 - backend.dataSources.noc_asset_query - INFO - 第 104 页数据已添加，当前总计 105000 条记录
2025-10-22 18:42:07,524 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:07,683 - backend.dataSources.noc_asset_query - INFO - 第 106 页请求成功，返回 1000 条记录
2025-10-22 18:42:07,689 - backend.dataSources.noc_asset_query - INFO - 发送第 114 页请求，起始ID: 113000
2025-10-22 18:42:07,689 - backend.dataSources.noc_asset_query - INFO - 第 106 页数据已添加，当前总计 106000 条记录
2025-10-22 18:42:07,693 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:07,851 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:08,105 - backend.dataSources.noc_asset_query - INFO - 第 107 页请求成功，返回 1000 条记录
2025-10-22 18:42:08,110 - backend.dataSources.noc_asset_query - INFO - 发送第 115 页请求，起始ID: 114000
2025-10-22 18:42:08,111 - backend.dataSources.noc_asset_query - INFO - 第 107 页数据已添加，当前总计 107000 条记录
2025-10-22 18:42:08,115 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:09,100 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:09,305 - backend.dataSources.noc_asset_query - INFO - 第 108 页请求成功，返回 1000 条记录
2025-10-22 18:42:09,308 - backend.dataSources.noc_asset_query - INFO - 发送第 116 页请求，起始ID: 115000
2025-10-22 18:42:09,309 - backend.dataSources.noc_asset_query - INFO - 第 108 页数据已添加，当前总计 108000 条记录
2025-10-22 18:42:09,311 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:09,376 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:09,705 - backend.dataSources.noc_asset_query - INFO - 第 109 页请求成功，返回 1000 条记录
2025-10-22 18:42:09,708 - backend.dataSources.noc_asset_query - INFO - 发送第 117 页请求，起始ID: 116000
2025-10-22 18:42:09,708 - backend.dataSources.noc_asset_query - INFO - 第 109 页数据已添加，当前总计 109000 条记录
2025-10-22 18:42:09,710 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:11,321 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:11,398 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:11,568 - backend.dataSources.noc_asset_query - INFO - 第 110 页请求成功，返回 1000 条记录
2025-10-22 18:42:11,570 - backend.dataSources.noc_asset_query - INFO - 发送第 118 页请求，起始ID: 117000
2025-10-22 18:42:11,570 - backend.dataSources.noc_asset_query - INFO - 第 110 页数据已添加，当前总计 110000 条记录
2025-10-22 18:42:11,573 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:11,614 - backend.dataSources.noc_asset_query - INFO - 第 111 页请求成功，返回 1000 条记录
2025-10-22 18:42:11,617 - backend.dataSources.noc_asset_query - INFO - 发送第 119 页请求，起始ID: 118000
2025-10-22 18:42:11,618 - backend.dataSources.noc_asset_query - INFO - 第 111 页数据已添加，当前总计 111000 条记录
2025-10-22 18:42:11,620 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:11,907 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:11,986 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:12,021 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:12,141 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:12,203 - backend.dataSources.noc_asset_query - INFO - 第 112 页请求成功，返回 1000 条记录
2025-10-22 18:42:12,206 - backend.dataSources.noc_asset_query - INFO - 发送第 120 页请求，起始ID: 119000
2025-10-22 18:42:12,206 - backend.dataSources.noc_asset_query - INFO - 第 112 页数据已添加，当前总计 112000 条记录
2025-10-22 18:42:12,209 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:12,252 - backend.dataSources.noc_asset_query - INFO - 第 114 页请求成功，返回 1000 条记录
2025-10-22 18:42:12,269 - backend.dataSources.noc_asset_query - INFO - 第 113 页请求成功，返回 1000 条记录
2025-10-22 18:42:12,272 - backend.dataSources.noc_asset_query - INFO - 发送第 121 页请求，起始ID: 120000
2025-10-22 18:42:12,273 - backend.dataSources.noc_asset_query - INFO - 第 114 页数据已添加，当前总计 113000 条记录
2025-10-22 18:42:12,277 - backend.dataSources.noc_asset_query - INFO - 发送第 122 页请求，起始ID: 121000
2025-10-22 18:42:12,280 - backend.dataSources.noc_asset_query - INFO - 第 113 页数据已添加，当前总计 114000 条记录
2025-10-22 18:42:12,280 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:12,284 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:12,400 - backend.dataSources.noc_asset_query - INFO - 第 115 页请求成功，返回 1000 条记录
2025-10-22 18:42:12,405 - backend.dataSources.noc_asset_query - INFO - 发送第 123 页请求，起始ID: 122000
2025-10-22 18:42:12,405 - backend.dataSources.noc_asset_query - INFO - 第 115 页数据已添加，当前总计 115000 条记录
2025-10-22 18:42:12,408 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:12,585 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:12,760 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:12,841 - backend.dataSources.noc_asset_query - INFO - 第 116 页请求成功，返回 1000 条记录
2025-10-22 18:42:12,846 - backend.dataSources.noc_asset_query - INFO - 发送第 124 页请求，起始ID: 123000
2025-10-22 18:42:12,847 - backend.dataSources.noc_asset_query - INFO - 第 116 页数据已添加，当前总计 116000 条记录
2025-10-22 18:42:12,852 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:12,980 - backend.dataSources.noc_asset_query - INFO - 第 117 页请求成功，返回 1000 条记录
2025-10-22 18:42:12,983 - backend.dataSources.noc_asset_query - INFO - 发送第 125 页请求，起始ID: 124000
2025-10-22 18:42:12,984 - backend.dataSources.noc_asset_query - INFO - 第 117 页数据已添加，当前总计 117000 条记录
2025-10-22 18:42:12,987 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:14,017 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:14,049 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:14,254 - backend.dataSources.noc_asset_query - INFO - 第 119 页请求成功，返回 1000 条记录
2025-10-22 18:42:14,257 - backend.dataSources.noc_asset_query - INFO - 发送第 126 页请求，起始ID: 125000
2025-10-22 18:42:14,258 - backend.dataSources.noc_asset_query - INFO - 第 119 页数据已添加，当前总计 118000 条记录
2025-10-22 18:42:14,261 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:14,287 - backend.dataSources.noc_asset_query - INFO - 第 118 页请求成功，返回 1000 条记录
2025-10-22 18:42:14,291 - backend.dataSources.noc_asset_query - INFO - 发送第 127 页请求，起始ID: 126000
2025-10-22 18:42:14,293 - backend.dataSources.noc_asset_query - INFO - 第 118 页数据已添加，当前总计 119000 条记录
2025-10-22 18:42:14,297 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:16,756 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:16,955 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:16,997 - backend.dataSources.noc_asset_query - INFO - 第 120 页请求成功，返回 1000 条记录
2025-10-22 18:42:16,999 - backend.dataSources.noc_asset_query - INFO - 发送第 128 页请求，起始ID: 127000
2025-10-22 18:42:16,999 - backend.dataSources.noc_asset_query - INFO - 第 120 页数据已添加，当前总计 120000 条记录
2025-10-22 18:42:17,000 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:17,016 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:17,020 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:17,144 - backend.dataSources.noc_asset_query - INFO - 第 121 页请求成功，返回 1000 条记录
2025-10-22 18:42:17,147 - backend.dataSources.noc_asset_query - INFO - 发送第 129 页请求，起始ID: 128000
2025-10-22 18:42:17,147 - backend.dataSources.noc_asset_query - INFO - 第 121 页数据已添加，当前总计 121000 条记录
2025-10-22 18:42:17,148 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:17,270 - backend.dataSources.noc_asset_query - INFO - 第 123 页请求成功，返回 1000 条记录
2025-10-22 18:42:17,276 - backend.dataSources.noc_asset_query - INFO - 第 122 页请求成功，返回 1000 条记录
2025-10-22 18:42:17,278 - backend.dataSources.noc_asset_query - INFO - 发送第 130 页请求，起始ID: 129000
2025-10-22 18:42:17,279 - backend.dataSources.noc_asset_query - INFO - 第 123 页数据已添加，当前总计 122000 条记录
2025-10-22 18:42:17,281 - backend.dataSources.noc_asset_query - INFO - 发送第 131 页请求，起始ID: 130000
2025-10-22 18:42:17,282 - backend.dataSources.noc_asset_query - INFO - 第 122 页数据已添加，当前总计 123000 条记录
2025-10-22 18:42:17,283 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:17,285 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:17,359 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:17,521 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:17,651 - backend.dataSources.noc_asset_query - INFO - 第 124 页请求成功，返回 1000 条记录
2025-10-22 18:42:17,654 - backend.dataSources.noc_asset_query - INFO - 发送第 132 页请求，起始ID: 131000
2025-10-22 18:42:17,654 - backend.dataSources.noc_asset_query - INFO - 第 124 页数据已添加，当前总计 124000 条记录
2025-10-22 18:42:17,657 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:17,763 - backend.dataSources.noc_asset_query - INFO - 第 125 页请求成功，返回 1000 条记录
2025-10-22 18:42:17,766 - backend.dataSources.noc_asset_query - INFO - 发送第 133 页请求，起始ID: 132000
2025-10-22 18:42:17,766 - backend.dataSources.noc_asset_query - INFO - 第 125 页数据已添加，当前总计 125000 条记录
2025-10-22 18:42:17,768 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:17,898 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:17,954 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:18,182 - backend.dataSources.noc_asset_query - INFO - 第 126 页请求成功，返回 1000 条记录
2025-10-22 18:42:18,186 - backend.dataSources.noc_asset_query - INFO - 发送第 134 页请求，起始ID: 133000
2025-10-22 18:42:18,186 - backend.dataSources.noc_asset_query - INFO - 第 126 页数据已添加，当前总计 126000 条记录
2025-10-22 18:42:18,189 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:18,233 - backend.dataSources.noc_asset_query - INFO - 第 127 页请求成功，返回 1000 条记录
2025-10-22 18:42:18,237 - backend.dataSources.noc_asset_query - INFO - 发送第 135 页请求，起始ID: 134000
2025-10-22 18:42:18,237 - backend.dataSources.noc_asset_query - INFO - 第 127 页数据已添加，当前总计 127000 条记录
2025-10-22 18:42:18,242 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:19,211 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:19,440 - backend.dataSources.noc_asset_query - INFO - 第 128 页请求成功，返回 1000 条记录
2025-10-22 18:42:19,443 - backend.dataSources.noc_asset_query - INFO - 发送第 136 页请求，起始ID: 135000
2025-10-22 18:42:19,443 - backend.dataSources.noc_asset_query - INFO - 第 128 页数据已添加，当前总计 128000 条记录
2025-10-22 18:42:19,445 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:20,184 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:20,449 - backend.dataSources.noc_asset_query - INFO - 第 129 页请求成功，返回 1000 条记录
2025-10-22 18:42:20,452 - backend.dataSources.noc_asset_query - INFO - 发送第 137 页请求，起始ID: 136000
2025-10-22 18:42:20,452 - backend.dataSources.noc_asset_query - INFO - 第 129 页数据已添加，当前总计 129000 条记录
2025-10-22 18:42:20,453 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:21,312 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:21,397 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:21,518 - backend.dataSources.noc_asset_query - INFO - 第 130 页请求成功，返回 1000 条记录
2025-10-22 18:42:21,520 - backend.dataSources.noc_asset_query - INFO - 发送第 138 页请求，起始ID: 137000
2025-10-22 18:42:21,520 - backend.dataSources.noc_asset_query - INFO - 第 130 页数据已添加，当前总计 130000 条记录
2025-10-22 18:42:21,522 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:21,635 - backend.dataSources.noc_asset_query - INFO - 第 131 页请求成功，返回 1000 条记录
2025-10-22 18:42:21,638 - backend.dataSources.noc_asset_query - INFO - 发送第 139 页请求，起始ID: 138000
2025-10-22 18:42:21,638 - backend.dataSources.noc_asset_query - INFO - 第 131 页数据已添加，当前总计 131000 条记录
2025-10-22 18:42:21,640 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:22,009 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:22,028 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:22,236 - backend.dataSources.noc_asset_query - INFO - 第 132 页请求成功，返回 1000 条记录
2025-10-22 18:42:22,239 - backend.dataSources.noc_asset_query - INFO - 发送第 140 页请求，起始ID: 139000
2025-10-22 18:42:22,239 - backend.dataSources.noc_asset_query - INFO - 第 132 页数据已添加，当前总计 132000 条记录
2025-10-22 18:42:22,242 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:22,311 - backend.dataSources.noc_asset_query - INFO - 第 133 页请求成功，返回 1000 条记录
2025-10-22 18:42:22,312 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:22,316 - backend.dataSources.noc_asset_query - INFO - 发送第 141 页请求，起始ID: 140000
2025-10-22 18:42:22,316 - backend.dataSources.noc_asset_query - INFO - 第 133 页数据已添加，当前总计 133000 条记录
2025-10-22 18:42:22,317 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:22,320 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:22,539 - backend.dataSources.noc_asset_query - INFO - 第 135 页请求成功，返回 1000 条记录
2025-10-22 18:42:22,549 - backend.dataSources.noc_asset_query - INFO - 第 134 页请求成功，返回 1000 条记录
2025-10-22 18:42:22,553 - backend.dataSources.noc_asset_query - INFO - 发送第 142 页请求，起始ID: 141000
2025-10-22 18:42:22,555 - backend.dataSources.noc_asset_query - INFO - 发送第 143 页请求，起始ID: 142000
2025-10-22 18:42:22,555 - backend.dataSources.noc_asset_query - INFO - 第 135 页数据已添加，当前总计 134000 条记录
2025-10-22 18:42:22,559 - backend.dataSources.noc_asset_query - INFO - 第 134 页数据已添加，当前总计 135000 条记录
2025-10-22 18:42:22,560 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:22,561 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:22,868 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:23,120 - backend.dataSources.noc_asset_query - INFO - 第 136 页请求成功，返回 1000 条记录
2025-10-22 18:42:23,124 - backend.dataSources.noc_asset_query - INFO - 发送第 144 页请求，起始ID: 143000
2025-10-22 18:42:23,125 - backend.dataSources.noc_asset_query - INFO - 第 136 页数据已添加，当前总计 136000 条记录
2025-10-22 18:42:23,128 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:23,215 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:23,481 - backend.dataSources.noc_asset_query - INFO - 第 137 页请求成功，返回 1000 条记录
2025-10-22 18:42:23,485 - backend.dataSources.noc_asset_query - INFO - 发送第 145 页请求，起始ID: 144000
2025-10-22 18:42:23,485 - backend.dataSources.noc_asset_query - INFO - 第 137 页数据已添加，当前总计 137000 条记录
2025-10-22 18:42:23,488 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:24,116 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:24,248 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:24,424 - backend.dataSources.noc_asset_query - INFO - 第 138 页请求成功，返回 1000 条记录
2025-10-22 18:42:24,427 - backend.dataSources.noc_asset_query - INFO - 发送第 146 页请求，起始ID: 145000
2025-10-22 18:42:24,427 - backend.dataSources.noc_asset_query - INFO - 第 138 页数据已添加，当前总计 138000 条记录
2025-10-22 18:42:24,429 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:24,484 - backend.dataSources.noc_asset_query - INFO - 第 139 页请求成功，返回 1000 条记录
2025-10-22 18:42:24,486 - backend.dataSources.noc_asset_query - INFO - 发送第 147 页请求，起始ID: 146000
2025-10-22 18:42:24,487 - backend.dataSources.noc_asset_query - INFO - 第 139 页数据已添加，当前总计 139000 条记录
2025-10-22 18:42:24,489 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:25,628 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:25,812 - backend.dataSources.noc_asset_query - INFO - 第 140 页请求成功，返回 1000 条记录
2025-10-22 18:42:25,815 - backend.dataSources.noc_asset_query - INFO - 发送第 148 页请求，起始ID: 147000
2025-10-22 18:42:25,815 - backend.dataSources.noc_asset_query - INFO - 第 140 页数据已添加，当前总计 140000 条记录
2025-10-22 18:42:25,816 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:25,901 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:26,178 - backend.dataSources.noc_asset_query - INFO - 第 141 页请求成功，返回 1000 条记录
2025-10-22 18:42:26,180 - backend.dataSources.noc_asset_query - INFO - 发送第 149 页请求，起始ID: 148000
2025-10-22 18:42:26,181 - backend.dataSources.noc_asset_query - INFO - 第 141 页数据已添加，当前总计 141000 条记录
2025-10-22 18:42:26,182 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:26,611 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:26,637 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:26,793 - backend.dataSources.noc_asset_query - INFO - 第 143 页请求成功，返回 1000 条记录
2025-10-22 18:42:26,795 - backend.dataSources.noc_asset_query - INFO - 发送第 150 页请求，起始ID: 149000
2025-10-22 18:42:26,796 - backend.dataSources.noc_asset_query - INFO - 第 143 页数据已添加，当前总计 142000 条记录
2025-10-22 18:42:26,798 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:26,846 - backend.dataSources.noc_asset_query - INFO - 第 142 页请求成功，返回 1000 条记录
2025-10-22 18:42:26,849 - backend.dataSources.noc_asset_query - INFO - 发送第 151 页请求，起始ID: 150000
2025-10-22 18:42:26,849 - backend.dataSources.noc_asset_query - INFO - 第 142 页数据已添加，当前总计 143000 条记录
2025-10-22 18:42:26,851 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:26,977 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:27,211 - backend.dataSources.noc_asset_query - INFO - 第 144 页请求成功，返回 1000 条记录
2025-10-22 18:42:27,214 - backend.dataSources.noc_asset_query - INFO - 发送第 152 页请求，起始ID: 151000
2025-10-22 18:42:27,215 - backend.dataSources.noc_asset_query - INFO - 第 144 页数据已添加，当前总计 144000 条记录
2025-10-22 18:42:27,217 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:27,242 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:27,531 - backend.dataSources.noc_asset_query - INFO - 第 145 页请求成功，返回 1000 条记录
2025-10-22 18:42:27,534 - backend.dataSources.noc_asset_query - INFO - 发送第 153 页请求，起始ID: 152000
2025-10-22 18:42:27,535 - backend.dataSources.noc_asset_query - INFO - 第 145 页数据已添加，当前总计 145000 条记录
2025-10-22 18:42:27,538 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:27,817 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:27,872 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:28,022 - backend.dataSources.noc_asset_query - INFO - 第 146 页请求成功，返回 1000 条记录
2025-10-22 18:42:28,025 - backend.dataSources.noc_asset_query - INFO - 发送第 154 页请求，起始ID: 153000
2025-10-22 18:42:28,026 - backend.dataSources.noc_asset_query - INFO - 第 146 页数据已添加，当前总计 146000 条记录
2025-10-22 18:42:28,029 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:28,106 - backend.dataSources.noc_asset_query - INFO - 第 147 页请求成功，返回 1000 条记录
2025-10-22 18:42:28,110 - backend.dataSources.noc_asset_query - INFO - 发送第 155 页请求，起始ID: 154000
2025-10-22 18:42:28,110 - backend.dataSources.noc_asset_query - INFO - 第 147 页数据已添加，当前总计 147000 条记录
2025-10-22 18:42:28,113 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:28,557 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:28,749 - backend.dataSources.noc_asset_query - INFO - 第 148 页请求成功，返回 1000 条记录
2025-10-22 18:42:28,753 - backend.dataSources.noc_asset_query - INFO - 发送第 156 页请求，起始ID: 155000
2025-10-22 18:42:28,753 - backend.dataSources.noc_asset_query - INFO - 第 148 页数据已添加，当前总计 148000 条记录
2025-10-22 18:42:28,756 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:28,814 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:29,079 - backend.dataSources.noc_asset_query - INFO - 第 149 页请求成功，返回 1000 条记录
2025-10-22 18:42:29,083 - backend.dataSources.noc_asset_query - INFO - 发送第 157 页请求，起始ID: 156000
2025-10-22 18:42:29,084 - backend.dataSources.noc_asset_query - INFO - 第 149 页数据已添加，当前总计 149000 条记录
2025-10-22 18:42:29,087 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:29,975 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:30,117 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:30,218 - backend.dataSources.noc_asset_query - INFO - 第 150 页请求成功，返回 1000 条记录
2025-10-22 18:42:30,222 - backend.dataSources.noc_asset_query - INFO - 发送第 158 页请求，起始ID: 157000
2025-10-22 18:42:30,223 - backend.dataSources.noc_asset_query - INFO - 第 150 页数据已添加，当前总计 150000 条记录
2025-10-22 18:42:30,235 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:30,394 - backend.dataSources.noc_asset_query - INFO - 第 151 页请求成功，返回 1000 条记录
2025-10-22 18:42:30,399 - backend.dataSources.noc_asset_query - INFO - 发送第 159 页请求，起始ID: 158000
2025-10-22 18:42:30,399 - backend.dataSources.noc_asset_query - INFO - 第 151 页数据已添加，当前总计 151000 条记录
2025-10-22 18:42:30,402 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:30,902 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:31,366 - backend.dataSources.noc_asset_query - INFO - 第 152 页请求成功，返回 1000 条记录
2025-10-22 18:42:31,371 - backend.dataSources.noc_asset_query - INFO - 发送第 160 页请求，起始ID: 159000
2025-10-22 18:42:31,371 - backend.dataSources.noc_asset_query - INFO - 第 152 页数据已添加，当前总计 152000 条记录
2025-10-22 18:42:31,377 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:31,470 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:31,721 - backend.dataSources.noc_asset_query - INFO - 第 153 页请求成功，返回 1000 条记录
2025-10-22 18:42:31,726 - backend.dataSources.noc_asset_query - INFO - 发送第 161 页请求，起始ID: 160000
2025-10-22 18:42:31,726 - backend.dataSources.noc_asset_query - INFO - 第 153 页数据已添加，当前总计 153000 条记录
2025-10-22 18:42:31,730 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:31,930 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:31,968 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:32,197 - backend.dataSources.noc_asset_query - INFO - 第 154 页请求成功，返回 1000 条记录
2025-10-22 18:42:32,202 - backend.dataSources.noc_asset_query - INFO - 发送第 162 页请求，起始ID: 161000
2025-10-22 18:42:32,203 - backend.dataSources.noc_asset_query - INFO - 第 154 页数据已添加，当前总计 154000 条记录
2025-10-22 18:42:32,207 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:32,240 - backend.dataSources.noc_asset_query - INFO - 第 155 页请求成功，返回 1000 条记录
2025-10-22 18:42:32,250 - backend.dataSources.noc_asset_query - INFO - 发送第 163 页请求，起始ID: 162000
2025-10-22 18:42:32,250 - backend.dataSources.noc_asset_query - INFO - 第 155 页数据已添加，当前总计 155000 条记录
2025-10-22 18:42:32,254 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:32,338 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:32,420 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:32,542 - backend.dataSources.noc_asset_query - INFO - 第 156 页请求成功，返回 1000 条记录
2025-10-22 18:42:32,548 - backend.dataSources.noc_asset_query - INFO - 发送第 164 页请求，起始ID: 163000
2025-10-22 18:42:32,548 - backend.dataSources.noc_asset_query - INFO - 第 156 页数据已添加，当前总计 156000 条记录
2025-10-22 18:42:32,553 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:32,690 - backend.dataSources.noc_asset_query - INFO - 第 157 页请求成功，返回 1000 条记录
2025-10-22 18:42:32,695 - backend.dataSources.noc_asset_query - INFO - 发送第 165 页请求，起始ID: 164000
2025-10-22 18:42:32,695 - backend.dataSources.noc_asset_query - INFO - 第 157 页数据已添加，当前总计 157000 条记录
2025-10-22 18:42:32,699 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:33,427 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:33,690 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:33,823 - backend.dataSources.noc_asset_query - INFO - 第 158 页请求成功，返回 1000 条记录
2025-10-22 18:42:33,829 - backend.dataSources.noc_asset_query - INFO - 发送第 166 页请求，起始ID: 165000
2025-10-22 18:42:33,830 - backend.dataSources.noc_asset_query - INFO - 第 158 页数据已添加，当前总计 158000 条记录
2025-10-22 18:42:33,834 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:34,156 - backend.dataSources.noc_asset_query - INFO - 第 159 页请求成功，返回 1000 条记录
2025-10-22 18:42:34,161 - backend.dataSources.noc_asset_query - INFO - 发送第 167 页请求，起始ID: 166000
2025-10-22 18:42:34,162 - backend.dataSources.noc_asset_query - INFO - 第 159 页数据已添加，当前总计 159000 条记录
2025-10-22 18:42:34,167 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:35,069 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:35,440 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:35,541 - backend.dataSources.noc_asset_query - INFO - 第 160 页请求成功，返回 1000 条记录
2025-10-22 18:42:35,546 - backend.dataSources.noc_asset_query - INFO - 发送第 168 页请求，起始ID: 167000
2025-10-22 18:42:35,547 - backend.dataSources.noc_asset_query - INFO - 第 160 页数据已添加，当前总计 160000 条记录
2025-10-22 18:42:35,551 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:35,860 - backend.dataSources.noc_asset_query - INFO - 第 161 页请求成功，返回 1000 条记录
2025-10-22 18:42:35,865 - backend.dataSources.noc_asset_query - INFO - 发送第 169 页请求，起始ID: 168000
2025-10-22 18:42:35,865 - backend.dataSources.noc_asset_query - INFO - 第 161 页数据已添加，当前总计 161000 条记录
2025-10-22 18:42:35,868 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:36,292 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:36,532 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:36,854 - backend.dataSources.noc_asset_query - INFO - 第 163 页请求成功，返回 1000 条记录
2025-10-22 18:42:36,873 - backend.dataSources.noc_asset_query - INFO - 发送第 170 页请求，起始ID: 169000
2025-10-22 18:42:36,873 - backend.dataSources.noc_asset_query - INFO - 第 162 页请求成功，返回 1000 条记录
2025-10-22 18:42:36,874 - backend.dataSources.noc_asset_query - INFO - 第 163 页数据已添加，当前总计 162000 条记录
2025-10-22 18:42:36,880 - backend.dataSources.noc_asset_query - INFO - 发送第 171 页请求，起始ID: 170000
2025-10-22 18:42:36,882 - backend.dataSources.noc_asset_query - INFO - 第 162 页数据已添加，当前总计 163000 条记录
2025-10-22 18:42:36,883 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:36,887 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:37,009 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:37,081 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:37,259 - backend.dataSources.noc_asset_query - INFO - 第 164 页请求成功，返回 1000 条记录
2025-10-22 18:42:37,264 - backend.dataSources.noc_asset_query - INFO - 发送第 172 页请求，起始ID: 171000
2025-10-22 18:42:37,265 - backend.dataSources.noc_asset_query - INFO - 第 164 页数据已添加，当前总计 164000 条记录
2025-10-22 18:42:37,269 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:37,342 - backend.dataSources.noc_asset_query - INFO - 第 165 页请求成功，返回 1000 条记录
2025-10-22 18:42:37,349 - backend.dataSources.noc_asset_query - INFO - 发送第 173 页请求，起始ID: 172000
2025-10-22 18:42:37,349 - backend.dataSources.noc_asset_query - INFO - 第 165 页数据已添加，当前总计 165000 条记录
2025-10-22 18:42:37,352 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:38,382 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:38,600 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:38,773 - backend.dataSources.noc_asset_query - INFO - 第 166 页请求成功，返回 1000 条记录
2025-10-22 18:42:38,780 - backend.dataSources.noc_asset_query - INFO - 发送第 174 页请求，起始ID: 173000
2025-10-22 18:42:38,781 - backend.dataSources.noc_asset_query - INFO - 第 166 页数据已添加，当前总计 166000 条记录
2025-10-22 18:42:38,790 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:39,019 - backend.dataSources.noc_asset_query - INFO - 第 167 页请求成功，返回 1000 条记录
2025-10-22 18:42:39,027 - backend.dataSources.noc_asset_query - INFO - 发送第 175 页请求，起始ID: 174000
2025-10-22 18:42:39,027 - backend.dataSources.noc_asset_query - INFO - 第 167 页数据已添加，当前总计 167000 条记录
2025-10-22 18:42:39,032 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:39,109 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:39,249 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:39,360 - backend.dataSources.noc_asset_query - INFO - 第 168 页请求成功，返回 1000 条记录
2025-10-22 18:42:39,366 - backend.dataSources.noc_asset_query - INFO - 发送第 176 页请求，起始ID: 175000
2025-10-22 18:42:39,366 - backend.dataSources.noc_asset_query - INFO - 第 168 页数据已添加，当前总计 168000 条记录
2025-10-22 18:42:39,371 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:39,793 - backend.dataSources.noc_asset_query - INFO - 第 169 页请求成功，返回 1000 条记录
2025-10-22 18:42:39,799 - backend.dataSources.noc_asset_query - INFO - 发送第 177 页请求，起始ID: 176000
2025-10-22 18:42:39,799 - backend.dataSources.noc_asset_query - INFO - 第 169 页数据已添加，当前总计 169000 条记录
2025-10-22 18:42:39,803 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:40,774 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:40,994 - backend.dataSources.noc_asset_query - INFO - 第 171 页请求成功，返回 1000 条记录
2025-10-22 18:42:40,999 - backend.dataSources.noc_asset_query - INFO - 发送第 178 页请求，起始ID: 177000
2025-10-22 18:42:40,999 - backend.dataSources.noc_asset_query - INFO - 第 171 页数据已添加，当前总计 170000 条记录
2025-10-22 18:42:41,003 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:41,045 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:41,318 - backend.dataSources.noc_asset_query - INFO - 第 170 页请求成功，返回 1000 条记录
2025-10-22 18:42:41,324 - backend.dataSources.noc_asset_query - INFO - 发送第 179 页请求，起始ID: 178000
2025-10-22 18:42:41,324 - backend.dataSources.noc_asset_query - INFO - 第 170 页数据已添加，当前总计 171000 条记录
2025-10-22 18:42:41,335 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:42,376 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:42,398 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:42,688 - backend.dataSources.noc_asset_query - INFO - 第 173 页请求成功，返回 1000 条记录
2025-10-22 18:42:42,693 - backend.dataSources.noc_asset_query - INFO - 发送第 180 页请求，起始ID: 179000
2025-10-22 18:42:42,693 - backend.dataSources.noc_asset_query - INFO - 第 173 页数据已添加，当前总计 172000 条记录
2025-10-22 18:42:42,698 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:42,759 - backend.dataSources.noc_asset_query - INFO - 第 172 页请求成功，返回 1000 条记录
2025-10-22 18:42:42,770 - backend.dataSources.noc_asset_query - INFO - 发送第 181 页请求，起始ID: 180000
2025-10-22 18:42:42,770 - backend.dataSources.noc_asset_query - INFO - 第 172 页数据已添加，当前总计 173000 条记录
2025-10-22 18:42:42,777 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:43,109 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:43,415 - backend.dataSources.noc_asset_query - INFO - 第 174 页请求成功，返回 1000 条记录
2025-10-22 18:42:43,434 - backend.dataSources.noc_asset_query - INFO - 发送第 182 页请求，起始ID: 181000
2025-10-22 18:42:43,450 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:43,436 - backend.dataSources.noc_asset_query - INFO - 第 174 页数据已添加，当前总计 174000 条记录
2025-10-22 18:42:43,481 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:43,627 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:43,813 - backend.dataSources.noc_asset_query - INFO - 第 175 页请求成功，返回 1000 条记录
2025-10-22 18:42:43,820 - backend.dataSources.noc_asset_query - INFO - 发送第 183 页请求，起始ID: 182000
2025-10-22 18:42:43,820 - backend.dataSources.noc_asset_query - INFO - 第 175 页数据已添加，当前总计 175000 条记录
2025-10-22 18:42:43,836 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:43,861 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:43,916 - backend.dataSources.noc_asset_query - INFO - 第 176 页请求成功，返回 1000 条记录
2025-10-22 18:42:43,924 - backend.dataSources.noc_asset_query - INFO - 发送第 184 页请求，起始ID: 183000
2025-10-22 18:42:43,924 - backend.dataSources.noc_asset_query - INFO - 第 176 页数据已添加，当前总计 176000 条记录
2025-10-22 18:42:43,931 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:44,148 - backend.dataSources.noc_asset_query - INFO - 第 177 页请求成功，返回 1000 条记录
2025-10-22 18:42:44,154 - backend.dataSources.noc_asset_query - INFO - 发送第 185 页请求，起始ID: 184000
2025-10-22 18:42:44,155 - backend.dataSources.noc_asset_query - INFO - 第 177 页数据已添加，当前总计 177000 条记录
2025-10-22 18:42:44,164 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:44,882 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:45,140 - backend.dataSources.noc_asset_query - INFO - 第 178 页请求成功，返回 1000 条记录
2025-10-22 18:42:45,145 - backend.dataSources.noc_asset_query - INFO - 发送第 186 页请求，起始ID: 185000
2025-10-22 18:42:45,146 - backend.dataSources.noc_asset_query - INFO - 第 178 页数据已添加，当前总计 178000 条记录
2025-10-22 18:42:45,151 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:45,250 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:45,519 - backend.dataSources.noc_asset_query - INFO - 第 179 页请求成功，返回 1000 条记录
2025-10-22 18:42:45,529 - backend.dataSources.noc_asset_query - INFO - 发送第 187 页请求，起始ID: 186000
2025-10-22 18:42:45,529 - backend.dataSources.noc_asset_query - INFO - 第 179 页数据已添加，当前总计 179000 条记录
2025-10-22 18:42:45,542 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:46,902 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:46,904 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:47,136 - backend.dataSources.noc_asset_query - INFO - 第 181 页请求成功，返回 1000 条记录
2025-10-22 18:42:47,156 - backend.dataSources.noc_asset_query - INFO - 第 180 页请求成功，返回 1000 条记录
2025-10-22 18:42:47,160 - backend.dataSources.noc_asset_query - INFO - 发送第 188 页请求，起始ID: 187000
2025-10-22 18:42:47,161 - backend.dataSources.noc_asset_query - INFO - 第 181 页数据已添加，当前总计 180000 条记录
2025-10-22 18:42:47,167 - backend.dataSources.noc_asset_query - INFO - 发送第 189 页请求，起始ID: 188000
2025-10-22 18:42:47,168 - backend.dataSources.noc_asset_query - INFO - 第 180 页数据已添加，当前总计 181000 条记录
2025-10-22 18:42:47,176 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:47,176 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:47,691 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:47,867 - backend.dataSources.noc_asset_query - INFO - 第 182 页请求成功，返回 1000 条记录
2025-10-22 18:42:47,871 - backend.dataSources.noc_asset_query - INFO - 发送第 190 页请求，起始ID: 189000
2025-10-22 18:42:47,872 - backend.dataSources.noc_asset_query - INFO - 第 182 页数据已添加，当前总计 182000 条记录
2025-10-22 18:42:47,876 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:48,752 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:48,943 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:49,117 - backend.dataSources.noc_asset_query - INFO - 第 183 页请求成功，返回 1000 条记录
2025-10-22 18:42:49,128 - backend.dataSources.noc_asset_query - INFO - 发送第 191 页请求，起始ID: 190000
2025-10-22 18:42:49,128 - backend.dataSources.noc_asset_query - INFO - 第 183 页数据已添加，当前总计 183000 条记录
2025-10-22 18:42:49,138 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:49,149 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:49,323 - backend.dataSources.noc_asset_query - INFO - 第 184 页请求成功，返回 1000 条记录
2025-10-22 18:42:49,328 - backend.dataSources.noc_asset_query - INFO - 发送第 192 页请求，起始ID: 191000
2025-10-22 18:42:49,328 - backend.dataSources.noc_asset_query - INFO - 第 184 页数据已添加，当前总计 184000 条记录
2025-10-22 18:42:49,332 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:49,455 - backend.dataSources.noc_asset_query - INFO - 第 185 页请求成功，返回 1000 条记录
2025-10-22 18:42:49,461 - backend.dataSources.noc_asset_query - INFO - 发送第 193 页请求，起始ID: 192000
2025-10-22 18:42:49,461 - backend.dataSources.noc_asset_query - INFO - 第 185 页数据已添加，当前总计 185000 条记录
2025-10-22 18:42:49,466 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:49,655 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:49,889 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:49,918 - backend.dataSources.noc_asset_query - INFO - 第 186 页请求成功，返回 1000 条记录
2025-10-22 18:42:49,929 - backend.dataSources.noc_asset_query - INFO - 发送第 194 页请求，起始ID: 193000
2025-10-22 18:42:49,930 - backend.dataSources.noc_asset_query - INFO - 第 186 页数据已添加，当前总计 186000 条记录
2025-10-22 18:42:49,942 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:50,175 - backend.dataSources.noc_asset_query - INFO - 第 187 页请求成功，返回 1000 条记录
2025-10-22 18:42:50,181 - backend.dataSources.noc_asset_query - INFO - 发送第 195 页请求，起始ID: 194000
2025-10-22 18:42:50,182 - backend.dataSources.noc_asset_query - INFO - 第 187 页数据已添加，当前总计 187000 条记录
2025-10-22 18:42:50,190 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:51,089 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:51,090 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:51,321 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:51,562 - backend.dataSources.noc_asset_query - INFO - 第 189 页请求成功，返回 1000 条记录
2025-10-22 18:42:51,598 - backend.dataSources.noc_asset_query - INFO - 第 188 页请求成功，返回 1000 条记录
2025-10-22 18:42:51,610 - backend.dataSources.noc_asset_query - INFO - 发送第 196 页请求，起始ID: 195000
2025-10-22 18:42:51,610 - backend.dataSources.noc_asset_query - INFO - 第 189 页数据已添加，当前总计 188000 条记录
2025-10-22 18:42:51,652 - backend.dataSources.noc_asset_query - INFO - 第 188 页数据已添加，当前总计 189000 条记录
2025-10-22 18:42:51,647 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:51,638 - backend.dataSources.noc_asset_query - INFO - 发送第 197 页请求，起始ID: 196000
2025-10-22 18:42:51,680 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:51,795 - backend.dataSources.noc_asset_query - INFO - 第 190 页请求成功，返回 757 条记录
2025-10-22 18:42:51,809 - backend.dataSources.noc_asset_query - INFO - 发送第 198 页请求，起始ID: 197000
2025-10-22 18:42:51,809 - backend.dataSources.noc_asset_query - INFO - 第 190 页数据已添加，当前总计 189757 条记录
2025-10-22 18:42:51,821 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:52,872 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:52,878 - backend.dataSources.noc_asset_query - INFO - 第 191 页请求成功，返回 0 条记录
2025-10-22 18:42:52,946 - backend.dataSources.noc_asset_query - INFO - 发送第 199 页请求，起始ID: 198000
2025-10-22 18:42:52,947 - backend.dataSources.noc_asset_query - INFO - 第 191 页无数据
2025-10-22 18:42:52,964 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:54,700 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:54,701 - backend.dataSources.noc_asset_query - INFO - 第 192 页请求成功，返回 0 条记录
2025-10-22 18:42:54,704 - backend.dataSources.noc_asset_query - INFO - 发送第 200 页请求，起始ID: 199000
2025-10-22 18:42:54,704 - backend.dataSources.noc_asset_query - INFO - 第 192 页无数据
2025-10-22 18:42:54,707 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:55,247 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:55,249 - backend.dataSources.noc_asset_query - INFO - 第 193 页请求成功，返回 0 条记录
2025-10-22 18:42:55,253 - backend.dataSources.noc_asset_query - INFO - 发送第 201 页请求，起始ID: 200000
2025-10-22 18:42:55,253 - backend.dataSources.noc_asset_query - INFO - 第 193 页无数据
2025-10-22 18:42:55,257 - backend.dataSources.noc_asset_query - INFO - 连续 3 页无数据，停止拉取
2025-10-22 18:42:55,262 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:42:55,337 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:55,339 - backend.dataSources.noc_asset_query - INFO - 第 194 页请求成功，返回 0 条记录
2025-10-22 18:42:56,063 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:56,064 - backend.dataSources.noc_asset_query - INFO - 第 195 页请求成功，返回 0 条记录
2025-10-22 18:42:56,744 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:56,745 - backend.dataSources.noc_asset_query - INFO - 第 197 页请求成功，返回 0 条记录
2025-10-22 18:42:56,824 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:56,825 - backend.dataSources.noc_asset_query - INFO - 第 196 页请求成功，返回 0 条记录
2025-10-22 18:42:56,877 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:56,879 - backend.dataSources.noc_asset_query - INFO - 第 198 页请求成功，返回 0 条记录
2025-10-22 18:42:57,068 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:57,071 - backend.dataSources.noc_asset_query - INFO - 第 199 页请求成功，返回 0 条记录
2025-10-22 18:42:57,983 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:57,984 - backend.dataSources.noc_asset_query - INFO - 第 200 页请求成功，返回 0 条记录
2025-10-22 18:42:58,147 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:42:58,148 - backend.dataSources.noc_asset_query - INFO - 第 201 页请求成功，返回 0 条记录
2025-10-22 18:42:58,153 - backend.dataSources.noc_asset_query - INFO - 光模块全量数据拉取完成，共 189757 条记录
2025-10-22 18:42:58,159 - backend.dataSources.api_optical_module_full_query - INFO - 成功拉取 189757 条原始数据
2025-10-22 18:42:59,940 - backend.dataSources.api_optical_module_full_query - INFO - 数据处理完成，共生成 1281 条记录
2025-10-22 18:43:00,023 - data_loader - DEBUG - Loaded 1281 records from NOC API
2025-10-22 18:43:00,023 - data_loader - INFO - NOC optical module full data load completed (status=0)
2025-10-22 18:43:00,024 - __main__ - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '状态', '机房', '集群', '客户', '在线总数量']
2025-10-22 18:43:00,024 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-22 18:43:00,028 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 18:43:00,028 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 18:43:00,029 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-22 18:43:00,030 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 18:43:00,030 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 18:43:00,031 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 18:43:00,031 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-22 18:43:00,053 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-22 18:43:00,054 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-22 18:43:00,054 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-22 18:43:00,055 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-22 18:43:00,055 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-22 18:43:00,055 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 18:43:00,056 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 18:43:00,056 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-22 18:43:00,056 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-22 18:43:00,066 - __main__ - INFO - Inserted 1281 records into table 光模块在线总数量统计表
2025-10-22 18:43:00,067 - __main__ - DEBUG - Processing data source: <data_loader.XLSXRoceNetworkPartFaultDataSourceLoader object at 0x00000121706F4D70>
2025-10-22 18:43:00,067 - data_loader - DEBUG - Loading XLSX ROCE network part fault data from D:\Code\KC-SQLAgent-Visualization-v1.8\roce事件列表_2025-10-22 18_18_28.xlsx_1761128309.xlsx
2025-10-22 18:43:00,069 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 开始读取XLSX文件: D:\Code\KC-SQLAgent-Visualization-v1.8\roce事件列表_2025-10-22 18_18_28.xlsx_1761128309.xlsx
2025-10-22 18:43:19,426 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 原始数据 20374 条记录，筛选后 1044 条记录
2025-10-22 18:43:19,567 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 需要查询 166 个唯一的SN
2025-10-22 18:43:19,567 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-22 18:43:19,569 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-22 18:43:20,368 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-22 18:43:20,369 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 3 条记录
2025-10-22 18:43:20,372 - backend.dataSources.xlsx_roce_network_part_fault - INFO - API查询返回 3 条记录
2025-10-22 18:43:20,372 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 数据处理完成，共生成 1044 条记录
2025-10-22 18:43:20,380 - data_loader - DEBUG - Loaded 1044 records from XLSX file
2025-10-22 18:43:20,381 - data_loader - INFO - XLSX ROCE network part fault data load completed (status=0)
2025-10-22 18:43:20,382 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-22 18:43:20,383 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 18:43:20,383 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 18:43:20,384 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 18:43:20,384 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 18:43:20,385 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 18:43:20,386 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 18:43:20,387 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 18:43:20,387 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 18:43:20,388 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 18:43:20,389 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 18:43:20,390 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 18:43:20,392 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 18:43:20,393 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 18:43:20,394 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 18:43:20,394 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-22 18:43:20,399 - __main__ - INFO - Rebuilt table ROCE-TOR下联-网络零件（光模块+AOC）故障表 from ROCE-TOR下联-网络零件（光模块+AOC）故障表
2025-10-22 18:43:20,401 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-22 18:43:20,401 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-22 18:43:20,402 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-22 18:43:20,402 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-22 18:43:20,403 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-22 18:43:20,403 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-22 18:43:20,404 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-22 18:43:20,404 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-22 18:43:20,404 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-22 18:43:20,405 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-22 18:43:20,405 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-22 18:43:20,406 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-22 18:43:20,406 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-22 18:43:20,406 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-22 18:43:20,407 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-22 18:43:20,449 - __main__ - INFO - Inserted 1044 records into table ROCE-TOR下联-网络零件（光模块+AOC）故障表
2025-10-22 18:43:20,475 - __main__ - INFO - Database built/updated at real_database.db (rebuild=True, status=0)
2025-10-23 10:03:07,188 - data_loader - DEBUG - Initialized NOCOpticalModuleFullDataSourceLoader with table 光模块在线总数量统计表
2025-10-23 10:03:07,189 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: real_database.db
2025-10-23 10:03:07,200 - __main__ - DEBUG - Processing data source: <data_loader.NOCOpticalModuleFullDataSourceLoader object at 0x000001884BF90C20>
2025-10-23 10:03:07,201 - data_loader - DEBUG - Loading NOC optical module full data
2025-10-23 10:03:07,242 - backend.dataSources.api_optical_module_full_query - INFO - 开始拉取NOC光模块全量数据...
2025-10-23 10:03:07,244 - backend.dataSources.noc_asset_query - INFO - 发送第 1 页请求，起始ID: 0
2025-10-23 10:03:07,248 - backend.dataSources.noc_asset_query - INFO - 发送第 2 页请求，起始ID: 1000
2025-10-23 10:03:07,249 - backend.dataSources.noc_asset_query - INFO - 发送第 3 页请求，起始ID: 2000
2025-10-23 10:03:07,250 - backend.dataSources.noc_asset_query - INFO - 发送第 4 页请求，起始ID: 3000
2025-10-23 10:03:07,250 - backend.dataSources.noc_asset_query - INFO - 发送第 5 页请求，起始ID: 4000
2025-10-23 10:03:07,251 - backend.dataSources.noc_asset_query - INFO - 发送第 6 页请求，起始ID: 5000
2025-10-23 10:03:07,252 - backend.dataSources.noc_asset_query - INFO - 发送第 7 页请求，起始ID: 6000
2025-10-23 10:03:07,253 - backend.dataSources.noc_asset_query - INFO - 发送第 8 页请求，起始ID: 7000
2025-10-23 10:03:07,277 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:07,283 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:07,283 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:07,284 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:07,285 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:07,289 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:07,290 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:07,291 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,317 - backend.dataSources.noc_asset_query - ERROR - 第 2 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,320 - backend.dataSources.noc_asset_query - INFO - 发送第 9 页请求，起始ID: 8000
2025-10-23 10:03:12,321 - backend.dataSources.noc_asset_query - ERROR - 第 6 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,321 - backend.dataSources.noc_asset_query - ERROR - 第 4 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,322 - backend.dataSources.noc_asset_query - ERROR - 第 3 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,322 - backend.dataSources.noc_asset_query - ERROR - 第 5 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,322 - backend.dataSources.noc_asset_query - ERROR - 第 7 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,324 - backend.dataSources.noc_asset_query - ERROR - 第 1 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,324 - backend.dataSources.noc_asset_query - ERROR - 第 8 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:12,324 - backend.dataSources.noc_asset_query - INFO - 发送第 10 页请求，起始ID: 9000
2025-10-23 10:03:12,327 - backend.dataSources.noc_asset_query - INFO - 发送第 11 页请求，起始ID: 10000
2025-10-23 10:03:12,328 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,328 - backend.dataSources.noc_asset_query - INFO - 发送第 12 页请求，起始ID: 11000
2025-10-23 10:03:12,329 - backend.dataSources.noc_asset_query - INFO - 发送第 13 页请求，起始ID: 12000
2025-10-23 10:03:12,329 - backend.dataSources.noc_asset_query - INFO - 发送第 14 页请求，起始ID: 13000
2025-10-23 10:03:12,330 - backend.dataSources.noc_asset_query - INFO - 发送第 15 页请求，起始ID: 14000
2025-10-23 10:03:12,330 - backend.dataSources.noc_asset_query - INFO - 发送第 16 页请求，起始ID: 15000
2025-10-23 10:03:12,334 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,342 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,343 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,344 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,351 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,353 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:12,354 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,449 - backend.dataSources.noc_asset_query - ERROR - 第 11 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,451 - backend.dataSources.noc_asset_query - ERROR - 第 12 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,451 - backend.dataSources.noc_asset_query - ERROR - 第 9 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,453 - backend.dataSources.noc_asset_query - ERROR - 第 10 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,453 - backend.dataSources.noc_asset_query - ERROR - 第 16 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,455 - backend.dataSources.noc_asset_query - ERROR - 第 15 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,456 - backend.dataSources.noc_asset_query - ERROR - 第 13 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,456 - backend.dataSources.noc_asset_query - ERROR - 第 14 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:17,457 - backend.dataSources.noc_asset_query - INFO - 发送第 17 页请求，起始ID: 16000
2025-10-23 10:03:17,458 - backend.dataSources.noc_asset_query - INFO - 发送第 18 页请求，起始ID: 17000
2025-10-23 10:03:17,459 - backend.dataSources.noc_asset_query - INFO - 发送第 19 页请求，起始ID: 18000
2025-10-23 10:03:17,460 - backend.dataSources.noc_asset_query - INFO - 发送第 20 页请求，起始ID: 19000
2025-10-23 10:03:17,461 - backend.dataSources.noc_asset_query - INFO - 发送第 21 页请求，起始ID: 20000
2025-10-23 10:03:17,462 - backend.dataSources.noc_asset_query - INFO - 发送第 22 页请求，起始ID: 21000
2025-10-23 10:03:17,464 - backend.dataSources.noc_asset_query - INFO - 发送第 23 页请求，起始ID: 22000
2025-10-23 10:03:17,465 - backend.dataSources.noc_asset_query - INFO - 发送第 24 页请求，起始ID: 23000
2025-10-23 10:03:17,573 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,574 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,583 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,589 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,600 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,603 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,605 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:17,606 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,626 - backend.dataSources.noc_asset_query - ERROR - 第 17 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,627 - backend.dataSources.noc_asset_query - ERROR - 第 19 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,627 - backend.dataSources.noc_asset_query - INFO - 发送第 25 页请求，起始ID: 24000
2025-10-23 10:03:22,629 - backend.dataSources.noc_asset_query - ERROR - 第 18 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,630 - backend.dataSources.noc_asset_query - INFO - 发送第 26 页请求，起始ID: 25000
2025-10-23 10:03:22,632 - backend.dataSources.noc_asset_query - INFO - 发送第 27 页请求，起始ID: 26000
2025-10-23 10:03:22,643 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,649 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,651 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,703 - backend.dataSources.noc_asset_query - ERROR - 第 20 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,704 - backend.dataSources.noc_asset_query - ERROR - 第 22 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,704 - backend.dataSources.noc_asset_query - ERROR - 第 23 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,705 - backend.dataSources.noc_asset_query - ERROR - 第 24 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,705 - backend.dataSources.noc_asset_query - ERROR - 第 21 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:22,705 - backend.dataSources.noc_asset_query - INFO - 发送第 28 页请求，起始ID: 27000
2025-10-23 10:03:22,706 - backend.dataSources.noc_asset_query - INFO - 发送第 29 页请求，起始ID: 28000
2025-10-23 10:03:22,706 - backend.dataSources.noc_asset_query - INFO - 发送第 30 页请求，起始ID: 29000
2025-10-23 10:03:22,706 - backend.dataSources.noc_asset_query - INFO - 发送第 31 页请求，起始ID: 30000
2025-10-23 10:03:22,707 - backend.dataSources.noc_asset_query - INFO - 发送第 32 页请求，起始ID: 31000
2025-10-23 10:03:22,713 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,716 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,718 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,719 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:22,721 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,672 - backend.dataSources.noc_asset_query - ERROR - 第 25 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,674 - backend.dataSources.noc_asset_query - INFO - 发送第 33 页请求，起始ID: 32000
2025-10-23 10:03:27,720 - backend.dataSources.noc_asset_query - ERROR - 第 27 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,720 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,721 - backend.dataSources.noc_asset_query - ERROR - 第 26 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,721 - backend.dataSources.noc_asset_query - INFO - 发送第 34 页请求，起始ID: 33000
2025-10-23 10:03:27,722 - backend.dataSources.noc_asset_query - INFO - 发送第 35 页请求，起始ID: 34000
2025-10-23 10:03:27,726 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,728 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,820 - backend.dataSources.noc_asset_query - ERROR - 第 28 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,820 - backend.dataSources.noc_asset_query - ERROR - 第 31 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,821 - backend.dataSources.noc_asset_query - ERROR - 第 30 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,821 - backend.dataSources.noc_asset_query - ERROR - 第 29 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,821 - backend.dataSources.noc_asset_query - ERROR - 第 32 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:27,821 - backend.dataSources.noc_asset_query - INFO - 发送第 36 页请求，起始ID: 35000
2025-10-23 10:03:27,822 - backend.dataSources.noc_asset_query - INFO - 发送第 37 页请求，起始ID: 36000
2025-10-23 10:03:27,824 - backend.dataSources.noc_asset_query - INFO - 发送第 38 页请求，起始ID: 37000
2025-10-23 10:03:27,825 - backend.dataSources.noc_asset_query - INFO - 发送第 39 页请求，起始ID: 38000
2025-10-23 10:03:27,826 - backend.dataSources.noc_asset_query - INFO - 发送第 40 页请求，起始ID: 39000
2025-10-23 10:03:27,831 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,841 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,846 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,847 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:27,848 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:32,784 - backend.dataSources.noc_asset_query - ERROR - 第 33 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,785 - backend.dataSources.noc_asset_query - ERROR - 第 34 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,785 - backend.dataSources.noc_asset_query - ERROR - 第 35 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,786 - backend.dataSources.noc_asset_query - INFO - 发送第 41 页请求，起始ID: 40000
2025-10-23 10:03:32,787 - backend.dataSources.noc_asset_query - INFO - 发送第 42 页请求，起始ID: 41000
2025-10-23 10:03:32,787 - backend.dataSources.noc_asset_query - INFO - 发送第 43 页请求，起始ID: 42000
2025-10-23 10:03:32,792 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:32,792 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:32,793 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:32,893 - backend.dataSources.noc_asset_query - ERROR - 第 39 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,893 - backend.dataSources.noc_asset_query - ERROR - 第 40 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,894 - backend.dataSources.noc_asset_query - INFO - 发送第 44 页请求，起始ID: 43000
2025-10-23 10:03:32,894 - backend.dataSources.noc_asset_query - INFO - 发送第 45 页请求，起始ID: 44000
2025-10-23 10:03:32,897 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:32,898 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:32,935 - backend.dataSources.noc_asset_query - ERROR - 第 38 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,936 - backend.dataSources.noc_asset_query - ERROR - 第 37 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,936 - backend.dataSources.noc_asset_query - ERROR - 第 36 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:32,938 - backend.dataSources.noc_asset_query - INFO - 发送第 46 页请求，起始ID: 45000
2025-10-23 10:03:32,945 - backend.dataSources.noc_asset_query - INFO - 发送第 47 页请求，起始ID: 46000
2025-10-23 10:03:32,954 - backend.dataSources.noc_asset_query - INFO - 发送第 48 页请求，起始ID: 47000
2025-10-23 10:03:32,964 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:32,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:33,034 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:37,815 - backend.dataSources.noc_asset_query - ERROR - 第 41 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:37,816 - backend.dataSources.noc_asset_query - ERROR - 第 42 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:37,816 - backend.dataSources.noc_asset_query - ERROR - 第 43 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:37,817 - backend.dataSources.noc_asset_query - INFO - 发送第 49 页请求，起始ID: 48000
2025-10-23 10:03:37,817 - backend.dataSources.noc_asset_query - INFO - 发送第 50 页请求，起始ID: 49000
2025-10-23 10:03:37,818 - backend.dataSources.noc_asset_query - INFO - 发送第 51 页请求，起始ID: 50000
2025-10-23 10:03:37,822 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:37,826 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:37,827 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:37,927 - backend.dataSources.noc_asset_query - ERROR - 第 44 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:37,927 - backend.dataSources.noc_asset_query - ERROR - 第 45 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:37,928 - backend.dataSources.noc_asset_query - INFO - 发送第 52 页请求，起始ID: 51000
2025-10-23 10:03:37,929 - backend.dataSources.noc_asset_query - INFO - 发送第 53 页请求，起始ID: 52000
2025-10-23 10:03:37,932 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:37,935 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:38,052 - backend.dataSources.noc_asset_query - ERROR - 第 46 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:38,060 - backend.dataSources.noc_asset_query - INFO - 发送第 54 页请求，起始ID: 53000
2025-10-23 10:03:38,061 - backend.dataSources.noc_asset_query - ERROR - 第 47 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:38,064 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:38,065 - backend.dataSources.noc_asset_query - INFO - 发送第 55 页请求，起始ID: 54000
2025-10-23 10:03:38,078 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:38,127 - backend.dataSources.noc_asset_query - ERROR - 第 48 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:38,128 - backend.dataSources.noc_asset_query - INFO - 发送第 56 页请求，起始ID: 55000
2025-10-23 10:03:38,132 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:42,849 - backend.dataSources.noc_asset_query - ERROR - 第 49 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:42,849 - backend.dataSources.noc_asset_query - ERROR - 第 51 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:42,850 - backend.dataSources.noc_asset_query - INFO - 发送第 57 页请求，起始ID: 56000
2025-10-23 10:03:42,851 - backend.dataSources.noc_asset_query - ERROR - 第 50 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:42,852 - backend.dataSources.noc_asset_query - INFO - 发送第 58 页请求，起始ID: 57000
2025-10-23 10:03:42,854 - backend.dataSources.noc_asset_query - INFO - 发送第 59 页请求，起始ID: 58000
2025-10-23 10:03:42,860 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:42,866 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:42,868 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:42,958 - backend.dataSources.noc_asset_query - ERROR - 第 53 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:42,959 - backend.dataSources.noc_asset_query - ERROR - 第 52 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:42,959 - backend.dataSources.noc_asset_query - INFO - 发送第 60 页请求，起始ID: 59000
2025-10-23 10:03:42,960 - backend.dataSources.noc_asset_query - INFO - 发送第 61 页请求，起始ID: 60000
2025-10-23 10:03:42,967 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:42,968 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:43,097 - backend.dataSources.noc_asset_query - ERROR - 第 54 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:43,098 - backend.dataSources.noc_asset_query - INFO - 发送第 62 页请求，起始ID: 61000
2025-10-23 10:03:43,144 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:43,144 - backend.dataSources.noc_asset_query - ERROR - 第 55 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:43,146 - backend.dataSources.noc_asset_query - INFO - 发送第 63 页请求，起始ID: 62000
2025-10-23 10:03:43,150 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:43,155 - backend.dataSources.noc_asset_query - ERROR - 第 56 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:43,156 - backend.dataSources.noc_asset_query - INFO - 发送第 64 页请求，起始ID: 63000
2025-10-23 10:03:43,160 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:47,882 - backend.dataSources.noc_asset_query - ERROR - 第 59 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:47,883 - backend.dataSources.noc_asset_query - ERROR - 第 58 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:47,883 - backend.dataSources.noc_asset_query - ERROR - 第 57 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:47,884 - backend.dataSources.noc_asset_query - INFO - 发送第 65 页请求，起始ID: 64000
2025-10-23 10:03:47,885 - backend.dataSources.noc_asset_query - INFO - 发送第 66 页请求，起始ID: 65000
2025-10-23 10:03:47,885 - backend.dataSources.noc_asset_query - INFO - 发送第 67 页请求，起始ID: 66000
2025-10-23 10:03:47,893 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:47,895 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:47,898 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:47,991 - backend.dataSources.noc_asset_query - ERROR - 第 60 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:47,992 - backend.dataSources.noc_asset_query - ERROR - 第 61 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:47,997 - backend.dataSources.noc_asset_query - INFO - 发送第 68 页请求，起始ID: 67000
2025-10-23 10:03:48,001 - backend.dataSources.noc_asset_query - INFO - 发送第 69 页请求，起始ID: 68000
2025-10-23 10:03:48,008 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:48,011 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:48,164 - backend.dataSources.noc_asset_query - ERROR - 第 62 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:48,165 - backend.dataSources.noc_asset_query - INFO - 发送第 70 页请求，起始ID: 69000
2025-10-23 10:03:48,168 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:48,173 - backend.dataSources.noc_asset_query - ERROR - 第 63 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:48,177 - backend.dataSources.noc_asset_query - INFO - 发送第 71 页请求，起始ID: 70000
2025-10-23 10:03:48,183 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:48,193 - backend.dataSources.noc_asset_query - ERROR - 第 64 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:48,200 - backend.dataSources.noc_asset_query - INFO - 发送第 72 页请求，起始ID: 71000
2025-10-23 10:03:48,203 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:52,925 - backend.dataSources.noc_asset_query - ERROR - 第 66 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:52,926 - backend.dataSources.noc_asset_query - ERROR - 第 65 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:52,926 - backend.dataSources.noc_asset_query - ERROR - 第 67 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:52,927 - backend.dataSources.noc_asset_query - INFO - 发送第 73 页请求，起始ID: 72000
2025-10-23 10:03:52,927 - backend.dataSources.noc_asset_query - INFO - 发送第 74 页请求，起始ID: 73000
2025-10-23 10:03:52,929 - backend.dataSources.noc_asset_query - INFO - 发送第 75 页请求，起始ID: 74000
2025-10-23 10:03:52,941 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:52,942 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:52,943 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:53,035 - backend.dataSources.noc_asset_query - ERROR - 第 69 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:53,036 - backend.dataSources.noc_asset_query - ERROR - 第 68 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:53,036 - backend.dataSources.noc_asset_query - INFO - 发送第 76 页请求，起始ID: 75000
2025-10-23 10:03:53,037 - backend.dataSources.noc_asset_query - INFO - 发送第 77 页请求，起始ID: 76000
2025-10-23 10:03:53,130 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:53,134 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:53,191 - backend.dataSources.noc_asset_query - ERROR - 第 70 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:53,193 - backend.dataSources.noc_asset_query - INFO - 发送第 78 页请求，起始ID: 77000
2025-10-23 10:03:53,196 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:53,207 - backend.dataSources.noc_asset_query - ERROR - 第 71 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:53,207 - backend.dataSources.noc_asset_query - INFO - 发送第 79 页请求，起始ID: 78000
2025-10-23 10:03:53,214 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:53,219 - backend.dataSources.noc_asset_query - ERROR - 第 72 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:53,220 - backend.dataSources.noc_asset_query - INFO - 发送第 80 页请求，起始ID: 79000
2025-10-23 10:03:53,223 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:57,963 - backend.dataSources.noc_asset_query - ERROR - 第 75 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:57,964 - backend.dataSources.noc_asset_query - ERROR - 第 73 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:57,965 - backend.dataSources.noc_asset_query - ERROR - 第 74 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:57,965 - backend.dataSources.noc_asset_query - INFO - 发送第 81 页请求，起始ID: 80000
2025-10-23 10:03:57,966 - backend.dataSources.noc_asset_query - INFO - 发送第 82 页请求，起始ID: 81000
2025-10-23 10:03:57,966 - backend.dataSources.noc_asset_query - INFO - 发送第 83 页请求，起始ID: 82000
2025-10-23 10:03:57,973 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:57,975 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:57,976 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:58,150 - backend.dataSources.noc_asset_query - ERROR - 第 76 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:58,150 - backend.dataSources.noc_asset_query - ERROR - 第 77 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:58,151 - backend.dataSources.noc_asset_query - INFO - 发送第 84 页请求，起始ID: 83000
2025-10-23 10:03:58,151 - backend.dataSources.noc_asset_query - INFO - 发送第 85 页请求，起始ID: 84000
2025-10-23 10:03:58,156 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:58,157 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:58,211 - backend.dataSources.noc_asset_query - ERROR - 第 78 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:58,212 - backend.dataSources.noc_asset_query - INFO - 发送第 86 页请求，起始ID: 85000
2025-10-23 10:03:58,215 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:58,221 - backend.dataSources.noc_asset_query - ERROR - 第 79 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:58,222 - backend.dataSources.noc_asset_query - INFO - 发送第 87 页请求，起始ID: 86000
2025-10-23 10:03:58,226 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:03:58,260 - backend.dataSources.noc_asset_query - ERROR - 第 80 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:03:58,266 - backend.dataSources.noc_asset_query - INFO - 发送第 88 页请求，起始ID: 87000
2025-10-23 10:03:58,269 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:04:02,989 - backend.dataSources.noc_asset_query - ERROR - 第 81 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:04:02,989 - backend.dataSources.noc_asset_query - ERROR - 第 83 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:04:02,991 - backend.dataSources.noc_asset_query - ERROR - 第 82 页请求失败: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
2025-10-23 10:04:02,991 - backend.dataSources.noc_asset_query - INFO - 发送第 89 页请求，起始ID: 88000
2025-10-23 10:04:02,992 - backend.dataSources.noc_asset_query - INFO - 发送第 90 页请求，起始ID: 89000
2025-10-23 10:09:03,177 - data_loader - DEBUG - Initialized NOCOpticalModuleFullDataSourceLoader with table 光模块在线总数量统计表
2025-10-23 10:09:03,177 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: real_database.db
2025-10-23 10:09:03,179 - __main__ - DEBUG - Processing data source: <data_loader.NOCOpticalModuleFullDataSourceLoader object at 0x0000017650C1CC20>
2025-10-23 10:09:03,180 - data_loader - DEBUG - Loading NOC optical module full data
2025-10-23 10:09:03,194 - backend.dataSources.api_optical_module_full_query - INFO - 开始拉取NOC光模块全量数据...
2025-10-23 10:09:03,196 - backend.dataSources.noc_asset_query - INFO - 发送第 1 页请求，起始ID: 0
2025-10-23 10:09:03,198 - backend.dataSources.noc_asset_query - INFO - 发送第 2 页请求，起始ID: 1000
2025-10-23 10:09:03,199 - backend.dataSources.noc_asset_query - INFO - 发送第 3 页请求，起始ID: 2000
2025-10-23 10:09:03,201 - backend.dataSources.noc_asset_query - INFO - 发送第 4 页请求，起始ID: 3000
2025-10-23 10:09:03,205 - backend.dataSources.noc_asset_query - INFO - 发送第 5 页请求，起始ID: 4000
2025-10-23 10:09:03,206 - backend.dataSources.noc_asset_query - INFO - 发送第 6 页请求，起始ID: 5000
2025-10-23 10:09:03,208 - backend.dataSources.noc_asset_query - INFO - 发送第 7 页请求，起始ID: 6000
2025-10-23 10:09:03,213 - backend.dataSources.noc_asset_query - INFO - 发送第 8 页请求，起始ID: 7000
2025-10-23 10:09:03,240 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:03,244 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:03,245 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:03,249 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:03,249 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:03,249 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:03,251 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:03,252 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,491 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,511 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,589 - backend.dataSources.noc_asset_query - INFO - 第 1 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,591 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,596 - backend.dataSources.noc_asset_query - INFO - 发送第 9 页请求，起始ID: 8000
2025-10-23 10:09:06,596 - backend.dataSources.noc_asset_query - INFO - 第 1 页数据已添加，当前总计 1000 条记录
2025-10-23 10:09:06,602 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,609 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,632 - backend.dataSources.noc_asset_query - INFO - 第 2 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,633 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,633 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,634 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,638 - backend.dataSources.noc_asset_query - INFO - 发送第 10 页请求，起始ID: 9000
2025-10-23 10:09:06,639 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:06,640 - backend.dataSources.noc_asset_query - INFO - 第 2 页数据已添加，当前总计 2000 条记录
2025-10-23 10:09:06,647 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,799 - backend.dataSources.noc_asset_query - INFO - 第 4 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,808 - backend.dataSources.noc_asset_query - INFO - 第 3 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,811 - backend.dataSources.noc_asset_query - INFO - 发送第 11 页请求，起始ID: 10000
2025-10-23 10:09:06,812 - backend.dataSources.noc_asset_query - INFO - 第 4 页数据已添加，当前总计 3000 条记录
2025-10-23 10:09:06,814 - backend.dataSources.noc_asset_query - INFO - 发送第 12 页请求，起始ID: 11000
2025-10-23 10:09:06,817 - backend.dataSources.noc_asset_query - INFO - 第 3 页数据已添加，当前总计 4000 条记录
2025-10-23 10:09:06,818 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,820 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,853 - backend.dataSources.noc_asset_query - INFO - 第 6 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,857 - backend.dataSources.noc_asset_query - INFO - 发送第 13 页请求，起始ID: 12000
2025-10-23 10:09:06,858 - backend.dataSources.noc_asset_query - INFO - 第 6 页数据已添加，当前总计 5000 条记录
2025-10-23 10:09:06,860 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,885 - backend.dataSources.noc_asset_query - INFO - 第 8 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,889 - backend.dataSources.noc_asset_query - INFO - 发送第 14 页请求，起始ID: 13000
2025-10-23 10:09:06,889 - backend.dataSources.noc_asset_query - INFO - 第 8 页数据已添加，当前总计 6000 条记录
2025-10-23 10:09:06,900 - backend.dataSources.noc_asset_query - INFO - 第 7 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,903 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,907 - backend.dataSources.noc_asset_query - INFO - 发送第 15 页请求，起始ID: 14000
2025-10-23 10:09:06,908 - backend.dataSources.noc_asset_query - INFO - 第 7 页数据已添加，当前总计 7000 条记录
2025-10-23 10:09:06,919 - backend.dataSources.noc_asset_query - INFO - 第 5 页请求成功，返回 1000 条记录
2025-10-23 10:09:06,921 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:06,926 - backend.dataSources.noc_asset_query - INFO - 发送第 16 页请求，起始ID: 15000
2025-10-23 10:09:06,926 - backend.dataSources.noc_asset_query - INFO - 第 5 页数据已添加，当前总计 8000 条记录
2025-10-23 10:09:06,929 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:09,153 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,157 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,254 - backend.dataSources.noc_asset_query - INFO - 第 9 页请求成功，返回 1000 条记录
2025-10-23 10:09:09,258 - backend.dataSources.noc_asset_query - INFO - 发送第 17 页请求，起始ID: 16000
2025-10-23 10:09:09,258 - backend.dataSources.noc_asset_query - INFO - 第 9 页数据已添加，当前总计 9000 条记录
2025-10-23 10:09:09,261 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:09,339 - backend.dataSources.noc_asset_query - INFO - 第 10 页请求成功，返回 1000 条记录
2025-10-23 10:09:09,344 - backend.dataSources.noc_asset_query - INFO - 发送第 18 页请求，起始ID: 17000
2025-10-23 10:09:09,345 - backend.dataSources.noc_asset_query - INFO - 第 10 页数据已添加，当前总计 10000 条记录
2025-10-23 10:09:09,349 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:09,574 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,606 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,661 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,662 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,663 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,679 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:09,909 - backend.dataSources.noc_asset_query - INFO - 第 11 页请求成功，返回 1000 条记录
2025-10-23 10:09:09,912 - backend.dataSources.noc_asset_query - INFO - 发送第 19 页请求，起始ID: 18000
2025-10-23 10:09:09,912 - backend.dataSources.noc_asset_query - INFO - 第 11 页数据已添加，当前总计 11000 条记录
2025-10-23 10:09:09,914 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:10,075 - backend.dataSources.noc_asset_query - INFO - 第 14 页请求成功，返回 1000 条记录
2025-10-23 10:09:10,078 - backend.dataSources.noc_asset_query - INFO - 发送第 20 页请求，起始ID: 19000
2025-10-23 10:09:10,078 - backend.dataSources.noc_asset_query - INFO - 第 14 页数据已添加，当前总计 12000 条记录
2025-10-23 10:09:10,080 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:10,195 - backend.dataSources.noc_asset_query - INFO - 第 12 页请求成功，返回 1000 条记录
2025-10-23 10:09:10,198 - backend.dataSources.noc_asset_query - INFO - 发送第 21 页请求，起始ID: 20000
2025-10-23 10:09:10,198 - backend.dataSources.noc_asset_query - INFO - 第 12 页数据已添加，当前总计 13000 条记录
2025-10-23 10:09:10,200 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:10,292 - backend.dataSources.noc_asset_query - INFO - 第 13 页请求成功，返回 1000 条记录
2025-10-23 10:09:10,301 - backend.dataSources.noc_asset_query - INFO - 第 15 页请求成功，返回 1000 条记录
2025-10-23 10:09:10,303 - backend.dataSources.noc_asset_query - INFO - 发送第 22 页请求，起始ID: 21000
2025-10-23 10:09:10,304 - backend.dataSources.noc_asset_query - INFO - 第 13 页数据已添加，当前总计 14000 条记录
2025-10-23 10:09:10,306 - backend.dataSources.noc_asset_query - INFO - 发送第 23 页请求，起始ID: 22000
2025-10-23 10:09:10,309 - backend.dataSources.noc_asset_query - INFO - 第 15 页数据已添加，当前总计 15000 条记录
2025-10-23 10:09:10,309 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:10,311 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:10,326 - backend.dataSources.noc_asset_query - INFO - 第 16 页请求成功，返回 1000 条记录
2025-10-23 10:09:10,330 - backend.dataSources.noc_asset_query - INFO - 发送第 24 页请求，起始ID: 23000
2025-10-23 10:09:10,330 - backend.dataSources.noc_asset_query - INFO - 第 16 页数据已添加，当前总计 16000 条记录
2025-10-23 10:09:10,333 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:11,057 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:11,071 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:11,126 - backend.dataSources.noc_asset_query - INFO - 第 17 页请求成功，返回 1000 条记录
2025-10-23 10:09:11,129 - backend.dataSources.noc_asset_query - INFO - 发送第 25 页请求，起始ID: 24000
2025-10-23 10:09:11,129 - backend.dataSources.noc_asset_query - INFO - 第 17 页数据已添加，当前总计 17000 条记录
2025-10-23 10:09:11,131 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:11,357 - backend.dataSources.noc_asset_query - INFO - 第 18 页请求成功，返回 1000 条记录
2025-10-23 10:09:11,361 - backend.dataSources.noc_asset_query - INFO - 发送第 26 页请求，起始ID: 25000
2025-10-23 10:09:11,361 - backend.dataSources.noc_asset_query - INFO - 第 18 页数据已添加，当前总计 18000 条记录
2025-10-23 10:09:11,364 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:12,020 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:12,161 - backend.dataSources.noc_asset_query - INFO - 第 19 页请求成功，返回 1000 条记录
2025-10-23 10:09:12,166 - backend.dataSources.noc_asset_query - INFO - 发送第 27 页请求，起始ID: 26000
2025-10-23 10:09:12,166 - backend.dataSources.noc_asset_query - INFO - 第 19 页数据已添加，当前总计 19000 条记录
2025-10-23 10:09:12,169 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:12,424 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:12,550 - backend.dataSources.noc_asset_query - INFO - 第 20 页请求成功，返回 1000 条记录
2025-10-23 10:09:12,552 - backend.dataSources.noc_asset_query - INFO - 发送第 28 页请求，起始ID: 27000
2025-10-23 10:09:12,552 - backend.dataSources.noc_asset_query - INFO - 第 20 页数据已添加，当前总计 20000 条记录
2025-10-23 10:09:12,554 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:12,573 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:12,646 - backend.dataSources.noc_asset_query - INFO - 第 21 页请求成功，返回 1000 条记录
2025-10-23 10:09:12,649 - backend.dataSources.noc_asset_query - INFO - 发送第 29 页请求，起始ID: 28000
2025-10-23 10:09:12,649 - backend.dataSources.noc_asset_query - INFO - 第 21 页数据已添加，当前总计 21000 条记录
2025-10-23 10:09:12,651 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:12,797 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:12,834 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:12,839 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:12,975 - backend.dataSources.noc_asset_query - INFO - 第 24 页请求成功，返回 1000 条记录
2025-10-23 10:09:12,978 - backend.dataSources.noc_asset_query - INFO - 发送第 30 页请求，起始ID: 29000
2025-10-23 10:09:12,978 - backend.dataSources.noc_asset_query - INFO - 第 24 页数据已添加，当前总计 22000 条记录
2025-10-23 10:09:12,980 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:13,011 - backend.dataSources.noc_asset_query - INFO - 第 23 页请求成功，返回 1000 条记录
2025-10-23 10:09:13,020 - backend.dataSources.noc_asset_query - INFO - 第 22 页请求成功，返回 1000 条记录
2025-10-23 10:09:13,022 - backend.dataSources.noc_asset_query - INFO - 发送第 31 页请求，起始ID: 30000
2025-10-23 10:09:13,022 - backend.dataSources.noc_asset_query - INFO - 第 23 页数据已添加，当前总计 23000 条记录
2025-10-23 10:09:13,025 - backend.dataSources.noc_asset_query - INFO - 发送第 32 页请求，起始ID: 31000
2025-10-23 10:09:13,026 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:13,026 - backend.dataSources.noc_asset_query - INFO - 第 22 页数据已添加，当前总计 24000 条记录
2025-10-23 10:09:13,030 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:13,153 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:13,280 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:13,360 - backend.dataSources.noc_asset_query - INFO - 第 25 页请求成功，返回 1000 条记录
2025-10-23 10:09:13,392 - backend.dataSources.noc_asset_query - INFO - 发送第 33 页请求，起始ID: 32000
2025-10-23 10:09:13,392 - backend.dataSources.noc_asset_query - INFO - 第 25 页数据已添加，当前总计 25000 条记录
2025-10-23 10:09:13,396 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:13,492 - backend.dataSources.noc_asset_query - INFO - 第 26 页请求成功，返回 1000 条记录
2025-10-23 10:09:13,497 - backend.dataSources.noc_asset_query - INFO - 发送第 34 页请求，起始ID: 33000
2025-10-23 10:09:13,498 - backend.dataSources.noc_asset_query - INFO - 第 26 页数据已添加，当前总计 26000 条记录
2025-10-23 10:09:13,500 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:13,756 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:13,837 - backend.dataSources.noc_asset_query - INFO - 第 27 页请求成功，返回 1000 条记录
2025-10-23 10:09:13,841 - backend.dataSources.noc_asset_query - INFO - 发送第 35 页请求，起始ID: 34000
2025-10-23 10:09:13,841 - backend.dataSources.noc_asset_query - INFO - 第 27 页数据已添加，当前总计 27000 条记录
2025-10-23 10:09:13,843 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:14,463 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:14,479 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:14,570 - backend.dataSources.noc_asset_query - INFO - 第 28 页请求成功，返回 1000 条记录
2025-10-23 10:09:14,572 - backend.dataSources.noc_asset_query - INFO - 发送第 36 页请求，起始ID: 35000
2025-10-23 10:09:14,572 - backend.dataSources.noc_asset_query - INFO - 第 28 页数据已添加，当前总计 28000 条记录
2025-10-23 10:09:14,574 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:14,587 - backend.dataSources.noc_asset_query - INFO - 第 29 页请求成功，返回 1000 条记录
2025-10-23 10:09:14,590 - backend.dataSources.noc_asset_query - INFO - 发送第 37 页请求，起始ID: 36000
2025-10-23 10:09:14,591 - backend.dataSources.noc_asset_query - INFO - 第 29 页数据已添加，当前总计 29000 条记录
2025-10-23 10:09:14,593 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:15,577 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:15,714 - backend.dataSources.noc_asset_query - INFO - 第 30 页请求成功，返回 1000 条记录
2025-10-23 10:09:15,717 - backend.dataSources.noc_asset_query - INFO - 发送第 38 页请求，起始ID: 37000
2025-10-23 10:09:15,718 - backend.dataSources.noc_asset_query - INFO - 第 30 页数据已添加，当前总计 30000 条记录
2025-10-23 10:09:15,720 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:16,135 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:16,136 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:16,256 - backend.dataSources.noc_asset_query - INFO - 第 31 页请求成功，返回 1000 条记录
2025-10-23 10:09:16,260 - backend.dataSources.noc_asset_query - INFO - 发送第 39 页请求，起始ID: 38000
2025-10-23 10:09:16,261 - backend.dataSources.noc_asset_query - INFO - 第 31 页数据已添加，当前总计 31000 条记录
2025-10-23 10:09:16,265 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:16,280 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:16,290 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:16,355 - backend.dataSources.noc_asset_query - INFO - 第 32 页请求成功，返回 1000 条记录
2025-10-23 10:09:16,361 - backend.dataSources.noc_asset_query - INFO - 发送第 40 页请求，起始ID: 39000
2025-10-23 10:09:16,362 - backend.dataSources.noc_asset_query - INFO - 第 32 页数据已添加，当前总计 32000 条记录
2025-10-23 10:09:16,365 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:16,416 - backend.dataSources.noc_asset_query - INFO - 第 33 页请求成功，返回 1000 条记录
2025-10-23 10:09:16,424 - backend.dataSources.noc_asset_query - INFO - 第 34 页请求成功，返回 1000 条记录
2025-10-23 10:09:16,427 - backend.dataSources.noc_asset_query - INFO - 发送第 41 页请求，起始ID: 40000
2025-10-23 10:09:16,427 - backend.dataSources.noc_asset_query - INFO - 第 33 页数据已添加，当前总计 33000 条记录
2025-10-23 10:09:16,430 - backend.dataSources.noc_asset_query - INFO - 发送第 42 页请求，起始ID: 41000
2025-10-23 10:09:16,432 - backend.dataSources.noc_asset_query - INFO - 第 34 页数据已添加，当前总计 34000 条记录
2025-10-23 10:09:16,434 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:16,435 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:16,501 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:16,557 - backend.dataSources.noc_asset_query - INFO - 第 35 页请求成功，返回 1000 条记录
2025-10-23 10:09:16,561 - backend.dataSources.noc_asset_query - INFO - 发送第 43 页请求，起始ID: 42000
2025-10-23 10:09:16,561 - backend.dataSources.noc_asset_query - INFO - 第 35 页数据已添加，当前总计 35000 条记录
2025-10-23 10:09:16,562 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:17,122 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:17,123 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:17,238 - backend.dataSources.noc_asset_query - INFO - 第 37 页请求成功，返回 1000 条记录
2025-10-23 10:09:17,242 - backend.dataSources.noc_asset_query - INFO - 发送第 44 页请求，起始ID: 43000
2025-10-23 10:09:17,242 - backend.dataSources.noc_asset_query - INFO - 第 37 页数据已添加，当前总计 36000 条记录
2025-10-23 10:09:17,244 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:17,298 - backend.dataSources.noc_asset_query - INFO - 第 36 页请求成功，返回 1000 条记录
2025-10-23 10:09:17,300 - backend.dataSources.noc_asset_query - INFO - 发送第 45 页请求，起始ID: 44000
2025-10-23 10:09:17,300 - backend.dataSources.noc_asset_query - INFO - 第 36 页数据已添加，当前总计 37000 条记录
2025-10-23 10:09:17,302 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:17,365 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:17,516 - backend.dataSources.noc_asset_query - INFO - 第 38 页请求成功，返回 1000 条记录
2025-10-23 10:09:17,519 - backend.dataSources.noc_asset_query - INFO - 发送第 46 页请求，起始ID: 45000
2025-10-23 10:09:17,519 - backend.dataSources.noc_asset_query - INFO - 第 38 页数据已添加，当前总计 38000 条记录
2025-10-23 10:09:17,520 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:18,775 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:18,886 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:18,985 - backend.dataSources.noc_asset_query - INFO - 第 40 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,005 - backend.dataSources.noc_asset_query - INFO - 第 39 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,013 - backend.dataSources.noc_asset_query - INFO - 发送第 47 页请求，起始ID: 46000
2025-10-23 10:09:19,018 - backend.dataSources.noc_asset_query - INFO - 发送第 48 页请求，起始ID: 47000
2025-10-23 10:09:19,018 - backend.dataSources.noc_asset_query - INFO - 第 40 页数据已添加，当前总计 39000 条记录
2025-10-23 10:09:19,025 - backend.dataSources.noc_asset_query - INFO - 第 39 页数据已添加，当前总计 40000 条记录
2025-10-23 10:09:19,029 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:19,031 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:19,297 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:19,326 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:19,355 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:19,423 - backend.dataSources.noc_asset_query - INFO - 第 42 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,426 - backend.dataSources.noc_asset_query - INFO - 发送第 49 页请求，起始ID: 48000
2025-10-23 10:09:19,426 - backend.dataSources.noc_asset_query - INFO - 第 42 页数据已添加，当前总计 41000 条记录
2025-10-23 10:09:19,429 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:19,457 - backend.dataSources.noc_asset_query - INFO - 第 43 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,467 - backend.dataSources.noc_asset_query - INFO - 第 41 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,471 - backend.dataSources.noc_asset_query - INFO - 发送第 50 页请求，起始ID: 49000
2025-10-23 10:09:19,473 - backend.dataSources.noc_asset_query - INFO - 发送第 51 页请求，起始ID: 50000
2025-10-23 10:09:19,474 - backend.dataSources.noc_asset_query - INFO - 第 43 页数据已添加，当前总计 42000 条记录
2025-10-23 10:09:19,477 - backend.dataSources.noc_asset_query - INFO - 第 41 页数据已添加，当前总计 43000 条记录
2025-10-23 10:09:19,478 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:19,478 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:19,799 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:19,799 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:19,833 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:19,924 - backend.dataSources.noc_asset_query - INFO - 第 45 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,927 - backend.dataSources.noc_asset_query - INFO - 发送第 52 页请求，起始ID: 51000
2025-10-23 10:09:19,927 - backend.dataSources.noc_asset_query - INFO - 第 45 页数据已添加，当前总计 44000 条记录
2025-10-23 10:09:19,930 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:19,941 - backend.dataSources.noc_asset_query - INFO - 第 44 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,945 - backend.dataSources.noc_asset_query - INFO - 发送第 53 页请求，起始ID: 52000
2025-10-23 10:09:19,945 - backend.dataSources.noc_asset_query - INFO - 第 44 页数据已添加，当前总计 45000 条记录
2025-10-23 10:09:19,947 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:19,996 - backend.dataSources.noc_asset_query - INFO - 第 46 页请求成功，返回 1000 条记录
2025-10-23 10:09:19,999 - backend.dataSources.noc_asset_query - INFO - 发送第 54 页请求，起始ID: 53000
2025-10-23 10:09:19,999 - backend.dataSources.noc_asset_query - INFO - 第 46 页数据已添加，当前总计 46000 条记录
2025-10-23 10:09:20,001 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:21,747 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:21,751 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:21,935 - backend.dataSources.noc_asset_query - INFO - 第 47 页请求成功，返回 1000 条记录
2025-10-23 10:09:21,954 - backend.dataSources.noc_asset_query - INFO - 第 48 页请求成功，返回 1000 条记录
2025-10-23 10:09:21,959 - backend.dataSources.noc_asset_query - INFO - 发送第 55 页请求，起始ID: 54000
2025-10-23 10:09:21,959 - backend.dataSources.noc_asset_query - INFO - 第 47 页数据已添加，当前总计 47000 条记录
2025-10-23 10:09:21,967 - backend.dataSources.noc_asset_query - INFO - 发送第 56 页请求，起始ID: 55000
2025-10-23 10:09:21,972 - backend.dataSources.noc_asset_query - INFO - 第 48 页数据已添加，当前总计 48000 条记录
2025-10-23 10:09:21,974 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:21,979 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:22,358 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:22,448 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:22,454 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:22,512 - backend.dataSources.noc_asset_query - INFO - 第 49 页请求成功，返回 1000 条记录
2025-10-23 10:09:22,514 - backend.dataSources.noc_asset_query - INFO - 发送第 57 页请求，起始ID: 56000
2025-10-23 10:09:22,514 - backend.dataSources.noc_asset_query - INFO - 第 49 页数据已添加，当前总计 49000 条记录
2025-10-23 10:09:22,516 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:22,566 - backend.dataSources.noc_asset_query - INFO - 第 50 页请求成功，返回 1000 条记录
2025-10-23 10:09:22,569 - backend.dataSources.noc_asset_query - INFO - 发送第 58 页请求，起始ID: 57000
2025-10-23 10:09:22,569 - backend.dataSources.noc_asset_query - INFO - 第 50 页数据已添加，当前总计 50000 条记录
2025-10-23 10:09:22,578 - backend.dataSources.noc_asset_query - INFO - 第 51 页请求成功，返回 1000 条记录
2025-10-23 10:09:22,581 - backend.dataSources.noc_asset_query - INFO - 发送第 59 页请求，起始ID: 58000
2025-10-23 10:09:22,582 - backend.dataSources.noc_asset_query - INFO - 第 51 页数据已添加，当前总计 51000 条记录
2025-10-23 10:09:22,583 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:22,585 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:22,699 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:22,714 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:22,740 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:22,845 - backend.dataSources.noc_asset_query - INFO - 第 52 页请求成功，返回 1000 条记录
2025-10-23 10:09:22,848 - backend.dataSources.noc_asset_query - INFO - 发送第 60 页请求，起始ID: 59000
2025-10-23 10:09:22,849 - backend.dataSources.noc_asset_query - INFO - 第 52 页数据已添加，当前总计 52000 条记录
2025-10-23 10:09:22,851 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:22,895 - backend.dataSources.noc_asset_query - INFO - 第 53 页请求成功，返回 1000 条记录
2025-10-23 10:09:22,898 - backend.dataSources.noc_asset_query - INFO - 发送第 61 页请求，起始ID: 60000
2025-10-23 10:09:22,899 - backend.dataSources.noc_asset_query - INFO - 第 53 页数据已添加，当前总计 53000 条记录
2025-10-23 10:09:22,901 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:23,006 - backend.dataSources.noc_asset_query - INFO - 第 54 页请求成功，返回 1000 条记录
2025-10-23 10:09:23,009 - backend.dataSources.noc_asset_query - INFO - 发送第 62 页请求，起始ID: 61000
2025-10-23 10:09:23,009 - backend.dataSources.noc_asset_query - INFO - 第 54 页数据已添加，当前总计 54000 条记录
2025-10-23 10:09:23,011 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:24,927 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:24,934 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:25,067 - backend.dataSources.noc_asset_query - INFO - 第 55 页请求成功，返回 1000 条记录
2025-10-23 10:09:25,093 - backend.dataSources.noc_asset_query - INFO - 发送第 63 页请求，起始ID: 62000
2025-10-23 10:09:25,094 - backend.dataSources.noc_asset_query - INFO - 第 56 页请求成功，返回 1000 条记录
2025-10-23 10:09:25,094 - backend.dataSources.noc_asset_query - INFO - 第 55 页数据已添加，当前总计 55000 条记录
2025-10-23 10:09:25,100 - backend.dataSources.noc_asset_query - INFO - 发送第 64 页请求，起始ID: 63000
2025-10-23 10:09:25,102 - backend.dataSources.noc_asset_query - INFO - 第 56 页数据已添加，当前总计 56000 条记录
2025-10-23 10:09:25,106 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:25,111 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:25,520 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:25,655 - backend.dataSources.noc_asset_query - INFO - 第 57 页请求成功，返回 1000 条记录
2025-10-23 10:09:25,658 - backend.dataSources.noc_asset_query - INFO - 发送第 65 页请求，起始ID: 64000
2025-10-23 10:09:25,658 - backend.dataSources.noc_asset_query - INFO - 第 57 页数据已添加，当前总计 57000 条记录
2025-10-23 10:09:25,659 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:25,748 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:25,754 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:25,897 - backend.dataSources.noc_asset_query - INFO - 第 58 页请求成功，返回 1000 条记录
2025-10-23 10:09:25,897 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:25,900 - backend.dataSources.noc_asset_query - INFO - 发送第 66 页请求，起始ID: 65000
2025-10-23 10:09:25,901 - backend.dataSources.noc_asset_query - INFO - 第 58 页数据已添加，当前总计 58000 条记录
2025-10-23 10:09:25,903 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:25,931 - backend.dataSources.noc_asset_query - INFO - 第 59 页请求成功，返回 1000 条记录
2025-10-23 10:09:25,935 - backend.dataSources.noc_asset_query - INFO - 发送第 67 页请求，起始ID: 66000
2025-10-23 10:09:25,935 - backend.dataSources.noc_asset_query - INFO - 第 59 页数据已添加，当前总计 59000 条记录
2025-10-23 10:09:25,938 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:25,968 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:25,985 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:26,008 - backend.dataSources.noc_asset_query - INFO - 第 60 页请求成功，返回 1000 条记录
2025-10-23 10:09:26,012 - backend.dataSources.noc_asset_query - INFO - 发送第 68 页请求，起始ID: 67000
2025-10-23 10:09:26,013 - backend.dataSources.noc_asset_query - INFO - 第 60 页数据已添加，当前总计 60000 条记录
2025-10-23 10:09:26,016 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:26,131 - backend.dataSources.noc_asset_query - INFO - 第 61 页请求成功，返回 1000 条记录
2025-10-23 10:09:26,143 - backend.dataSources.noc_asset_query - INFO - 第 62 页请求成功，返回 1000 条记录
2025-10-23 10:09:26,146 - backend.dataSources.noc_asset_query - INFO - 发送第 69 页请求，起始ID: 68000
2025-10-23 10:09:26,146 - backend.dataSources.noc_asset_query - INFO - 第 61 页数据已添加，当前总计 61000 条记录
2025-10-23 10:09:26,153 - backend.dataSources.noc_asset_query - INFO - 发送第 70 页请求，起始ID: 69000
2025-10-23 10:09:26,155 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:26,155 - backend.dataSources.noc_asset_query - INFO - 第 62 页数据已添加，当前总计 62000 条记录
2025-10-23 10:09:26,158 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:27,479 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:27,495 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:27,630 - backend.dataSources.noc_asset_query - INFO - 第 64 页请求成功，返回 1000 条记录
2025-10-23 10:09:27,645 - backend.dataSources.noc_asset_query - INFO - 第 63 页请求成功，返回 1000 条记录
2025-10-23 10:09:27,647 - backend.dataSources.noc_asset_query - INFO - 发送第 71 页请求，起始ID: 70000
2025-10-23 10:09:27,648 - backend.dataSources.noc_asset_query - INFO - 第 64 页数据已添加，当前总计 63000 条记录
2025-10-23 10:09:27,651 - backend.dataSources.noc_asset_query - INFO - 发送第 72 页请求，起始ID: 71000
2025-10-23 10:09:27,654 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:27,655 - backend.dataSources.noc_asset_query - INFO - 第 63 页数据已添加，当前总计 64000 条记录
2025-10-23 10:09:27,658 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:28,452 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:28,647 - backend.dataSources.noc_asset_query - INFO - 第 65 页请求成功，返回 1000 条记录
2025-10-23 10:09:28,655 - backend.dataSources.noc_asset_query - INFO - 发送第 73 页请求，起始ID: 72000
2025-10-23 10:09:28,655 - backend.dataSources.noc_asset_query - INFO - 第 65 页数据已添加，当前总计 65000 条记录
2025-10-23 10:09:28,660 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:28,812 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:28,969 - backend.dataSources.noc_asset_query - INFO - 第 66 页请求成功，返回 1000 条记录
2025-10-23 10:09:28,972 - backend.dataSources.noc_asset_query - INFO - 发送第 74 页请求，起始ID: 73000
2025-10-23 10:09:28,972 - backend.dataSources.noc_asset_query - INFO - 第 66 页数据已添加，当前总计 66000 条记录
2025-10-23 10:09:28,974 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:29,127 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:29,289 - backend.dataSources.noc_asset_query - INFO - 第 68 页请求成功，返回 1000 条记录
2025-10-23 10:09:29,291 - backend.dataSources.noc_asset_query - INFO - 发送第 75 页请求，起始ID: 74000
2025-10-23 10:09:29,291 - backend.dataSources.noc_asset_query - INFO - 第 68 页数据已添加，当前总计 67000 条记录
2025-10-23 10:09:29,293 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:29,457 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:29,494 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:29,498 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:29,629 - backend.dataSources.noc_asset_query - INFO - 第 67 页请求成功，返回 1000 条记录
2025-10-23 10:09:29,642 - backend.dataSources.noc_asset_query - INFO - 第 69 页请求成功，返回 1000 条记录
2025-10-23 10:09:29,644 - backend.dataSources.noc_asset_query - INFO - 发送第 76 页请求，起始ID: 75000
2025-10-23 10:09:29,644 - backend.dataSources.noc_asset_query - INFO - 第 67 页数据已添加，当前总计 68000 条记录
2025-10-23 10:09:29,649 - backend.dataSources.noc_asset_query - INFO - 发送第 77 页请求，起始ID: 76000
2025-10-23 10:09:29,652 - backend.dataSources.noc_asset_query - INFO - 第 69 页数据已添加，当前总计 69000 条记录
2025-10-23 10:09:29,652 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:29,655 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:29,708 - backend.dataSources.noc_asset_query - INFO - 第 70 页请求成功，返回 1000 条记录
2025-10-23 10:09:29,711 - backend.dataSources.noc_asset_query - INFO - 发送第 78 页请求，起始ID: 77000
2025-10-23 10:09:29,711 - backend.dataSources.noc_asset_query - INFO - 第 70 页数据已添加，当前总计 70000 条记录
2025-10-23 10:09:29,713 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:30,400 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:30,403 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:30,556 - backend.dataSources.noc_asset_query - INFO - 第 71 页请求成功，返回 1000 条记录
2025-10-23 10:09:30,559 - backend.dataSources.noc_asset_query - INFO - 发送第 79 页请求，起始ID: 78000
2025-10-23 10:09:30,559 - backend.dataSources.noc_asset_query - INFO - 第 71 页数据已添加，当前总计 71000 条记录
2025-10-23 10:09:30,562 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:30,593 - backend.dataSources.noc_asset_query - INFO - 第 72 页请求成功，返回 1000 条记录
2025-10-23 10:09:30,596 - backend.dataSources.noc_asset_query - INFO - 发送第 80 页请求，起始ID: 79000
2025-10-23 10:09:30,596 - backend.dataSources.noc_asset_query - INFO - 第 72 页数据已添加，当前总计 72000 条记录
2025-10-23 10:09:30,598 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:31,264 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:31,420 - backend.dataSources.noc_asset_query - INFO - 第 73 页请求成功，返回 1000 条记录
2025-10-23 10:09:31,422 - backend.dataSources.noc_asset_query - INFO - 发送第 81 页请求，起始ID: 80000
2025-10-23 10:09:31,423 - backend.dataSources.noc_asset_query - INFO - 第 73 页数据已添加，当前总计 73000 条记录
2025-10-23 10:09:31,424 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:31,683 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:31,933 - backend.dataSources.noc_asset_query - INFO - 第 74 页请求成功，返回 1000 条记录
2025-10-23 10:09:31,936 - backend.dataSources.noc_asset_query - INFO - 发送第 82 页请求，起始ID: 81000
2025-10-23 10:09:31,937 - backend.dataSources.noc_asset_query - INFO - 第 74 页数据已添加，当前总计 74000 条记录
2025-10-23 10:09:31,941 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:32,497 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:32,662 - backend.dataSources.noc_asset_query - INFO - 第 75 页请求成功，返回 1000 条记录
2025-10-23 10:09:32,666 - backend.dataSources.noc_asset_query - INFO - 发送第 83 页请求，起始ID: 82000
2025-10-23 10:09:32,666 - backend.dataSources.noc_asset_query - INFO - 第 75 页数据已添加，当前总计 75000 条记录
2025-10-23 10:09:32,670 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:33,316 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:33,335 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:33,338 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:33,517 - backend.dataSources.noc_asset_query - INFO - 第 78 页请求成功，返回 1000 条记录
2025-10-23 10:09:33,518 - backend.dataSources.noc_asset_query - INFO - 第 76 页请求成功，返回 1000 条记录
2025-10-23 10:09:33,535 - backend.dataSources.noc_asset_query - INFO - 发送第 84 页请求，起始ID: 83000
2025-10-23 10:09:33,535 - backend.dataSources.noc_asset_query - INFO - 第 77 页请求成功，返回 1000 条记录
2025-10-23 10:09:33,536 - backend.dataSources.noc_asset_query - INFO - 第 78 页数据已添加，当前总计 76000 条记录
2025-10-23 10:09:33,537 - backend.dataSources.noc_asset_query - INFO - 发送第 85 页请求，起始ID: 84000
2025-10-23 10:09:33,541 - backend.dataSources.noc_asset_query - INFO - 发送第 86 页请求，起始ID: 85000
2025-10-23 10:09:33,542 - backend.dataSources.noc_asset_query - INFO - 第 76 页数据已添加，当前总计 77000 条记录
2025-10-23 10:09:33,543 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:33,547 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:33,548 - backend.dataSources.noc_asset_query - INFO - 第 77 页数据已添加，当前总计 78000 条记录
2025-10-23 10:09:33,549 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:33,848 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:33,878 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:33,976 - backend.dataSources.noc_asset_query - INFO - 第 79 页请求成功，返回 1000 条记录
2025-10-23 10:09:33,979 - backend.dataSources.noc_asset_query - INFO - 发送第 87 页请求，起始ID: 86000
2025-10-23 10:09:33,979 - backend.dataSources.noc_asset_query - INFO - 第 79 页数据已添加，当前总计 79000 条记录
2025-10-23 10:09:33,981 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:34,001 - backend.dataSources.noc_asset_query - INFO - 第 80 页请求成功，返回 1000 条记录
2025-10-23 10:09:34,003 - backend.dataSources.noc_asset_query - INFO - 发送第 88 页请求，起始ID: 87000
2025-10-23 10:09:34,004 - backend.dataSources.noc_asset_query - INFO - 第 80 页数据已添加，当前总计 80000 条记录
2025-10-23 10:09:34,006 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:34,435 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:34,542 - backend.dataSources.noc_asset_query - INFO - 第 81 页请求成功，返回 1000 条记录
2025-10-23 10:09:34,545 - backend.dataSources.noc_asset_query - INFO - 发送第 89 页请求，起始ID: 88000
2025-10-23 10:09:34,545 - backend.dataSources.noc_asset_query - INFO - 第 81 页数据已添加，当前总计 81000 条记录
2025-10-23 10:09:34,547 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:34,595 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:34,767 - backend.dataSources.noc_asset_query - INFO - 第 82 页请求成功，返回 1000 条记录
2025-10-23 10:09:34,770 - backend.dataSources.noc_asset_query - INFO - 发送第 90 页请求，起始ID: 89000
2025-10-23 10:09:34,770 - backend.dataSources.noc_asset_query - INFO - 第 82 页数据已添加，当前总计 82000 条记录
2025-10-23 10:09:34,771 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:34,895 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:35,085 - backend.dataSources.noc_asset_query - INFO - 第 83 页请求成功，返回 1000 条记录
2025-10-23 10:09:35,089 - backend.dataSources.noc_asset_query - INFO - 发送第 91 页请求，起始ID: 90000
2025-10-23 10:09:35,089 - backend.dataSources.noc_asset_query - INFO - 第 83 页数据已添加，当前总计 83000 条记录
2025-10-23 10:09:35,091 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:36,902 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:36,908 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:36,910 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:37,098 - backend.dataSources.noc_asset_query - INFO - 第 85 页请求成功，返回 1000 条记录
2025-10-23 10:09:37,098 - backend.dataSources.noc_asset_query - INFO - 第 86 页请求成功，返回 1000 条记录
2025-10-23 10:09:37,105 - backend.dataSources.noc_asset_query - INFO - 发送第 92 页请求，起始ID: 91000
2025-10-23 10:09:37,107 - backend.dataSources.noc_asset_query - INFO - 第 85 页数据已添加，当前总计 84000 条记录
2025-10-23 10:09:37,116 - backend.dataSources.noc_asset_query - INFO - 发送第 93 页请求，起始ID: 92000
2025-10-23 10:09:37,119 - backend.dataSources.noc_asset_query - INFO - 第 86 页数据已添加，当前总计 85000 条记录
2025-10-23 10:09:37,128 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:37,154 - backend.dataSources.noc_asset_query - INFO - 第 84 页请求成功，返回 1000 条记录
2025-10-23 10:09:37,157 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:37,168 - backend.dataSources.noc_asset_query - INFO - 发送第 94 页请求，起始ID: 93000
2025-10-23 10:09:37,168 - backend.dataSources.noc_asset_query - INFO - 第 84 页数据已添加，当前总计 86000 条记录
2025-10-23 10:09:37,180 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:37,215 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:37,221 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:37,349 - backend.dataSources.noc_asset_query - INFO - 第 87 页请求成功，返回 1000 条记录
2025-10-23 10:09:37,362 - backend.dataSources.noc_asset_query - INFO - 第 88 页请求成功，返回 1000 条记录
2025-10-23 10:09:37,365 - backend.dataSources.noc_asset_query - INFO - 发送第 95 页请求，起始ID: 94000
2025-10-23 10:09:37,369 - backend.dataSources.noc_asset_query - INFO - 发送第 96 页请求，起始ID: 95000
2025-10-23 10:09:37,369 - backend.dataSources.noc_asset_query - INFO - 第 87 页数据已添加，当前总计 87000 条记录
2025-10-23 10:09:37,371 - backend.dataSources.noc_asset_query - INFO - 第 88 页数据已添加，当前总计 88000 条记录
2025-10-23 10:09:37,373 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:37,374 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:37,645 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:37,748 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:37,783 - backend.dataSources.noc_asset_query - INFO - 第 89 页请求成功，返回 1000 条记录
2025-10-23 10:09:37,787 - backend.dataSources.noc_asset_query - INFO - 发送第 97 页请求，起始ID: 96000
2025-10-23 10:09:37,787 - backend.dataSources.noc_asset_query - INFO - 第 89 页数据已添加，当前总计 89000 条记录
2025-10-23 10:09:37,790 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:37,877 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:37,905 - backend.dataSources.noc_asset_query - INFO - 第 90 页请求成功，返回 1000 条记录
2025-10-23 10:09:37,911 - backend.dataSources.noc_asset_query - INFO - 发送第 98 页请求，起始ID: 97000
2025-10-23 10:09:37,911 - backend.dataSources.noc_asset_query - INFO - 第 90 页数据已添加，当前总计 90000 条记录
2025-10-23 10:09:37,915 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:38,146 - backend.dataSources.noc_asset_query - INFO - 第 91 页请求成功，返回 1000 条记录
2025-10-23 10:09:38,155 - backend.dataSources.noc_asset_query - INFO - 发送第 99 页请求，起始ID: 98000
2025-10-23 10:09:38,156 - backend.dataSources.noc_asset_query - INFO - 第 91 页数据已添加，当前总计 91000 条记录
2025-10-23 10:09:38,163 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,125 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,227 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,267 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,268 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,268 - backend.dataSources.noc_asset_query - INFO - 第 93 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,282 - backend.dataSources.noc_asset_query - INFO - 发送第 100 页请求，起始ID: 99000
2025-10-23 10:09:41,283 - backend.dataSources.noc_asset_query - INFO - 第 93 页数据已添加，当前总计 92000 条记录
2025-10-23 10:09:41,297 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,317 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,483 - backend.dataSources.noc_asset_query - INFO - 第 92 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,502 - backend.dataSources.noc_asset_query - INFO - 第 94 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,507 - backend.dataSources.noc_asset_query - INFO - 发送第 101 页请求，起始ID: 100000
2025-10-23 10:09:41,507 - backend.dataSources.noc_asset_query - INFO - 第 92 页数据已添加，当前总计 93000 条记录
2025-10-23 10:09:41,528 - backend.dataSources.noc_asset_query - INFO - 第 95 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,532 - backend.dataSources.noc_asset_query - INFO - 发送第 102 页请求，起始ID: 101000
2025-10-23 10:09:41,534 - backend.dataSources.noc_asset_query - INFO - 第 94 页数据已添加，当前总计 94000 条记录
2025-10-23 10:09:41,554 - backend.dataSources.noc_asset_query - INFO - 发送第 103 页请求，起始ID: 102000
2025-10-23 10:09:41,556 - backend.dataSources.noc_asset_query - INFO - 第 96 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,557 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,558 - backend.dataSources.noc_asset_query - INFO - 第 95 页数据已添加，当前总计 95000 条记录
2025-10-23 10:09:41,562 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,565 - backend.dataSources.noc_asset_query - INFO - 发送第 104 页请求，起始ID: 103000
2025-10-23 10:09:41,567 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,568 - backend.dataSources.noc_asset_query - INFO - 第 96 页数据已添加，当前总计 96000 条记录
2025-10-23 10:09:41,576 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,675 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,700 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,718 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:41,855 - backend.dataSources.noc_asset_query - INFO - 第 98 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,869 - backend.dataSources.noc_asset_query - INFO - 第 99 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,887 - backend.dataSources.noc_asset_query - INFO - 发送第 105 页请求，起始ID: 104000
2025-10-23 10:09:41,889 - backend.dataSources.noc_asset_query - INFO - 第 98 页数据已添加，当前总计 97000 条记录
2025-10-23 10:09:41,890 - backend.dataSources.noc_asset_query - INFO - 第 97 页请求成功，返回 1000 条记录
2025-10-23 10:09:41,894 - backend.dataSources.noc_asset_query - INFO - 发送第 106 页请求，起始ID: 105000
2025-10-23 10:09:41,898 - backend.dataSources.noc_asset_query - INFO - 第 99 页数据已添加，当前总计 98000 条记录
2025-10-23 10:09:41,898 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,913 - backend.dataSources.noc_asset_query - INFO - 发送第 107 页请求，起始ID: 106000
2025-10-23 10:09:41,916 - backend.dataSources.noc_asset_query - INFO - 第 97 页数据已添加，当前总计 99000 条记录
2025-10-23 10:09:41,917 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:41,927 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:44,890 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:45,103 - backend.dataSources.noc_asset_query - INFO - 第 100 页请求成功，返回 1000 条记录
2025-10-23 10:09:45,108 - backend.dataSources.noc_asset_query - INFO - 发送第 108 页请求，起始ID: 107000
2025-10-23 10:09:45,108 - backend.dataSources.noc_asset_query - INFO - 第 100 页数据已添加，当前总计 100000 条记录
2025-10-23 10:09:45,114 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:45,706 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:45,857 - backend.dataSources.noc_asset_query - INFO - 第 103 页请求成功，返回 1000 条记录
2025-10-23 10:09:45,859 - backend.dataSources.noc_asset_query - INFO - 发送第 109 页请求，起始ID: 108000
2025-10-23 10:09:45,860 - backend.dataSources.noc_asset_query - INFO - 第 103 页数据已添加，当前总计 101000 条记录
2025-10-23 10:09:45,861 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:45,888 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:45,926 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:45,941 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:46,037 - backend.dataSources.noc_asset_query - INFO - 第 102 页请求成功，返回 1000 条记录
2025-10-23 10:09:46,040 - backend.dataSources.noc_asset_query - INFO - 发送第 110 页请求，起始ID: 109000
2025-10-23 10:09:46,040 - backend.dataSources.noc_asset_query - INFO - 第 102 页数据已添加，当前总计 102000 条记录
2025-10-23 10:09:46,043 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:46,050 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:46,123 - backend.dataSources.noc_asset_query - INFO - 第 101 页请求成功，返回 1000 条记录
2025-10-23 10:09:46,127 - backend.dataSources.noc_asset_query - INFO - 发送第 111 页请求，起始ID: 110000
2025-10-23 10:09:46,127 - backend.dataSources.noc_asset_query - INFO - 第 101 页数据已添加，当前总计 103000 条记录
2025-10-23 10:09:46,131 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:46,136 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:46,139 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:46,174 - backend.dataSources.noc_asset_query - INFO - 第 104 页请求成功，返回 1000 条记录
2025-10-23 10:09:46,177 - backend.dataSources.noc_asset_query - INFO - 发送第 112 页请求，起始ID: 111000
2025-10-23 10:09:46,177 - backend.dataSources.noc_asset_query - INFO - 第 104 页数据已添加，当前总计 104000 条记录
2025-10-23 10:09:46,182 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:46,259 - backend.dataSources.noc_asset_query - INFO - 第 105 页请求成功，返回 1000 条记录
2025-10-23 10:09:46,263 - backend.dataSources.noc_asset_query - INFO - 发送第 113 页请求，起始ID: 112000
2025-10-23 10:09:46,263 - backend.dataSources.noc_asset_query - INFO - 第 105 页数据已添加，当前总计 105000 条记录
2025-10-23 10:09:46,266 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:46,341 - backend.dataSources.noc_asset_query - INFO - 第 106 页请求成功，返回 1000 条记录
2025-10-23 10:09:46,345 - backend.dataSources.noc_asset_query - INFO - 发送第 114 页请求，起始ID: 113000
2025-10-23 10:09:46,345 - backend.dataSources.noc_asset_query - INFO - 第 106 页数据已添加，当前总计 106000 条记录
2025-10-23 10:09:46,348 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:46,404 - backend.dataSources.noc_asset_query - INFO - 第 107 页请求成功，返回 1000 条记录
2025-10-23 10:09:46,417 - backend.dataSources.noc_asset_query - INFO - 发送第 115 页请求，起始ID: 114000
2025-10-23 10:09:46,419 - backend.dataSources.noc_asset_query - INFO - 第 107 页数据已添加，当前总计 107000 条记录
2025-10-23 10:09:46,425 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:47,242 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:47,410 - backend.dataSources.noc_asset_query - INFO - 第 108 页请求成功，返回 1000 条记录
2025-10-23 10:09:47,417 - backend.dataSources.noc_asset_query - INFO - 发送第 116 页请求，起始ID: 115000
2025-10-23 10:09:47,417 - backend.dataSources.noc_asset_query - INFO - 第 108 页数据已添加，当前总计 108000 条记录
2025-10-23 10:09:47,420 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:49,222 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:49,393 - backend.dataSources.noc_asset_query - INFO - 第 109 页请求成功，返回 1000 条记录
2025-10-23 10:09:49,396 - backend.dataSources.noc_asset_query - INFO - 发送第 117 页请求，起始ID: 116000
2025-10-23 10:09:49,396 - backend.dataSources.noc_asset_query - INFO - 第 109 页数据已添加，当前总计 109000 条记录
2025-10-23 10:09:49,399 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:50,187 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:50,323 - backend.dataSources.noc_asset_query - INFO - 第 110 页请求成功，返回 1000 条记录
2025-10-23 10:09:50,323 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:50,324 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:50,324 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:50,328 - backend.dataSources.noc_asset_query - INFO - 发送第 118 页请求，起始ID: 117000
2025-10-23 10:09:50,328 - backend.dataSources.noc_asset_query - INFO - 第 110 页数据已添加，当前总计 110000 条记录
2025-10-23 10:09:50,333 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:50,428 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:50,476 - backend.dataSources.noc_asset_query - INFO - 第 111 页请求成功，返回 1000 条记录
2025-10-23 10:09:50,482 - backend.dataSources.noc_asset_query - INFO - 发送第 119 页请求，起始ID: 118000
2025-10-23 10:09:50,483 - backend.dataSources.noc_asset_query - INFO - 第 111 页数据已添加，当前总计 111000 条记录
2025-10-23 10:09:50,488 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:50,510 - backend.dataSources.noc_asset_query - INFO - 第 112 页请求成功，返回 1000 条记录
2025-10-23 10:09:50,511 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:50,520 - backend.dataSources.noc_asset_query - INFO - 发送第 120 页请求，起始ID: 119000
2025-10-23 10:09:50,539 - backend.dataSources.noc_asset_query - INFO - 第 113 页请求成功，返回 1000 条记录
2025-10-23 10:09:50,540 - backend.dataSources.noc_asset_query - INFO - 第 112 页数据已添加，当前总计 112000 条记录
2025-10-23 10:09:50,550 - backend.dataSources.noc_asset_query - INFO - 发送第 121 页请求，起始ID: 120000
2025-10-23 10:09:50,552 - backend.dataSources.noc_asset_query - INFO - 第 113 页数据已添加，当前总计 113000 条记录
2025-10-23 10:09:50,556 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:50,558 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:50,637 - backend.dataSources.noc_asset_query - INFO - 第 114 页请求成功，返回 1000 条记录
2025-10-23 10:09:50,642 - backend.dataSources.noc_asset_query - INFO - 发送第 122 页请求，起始ID: 121000
2025-10-23 10:09:50,643 - backend.dataSources.noc_asset_query - INFO - 第 114 页数据已添加，当前总计 114000 条记录
2025-10-23 10:09:50,646 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:50,731 - backend.dataSources.noc_asset_query - INFO - 第 115 页请求成功，返回 1000 条记录
2025-10-23 10:09:50,736 - backend.dataSources.noc_asset_query - INFO - 发送第 123 页请求，起始ID: 122000
2025-10-23 10:09:50,737 - backend.dataSources.noc_asset_query - INFO - 第 115 页数据已添加，当前总计 115000 条记录
2025-10-23 10:09:50,741 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:50,861 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:51,048 - backend.dataSources.noc_asset_query - INFO - 第 116 页请求成功，返回 1000 条记录
2025-10-23 10:09:51,056 - backend.dataSources.noc_asset_query - INFO - 发送第 124 页请求，起始ID: 123000
2025-10-23 10:09:51,056 - backend.dataSources.noc_asset_query - INFO - 第 116 页数据已添加，当前总计 116000 条记录
2025-10-23 10:09:51,060 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:51,759 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:51,970 - backend.dataSources.noc_asset_query - INFO - 第 117 页请求成功，返回 1000 条记录
2025-10-23 10:09:51,973 - backend.dataSources.noc_asset_query - INFO - 发送第 125 页请求，起始ID: 124000
2025-10-23 10:09:51,973 - backend.dataSources.noc_asset_query - INFO - 第 117 页数据已添加，当前总计 117000 条记录
2025-10-23 10:09:51,977 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:54,316 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:54,334 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:54,451 - backend.dataSources.noc_asset_query - INFO - 第 121 页请求成功，返回 1000 条记录
2025-10-23 10:09:54,455 - backend.dataSources.noc_asset_query - INFO - 发送第 126 页请求，起始ID: 125000
2025-10-23 10:09:54,455 - backend.dataSources.noc_asset_query - INFO - 第 121 页数据已添加，当前总计 118000 条记录
2025-10-23 10:09:54,457 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:54,476 - backend.dataSources.noc_asset_query - INFO - 第 118 页请求成功，返回 1000 条记录
2025-10-23 10:09:54,480 - backend.dataSources.noc_asset_query - INFO - 发送第 127 页请求，起始ID: 126000
2025-10-23 10:09:54,480 - backend.dataSources.noc_asset_query - INFO - 第 118 页数据已添加，当前总计 119000 条记录
2025-10-23 10:09:54,482 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:54,566 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:54,708 - backend.dataSources.noc_asset_query - INFO - 第 122 页请求成功，返回 1000 条记录
2025-10-23 10:09:54,712 - backend.dataSources.noc_asset_query - INFO - 发送第 128 页请求，起始ID: 127000
2025-10-23 10:09:54,713 - backend.dataSources.noc_asset_query - INFO - 第 122 页数据已添加，当前总计 120000 条记录
2025-10-23 10:09:54,716 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:54,769 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:54,773 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:54,883 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:54,946 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:54,970 - backend.dataSources.noc_asset_query - INFO - 第 120 页请求成功，返回 1000 条记录
2025-10-23 10:09:54,987 - backend.dataSources.noc_asset_query - INFO - 第 119 页请求成功，返回 1000 条记录
2025-10-23 10:09:54,991 - backend.dataSources.noc_asset_query - INFO - 发送第 129 页请求，起始ID: 128000
2025-10-23 10:09:54,992 - backend.dataSources.noc_asset_query - INFO - 第 120 页数据已添加，当前总计 121000 条记录
2025-10-23 10:09:54,998 - backend.dataSources.noc_asset_query - INFO - 发送第 130 页请求，起始ID: 129000
2025-10-23 10:09:55,000 - backend.dataSources.noc_asset_query - INFO - 第 119 页数据已添加，当前总计 122000 条记录
2025-10-23 10:09:55,003 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:55,006 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:55,095 - backend.dataSources.noc_asset_query - INFO - 第 123 页请求成功，返回 1000 条记录
2025-10-23 10:09:55,098 - backend.dataSources.noc_asset_query - INFO - 发送第 131 页请求，起始ID: 130000
2025-10-23 10:09:55,098 - backend.dataSources.noc_asset_query - INFO - 第 123 页数据已添加，当前总计 123000 条记录
2025-10-23 10:09:55,101 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:55,153 - backend.dataSources.noc_asset_query - INFO - 第 124 页请求成功，返回 1000 条记录
2025-10-23 10:09:55,158 - backend.dataSources.noc_asset_query - INFO - 发送第 132 页请求，起始ID: 131000
2025-10-23 10:09:55,158 - backend.dataSources.noc_asset_query - INFO - 第 124 页数据已添加，当前总计 124000 条记录
2025-10-23 10:09:55,161 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:55,189 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:55,325 - backend.dataSources.noc_asset_query - INFO - 第 125 页请求成功，返回 1000 条记录
2025-10-23 10:09:55,334 - backend.dataSources.noc_asset_query - INFO - 发送第 133 页请求，起始ID: 132000
2025-10-23 10:09:55,334 - backend.dataSources.noc_asset_query - INFO - 第 125 页数据已添加，当前总计 125000 条记录
2025-10-23 10:09:55,340 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:58,712 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:58,715 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:58,955 - backend.dataSources.noc_asset_query - INFO - 第 127 页请求成功，返回 1000 条记录
2025-10-23 10:09:58,980 - backend.dataSources.noc_asset_query - INFO - 第 126 页请求成功，返回 1000 条记录
2025-10-23 10:09:58,986 - backend.dataSources.noc_asset_query - INFO - 发送第 134 页请求，起始ID: 133000
2025-10-23 10:09:58,987 - backend.dataSources.noc_asset_query - INFO - 第 127 页数据已添加，当前总计 126000 条记录
2025-10-23 10:09:58,996 - backend.dataSources.noc_asset_query - INFO - 发送第 135 页请求，起始ID: 134000
2025-10-23 10:09:58,999 - backend.dataSources.noc_asset_query - INFO - 第 126 页数据已添加，当前总计 127000 条记录
2025-10-23 10:09:59,004 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:59,008 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:59,052 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:59,201 - backend.dataSources.noc_asset_query - INFO - 第 128 页请求成功，返回 1000 条记录
2025-10-23 10:09:59,205 - backend.dataSources.noc_asset_query - INFO - 发送第 136 页请求，起始ID: 135000
2025-10-23 10:09:59,206 - backend.dataSources.noc_asset_query - INFO - 第 128 页数据已添加，当前总计 128000 条记录
2025-10-23 10:09:59,209 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:59,360 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:59,430 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:59,492 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:59,514 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:59,579 - backend.dataSources.noc_asset_query - INFO - 第 130 页请求成功，返回 1000 条记录
2025-10-23 10:09:59,583 - backend.dataSources.noc_asset_query - INFO - 发送第 137 页请求，起始ID: 136000
2025-10-23 10:09:59,583 - backend.dataSources.noc_asset_query - INFO - 第 130 页数据已添加，当前总计 129000 条记录
2025-10-23 10:09:59,590 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:59,594 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:09:59,667 - backend.dataSources.noc_asset_query - INFO - 第 129 页请求成功，返回 1000 条记录
2025-10-23 10:09:59,673 - backend.dataSources.noc_asset_query - INFO - 发送第 138 页请求，起始ID: 137000
2025-10-23 10:09:59,691 - backend.dataSources.noc_asset_query - INFO - 第 129 页数据已添加，当前总计 130000 条记录
2025-10-23 10:09:59,692 - backend.dataSources.noc_asset_query - INFO - 第 131 页请求成功，返回 1000 条记录
2025-10-23 10:09:59,694 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:59,697 - backend.dataSources.noc_asset_query - INFO - 发送第 139 页请求，起始ID: 138000
2025-10-23 10:09:59,697 - backend.dataSources.noc_asset_query - INFO - 第 131 页数据已添加，当前总计 131000 条记录
2025-10-23 10:09:59,701 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:59,751 - backend.dataSources.noc_asset_query - INFO - 第 132 页请求成功，返回 1000 条记录
2025-10-23 10:09:59,758 - backend.dataSources.noc_asset_query - INFO - 发送第 140 页请求，起始ID: 139000
2025-10-23 10:09:59,759 - backend.dataSources.noc_asset_query - INFO - 第 132 页数据已添加，当前总计 132000 条记录
2025-10-23 10:09:59,762 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:09:59,832 - backend.dataSources.noc_asset_query - INFO - 第 133 页请求成功，返回 1000 条记录
2025-10-23 10:09:59,838 - backend.dataSources.noc_asset_query - INFO - 发送第 141 页请求，起始ID: 140000
2025-10-23 10:09:59,838 - backend.dataSources.noc_asset_query - INFO - 第 133 页数据已添加，当前总计 133000 条记录
2025-10-23 10:09:59,842 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:03,624 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:03,757 - backend.dataSources.noc_asset_query - INFO - 第 134 页请求成功，返回 1000 条记录
2025-10-23 10:10:03,758 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:03,764 - backend.dataSources.noc_asset_query - INFO - 发送第 142 页请求，起始ID: 141000
2025-10-23 10:10:03,765 - backend.dataSources.noc_asset_query - INFO - 第 134 页数据已添加，当前总计 134000 条记录
2025-10-23 10:10:03,771 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:03,877 - backend.dataSources.noc_asset_query - INFO - 第 135 页请求成功，返回 1000 条记录
2025-10-23 10:10:03,884 - backend.dataSources.noc_asset_query - INFO - 发送第 143 页请求，起始ID: 142000
2025-10-23 10:10:03,885 - backend.dataSources.noc_asset_query - INFO - 第 135 页数据已添加，当前总计 135000 条记录
2025-10-23 10:10:03,890 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:04,191 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:04,344 - backend.dataSources.noc_asset_query - INFO - 第 136 页请求成功，返回 1000 条记录
2025-10-23 10:10:04,348 - backend.dataSources.noc_asset_query - INFO - 发送第 144 页请求，起始ID: 143000
2025-10-23 10:10:04,349 - backend.dataSources.noc_asset_query - INFO - 第 136 页数据已添加，当前总计 136000 条记录
2025-10-23 10:10:04,353 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:04,753 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:04,755 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:04,773 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:04,791 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:04,810 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:04,916 - backend.dataSources.noc_asset_query - INFO - 第 137 页请求成功，返回 1000 条记录
2025-10-23 10:10:04,939 - backend.dataSources.noc_asset_query - INFO - 第 138 页请求成功，返回 1000 条记录
2025-10-23 10:10:04,943 - backend.dataSources.noc_asset_query - INFO - 发送第 145 页请求，起始ID: 144000
2025-10-23 10:10:04,943 - backend.dataSources.noc_asset_query - INFO - 第 137 页数据已添加，当前总计 137000 条记录
2025-10-23 10:10:04,950 - backend.dataSources.noc_asset_query - INFO - 发送第 146 页请求，起始ID: 145000
2025-10-23 10:10:04,952 - backend.dataSources.noc_asset_query - INFO - 第 138 页数据已添加，当前总计 138000 条记录
2025-10-23 10:10:04,955 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:04,971 - backend.dataSources.noc_asset_query - INFO - 第 139 页请求成功，返回 1000 条记录
2025-10-23 10:10:04,989 - backend.dataSources.noc_asset_query - INFO - 第 140 页请求成功，返回 1000 条记录
2025-10-23 10:10:04,995 - backend.dataSources.noc_asset_query - INFO - 发送第 147 页请求，起始ID: 146000
2025-10-23 10:10:04,996 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:04,996 - backend.dataSources.noc_asset_query - INFO - 第 139 页数据已添加，当前总计 139000 条记录
2025-10-23 10:10:04,999 - backend.dataSources.noc_asset_query - INFO - 发送第 148 页请求，起始ID: 147000
2025-10-23 10:10:05,002 - backend.dataSources.noc_asset_query - INFO - 第 140 页数据已添加，当前总计 140000 条记录
2025-10-23 10:10:05,004 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:05,009 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:05,046 - backend.dataSources.noc_asset_query - INFO - 第 141 页请求成功，返回 1000 条记录
2025-10-23 10:10:05,055 - backend.dataSources.noc_asset_query - INFO - 发送第 149 页请求，起始ID: 148000
2025-10-23 10:10:05,055 - backend.dataSources.noc_asset_query - INFO - 第 141 页数据已添加，当前总计 141000 条记录
2025-10-23 10:10:05,061 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:08,131 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:08,260 - backend.dataSources.noc_asset_query - INFO - 第 142 页请求成功，返回 1000 条记录
2025-10-23 10:10:08,265 - backend.dataSources.noc_asset_query - INFO - 发送第 150 页请求，起始ID: 149000
2025-10-23 10:10:08,266 - backend.dataSources.noc_asset_query - INFO - 第 142 页数据已添加，当前总计 142000 条记录
2025-10-23 10:10:08,270 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:08,362 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:08,495 - backend.dataSources.noc_asset_query - INFO - 第 143 页请求成功，返回 1000 条记录
2025-10-23 10:10:08,503 - backend.dataSources.noc_asset_query - INFO - 发送第 151 页请求，起始ID: 150000
2025-10-23 10:10:08,504 - backend.dataSources.noc_asset_query - INFO - 第 143 页数据已添加，当前总计 143000 条记录
2025-10-23 10:10:08,509 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:09,977 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:09,983 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:09,987 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:10,060 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:10,164 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:10,189 - backend.dataSources.noc_asset_query - INFO - 第 144 页请求成功，返回 1000 条记录
2025-10-23 10:10:10,207 - backend.dataSources.noc_asset_query - INFO - 第 147 页请求成功，返回 1000 条记录
2025-10-23 10:10:10,211 - backend.dataSources.noc_asset_query - INFO - 发送第 152 页请求，起始ID: 151000
2025-10-23 10:10:10,215 - backend.dataSources.noc_asset_query - INFO - 发送第 153 页请求，起始ID: 152000
2025-10-23 10:10:10,216 - backend.dataSources.noc_asset_query - INFO - 第 144 页数据已添加，当前总计 144000 条记录
2025-10-23 10:10:10,222 - backend.dataSources.noc_asset_query - INFO - 第 147 页数据已添加，当前总计 145000 条记录
2025-10-23 10:10:10,224 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:10,224 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:10,259 - backend.dataSources.noc_asset_query - INFO - 第 145 页请求成功，返回 1000 条记录
2025-10-23 10:10:10,263 - backend.dataSources.noc_asset_query - INFO - 发送第 154 页请求，起始ID: 153000
2025-10-23 10:10:10,264 - backend.dataSources.noc_asset_query - INFO - 第 145 页数据已添加，当前总计 146000 条记录
2025-10-23 10:10:10,268 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:10,284 - backend.dataSources.noc_asset_query - INFO - 第 148 页请求成功，返回 1000 条记录
2025-10-23 10:10:10,290 - backend.dataSources.noc_asset_query - INFO - 发送第 155 页请求，起始ID: 154000
2025-10-23 10:10:10,290 - backend.dataSources.noc_asset_query - INFO - 第 148 页数据已添加，当前总计 147000 条记录
2025-10-23 10:10:10,294 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:10,335 - backend.dataSources.noc_asset_query - INFO - 第 146 页请求成功，返回 1000 条记录
2025-10-23 10:10:10,342 - backend.dataSources.noc_asset_query - INFO - 发送第 156 页请求，起始ID: 155000
2025-10-23 10:10:10,342 - backend.dataSources.noc_asset_query - INFO - 第 146 页数据已添加，当前总计 148000 条记录
2025-10-23 10:10:10,345 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:10,899 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:11,108 - backend.dataSources.noc_asset_query - INFO - 第 149 页请求成功，返回 1000 条记录
2025-10-23 10:10:11,114 - backend.dataSources.noc_asset_query - INFO - 发送第 157 页请求，起始ID: 156000
2025-10-23 10:10:11,116 - backend.dataSources.noc_asset_query - INFO - 第 149 页数据已添加，当前总计 149000 条记录
2025-10-23 10:10:11,122 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:12,287 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:12,455 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:12,522 - backend.dataSources.noc_asset_query - INFO - 第 151 页请求成功，返回 1000 条记录
2025-10-23 10:10:12,525 - backend.dataSources.noc_asset_query - INFO - 发送第 158 页请求，起始ID: 157000
2025-10-23 10:10:12,525 - backend.dataSources.noc_asset_query - INFO - 第 151 页数据已添加，当前总计 150000 条记录
2025-10-23 10:10:12,528 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:12,642 - backend.dataSources.noc_asset_query - INFO - 第 150 页请求成功，返回 1000 条记录
2025-10-23 10:10:12,646 - backend.dataSources.noc_asset_query - INFO - 发送第 159 页请求，起始ID: 158000
2025-10-23 10:10:12,646 - backend.dataSources.noc_asset_query - INFO - 第 150 页数据已添加，当前总计 151000 条记录
2025-10-23 10:10:12,649 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:15,441 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:15,456 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:15,588 - backend.dataSources.noc_asset_query - INFO - 第 153 页请求成功，返回 1000 条记录
2025-10-23 10:10:15,591 - backend.dataSources.noc_asset_query - INFO - 发送第 160 页请求，起始ID: 159000
2025-10-23 10:10:15,591 - backend.dataSources.noc_asset_query - INFO - 第 153 页数据已添加，当前总计 152000 条记录
2025-10-23 10:10:15,594 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:15,606 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:15,638 - backend.dataSources.noc_asset_query - INFO - 第 152 页请求成功，返回 1000 条记录
2025-10-23 10:10:15,641 - backend.dataSources.noc_asset_query - INFO - 发送第 161 页请求，起始ID: 160000
2025-10-23 10:10:15,641 - backend.dataSources.noc_asset_query - INFO - 第 152 页数据已添加，当前总计 153000 条记录
2025-10-23 10:10:15,644 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:15,762 - backend.dataSources.noc_asset_query - INFO - 第 156 页请求成功，返回 1000 条记录
2025-10-23 10:10:15,764 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:15,769 - backend.dataSources.noc_asset_query - INFO - 发送第 162 页请求，起始ID: 161000
2025-10-23 10:10:15,770 - backend.dataSources.noc_asset_query - INFO - 第 156 页数据已添加，当前总计 154000 条记录
2025-10-23 10:10:15,774 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:15,957 - backend.dataSources.noc_asset_query - INFO - 第 154 页请求成功，返回 1000 条记录
2025-10-23 10:10:15,962 - backend.dataSources.noc_asset_query - INFO - 发送第 163 页请求，起始ID: 162000
2025-10-23 10:10:15,962 - backend.dataSources.noc_asset_query - INFO - 第 154 页数据已添加，当前总计 155000 条记录
2025-10-23 10:10:15,965 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:16,780 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:16,894 - backend.dataSources.noc_asset_query - INFO - 第 157 页请求成功，返回 1000 条记录
2025-10-23 10:10:16,898 - backend.dataSources.noc_asset_query - INFO - 发送第 164 页请求，起始ID: 163000
2025-10-23 10:10:16,899 - backend.dataSources.noc_asset_query - INFO - 第 157 页数据已添加，当前总计 156000 条记录
2025-10-23 10:10:16,902 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:17,216 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:17,259 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:17,348 - backend.dataSources.noc_asset_query - INFO - 第 155 页请求成功，返回 1000 条记录
2025-10-23 10:10:17,351 - backend.dataSources.noc_asset_query - INFO - 发送第 165 页请求，起始ID: 164000
2025-10-23 10:10:17,351 - backend.dataSources.noc_asset_query - INFO - 第 155 页数据已添加，当前总计 157000 条记录
2025-10-23 10:10:17,354 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:17,384 - backend.dataSources.noc_asset_query - INFO - 第 158 页请求成功，返回 1000 条记录
2025-10-23 10:10:17,387 - backend.dataSources.noc_asset_query - INFO - 发送第 166 页请求，起始ID: 165000
2025-10-23 10:10:17,387 - backend.dataSources.noc_asset_query - INFO - 第 158 页数据已添加，当前总计 158000 条记录
2025-10-23 10:10:17,389 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:17,655 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:17,819 - backend.dataSources.noc_asset_query - INFO - 第 159 页请求成功，返回 1000 条记录
2025-10-23 10:10:17,823 - backend.dataSources.noc_asset_query - INFO - 发送第 167 页请求，起始ID: 166000
2025-10-23 10:10:17,824 - backend.dataSources.noc_asset_query - INFO - 第 159 页数据已添加，当前总计 159000 条记录
2025-10-23 10:10:17,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:20,241 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:20,245 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:20,391 - backend.dataSources.noc_asset_query - INFO - 第 160 页请求成功，返回 1000 条记录
2025-10-23 10:10:20,392 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:20,400 - backend.dataSources.noc_asset_query - INFO - 发送第 168 页请求，起始ID: 167000
2025-10-23 10:10:20,401 - backend.dataSources.noc_asset_query - INFO - 第 160 页数据已添加，当前总计 160000 条记录
2025-10-23 10:10:20,432 - backend.dataSources.noc_asset_query - INFO - 第 161 页请求成功，返回 1000 条记录
2025-10-23 10:10:20,438 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:20,447 - backend.dataSources.noc_asset_query - INFO - 发送第 169 页请求，起始ID: 168000
2025-10-23 10:10:20,448 - backend.dataSources.noc_asset_query - INFO - 第 161 页数据已添加，当前总计 161000 条记录
2025-10-23 10:10:20,454 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:20,457 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:20,605 - backend.dataSources.noc_asset_query - INFO - 第 162 页请求成功，返回 1000 条记录
2025-10-23 10:10:20,609 - backend.dataSources.noc_asset_query - INFO - 发送第 170 页请求，起始ID: 169000
2025-10-23 10:10:20,609 - backend.dataSources.noc_asset_query - INFO - 第 162 页数据已添加，当前总计 162000 条记录
2025-10-23 10:10:20,614 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:20,660 - backend.dataSources.noc_asset_query - INFO - 第 163 页请求成功，返回 1000 条记录
2025-10-23 10:10:20,665 - backend.dataSources.noc_asset_query - INFO - 发送第 171 页请求，起始ID: 170000
2025-10-23 10:10:20,665 - backend.dataSources.noc_asset_query - INFO - 第 163 页数据已添加，当前总计 163000 条记录
2025-10-23 10:10:20,669 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:21,034 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:21,160 - backend.dataSources.noc_asset_query - INFO - 第 164 页请求成功，返回 1000 条记录
2025-10-23 10:10:21,164 - backend.dataSources.noc_asset_query - INFO - 发送第 172 页请求，起始ID: 171000
2025-10-23 10:10:21,165 - backend.dataSources.noc_asset_query - INFO - 第 164 页数据已添加，当前总计 164000 条记录
2025-10-23 10:10:21,167 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:21,449 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:21,541 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:21,582 - backend.dataSources.noc_asset_query - INFO - 第 166 页请求成功，返回 1000 条记录
2025-10-23 10:10:21,585 - backend.dataSources.noc_asset_query - INFO - 发送第 173 页请求，起始ID: 172000
2025-10-23 10:10:21,585 - backend.dataSources.noc_asset_query - INFO - 第 166 页数据已添加，当前总计 165000 条记录
2025-10-23 10:10:21,587 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:21,689 - backend.dataSources.noc_asset_query - INFO - 第 165 页请求成功，返回 1000 条记录
2025-10-23 10:10:21,694 - backend.dataSources.noc_asset_query - INFO - 发送第 174 页请求，起始ID: 173000
2025-10-23 10:10:21,694 - backend.dataSources.noc_asset_query - INFO - 第 165 页数据已添加，当前总计 166000 条记录
2025-10-23 10:10:21,698 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:21,902 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:22,141 - backend.dataSources.noc_asset_query - INFO - 第 167 页请求成功，返回 1000 条记录
2025-10-23 10:10:22,144 - backend.dataSources.noc_asset_query - INFO - 发送第 175 页请求，起始ID: 174000
2025-10-23 10:10:22,144 - backend.dataSources.noc_asset_query - INFO - 第 167 页数据已添加，当前总计 167000 条记录
2025-10-23 10:10:22,147 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:25,221 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:25,393 - backend.dataSources.noc_asset_query - INFO - 第 168 页请求成功，返回 1000 条记录
2025-10-23 10:10:25,394 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:25,404 - backend.dataSources.noc_asset_query - INFO - 发送第 176 页请求，起始ID: 175000
2025-10-23 10:10:25,405 - backend.dataSources.noc_asset_query - INFO - 第 168 页数据已添加，当前总计 168000 条记录
2025-10-23 10:10:25,412 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:25,443 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:25,506 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:25,616 - backend.dataSources.noc_asset_query - INFO - 第 171 页请求成功，返回 1000 条记录
2025-10-23 10:10:25,649 - backend.dataSources.noc_asset_query - INFO - 第 169 页请求成功，返回 1000 条记录
2025-10-23 10:10:25,659 - backend.dataSources.noc_asset_query - INFO - 发送第 177 页请求，起始ID: 176000
2025-10-23 10:10:25,660 - backend.dataSources.noc_asset_query - INFO - 第 171 页数据已添加，当前总计 169000 条记录
2025-10-23 10:10:25,665 - backend.dataSources.noc_asset_query - INFO - 发送第 178 页请求，起始ID: 177000
2025-10-23 10:10:25,668 - backend.dataSources.noc_asset_query - INFO - 第 169 页数据已添加，当前总计 170000 条记录
2025-10-23 10:10:25,670 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:25,686 - backend.dataSources.noc_asset_query - INFO - 第 170 页请求成功，返回 1000 条记录
2025-10-23 10:10:25,688 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:25,693 - backend.dataSources.noc_asset_query - INFO - 发送第 179 页请求，起始ID: 178000
2025-10-23 10:10:25,694 - backend.dataSources.noc_asset_query - INFO - 第 170 页数据已添加，当前总计 171000 条记录
2025-10-23 10:10:25,699 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:26,049 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:26,203 - backend.dataSources.noc_asset_query - INFO - 第 172 页请求成功，返回 1000 条记录
2025-10-23 10:10:26,207 - backend.dataSources.noc_asset_query - INFO - 发送第 180 页请求，起始ID: 179000
2025-10-23 10:10:26,208 - backend.dataSources.noc_asset_query - INFO - 第 172 页数据已添加，当前总计 172000 条记录
2025-10-23 10:10:26,211 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:26,234 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:26,329 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:26,356 - backend.dataSources.noc_asset_query - INFO - 第 173 页请求成功，返回 1000 条记录
2025-10-23 10:10:26,361 - backend.dataSources.noc_asset_query - INFO - 发送第 181 页请求，起始ID: 180000
2025-10-23 10:10:26,362 - backend.dataSources.noc_asset_query - INFO - 第 173 页数据已添加，当前总计 173000 条记录
2025-10-23 10:10:26,365 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:26,427 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:26,511 - backend.dataSources.noc_asset_query - INFO - 第 174 页请求成功，返回 1000 条记录
2025-10-23 10:10:26,517 - backend.dataSources.noc_asset_query - INFO - 发送第 182 页请求，起始ID: 181000
2025-10-23 10:10:26,518 - backend.dataSources.noc_asset_query - INFO - 第 174 页数据已添加，当前总计 174000 条记录
2025-10-23 10:10:26,523 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:26,585 - backend.dataSources.noc_asset_query - INFO - 第 175 页请求成功，返回 1000 条记录
2025-10-23 10:10:26,590 - backend.dataSources.noc_asset_query - INFO - 发送第 183 页请求，起始ID: 182000
2025-10-23 10:10:26,591 - backend.dataSources.noc_asset_query - INFO - 第 175 页数据已添加，当前总计 175000 条记录
2025-10-23 10:10:26,596 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:30,275 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:30,410 - backend.dataSources.noc_asset_query - INFO - 第 176 页请求成功，返回 1000 条记录
2025-10-23 10:10:30,417 - backend.dataSources.noc_asset_query - INFO - 发送第 184 页请求，起始ID: 183000
2025-10-23 10:10:30,417 - backend.dataSources.noc_asset_query - INFO - 第 176 页数据已添加，当前总计 176000 条记录
2025-10-23 10:10:30,422 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:30,865 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:30,868 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:30,871 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:31,015 - backend.dataSources.noc_asset_query - INFO - 第 177 页请求成功，返回 1000 条记录
2025-10-23 10:10:31,037 - backend.dataSources.noc_asset_query - INFO - 发送第 185 页请求，起始ID: 184000
2025-10-23 10:10:31,037 - backend.dataSources.noc_asset_query - INFO - 第 178 页请求成功，返回 1000 条记录
2025-10-23 10:10:31,038 - backend.dataSources.noc_asset_query - INFO - 第 177 页数据已添加，当前总计 177000 条记录
2025-10-23 10:10:31,045 - backend.dataSources.noc_asset_query - INFO - 发送第 186 页请求，起始ID: 185000
2025-10-23 10:10:31,045 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:31,045 - backend.dataSources.noc_asset_query - INFO - 第 178 页数据已添加，当前总计 178000 条记录
2025-10-23 10:10:31,060 - backend.dataSources.noc_asset_query - INFO - 第 179 页请求成功，返回 1000 条记录
2025-10-23 10:10:31,064 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:31,067 - backend.dataSources.noc_asset_query - INFO - 发送第 187 页请求，起始ID: 186000
2025-10-23 10:10:31,068 - backend.dataSources.noc_asset_query - INFO - 第 179 页数据已添加，当前总计 179000 条记录
2025-10-23 10:10:31,072 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:31,375 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:31,416 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:31,416 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:31,442 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:31,513 - backend.dataSources.noc_asset_query - INFO - 第 180 页请求成功，返回 1000 条记录
2025-10-23 10:10:31,516 - backend.dataSources.noc_asset_query - INFO - 发送第 188 页请求，起始ID: 187000
2025-10-23 10:10:31,517 - backend.dataSources.noc_asset_query - INFO - 第 180 页数据已添加，当前总计 180000 条记录
2025-10-23 10:10:31,519 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:31,611 - backend.dataSources.noc_asset_query - INFO - 第 182 页请求成功，返回 1000 条记录
2025-10-23 10:10:31,615 - backend.dataSources.noc_asset_query - INFO - 发送第 189 页请求，起始ID: 188000
2025-10-23 10:10:31,616 - backend.dataSources.noc_asset_query - INFO - 第 182 页数据已添加，当前总计 181000 条记录
2025-10-23 10:10:31,623 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:31,681 - backend.dataSources.noc_asset_query - INFO - 第 183 页请求成功，返回 1000 条记录
2025-10-23 10:10:31,693 - backend.dataSources.noc_asset_query - INFO - 第 181 页请求成功，返回 1000 条记录
2025-10-23 10:10:31,702 - backend.dataSources.noc_asset_query - INFO - 发送第 190 页请求，起始ID: 189000
2025-10-23 10:10:31,702 - backend.dataSources.noc_asset_query - INFO - 第 183 页数据已添加，当前总计 182000 条记录
2025-10-23 10:10:31,707 - backend.dataSources.noc_asset_query - INFO - 发送第 191 页请求，起始ID: 190000
2025-10-23 10:10:31,709 - backend.dataSources.noc_asset_query - INFO - 第 181 页数据已添加，当前总计 183000 条记录
2025-10-23 10:10:31,712 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:31,715 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:33,529 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:33,675 - backend.dataSources.noc_asset_query - INFO - 第 184 页请求成功，返回 1000 条记录
2025-10-23 10:10:33,678 - backend.dataSources.noc_asset_query - INFO - 发送第 192 页请求，起始ID: 191000
2025-10-23 10:10:33,678 - backend.dataSources.noc_asset_query - INFO - 第 184 页数据已添加，当前总计 184000 条记录
2025-10-23 10:10:33,680 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:35,182 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:35,183 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:35,332 - backend.dataSources.noc_asset_query - INFO - 第 186 页请求成功，返回 1000 条记录
2025-10-23 10:10:35,339 - backend.dataSources.noc_asset_query - INFO - 发送第 193 页请求，起始ID: 192000
2025-10-23 10:10:35,339 - backend.dataSources.noc_asset_query - INFO - 第 186 页数据已添加，当前总计 185000 条记录
2025-10-23 10:10:35,348 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:35,459 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:35,542 - backend.dataSources.noc_asset_query - INFO - 第 185 页请求成功，返回 1000 条记录
2025-10-23 10:10:35,547 - backend.dataSources.noc_asset_query - INFO - 发送第 194 页请求，起始ID: 193000
2025-10-23 10:10:35,547 - backend.dataSources.noc_asset_query - INFO - 第 185 页数据已添加，当前总计 186000 条记录
2025-10-23 10:10:35,551 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:35,601 - backend.dataSources.noc_asset_query - INFO - 第 187 页请求成功，返回 1000 条记录
2025-10-23 10:10:35,606 - backend.dataSources.noc_asset_query - INFO - 发送第 195 页请求，起始ID: 194000
2025-10-23 10:10:35,606 - backend.dataSources.noc_asset_query - INFO - 第 187 页数据已添加，当前总计 187000 条记录
2025-10-23 10:10:35,610 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:36,190 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:36,194 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:36,351 - backend.dataSources.noc_asset_query - INFO - 第 188 页请求成功，返回 1000 条记录
2025-10-23 10:10:36,355 - backend.dataSources.noc_asset_query - INFO - 发送第 196 页请求，起始ID: 195000
2025-10-23 10:10:36,356 - backend.dataSources.noc_asset_query - INFO - 第 188 页数据已添加，当前总计 188000 条记录
2025-10-23 10:10:36,360 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:36,377 - backend.dataSources.noc_asset_query - INFO - 第 189 页请求成功，返回 1000 条记录
2025-10-23 10:10:36,378 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:36,381 - backend.dataSources.noc_asset_query - INFO - 发送第 197 页请求，起始ID: 196000
2025-10-23 10:10:36,382 - backend.dataSources.noc_asset_query - INFO - 第 189 页数据已添加，当前总计 189000 条记录
2025-10-23 10:10:36,383 - backend.dataSources.noc_asset_query - INFO - 第 191 页请求成功，返回 0 条记录
2025-10-23 10:10:36,389 - backend.dataSources.noc_asset_query - INFO - 发送第 198 页请求，起始ID: 197000
2025-10-23 10:10:36,390 - backend.dataSources.noc_asset_query - INFO - 第 191 页无数据
2025-10-23 10:10:36,391 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:36,394 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:36,399 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:36,550 - backend.dataSources.noc_asset_query - INFO - 第 190 页请求成功，返回 762 条记录
2025-10-23 10:10:36,554 - backend.dataSources.noc_asset_query - INFO - 发送第 199 页请求，起始ID: 198000
2025-10-23 10:10:36,555 - backend.dataSources.noc_asset_query - INFO - 第 190 页数据已添加，当前总计 189762 条记录
2025-10-23 10:10:36,560 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:37,051 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:37,052 - backend.dataSources.noc_asset_query - INFO - 第 192 页请求成功，返回 0 条记录
2025-10-23 10:10:37,056 - backend.dataSources.noc_asset_query - INFO - 发送第 200 页请求，起始ID: 199000
2025-10-23 10:10:37,056 - backend.dataSources.noc_asset_query - INFO - 第 192 页无数据
2025-10-23 10:10:37,059 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:39,862 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:39,864 - backend.dataSources.noc_asset_query - INFO - 第 193 页请求成功，返回 0 条记录
2025-10-23 10:10:39,869 - backend.dataSources.noc_asset_query - INFO - 发送第 201 页请求，起始ID: 200000
2025-10-23 10:10:39,869 - backend.dataSources.noc_asset_query - INFO - 第 193 页无数据
2025-10-23 10:10:39,875 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:40,418 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:40,423 - backend.dataSources.noc_asset_query - INFO - 第 194 页请求成功，返回 0 条记录
2025-10-23 10:10:40,426 - backend.dataSources.noc_asset_query - INFO - 发送第 202 页请求，起始ID: 201000
2025-10-23 10:10:40,426 - backend.dataSources.noc_asset_query - INFO - 第 194 页无数据
2025-10-23 10:10:40,427 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:40,430 - backend.dataSources.noc_asset_query - INFO - 连续 3 页无数据，停止拉取
2025-10-23 10:10:40,431 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:10:40,432 - backend.dataSources.noc_asset_query - INFO - 第 195 页请求成功，返回 0 条记录
2025-10-23 10:10:41,128 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:41,132 - backend.dataSources.noc_asset_query - INFO - 第 197 页请求成功，返回 0 条记录
2025-10-23 10:10:41,227 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:41,227 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:41,228 - backend.dataSources.noc_asset_query - INFO - 第 198 页请求成功，返回 0 条记录
2025-10-23 10:10:41,228 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:41,229 - backend.dataSources.noc_asset_query - INFO - 第 196 页请求成功，返回 0 条记录
2025-10-23 10:10:41,230 - backend.dataSources.noc_asset_query - INFO - 第 199 页请求成功，返回 0 条记录
2025-10-23 10:10:41,272 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:41,273 - backend.dataSources.noc_asset_query - INFO - 第 200 页请求成功，返回 0 条记录
2025-10-23 10:10:43,138 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:43,140 - backend.dataSources.noc_asset_query - INFO - 第 201 页请求成功，返回 0 条记录
2025-10-23 10:10:43,549 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:10:43,550 - backend.dataSources.noc_asset_query - INFO - 第 202 页请求成功，返回 0 条记录
2025-10-23 10:10:43,559 - backend.dataSources.noc_asset_query - INFO - 光模块全量数据拉取完成，共 189762 条记录
2025-10-23 10:10:43,577 - backend.dataSources.api_optical_module_full_query - INFO - 成功拉取 189762 条原始数据
2025-10-23 10:10:47,086 - backend.dataSources.api_optical_module_full_query - INFO - 数据处理完成，共生成 1283 条记录
2025-10-23 10:10:47,222 - data_loader - DEBUG - Loaded 1283 records from NOC API
2025-10-23 10:10:47,222 - data_loader - INFO - NOC optical module full data load completed (status=0)
2025-10-23 10:10:47,232 - __main__ - DEBUG - Sample record columns: ['光模块型号', '光模块厂商', '状态', '机房', '集群', '客户', '在线总数量']
2025-10-23 10:10:47,234 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-23 10:10:47,242 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-23 10:10:47,244 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-23 10:10:47,245 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-23 10:10:47,246 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-23 10:10:47,247 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-23 10:10:47,248 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-23 10:10:47,310 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-23 10:10:47,310 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-23 10:10:47,311 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-23 10:10:47,312 - __main__ - DEBUG - Sanitized name: 状态 -> 状态
2025-10-23 10:10:47,312 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-23 10:10:47,313 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-23 10:10:47,313 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-23 10:10:47,314 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-23 10:10:47,329 - __main__ - INFO - Inserted 1283 records into table 光模块在线总数量统计表
2025-10-23 10:10:47,357 - __main__ - INFO - Database built/updated at real_database.db (rebuild=True, status=0)
2025-10-23 10:17:58,133 - data_loader - DEBUG - Initialized XLSXRoceNetworkPartFaultDataSourceLoader with file D:\Code\KC-SQLAgent-Visualization-v1.8\roce事件列表_2025-10-23 10_16_19.xlsx_1761185779.xlsx and table ROCE-TOR下联-网络零件（光模块+AOC）故障表
2025-10-23 10:17:58,134 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: real_database.db
2025-10-23 10:17:58,149 - __main__ - DEBUG - Processing data source: <data_loader.XLSXRoceNetworkPartFaultDataSourceLoader object at 0x000001F7E4FA4C20>
2025-10-23 10:17:58,149 - data_loader - DEBUG - Loading XLSX ROCE network part fault data from D:\Code\KC-SQLAgent-Visualization-v1.8\roce事件列表_2025-10-23 10_16_19.xlsx_1761185779.xlsx
2025-10-23 10:17:58,152 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 开始读取XLSX文件: D:\Code\KC-SQLAgent-Visualization-v1.8\roce事件列表_2025-10-23 10_16_19.xlsx_1761185779.xlsx
2025-10-23 10:18:15,263 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 原始数据 20388 条记录，筛选后 1044 条记录
2025-10-23 10:18:15,455 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 需要查询 166 个唯一的SN
2025-10-23 10:18:15,468 - backend.dataSources.noc_asset_query - INFO - 发送NOC资产API请求: cable_high_value_asset...
2025-10-23 10:18:15,474 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): noc.ksyun.com:443
2025-10-23 10:18:16,465 - urllib3.connectionpool - DEBUG - https://noc.ksyun.com:443 "POST /api/get-list?access_token=g4m5o9w8m7n2b8d2l5p1w7f4p2r9y9q2 HTTP/1.1" 200 None
2025-10-23 10:18:16,467 - backend.dataSources.noc_asset_query - INFO - NOC资产API请求成功: cable_high_value_asset，返回 3 条记录
2025-10-23 10:18:16,473 - backend.dataSources.xlsx_roce_network_part_fault - INFO - API查询返回 3 条记录
2025-10-23 10:18:16,474 - backend.dataSources.xlsx_roce_network_part_fault - INFO - 数据处理完成，共生成 1044 条记录
2025-10-23 10:18:16,495 - data_loader - DEBUG - Loaded 1044 records from XLSX file
2025-10-23 10:18:16,497 - data_loader - INFO - XLSX ROCE network part fault data load completed (status=0)
2025-10-23 10:18:16,499 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '网络零件种类', '网络零件厂商', '网络零件型号', '网络零件SN', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-23 10:18:16,501 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-23 10:18:16,502 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-23 10:18:16,523 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-23 10:18:16,525 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-23 10:18:16,527 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-23 10:18:16,530 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-23 10:18:16,535 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-23 10:18:16,538 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-23 10:18:16,542 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-23 10:18:16,544 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-23 10:18:16,549 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-23 10:18:16,552 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-23 10:18:16,556 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-23 10:18:16,558 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-23 10:18:16,559 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-23 10:18:16,682 - __main__ - INFO - Rebuilt table ROCE-TOR下联-网络零件（光模块+AOC）故障表 from ROCE-TOR下联-网络零件（光模块+AOC）故障表
2025-10-23 10:18:16,683 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-23 10:18:16,684 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-23 10:18:16,684 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-23 10:18:16,684 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-23 10:18:16,685 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-23 10:18:16,685 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-23 10:18:16,686 - __main__ - DEBUG - Sanitized name: 网络零件种类 -> 网络零件种类
2025-10-23 10:18:16,686 - __main__ - DEBUG - Sanitized name: 网络零件厂商 -> 网络零件厂商
2025-10-23 10:18:16,686 - __main__ - DEBUG - Sanitized name: 网络零件型号 -> 网络零件型号
2025-10-23 10:18:16,687 - __main__ - DEBUG - Sanitized name: 网络零件SN -> 网络零件SN
2025-10-23 10:18:16,687 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-23 10:18:16,688 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-23 10:18:16,688 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-23 10:18:16,689 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-23 10:18:16,689 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-23 10:18:16,715 - __main__ - INFO - Inserted 1044 records into table ROCE-TOR下联-网络零件（光模块+AOC）故障表
2025-10-23 10:18:16,741 - __main__ - INFO - Database built/updated at real_database.db (rebuild=True, status=0)
