2025-09-01 16:22:29,003 - data_loader - DEBUG - Initialized ExcelDataSourceLoader for 20250813光模块分析.xlsx with sheets: [('工作表6', '光模块故障表')]
2025-09-01 16:22:29,004 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-09-01 16:22:29,005 - __main__ - DEBUG - Processing data source: <data_loader.ExcelDataSourceLoader object at 0x00000224539FC830>
2025-09-01 16:22:29,005 - data_loader - DEBUG - Loading Excel file: 20250813光模块分析.xlsx
2025-09-01 16:22:36,369 - data_loader - DEBUG - Reading sheet: 工作表6
2025-09-01 16:22:43,212 - data_loader - DEBUG - Columns in sheet 工作表6: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,217 - data_loader - DEBUG - Loaded sheet 工作表6 as table 光模块故障表 with 174 records
2025-09-01 16:22:43,217 - data_loader - INFO - Loaded Excel file 20250813光模块分析.xlsx with sheets: ['工作表6'] (status=0)
2025-09-01 16:22:43,218 - data_loader - INFO - Excel load completed for 20250813光模块分析.xlsx (status=0)
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sample record columns: ['日期', '型号', '厂商', '总数量', '在线数', '故障数', '故障率1=故障/总数', '故障率2=故障/在线']
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,218 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,222 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,223 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,244 - __main__ - INFO - Rebuilt table 光模块故障表 from 光模块故障表
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 型号 -> 型号
2025-09-01 16:22:43,245 - __main__ - DEBUG - Sanitized name: 厂商 -> 厂商
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 总数量 -> 总数量
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 在线数 -> 在线数
2025-09-01 16:22:43,246 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率1=故障/总数 -> 故障率1_故障_总数
2025-09-01 16:22:43,247 - __main__ - DEBUG - Sanitized name: 故障率2=故障/在线 -> 故障率2_故障_在线
2025-09-01 16:22:43,250 - __main__ - INFO - Inserted 174 records into table 光模块故障表
2025-09-01 16:22:43,266 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:52:56,869 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:52:56,924 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:52:56,925 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:54:21,576 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:54:21,577 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:54:21,584 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:54:21,584 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:55:51,005 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:55:51,006 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:55:51,095 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:55:51,099 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:56:33,313 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:56:33,314 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:56:33,317 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 179, in load_data
    from backend.dataSources.optical_failure import query_event_monitor_demo
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 10, in <module>
    from mongodb_connector import connect_mongodb, get_database
ModuleNotFoundError: No module named 'mongodb_connector'
 (status=1)
2025-10-15 17:56:33,317 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,050 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,657 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,659 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,660 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,661 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,665 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,666 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,688 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,701 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.166899995761923, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:28.884Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42626, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,702 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,703 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>"}
2025-10-15 17:57:31,704 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,705 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a87"}, "driverConnectionId": 1, "serverConnectionId": 42626, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,706 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,707 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,790 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07270179998886306}
2025-10-15 17:57:31,791 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08514739999372978}
2025-10-15 17:57:31,792 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,802 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 9.745999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,803 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,803 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:31,804 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:31.804125
2025-10-15 17:57:31,804 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,805 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,806 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005225999921094626}
2025-10-15 17:57:31,807 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,826 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.728, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,827 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,829 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}}
2025-10-15 17:57:31,830 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a87, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009166899995761923>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,831 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,832 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006704999977955595}
2025-10-15 17:57:31,832 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:31.804Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xkiza241SxivsB0vFpzfMw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,851 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "durationMS": 18.922, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42628, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,859 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a87"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,860 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:31,862 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:31,863 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:31,864 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:31,867 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 17:57:31,867 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 17:57:31,883 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002B6BADC3390>
2025-10-15 17:57:31,883 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 17:57:31,887 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,888 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 17:57:31,889 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,891 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 17:57:31,893 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:31,895 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "remainingTimeMS": 4998}
2025-10-15 17:57:31,907 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 17:57:31,917 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.064999991096556, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T09:57:29.101Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42629, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 17:57:31,919 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,920 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "previousDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>"}
2025-10-15 17:57:31,921 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,922 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "driverConnectionId": 1, "serverConnectionId": 42629, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 17:57:31,922 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:31,923 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:31,989 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05641550000291318}
2025-10-15 17:57:31,990 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0682307000097353}
2025-10-15 17:57:31,991 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,001 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 9.912, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,002 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,002 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 17:57:32,003 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-09-15 00:00:00 至 2025-10-15 17:57:32.003461
2025-10-15 17:57:32,004 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,005 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,006 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004942999948980287}
2025-10-15 17:57:32,007 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 20.337999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 5}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,028 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,029 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}}
2025-10-15 17:57:32,030 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef700b505fba33ffbd7a88, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009064999991096556>]>", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,031 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,032 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006326000002445653}
2025-10-15 17:57:32,033 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-09-15T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T17:57:32.003Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QYEz2okvSNyo5Rt8xgY+cg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,051 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "durationMS": 18.724, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42631, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 17:57:32,053 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 17:57:32,053 - backend.dataSources.optical_failure - INFO - 查询到 5 条记录，返回 5 条
2025-10-15 17:57:32,054 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 4 条记录
2025-10-15 17:57:32,055 - backend.data_loader - DEBUG - Loaded 4 records from MongoDB
2025-10-15 17:57:32,055 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 17:57:32,055 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 17:57:32,057 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,060 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,064 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,065 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,066 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,067 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,103 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 17:57:32,104 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 17:57:32,105 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 17:57:32,108 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 17:57:32,109 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 17:57:32,112 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 17:57:32,115 - backend.database_builder - INFO - Inserted 4 records into table 事件监控-光模块故障表
2025-10-15 17:57:32,141 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 17:57:32,429 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef700b505fba33ffbd7a88"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 507.1827000065241, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:44,204 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:44,558 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,559 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:44,560 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,560 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,563 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "remainingTimeMS": 4999}
2025-10-15 20:12:44,584 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:44,601 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.551199994864874, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.193Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42710, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:44,602 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "previousDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>"}
2025-10-15 20:12:44,603 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,603 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "driverConnectionId": 1, "serverConnectionId": 42710, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,604 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04508509999141097}
2025-10-15 20:12:44,660 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056563300007837825}
2025-10-15 20:12:44,661 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,671 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 10.479000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,672 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,672 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:44,673 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:44.673086
2025-10-15 20:12:44,673 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,674 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,674 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00030520001018885523}
2025-10-15 20:12:44,675 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,695 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 20.1, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,696 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,696 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,697 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,697 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,698 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003618000046117231}
2025-10-15 20:12:44,698 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:44.673Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,758 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 60.125, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,761 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}}
2025-10-15 20:12:44,762 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbc9279eb444bf3fa42, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.016551199994864874>]>", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:44,763 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003352000057930127}
2025-10-15 20:12:44,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "command": "{\"getMore\": 5054377260502831866, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"X9G1jDI+TU2khcHp2Kzb2A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "durationMS": 274.81100000000004, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42712, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,039 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbc9279eb444bf3fa42"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,040 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,044 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,047 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,047 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,049 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 20:12:45,049 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 20:12:45,057 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x0000021634723390>
2025-10-15 20:12:45,057 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 20:12:45,059 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,060 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,061 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "remainingTimeMS": 4999}
2025-10-15 20:12:45,075 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 20:12:45,089 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.31979998596944, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T12:12:42.681Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42713, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 20:12:45,090 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,090 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "previousDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>"}
2025-10-15 20:12:45,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,091 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "driverConnectionId": 1, "serverConnectionId": 42713, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 20:12:45,091 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,092 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,136 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03614190001098905}
2025-10-15 20:12:45,137 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.045386199999484234}
2025-10-15 20:12:45,137 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,146 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 9.197000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,147 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,147 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 20:12:45,147 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 20:12:45.147662
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,148 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,148 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,149 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000228599994443357}
2025-10-15 20:12:45,149 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,168 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 19.352999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,169 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,170 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,170 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,171 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003893000102834776}
2025-10-15 20:12:45,171 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T20:12:45.147Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,232 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 61.038000000000004, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,233 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}}
2025-10-15 20:12:45,234 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002163431EC00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef8fbd9279eb444bf3fa43, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01431979998596944>]>", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00039679999463260174}
2025-10-15 20:12:45,235 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "command": "{\"getMore\": 3746973641896813909, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"IXpMFo7tRKWl6QZUVAJbRg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "durationMS": 227.198, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42714, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 20:12:45,463 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 20:12:45,464 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 20:12:45,467 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 20:12:45,470 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 20:12:45,470 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 20:12:45,470 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '故障数']
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,471 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,473 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,474 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,515 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 20:12:45,515 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 20:12:45,516 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 20:12:45,518 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 20:12:45,519 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 20:12:45,521 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 20:12:45,522 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 20:12:45,524 - backend.database_builder - INFO - Inserted 92 records into table 事件监控-光模块故障表
2025-10-15 20:12:45,552 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 20:12:45,607 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef8fbd9279eb444bf3fa43"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 515.7670000044163, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:13:50,264 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:13:50,265 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:13:50,645 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,646 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "previousDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:13:50,647 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,648 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:13:50,650 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,651 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "remainingTimeMS": 4999}
2025-10-15 21:13:50,679 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:13:50,690 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverConnectionId": 42725, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.160899997572415, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:13:48.327Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42725, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:13:50,691 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,692 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "previousDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>"}
2025-10-15 21:13:50,693 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,694 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0e5c1862b452878bea"}, "driverConnectionId": 1, "serverConnectionId": 42725, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:13:50,694 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,695 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,767 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06076490000123158}
2025-10-15 21:13:50,767 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07307240000227466}
2025-10-15 21:13:50,768 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,780 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 12.414, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,781 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,781 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:13:50,782 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:13:50.782309
2025-10-15 21:13:50,783 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,784 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,784 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,785 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005285999941406772}
2025-10-15 21:13:50,786 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:50.782Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,806 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 20.082, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,807 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,807 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,808 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,809 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,809 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005624000041279942}
2025-10-15 21:13:50,810 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:50.782Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,886 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 75.899, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,893 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:50,893 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}}
2025-10-15 21:13:50,894 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0e5c1862b452878bea, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010160899997572415>]>", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,895 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:50,895 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004589000018313527}
2025-10-15 21:13:50,896 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "command": "{\"getMore\": 1129965204086066459, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xrBwaenuR3qcJtmYfBMQ9Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,122 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "durationMS": 226.30100000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42727, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,123 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0e5c1862b452878bea"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,124 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:13:51,133 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 21:13:51,136 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 21:13:51,137 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:13:51,139 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:13:51,139 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:13:51,159 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x0000016735B73390>
2025-10-15 21:13:51,160 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:13:51,165 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,165 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "previousDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:13:51,166 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,167 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:13:51,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,169 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "remainingTimeMS": 4999}
2025-10-15 21:13:51,191 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:13:51,202 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverConnectionId": 42728, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.75100000121165, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:13:48.840Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42728, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:13:51,203 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,203 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "previousDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>"}
2025-10-15 21:13:51,204 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,205 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "driverConnectionId": 1, "serverConnectionId": 42728, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:13:51,205 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,206 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,259 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04333309999492485}
2025-10-15 21:13:51,260 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05520650000835303}
2025-10-15 21:13:51,261 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,272 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 11.207999999999998, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,273 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,274 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:13:51,275 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:13:51.275086
2025-10-15 21:13:51,275 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,276 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,277 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,278 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007470999989891425}
2025-10-15 21:13:51,279 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:51.275Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,298 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 19.616999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,299 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,300 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,301 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,302 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,302 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005055999936303124}
2025-10-15 21:13:51,303 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:13:51.275Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,380 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 77.352, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,383 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:51,384 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}}
2025-10-15 21:13:51,385 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016735772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68ef9e0f5c1862b452878beb, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00875100000121165>]>", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,386 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:51,386 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005604000034509227}
2025-10-15 21:13:51,415 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "command": "{\"getMore\": 1915413828488675802, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"BRnm2Xr1T4O8mFec4H5+zA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:52,177 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:13:52,305 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.07596589998865966}
2025-10-15 21:13:52,320 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:13:52,404 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "durationMS": 989.038, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42730, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:13:52,412 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:13:52,417 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:13:52,422 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.041064000004553236}
2025-10-15 21:13:52,441 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 92 条记录
2025-10-15 21:13:52,442 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:13:52,459 - backend.data_loader - DEBUG - Loaded 92 records from MongoDB
2025-10-15 21:13:52,466 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:13:52,468 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:13:52,469 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:13:52,473 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:13:52,491 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:13:52,502 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:13:52,505 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:13:52,514 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.03668710000056308}
2025-10-15 21:13:52,525 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:13:52,528 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:13:52,531 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:13:52,587 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02164650001213886}
2025-10-15 21:13:52,646 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:13:52,647 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:13:52,647 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:13:52,648 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:13:52,649 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:13:52,649 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:13:52,650 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:13:52,651 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:13:52,661 - backend.database_builder - INFO - Inserted 92 records into table 事件监控-光模块故障表
2025-10-15 21:13:52,734 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:13:53,249 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68ef9e0f5c1862b452878beb"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2044.148300003144, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:28:06,521 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:28:06,521 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:28:07,822 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:07,849 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "previousDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:28:07,865 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:07,872 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:28:07,991 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,015 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:28:08,080 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "remainingTimeMS": 4911}
2025-10-15 21:28:08,194 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverConnectionId": 42741, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 32.86839999782387, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:28:05.843Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42741, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:28:08,248 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,270 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "previousDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>"}
2025-10-15 21:28:08,275 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,280 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,280 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "driverConnectionId": 1, "serverConnectionId": 42741, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:28:08,348 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,615 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1627050999959465}
2025-10-15 21:28:08,621 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.3411100999946939}
2025-10-15 21:28:08,623 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,642 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 19.619, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,646 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,649 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:28:08,653 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:28:08.653306
2025-10-15 21:28:08,659 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,661 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,663 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,669 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0063510999898426235}
2025-10-15 21:28:08,675 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:28:08.653Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,706 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 31.534, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,726 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:08,733 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:08,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,756 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:08,762 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.006179200005135499}
2025-10-15 21:28:08,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:28:08.653Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,036 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:28:09,135 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 371.388, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42743, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,225 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:28:09,230 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B295772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}}
2025-10-15 21:28:09,304 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B295772C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1676cb49e9372663282, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.03286839999782387>]>", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,313 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.10731169999053236}
2025-10-15 21:28:09,331 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,339 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:28:09,355 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02461929999117274}
2025-10-15 21:28:09,369 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "command": "{\"getMore\": 5085479942393133435, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aXxJchdGRriIy4ijH1DOAw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 2, "serverConnectionId": 42744, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:09,555 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.08340950000274461}
2025-10-15 21:28:09,557 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:28:09,633 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.05685079999966547}
2025-10-15 21:28:09,642 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:28:09,779 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04499900000519119}
2025-10-15 21:28:10,076 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "durationMS": 707.557, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 2, "serverConnectionId": 42744, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:28:10,079 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:28:10,081 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:28:10,086 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 297, in query_event_monitor_demo
    noc_case_id = noc_case.get("noc_case_id", "")
                  ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:28:10,087 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:28:10,419 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa1676cb49e9372663282"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2139.2545999988215, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:29:44,111 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:29:44,111 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:29:44,639 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,640 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "previousDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:29:44,641 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,644 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:29:44,648 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,649 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "remainingTimeMS": 4999}
2025-10-15 21:29:44,673 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:29:44,684 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverConnectionId": 42748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.354500001994893, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:29:42.333Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:29:44,686 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,687 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "previousDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>"}
2025-10-15 21:29:44,692 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,693 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,694 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,695 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c8994788e83db08c6a"}, "driverConnectionId": 1, "serverConnectionId": 42748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:29:44,792 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08512650000920985}
2025-10-15 21:29:44,793 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.10031510000408161}
2025-10-15 21:29:44,794 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,808 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 14.244, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,809 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,810 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:29:44,811 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:29:44.811214
2025-10-15 21:29:44,812 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,814 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,815 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,816 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001378599990857765}
2025-10-15 21:29:44,817 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:44.811Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,840 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 23.311999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,841 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,842 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,845 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,847 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,848 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0013172000035410747}
2025-10-15 21:29:44,849 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:44.811Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,929 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 79.67299999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,935 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:44,937 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}}
2025-10-15 21:29:44,940 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c8994788e83db08c6a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010354500001994893>]>", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,943 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:44,944 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000980499986326322}
2025-10-15 21:29:44,945 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "command": "{\"getMore\": 2114070532873537457, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QkNVyjsFQCG450kApYU3mw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,485 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "durationMS": 540.303, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,490 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c8994788e83db08c6a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,494 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:29:45,505 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:29:45,522 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:29:45,528 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:29:45,545 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:29:45,546 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:29:45,551 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002236A362C10>
2025-10-15 21:29:45,552 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:29:45,561 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,564 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "previousDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:29:45,566 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,569 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:29:45,585 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,590 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "remainingTimeMS": 4995}
2025-10-15 21:29:45,617 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:29:45,631 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverConnectionId": 42751, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.377600003266707, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:29:43.280Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42751, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:29:45,632 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,635 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "previousDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>"}
2025-10-15 21:29:45,638 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,641 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,642 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,645 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "driverConnectionId": 1, "serverConnectionId": 42751, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:29:45,767 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11051059998862911}
2025-10-15 21:29:45,770 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1285545999999158}
2025-10-15 21:29:45,777 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,806 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 28.59, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,810 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,814 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:29:45,824 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:29:45.824048
2025-10-15 21:29:45,827 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,832 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,841 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,844 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0029910000012023374}
2025-10-15 21:29:45,848 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:45.824Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,882 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 33.984, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,896 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:45,900 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:45,904 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,908 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:45,911 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002620100000058301}
2025-10-15 21:29:45,920 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:29:45.824Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,040 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 120.62100000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,044 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:46,045 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}}
2025-10-15 21:29:46,047 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000022369F62C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa1c9994788e83db08c6b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010377600003266707>]>", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,048 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,050 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002340799997909926}
2025-10-15 21:29:46,058 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "command": "{\"getMore\": 2104555677937635301, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"TIWGaLTUS1iM13fEk/7Eqw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,509 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "durationMS": 451.192, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42752, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:29:46,511 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:29:46,514 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:29:46,516 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:29:46,525 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:29:46,525 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:29:46,526 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:29:46,527 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:29:46,529 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:29:46,534 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:29:46,535 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:29:46,536 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:29:46,537 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:29:46,538 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:29:46,591 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:29:46,611 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:29:46,612 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:29:46,614 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:29:46,615 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:29:46,615 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:29:46,616 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:29:46,617 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:29:46,618 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:29:46,623 - backend.database_builder - INFO - Inserted 6 records into table 事件监控-光模块故障表
2025-10-15 21:29:46,633 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.027907199997571297}
2025-10-15 21:29:46,634 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:29:46,667 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:29:46,673 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.024851299996953458}
2025-10-15 21:29:46,677 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:29:46,712 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023344300003373064}
2025-10-15 21:29:46,713 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:29:46,744 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.01950609999767039}
2025-10-15 21:29:47,182 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa1c9994788e83db08c6b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1537.3638999881223, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:41:14,629 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:41:14,630 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:41:15,975 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:15,987 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "previousDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:41:15,996 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,012 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:41:16,058 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,061 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "remainingTimeMS": 4996}
2025-10-15 21:41:16,087 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:41:16,121 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverConnectionId": 42770, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 25.128399996901862, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:41:13.775Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42770, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:41:16,123 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,126 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "previousDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>"}
2025-10-15 21:41:16,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,130 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,132 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,139 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "driverConnectionId": 1, "serverConnectionId": 42770, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:41:16,309 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.15194310000515543}
2025-10-15 21:41:16,329 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.19988119999470655}
2025-10-15 21:41:16,331 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,353 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 21.802, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,357 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,360 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:41:16,362 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:41:16.362799
2025-10-15 21:41:16,391 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,409 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,414 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,421 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.007230200004414655}
2025-10-15 21:41:16,425 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:16.362Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,911 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 486.52099999999996, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,914 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:16,916 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:16,919 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,925 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:16,927 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001808600005460903}
2025-10-15 21:41:16,929 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:16.362Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,018 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 89.10600000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,024 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,025 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}}
2025-10-15 21:41:17,026 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47b49d43d3a7a0bdd95, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.025128399996901862>]>", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,028 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,028 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008606000046711415}
2025-10-15 21:41:17,029 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "command": "{\"getMore\": 8909637537337048233, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kvERJmL1RdawEy8JRm7w/g==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,060 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:41:17,140 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.04100050000124611}
2025-10-15 21:41:17,141 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:41:17,192 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.035644999996293336}
2025-10-15 21:41:17,193 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:41:17,253 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.04577169999538455}
2025-10-15 21:41:17,257 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:41:17,319 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04199129999324214}
2025-10-15 21:41:17,412 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "durationMS": 382.214, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42771, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,417 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47b49d43d3a7a0bdd95"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,420 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:41:17,431 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:41:17,441 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:41:17,444 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:41:17,453 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:41:17,454 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:41:17,457 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001397C6A2C10>
2025-10-15 21:41:17,458 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:41:17,463 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,464 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "previousDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:41:17,464 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,467 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:41:17,470 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,473 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "remainingTimeMS": 4997}
2025-10-15 21:41:17,503 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:41:17,513 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverConnectionId": 42777, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.280600002966821, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:41:15.175Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42777, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:41:17,514 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,515 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "previousDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>"}
2025-10-15 21:41:17,518 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,519 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "driverConnectionId": 1, "serverConnectionId": 42777, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:41:17,522 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,523 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,618 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06925609998870641}
2025-10-15 21:41:17,619 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09770459998981096}
2025-10-15 21:41:17,621 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,632 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 11.376000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,633 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,634 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:41:17,635 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:41:17.635427
2025-10-15 21:41:17,636 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,637 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,638 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,640 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0014967999886721373}
2025-10-15 21:41:17,641 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:17.635Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,661 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 20.261000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,662 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,663 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,664 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,665 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,667 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011585000029299408}
2025-10-15 21:41:17,669 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:41:17.635Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,759 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 90.408, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,762 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:17,763 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}}
2025-10-15 21:41:17,764 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001397C2A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa47d49d43d3a7a0bdd96, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009280600002966821>]>", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,765 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:17,766 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011492999910842627}
2025-10-15 21:41:17,767 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "command": "{\"getMore\": 191292709385973757, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"bQ7U2k/2S2CUQZGIo//8KA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:18,216 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "durationMS": 448.913, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42779, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:41:18,218 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:41:18,220 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:41:18,227 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 6 条记录
2025-10-15 21:41:18,236 - backend.data_loader - DEBUG - Loaded 6 records from MongoDB
2025-10-15 21:41:18,237 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:41:18,238 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:41:18,239 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:41:18,242 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:41:18,248 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:41:18,250 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:41:18,251 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:41:18,254 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:41:18,258 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:41:18,355 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:41:18,357 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:41:18,358 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:41:18,359 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:41:18,360 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:41:18,361 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:41:18,363 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:41:18,372 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:41:18,376 - backend.database_builder - INFO - Inserted 6 records into table 事件监控-光模块故障表
2025-10-15 21:41:18,427 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:41:18,477 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:41:18,665 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.05358219999470748}
2025-10-15 21:41:18,667 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:41:18,698 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.019659500001580454}
2025-10-15 21:41:18,700 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:41:18,759 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023579400003654882}
2025-10-15 21:41:18,760 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:41:18,800 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02887639999971725}
2025-10-15 21:41:19,044 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa47d49d43d3a7a0bdd96"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1525.4249999998137, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:48:39,932 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:48:39,932 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:48:40,745 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,746 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "previousDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:48:40,747 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,749 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:48:40,753 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,754 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "remainingTimeMS": 4998}
2025-10-15 21:48:40,775 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:48:40,787 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverConnectionId": 42791, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.42020000750199, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:48:38.452Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42791, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:48:40,789 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,790 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "previousDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>"}
2025-10-15 21:48:40,791 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,792 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa638566c626cdd17f040"}, "driverConnectionId": 1, "serverConnectionId": 42791, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:48:40,793 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,795 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,879 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07432270000572316}
2025-10-15 21:48:40,880 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08674420000170358}
2025-10-15 21:48:40,881 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,891 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 9.898, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,892 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,892 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:48:40,893 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:48:40.893483
2025-10-15 21:48:40,894 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,895 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,897 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,897 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008760999917285517}
2025-10-15 21:48:40,899 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:40.893Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,922 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 23.499, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,923 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:40,925 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:40,926 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,926 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,927 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006239000067580491}
2025-10-15 21:48:40,928 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:40.893Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:40,998 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 69.982, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,003 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,005 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}}
2025-10-15 21:48:41,006 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa638566c626cdd17f040, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01042020000750199>]>", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,007 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,009 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001539100005174987}
2025-10-15 21:48:41,010 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "command": "{\"getMore\": 2761820994334931500, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ENyphq0KQ3C+dm3gD0mJ2Q==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,330 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "durationMS": 320.034, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42793, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,333 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa638566c626cdd17f040"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,336 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:48:41,341 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:48:41,350 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:48:41,351 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:48:41,355 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:48:41,356 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:48:41,359 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x00000229D64A3110>
2025-10-15 21:48:41,360 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:48:41,368 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,371 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "previousDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:48:41,372 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,376 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:48:41,382 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,385 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "remainingTimeMS": 4996}
2025-10-15 21:48:41,391 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:48:41,401 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverConnectionId": 42794, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.80660000257194, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:48:39.066Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42794, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:48:41,403 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,404 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "previousDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>"}
2025-10-15 21:48:41,406 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,407 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "driverConnectionId": 1, "serverConnectionId": 42794, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:48:41,408 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,410 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,506 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06546959999832325}
2025-10-15 21:48:41,507 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09855729999253526}
2025-10-15 21:48:41,508 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,529 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 21.408, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,530 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,531 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:48:41,532 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:48:41.532237
2025-10-15 21:48:41,533 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,536 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,538 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,539 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007875999872339889}
2025-10-15 21:48:41,540 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:41.532Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,561 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 20.559, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,562 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,563 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,564 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,566 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,568 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0025396999990334734}
2025-10-15 21:48:41,570 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:48:41.532Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,642 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 72.238, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,644 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,645 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}}
2025-10-15 21:48:41,645 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000229D60A2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa639566c626cdd17f041, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.00880660000257194>]>", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,646 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,647 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000586000009207055}
2025-10-15 21:48:41,648 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "command": "{\"getMore\": 8689348324599948128, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+vm5PwkqTtKXsTGzZY37pw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,911 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "durationMS": 263.63599999999997, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42796, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:48:41,913 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:48:41,915 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:48:41,916 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:48:41,922 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:48:41,922 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:48:41,923 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:48:41,924 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:48:41,925 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:48:41,929 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:48:41,930 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:48:41,931 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:48:41,932 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:48:41,933 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:48:42,129 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:48:42,130 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:48:42,131 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:48:42,133 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:48:42,134 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:48:42,134 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:48:42,137 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:48:42,138 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:48:42,142 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:48:42,197 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:48:42,436 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa639566c626cdd17f041"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1028.9198000100441, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:51:54,549 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:51:54,549 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:51:55,140 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,142 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:51:55,143 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,146 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:51:55,152 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,153 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "remainingTimeMS": 4998}
2025-10-15 21:51:55,172 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:51:55,194 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverConnectionId": 42798, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.043300005141646, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:51:52.860Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42798, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:51:55,197 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,198 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>"}
2025-10-15 21:51:55,199 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,200 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,201 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,206 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "driverConnectionId": 1, "serverConnectionId": 42798, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:51:55,319 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.10117510000418406}
2025-10-15 21:51:55,320 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.11996219999855384}
2025-10-15 21:51:55,321 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,333 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 11.926, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,334 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,335 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:51:55,336 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:51:55.336380
2025-10-15 21:51:55,337 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,338 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,339 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,341 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0014795000024605542}
2025-10-15 21:51:55,343 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:55.336Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,362 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 19.748, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,363 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,365 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,366 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,367 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,368 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009962000040104613}
2025-10-15 21:51:55,370 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:55.336Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,451 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 81.114, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,456 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,457 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}}
2025-10-15 21:51:55,458 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f63, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014043300005141646>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,459 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,460 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009806999878492206}
2025-10-15 21:51:55,462 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "command": "{\"getMore\": 8255088930409715994, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"49klBnuwSI21wt0WRC4rmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,800 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "durationMS": 338.793, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42799, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,806 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f63"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:55,809 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:51:55,814 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:51:55,828 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:51:55,829 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:51:55,862 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:51:55,863 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:51:55,870 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002D274382FD0>
2025-10-15 21:51:55,871 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:51:55,883 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:55,887 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:51:55,888 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,896 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:51:55,901 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:55,903 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "remainingTimeMS": 4997}
2025-10-15 21:51:55,942 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:51:55,954 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverConnectionId": 42801, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.205700004007667, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:51:53.624Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42801, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:51:55,956 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,957 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "previousDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>"}
2025-10-15 21:51:55,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,967 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "driverConnectionId": 1, "serverConnectionId": 42801, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:51:55,968 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:55,971 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,095 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09189969999715686}
2025-10-15 21:51:56,099 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.13051160000031814}
2025-10-15 21:51:56,103 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,134 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 30.951, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,144 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,145 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:51:56,146 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:51:56.146643
2025-10-15 21:51:56,163 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,169 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,179 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,182 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0026959999959217384}
2025-10-15 21:51:56,185 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:56.146Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,222 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 37.083, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,226 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,229 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,230 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,232 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,235 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002549700002418831}
2025-10-15 21:51:56,237 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:51:56.146Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,366 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 129.28799999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,369 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,370 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}}
2025-10-15 21:51:56,371 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002D273FA2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa6fb5271d4f9faf15f64, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010205700004007667>]>", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,373 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,374 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009608999971533194}
2025-10-15 21:51:56,379 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "command": "{\"getMore\": 3873085917204919547, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"kwRUezH1Qjm0zUMbqLuVCQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,793 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "durationMS": 413.588, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42803, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:51:56,795 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:51:56,798 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:51:56,800 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:51:56,808 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:51:56,808 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:51:56,809 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:51:56,810 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:51:56,813 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:51:56,822 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:51:56,823 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:51:56,824 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:51:56,826 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:51:56,827 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:51:56,903 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:51:56,904 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:51:56,908 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:51:56,908 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:51:56,909 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:51:56,910 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:51:56,911 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:51:56,911 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:51:56,912 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-15 21:51:56,914 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:51:56,983 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.05662329999904614}
2025-10-15 21:51:56,985 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-15 21:51:56,991 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:51:57,021 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.01944369998818729}
2025-10-15 21:51:57,022 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-15 21:51:57,052 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.019824599992716685}
2025-10-15 21:51:57,053 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-15 21:51:57,085 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02183589999913238}
2025-10-15 21:51:57,511 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa6fb5271d4f9faf15f64"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1544.3687999941176, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:54:47,323 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:54:47,324 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:54:47,825 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,826 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "previousDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:54:47,827 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,829 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:54:47,833 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,834 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "remainingTimeMS": 4998}
2025-10-15 21:54:47,844 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:54:47,865 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverConnectionId": 42809, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 20.74490000086371, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:54:45.533Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42809, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:54:47,867 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,867 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "previousDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>"}
2025-10-15 21:54:47,869 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,870 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "driverConnectionId": 1, "serverConnectionId": 42809, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:54:47,871 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,872 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:47,963 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07692799999495037}
2025-10-15 21:54:47,964 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09288820000074338}
2025-10-15 21:54:47,965 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,976 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 10.799, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,978 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:47,979 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:54:47,980 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:54:47.980035
2025-10-15 21:54:47,981 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:47,982 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,982 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:47,983 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007210000039776787}
2025-10-15 21:54:47,984 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:47.980Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,004 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 19.699, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,005 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,007 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:48,008 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,009 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,011 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0016450999974040315}
2025-10-15 21:54:48,013 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:47.980Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,085 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 72.738, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,089 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,090 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}}
2025-10-15 21:54:48,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a7bb45f9b4e2b52ac1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.02074490000086371>]>", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,092 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,092 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004969000001437962}
2025-10-15 21:54:48,093 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "command": "{\"getMore\": 642056611885069641, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"pLYeX9mwTYSsTCwUP3fX4w==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,399 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "durationMS": 306.283, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42811, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,403 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a7bb45f9b4e2b52ac1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,406 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:54:48,412 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:54:48,423 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:54:48,423 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:54:48,442 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:54:48,443 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:54:48,449 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001C58E7F3390>
2025-10-15 21:54:48,454 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:54:48,462 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,465 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "previousDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:54:48,469 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,473 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:54:48,478 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,479 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "remainingTimeMS": 4998}
2025-10-15 21:54:48,486 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:54:48,496 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverConnectionId": 42812, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.6035999993328, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:54:46.164Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42812, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:54:48,499 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,500 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "previousDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>"}
2025-10-15 21:54:48,502 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,502 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "driverConnectionId": 1, "serverConnectionId": 42812, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:54:48,503 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,505 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,586 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0702447000076063}
2025-10-15 21:54:48,587 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08364089998940472}
2025-10-15 21:54:48,588 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,600 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 11.892, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,601 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,602 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:54:48,602 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:54:48.602866
2025-10-15 21:54:48,603 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,604 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,605 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,606 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000774300002376549}
2025-10-15 21:54:48,607 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:48.602Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,629 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 22.093999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,632 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,634 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,636 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,637 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,638 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007474000012734905}
2025-10-15 21:54:48,639 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:54:48.602Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,718 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 78.22500000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,719 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:48,721 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}}
2025-10-15 21:54:48,722 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001C58E3F2C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa7a8bb45f9b4e2b52ac2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.0086035999993328>]>", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,723 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:48,723 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006567999953404069}
2025-10-15 21:54:48,724 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "command": "{\"getMore\": 3244617196764948786, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YRRvRUyIRzSroXp7VAWitQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:49,159 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "durationMS": 435.26599999999996, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42814, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:54:49,161 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:54:49,164 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:54:49,166 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 10 条记录
2025-10-15 21:54:49,176 - backend.data_loader - DEBUG - Loaded 10 records from MongoDB
2025-10-15 21:54:49,177 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:54:49,179 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:54:49,182 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:54:49,184 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:54:49,192 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:54:49,193 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:54:49,195 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:54:49,197 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:54:49,198 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:54:49,279 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:54:49,281 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:54:49,282 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:54:49,284 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:54:49,286 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:54:49,295 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:54:49,296 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:54:49,297 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:54:49,300 - backend.database_builder - INFO - Inserted 10 records into table 事件监控-光模块故障表
2025-10-15 21:54:49,385 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:54:49,523 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa7a8bb45f9b4e2b52ac2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1020.6214999925578, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:56:18,326 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:56:18,326 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:56:18,723 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,723 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "previousDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:56:18,724 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,725 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:56:18,728 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,729 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "remainingTimeMS": 4999}
2025-10-15 21:56:18,757 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:56:18,771 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverConnectionId": 42816, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.101100001018494, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:56:16.442Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42816, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:56:18,772 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,774 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "previousDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>"}
2025-10-15 21:56:18,776 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,777 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "driverConnectionId": 1, "serverConnectionId": 42816, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:56:18,778 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,779 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,845 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056574099988210946}
2025-10-15 21:56:18,845 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06763689999934286}
2025-10-15 21:56:18,846 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,856 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 10.234, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,857 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,858 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:56:18,859 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:56:18.859292
2025-10-15 21:56:18,860 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,861 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,861 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,862 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005152999947313219}
2025-10-15 21:56:18,862 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:18.859Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,882 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 19.541, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,883 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,884 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,884 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,885 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,886 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00048750000132713467}
2025-10-15 21:56:18,886 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:18.859Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,956 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 69.53, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,960 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:18,961 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000211D8322C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}}
2025-10-15 21:56:18,961 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000211D8322C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8025cfc86412a6507c8, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012101100001018494>]>", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,962 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:18,963 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005035999929532409}
2025-10-15 21:56:18,963 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "command": "{\"getMore\": 6638224362842435104, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ujxsEFwBTxq/lIWZJ9tAtQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:19,291 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "durationMS": 328.04100000000005, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42817, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:19,293 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:19,294 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:56:19,300 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 387, in query_event_monitor_demo
    module_name = optical_module.get("module_name", "non-data")
                  ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:56:19,300 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:56:19,794 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa8025cfc86412a6507c8"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1017.3420000064652, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:56:37,906 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:56:37,907 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:56:38,227 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,227 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "previousDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:56:38,228 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,229 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:56:38,231 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,232 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "remainingTimeMS": 4999}
2025-10-15 21:56:38,241 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:56:38,253 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverConnectionId": 42819, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.27489999635145, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:56:35.925Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42819, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:56:38,254 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,254 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "previousDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>"}
2025-10-15 21:56:38,255 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,256 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "driverConnectionId": 1, "serverConnectionId": 42819, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:56:38,256 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,257 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,325 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.056778900005156174}
2025-10-15 21:56:38,326 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06968659999256488}
2025-10-15 21:56:38,327 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,337 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 10.644, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,338 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,338 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:56:38,339 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:56:38.339152
2025-10-15 21:56:38,339 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,340 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,341 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,342 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004444999940460548}
2025-10-15 21:56:38,342 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:38.339Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,362 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 20.154, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,363 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,364 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,364 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,365 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,365 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00038219999987632036}
2025-10-15 21:56:38,366 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:56:38.339Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,428 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 62.021, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,430 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,431 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002A9B7D22C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}}
2025-10-15 21:56:38,431 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002A9B7D22C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa81616895472aefc4b1f, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01127489999635145>]>", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,432 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,432 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00037960000918246806}
2025-10-15 21:56:38,433 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "command": "{\"getMore\": 5828647788721058203, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"f370Kr7xS865Am2JvLjwwg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,651 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "durationMS": 217.78300000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42821, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:56:38,652 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:56:38,653 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:56:38,657 - backend.data_loader - ERROR - Failed to load optical failure data: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\data_loader.py", line 182, in load_data
    data = query_event_monitor_demo()
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend/..\backend\dataSources\optical_failure.py", line 387, in query_event_monitor_demo
    module_name = optical_module.get("module_name", "non-data")
                  ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
 (status=1)
2025-10-15 21:56:38,657 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:56:38,759 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa81616895472aefc4b1f"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 503.1449999951292, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-15 21:59:14,323 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:59:14,324 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:59:14,954 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:14,955 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "previousDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:59:14,956 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:14,958 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:59:14,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:14,963 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "remainingTimeMS": 4998}
2025-10-15 21:59:14,997 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:59:15,008 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverConnectionId": 42825, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.260600010748021, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:59:12.681Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42825, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:59:15,010 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,011 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "previousDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>"}
2025-10-15 21:59:15,013 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,015 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "driverConnectionId": 1, "serverConnectionId": 42825, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:59:15,016 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,020 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,113 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07035950000863522}
2025-10-15 21:59:15,114 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09840149999945424}
2025-10-15 21:59:15,115 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,125 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 9.998999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,126 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,127 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:59:15,127 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:59:15.127849
2025-10-15 21:59:15,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,129 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,130 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,131 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006229999999050051}
2025-10-15 21:59:15,131 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.127Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,152 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 21.023, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,154 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,155 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,156 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,156 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,157 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006013999955030158}
2025-10-15 21:59:15,158 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.127Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,233 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 74.828, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,236 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,237 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}}
2025-10-15 21:59:15,238 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b2d9e5d42c122cf7f3, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009260600010748021>]>", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,239 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,239 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000562699991860427}
2025-10-15 21:59:15,240 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "command": "{\"getMore\": 478595367856304872, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ik7u0iyEQc+DDHzhQUZ5oA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,585 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "durationMS": 345.42699999999996, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 42827, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,587 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b2d9e5d42c122cf7f3"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,588 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:59:15,607 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 466 条记录
2025-10-15 21:59:15,615 - backend.data_loader - DEBUG - Loaded 466 records from MongoDB
2025-10-15 21:59:15,615 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:59:15,620 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-15 21:59:15,621 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-15 21:59:15,623 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x00000171BF183390>
2025-10-15 21:59:15,624 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-15 21:59:15,629 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,630 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "previousDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-15 21:59:15,635 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,637 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-15 21:59:15,639 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,640 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "remainingTimeMS": 4999}
2025-10-15 21:59:15,648 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-15 21:59:15,657 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverConnectionId": 42828, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 8.477399998810142, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-15T13:59:13.330Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 42828, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-15 21:59:15,659 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,659 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "previousDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>"}
2025-10-15 21:59:15,661 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,661 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "driverConnectionId": 1, "serverConnectionId": 42828, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-15 21:59:15,662 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,665 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,732 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05665549999685027}
2025-10-15 21:59:15,733 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07063299999572337}
2025-10-15 21:59:15,734 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,744 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 10.181000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,745 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,746 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-15 21:59:15,746 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-17 00:00:00 至 2025-10-15 21:59:15.746900
2025-10-15 21:59:15,747 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,749 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,750 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005434999911813065}
2025-10-15 21:59:15,751 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.746Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,772 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 20.962999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,773 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,774 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,775 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,776 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,777 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0011341000063112006}
2025-10-15 21:59:15,779 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-17T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-15T21:59:15.746Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,848 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 69.34899999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,851 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:15,852 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}}
2025-10-15 21:59:15,853 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000171BED82C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68efa8b3d9e5d42c122cf7f4, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.008477399998810142>]>", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,854 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:15,855 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007027999963611364}
2025-10-15 21:59:15,855 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "command": "{\"getMore\": 4863982385481659248, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"okhEdiniQ5C1ueH0TFuuEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:16,202 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "durationMS": 346.874, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 42830, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-15 21:59:16,204 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-15 21:59:16,207 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-15 21:59:16,234 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 466 条记录
2025-10-15 21:59:16,254 - backend.data_loader - DEBUG - Loaded 466 records from MongoDB
2025-10-15 21:59:16,255 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-15 21:59:16,255 - backend.database_builder - DEBUG - Sample record columns: ['日期', '型号', '厂商', '机房', '集群', '客户', '故障数']
2025-10-15 21:59:16,256 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:59:16,259 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:59:16,268 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:59:16,271 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:59:16,272 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:59:16,273 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:59:16,274 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:59:16,354 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-15 21:59:16,355 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-15 21:59:16,356 - backend.database_builder - DEBUG - Sanitized name: 型号 -> 型号
2025-10-15 21:59:16,356 - backend.database_builder - DEBUG - Sanitized name: 厂商 -> 厂商
2025-10-15 21:59:16,357 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-15 21:59:16,358 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-15 21:59:16,358 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-15 21:59:16,359 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-15 21:59:16,369 - backend.database_builder - INFO - Inserted 466 records into table 事件监控-光模块故障表
2025-10-15 21:59:16,402 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-15 21:59:16,690 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68efa8b3d9e5d42c122cf7f4"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1029.2006999952719, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 18:25:45,567 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:25:45,569 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:25:45,947 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:45,948 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "previousDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:25:45,949 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:45,950 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:25:45,954 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:45,954 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "remainingTimeMS": 4999}
2025-10-18 18:25:45,977 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:25:46,020 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "driverConnectionId": 1, "serverConnectionId": 45573, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 41.61249997559935, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:25:40.356Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45573, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:25:46,043 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,044 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "previousDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>"}
2025-10-18 18:25:46,045 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,051 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,053 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "driverConnectionId": 1, "serverConnectionId": 45573, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:25:46,068 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,296 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.19596779998391867}
2025-10-18 18:25:46,297 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.24586689998977818}
2025-10-18 18:25:46,298 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,349 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 50.776, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,351 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,352 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:25:46,352 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:25:46.352705
2025-10-18 18:25:46,353 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:46,354 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,355 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,355 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005484999855980277}
2025-10-18 18:25:46,356 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:46.352Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,381 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 24.798000000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,383 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,384 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:46,385 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,386 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,387 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005575999966822565}
2025-10-18 18:25:46,388 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:46.352Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,691 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 303.613, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,701 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:46,702 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}}
2025-10-18 18:25:46,703 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b29a00ae83ac9d2a78a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.04161249997559935>]>", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,704 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,705 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007919000054243952}
2025-10-18 18:25:46,706 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "command": "{\"getMore\": 8318068146207549427, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZJwgvQtLSkuniMcMCSgeWw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:46,954 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 18:25:47,074 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.07504060000064783}
2025-10-18 18:25:47,075 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 18:25:47,209 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.03857629999401979}
2025-10-18 18:25:47,210 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 18:25:47,320 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.051711700012674555}
2025-10-18 18:25:47,323 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 18:25:47,448 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04446910001570359}
2025-10-18 18:25:47,702 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "durationMS": 996.4739999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45575, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,704 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b29a00ae83ac9d2a78a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:47,706 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:25:47,709 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 11 条记录
2025-10-18 18:25:47,719 - backend.data_loader - DEBUG - Loaded 11 records from MongoDB
2025-10-18 18:25:47,719 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:25:47,725 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:25:47,726 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 18:25:47,743 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001B707052C10>
2025-10-18 18:25:47,744 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:25:47,750 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:47,751 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "previousDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:25:47,752 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,753 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:25:47,758 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:47,759 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "remainingTimeMS": 4998}
2025-10-18 18:25:47,792 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:25:47,809 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "driverConnectionId": 1, "serverConnectionId": 45580, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.15070000034757, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:25:42.175Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45580, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:25:47,811 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,813 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "previousDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>"}
2025-10-18 18:25:47,816 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,817 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "driverConnectionId": 1, "serverConnectionId": 45580, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:25:47,818 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:47,820 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,010 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1791275000141468}
2025-10-18 18:25:48,057 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.2391666999901645}
2025-10-18 18:25:48,072 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,084 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 12.600999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,086 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,086 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:25:48,087 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:25:48.087720
2025-10-18 18:25:48,088 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:48,090 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,091 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,091 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007611000037286431}
2025-10-18 18:25:48,092 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:48.087Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,138 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 45.258, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,139 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,140 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:48,141 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,142 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,143 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.000686999992467463}
2025-10-18 18:25:48,144 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:25:48.087Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,259 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 115.19699999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,263 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,264 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}}
2025-10-18 18:25:48,265 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B706C52C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36b2ba00ae83ac9d2a78b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01215070000034757>]>", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,266 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,267 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007027999963611364}
2025-10-18 18:25:48,267 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "command": "{\"getMore\": 1683173298301450532, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkGD6J5cTzyVkK2rf6EQEw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,780 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 18:25:48,810 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "durationMS": 542.7180000000001, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45582, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:25:48,814 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:25:48,816 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:25:48,819 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 11 条记录
2025-10-18 18:25:48,830 - backend.data_loader - DEBUG - Loaded 11 records from MongoDB
2025-10-18 18:25:48,832 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:25:48,835 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 18:25:48,837 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:25:48,847 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:25:48,851 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:25:48,852 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:25:48,853 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:25:48,854 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:25:48,855 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:25:48,856 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:25:48,862 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.0319358000124339}
2025-10-18 18:25:48,865 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:25:48,866 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 18:25:48,868 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:25:48,869 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:25:48,870 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:25:48,872 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:25:48,872 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:25:48,876 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:25:48,877 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:25:48,902 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.022860400000354275}
2025-10-18 18:25:48,903 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 18:25:49,120 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 18:25:49,123 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:25:49,124 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.18961010000202805}
2025-10-18 18:25:49,131 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:25:49,132 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 18:25:49,134 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:25:49,138 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:25:49,139 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:25:49,140 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:25:49,140 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:25:49,141 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:25:49,142 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:25:49,142 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:25:49,144 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:25:49,147 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:25:49,148 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:25:49,149 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:25:49,149 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:25:49,150 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:25:49,159 - backend.database_builder - INFO - Inserted 11 records into table 事件监控-光模块故障表
2025-10-18 18:25:49,203 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.05207570001948625}
2025-10-18 18:25:49,224 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 18:25:49,352 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f36b2ba00ae83ac9d2a78b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1535.4507000010926, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 18:34:48,249 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:34:48,249 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:34:48,416 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,416 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "previousDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:34:48,416 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,417 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:34:48,419 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,419 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "remainingTimeMS": 4999}
2025-10-18 18:34:48,449 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:34:48,461 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "driverConnectionId": 1, "serverConnectionId": 45589, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.377999995602295, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:34:42.830Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45589, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:34:48,461 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,462 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "previousDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>"}
2025-10-18 18:34:48,462 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,462 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d480f4d2992b1af3a14"}, "driverConnectionId": 1, "serverConnectionId": 45589, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:34:48,463 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,463 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,517 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04264230001717806}
2025-10-18 18:34:48,517 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.054292699991492555}
2025-10-18 18:34:48,518 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,529 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 11.198, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,529 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,529 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:34:48,530 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:34:48.530061
2025-10-18 18:34:48,530 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,530 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,530 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,531 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00021040000137872994}
2025-10-18 18:34:48,531 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:48.530Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,554 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 22.603, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,554 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,554 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,555 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,555 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,555 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00019650001195259392}
2025-10-18 18:34:48,555 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:48.530Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,630 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 74.935, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,632 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:48,633 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}}
2025-10-18 18:34:48,633 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d480f4d2992b1af3a14, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011377999995602295>]>", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,633 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:48,634 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002154999820049852}
2025-10-18 18:34:48,634 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "command": "{\"getMore\": 1143578447385398918, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"qXzK/96lSYmoi+QboEhuyg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,014 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "durationMS": 380.567, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45590, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,015 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d480f4d2992b1af3a14"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,016 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:34:49,030 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 18:34:49,033 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 18:34:49,033 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:34:49,036 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:34:49,036 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 18:34:49,037 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000002457D823390>
2025-10-18 18:34:49,037 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:34:49,038 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,038 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "previousDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:34:49,039 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,039 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:34:49,040 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,040 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "remainingTimeMS": 4999}
2025-10-18 18:34:49,075 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:34:49,090 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "driverConnectionId": 1, "serverConnectionId": 45592, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 14.339200017275289, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:34:43.458Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45592, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:34:49,091 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,092 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "previousDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>"}
2025-10-18 18:34:49,092 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,093 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "driverConnectionId": 1, "serverConnectionId": 45592, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:34:49,093 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,094 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,141 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.03600309998728335}
2025-10-18 18:34:49,142 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.048364799993578345}
2025-10-18 18:34:49,142 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,152 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 10.266, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,153 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,153 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:34:49,154 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:34:49.154016
2025-10-18 18:34:49,154 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,154 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,155 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,155 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00019609997980296612}
2025-10-18 18:34:49,155 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:49.154Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,173 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 18.395000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,174 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,174 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,175 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,176 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,176 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002804999821819365}
2025-10-18 18:34:49,176 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:34:49.154Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,255 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 78.387, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,256 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,256 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}}
2025-10-18 18:34:49,256 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002457D422C00>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36d490f4d2992b1af3a15, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.014339200017275289>]>", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,257 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,257 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003043999895453453}
2025-10-18 18:34:49,257 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "command": "{\"getMore\": 5285905477664583787, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"nAno//qYQeeG2HWalCSPmg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,737 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "durationMS": 480.208, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45594, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:34:49,738 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:34:49,739 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:34:49,752 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 18:34:49,755 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 18:34:49,755 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:34:49,755 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 18:34:49,756 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:34:49,758 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:34:49,758 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:34:49,758 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:34:49,759 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:34:49,760 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:34:49,760 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:34:49,760 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:34:49,761 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:34:49,761 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:34:49,761 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:34:49,763 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:34:49,803 - backend.database_builder - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:34:49,804 - backend.database_builder - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:34:49,805 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:34:49,806 - backend.database_builder - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:34:49,817 - backend.database_builder - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 18:34:49,834 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 18:34:50,121 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f36d490f4d2992b1af3a15"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1027.3723999853246, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 18:45:45,829 - data_loader - ERROR - File not found: 20250813光模块分析.xlsx (status=1)
2025-10-18 18:45:45,830 - data_loader - ERROR - Initialization failed: Traceback (most recent call last):
  File "D:\Code\KC-SQLAgent-Visualization-v1.8\backend\data_loader.py", line 43, in __init__
    raise FileNotFoundError(f"Excel file not found: {file_path}")
FileNotFoundError: Excel file not found: 20250813光模块分析.xlsx

2025-10-18 18:46:09,971 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 18:46:09,971 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 18:46:09,972 - __main__ - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001BDCE920D70>
2025-10-18 18:46:09,972 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 18:46:10,104 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,104 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "previousDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 18:46:10,104 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,105 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 18:46:10,107 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,107 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "remainingTimeMS": 4999}
2025-10-18 18:46:10,140 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 18:46:10,153 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "driverConnectionId": 1, "serverConnectionId": 45599, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 12.545599980512634, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T10:46:04.535Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45599, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 18:46:10,154 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,154 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "previousDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>"}
2025-10-18 18:46:10,155 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,155 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "driverConnectionId": 1, "serverConnectionId": 45599, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 18:46:10,156 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,157 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,211 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04150099999969825}
2025-10-18 18:46:10,211 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05529899999964982}
2025-10-18 18:46:10,211 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,223 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 11.520000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,224 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,224 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 18:46:10,224 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 18:46:10.224777
2025-10-18 18:46:10,225 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,225 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,226 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,226 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003491000097710639}
2025-10-18 18:46:10,226 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:46:10.224Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,247 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 20.953, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,248 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,249 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,249 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,249 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,250 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002995999820996076}
2025-10-18 18:46:10,250 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T18:46:10.224Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,355 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 105.42500000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,357 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,357 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BDCEBEF240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}}
2025-10-18 18:46:10,358 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BDCEBEF240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f36ff2e4611c9a4d54e233, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.012545599980512634>]>", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,358 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,359 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002924000145867467}
2025-10-18 18:46:10,359 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "command": "{\"getMore\": 1016983114054841584, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"dqgf/ew1R8mzPW5CSxBxCg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,713 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "durationMS": 353.71599999999995, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45601, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 18:46:10,714 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 18:46:10,714 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 18:46:10,732 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 18:46:10,735 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 18:46:10,735 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 18:46:10,735 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 18:46:10,736 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:46:10,738 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:46:10,738 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:46:10,738 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:46:10,739 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:46:10,739 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:46:10,739 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:46:10,740 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:46:10,740 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:46:10,740 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:46:10,741 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:46:10,741 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:46:10,741 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:46:10,742 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:46:10,742 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:46:10,742 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:46:10,768 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 18:46:10,769 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 18:46:10,770 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 18:46:10,771 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 18:46:10,772 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 18:46:10,772 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 18:46:10,780 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 18:46:10,793 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 18:46:11,177 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f36ff2e4611c9a4d54e233"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1021.627800015267, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 20:51:07,783 - backend.data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 20:51:07,785 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 20:51:07,803 - __main__ - DEBUG - Processing data source: <backend.data_loader.OpticalFailureDataSourceLoader object at 0x000001B7D5390D70>
2025-10-18 20:51:07,804 - backend.data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 20:51:09,738 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:09,740 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "previousDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 20:51:09,741 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,743 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 20:51:09,749 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:09,750 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "remainingTimeMS": 4998}
2025-10-18 20:51:09,814 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 20:51:09,883 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "driverConnectionId": 1, "serverConnectionId": 45657, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 67.90339999133721, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T12:51:03.137Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45657, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 20:51:09,885 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,886 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "previousDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>"}
2025-10-18 20:51:09,888 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,890 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "driverConnectionId": 1, "serverConnectionId": 45657, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 20:51:09,891 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:09,894 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:10,153 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.18449169999803416}
2025-10-18 20:51:10,154 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.2632819999998901}
2025-10-18 20:51:10,155 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,172 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 16.297, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,173 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:10,174 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 20:51:10,175 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 20:51:10.175718
2025-10-18 20:51:10,176 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:10,178 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,179 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,180 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001136499980930239}
2025-10-18 20:51:10,181 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T20:51:10.175Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,216 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 34.303, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,217 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:10,219 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:10,221 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,223 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,224 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001370599988149479}
2025-10-18 20:51:10,226 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T20:51:10.175Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:10,751 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 20:51:12,003 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.17179929997655563}
2025-10-18 20:51:12,005 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 20:51:12,128 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 1902.836, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,146 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:12,147 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001B7D565F240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}}
2025-10-18 20:51:12,149 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001B7D565F240>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f38d3d91cc6588faba488a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.06790339999133721>]>", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,151 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,154 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002653700008522719}
2025-10-18 20:51:12,156 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "command": "{\"getMore\": 2692390928945327481, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YgT9aqbhQO24cY3ypy3DMA==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:12,179 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.07488989998819306}
2025-10-18 20:51:12,181 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 20:51:12,241 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.03705030001583509}
2025-10-18 20:51:12,243 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 20:51:12,315 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.04948440002044663}
2025-10-18 20:51:13,274 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "durationMS": 1117.79, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45658, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 20:51:13,275 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 20:51:13,276 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 20:51:13,314 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 20:51:13,321 - backend.data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 20:51:13,322 - backend.data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 20:51:13,323 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 20:51:13,323 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 20:51:13,329 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 20:51:13,330 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 20:51:13,331 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 20:51:13,332 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 20:51:13,332 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 20:51:13,333 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 20:51:13,334 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 20:51:13,337 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 20:51:13,338 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 20:51:13,339 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 20:51:13,340 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 20:51:13,341 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 20:51:13,342 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 20:51:13,345 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 20:51:13,346 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 20:51:13,346 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 20:51:13,424 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 20:51:13,426 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 20:51:13,427 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 20:51:13,428 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 20:51:13,428 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 20:51:13,429 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 20:51:13,429 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 20:51:13,430 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 20:51:13,430 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 20:51:13,431 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 20:51:13,431 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 20:51:13,431 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 20:51:13,432 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 20:51:13,432 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 20:51:13,433 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 20:51:13,433 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 20:51:13,434 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 20:51:13,434 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 20:51:13,459 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 20:51:13,484 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-18 20:51:13,974 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f38d3d91cc6588faba488a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 4084.5706000109203, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 23:29:25,751 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-18 23:29:25,754 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-18 23:29:25,754 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-18 23:29:25,755 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000029EDFD1CD70>
2025-10-18 23:29:25,755 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-18 23:29:26,729 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,731 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "previousDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-18 23:29:26,731 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,732 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-18 23:29:26,734 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,735 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "remainingTimeMS": 4999}
2025-10-18 23:29:26,755 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-18 23:29:26,766 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.130799986654893, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T15:29:20.547Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45727, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 23:29:26,766 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,767 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "previousDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>"}
2025-10-18 23:29:26,767 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,768 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 23:29:26,768 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,768 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,820 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.042580600013025105}
2025-10-18 23:29:26,821 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05297920000157319}
2025-10-18 23:29:26,821 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,831 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 9.530000000000001, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,831 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,832 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-18 23:29:26,832 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-20 00:00:00 至 2025-10-18 23:29:26.832438
2025-10-18 23:29:26,833 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,833 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,833 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,834 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003060000017285347}
2025-10-18 23:29:26,834 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T23:29:26.832Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,854 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 20.119, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,855 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,855 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,856 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,856 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,856 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00022620000527240336}
2025-10-18 23:29:26,856 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-20T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-18T23:29:26.832Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,955 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 98.15599999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,961 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:26,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000029EDFFEF4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}}
2025-10-18 23:29:26,962 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000029EDFFEF4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3b2564227d7dea4e63962, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010130799986654893>]>", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,963 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:26,963 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003330000035930425}
2025-10-18 23:29:26,964 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "command": "{\"getMore\": 7859898831059463066, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+NvBPhsbQ1aE+eP8O7L4+A==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:27,432 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "durationMS": 468.474, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45728, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-18 23:29:27,433 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-18 23:29:27,434 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-18 23:29:27,448 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-18 23:29:27,451 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-18 23:29:27,452 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-18 23:29:27,452 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-18 23:29:27,452 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 23:29:27,454 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 23:29:27,455 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 23:29:27,455 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 23:29:27,456 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:29:27,457 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 23:29:27,458 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 23:29:27,493 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-18 23:29:27,493 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:29:27,494 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-18 23:29:27,495 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-18 23:29:27,504 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-18 23:29:27,505 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x0000029EDFD1CEC0>
2025-10-18 23:29:27,505 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-18 23:29:27,507 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-18 23:29:27,735 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-18 23:29:27,773 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02563050002208911}
2025-10-18 23:29:27,774 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-18 23:29:27,820 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.03643979999469593}
2025-10-18 23:29:27,821 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-18 23:29:27,878 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.023953800002345815}
2025-10-18 23:29:27,879 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-18 23:29:27,912 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02104029999463819}
2025-10-18 23:29:28,477 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:28,526 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-18 23:29:28,527 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-18 23:29:29,623 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:29,667 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-18 23:29:29,667 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-18 23:29:30,627 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:30,744 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-18 23:29:30,744 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-18 23:29:31,771 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:31,912 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-18 23:29:31,913 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-18 23:29:32,912 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:32,997 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-18 23:29:32,997 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-18 23:29:33,978 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:34,042 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-18 23:29:34,042 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-18 23:29:35,077 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:35,116 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-18 23:29:35,117 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-18 23:29:36,121 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:36,196 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-18 23:29:36,197 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-18 23:29:36,780 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10011.663399985991, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T15:29:30.559Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45727, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 23:29:36,782 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 23:29:37,097 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:37,141 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-18 23:29:37,142 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-18 23:29:38,125 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:38,167 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-18 23:29:38,167 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-18 23:29:39,120 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:39,164 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-18 23:29:39,164 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-18 23:29:40,045 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:40,088 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-18 23:29:40,088 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-18 23:29:41,037 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:41,085 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-18 23:29:41,085 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-18 23:29:42,084 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:42,128 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-18 23:29:42,138 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-18 23:29:43,035 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:43,086 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-18 23:29:43,086 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-18 23:29:43,971 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:44,028 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-18 23:29:44,030 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-18 23:29:44,949 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:44,995 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-18 23:29:44,995 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-18 23:29:45,900 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:45,943 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-18 23:29:45,943 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-18 23:29:46,790 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10006.146399973659, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T15:29:40.570Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45727, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-18 23:29:46,791 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "driverConnectionId": 1, "serverConnectionId": 45727, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-18 23:29:46,913 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:29:46,955 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-18 23:29:46,956 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-18 23:29:47,838 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-18 23:29:48,317 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3b2564227d7dea4e63962"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 1525.8389999798965, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-18 23:32:09,854 - backend.data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-18 23:32:09,854 - backend.data_loader - DEBUG - Loading optical module inventory data from API
2025-10-18 23:32:09,862 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-18 23:32:10,953 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:10,997 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-18 23:32:10,999 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-18 23:32:11,979 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:12,029 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-18 23:32:12,030 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-18 23:32:13,001 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:13,059 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-18 23:32:13,060 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-18 23:32:14,115 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:14,159 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-18 23:32:14,160 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-18 23:32:15,101 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:15,145 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-18 23:32:15,146 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-18 23:32:16,195 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:16,296 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-18 23:32:16,297 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-18 23:32:17,284 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:17,331 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-18 23:32:17,332 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-18 23:32:18,267 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:18,317 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-18 23:32:18,318 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-18 23:32:19,259 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:19,305 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-18 23:32:19,305 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-18 23:32:20,286 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:20,327 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-18 23:32:20,328 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-18 23:32:21,238 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:21,289 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-18 23:32:21,290 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-18 23:32:22,257 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:22,300 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-18 23:32:22,300 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-18 23:32:23,241 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:23,297 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-18 23:32:23,299 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-18 23:32:24,309 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:24,441 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-18 23:32:24,441 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-18 23:32:25,330 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:25,376 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-18 23:32:25,376 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-18 23:32:26,320 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:26,369 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-18 23:32:26,369 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-18 23:32:27,329 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:27,372 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-18 23:32:27,372 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-18 23:32:28,275 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:28,320 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-18 23:32:28,320 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-18 23:32:29,210 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:29,251 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-18 23:32:29,252 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-18 23:32:30,173 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:30,219 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-18 23:32:30,220 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-18 23:32:31,155 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:31,200 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-18 23:32:31,200 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-18 23:32:32,053 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:32,092 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-18 23:32:32,093 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-18 23:32:32,974 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:33,021 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-18 23:32:33,021 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-18 23:32:33,915 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:33,959 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-18 23:32:33,960 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-18 23:32:34,773 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:34,813 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-18 23:32:34,813 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-18 23:32:35,668 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:35,711 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-18 23:32:35,711 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-18 23:32:36,550 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:36,594 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-18 23:32:36,595 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-18 23:32:37,477 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:37,519 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-18 23:32:37,519 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-18 23:32:38,341 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:38,400 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-18 23:32:38,401 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-18 23:32:39,217 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:39,267 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-18 23:32:39,267 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-18 23:32:40,108 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:40,147 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-18 23:32:40,147 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-18 23:32:40,973 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:41,012 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-18 23:32:41,012 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-18 23:32:41,808 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:41,853 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-18 23:32:41,854 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-18 23:32:42,707 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:42,745 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-18 23:32:42,746 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-18 23:32:43,577 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:43,618 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-18 23:32:43,619 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-18 23:32:44,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:44,422 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-18 23:32:44,423 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-18 23:32:45,201 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:45,242 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-18 23:32:45,243 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-18 23:32:46,062 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:46,109 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-18 23:32:46,110 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-18 23:32:46,891 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:46,932 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-18 23:32:46,933 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-18 23:32:47,718 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:47,768 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-18 23:32:47,769 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-18 23:32:48,623 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:48,669 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-18 23:32:48,670 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-18 23:32:49,496 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:49,549 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-18 23:32:49,550 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-18 23:32:50,383 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:50,432 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-18 23:32:50,432 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-18 23:32:51,269 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:51,318 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-18 23:32:51,318 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-18 23:32:52,103 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:52,156 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-18 23:32:52,157 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-18 23:32:52,941 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:52,987 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-18 23:32:52,988 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-18 23:32:53,731 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:53,773 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-18 23:32:53,774 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-18 23:32:54,302 - backend.data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-18 23:32:54,303 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_optical_module.db
2025-10-18 23:32:54,305 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalModuleInventoryDataSourceLoader object at 0x000001910A2F4D70>
2025-10-18 23:32:54,305 - backend.data_loader - DEBUG - Loading optical module inventory data from API
2025-10-18 23:32:54,313 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-18 23:32:54,559 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:54,599 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-18 23:32:54,599 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-18 23:32:55,596 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:55,599 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:55,661 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-18 23:32:55,665 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-18 23:32:55,669 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-18 23:32:55,669 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-18 23:32:56,627 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:56,672 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-18 23:32:56,673 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-18 23:32:57,071 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:57,115 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-18 23:32:57,115 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-18 23:32:57,534 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:57,576 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-18 23:32:57,576 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-18 23:32:58,311 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:58,359 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-18 23:32:58,359 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-18 23:32:58,477 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:58,526 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-18 23:32:58,528 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-18 23:32:59,413 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:59,452 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-18 23:32:59,453 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-18 23:32:59,543 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:32:59,584 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-18 23:32:59,585 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-18 23:33:00,253 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:00,301 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-18 23:33:00,309 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-18 23:33:00,816 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:00,899 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-18 23:33:00,899 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-18 23:33:01,174 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:01,231 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-18 23:33:01,232 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-18 23:33:01,997 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:02,041 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:02,044 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-18 23:33:02,045 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-18 23:33:02,174 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-18 23:33:02,198 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-18 23:33:02,970 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:03,014 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-18 23:33:03,015 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-18 23:33:03,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:03,544 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-18 23:33:03,545 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-18 23:33:03,777 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:03,816 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-18 23:33:03,817 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-18 23:33:04,572 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:04,615 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-18 23:33:04,616 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-18 23:33:04,676 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:04,721 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-18 23:33:04,722 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-18 23:33:05,388 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:05,446 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-18 23:33:05,447 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-18 23:33:05,952 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:05,997 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-18 23:33:05,997 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-18 23:33:06,210 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:06,258 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-18 23:33:06,259 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-18 23:33:07,002 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:07,041 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-18 23:33:07,042 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-18 23:33:07,092 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:07,130 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-18 23:33:07,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-18 23:33:07,804 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:07,848 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-18 23:33:07,849 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-18 23:33:08,289 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:08,332 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-18 23:33:08,333 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-18 23:33:08,533 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:08,572 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-18 23:33:08,572 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-18 23:33:09,374 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:09,416 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-18 23:33:09,416 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-18 23:33:09,540 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:09,582 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-18 23:33:09,583 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-18 23:33:10,056 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:10,124 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-18 23:33:10,125 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-18 23:33:10,690 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:10,735 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-18 23:33:10,735 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-18 23:33:10,872 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:10,916 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-18 23:33:10,917 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-18 23:33:11,504 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:11,543 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-18 23:33:11,545 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-18 23:33:11,801 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:11,848 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-18 23:33:11,849 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-18 23:33:12,196 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:12,230 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-18 23:33:12,230 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-18 23:33:12,858 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:12,895 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-18 23:33:12,895 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-18 23:33:13,005 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:13,058 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-18 23:33:13,058 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-18 23:33:13,434 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:13,468 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-18 23:33:13,469 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-18 23:33:14,000 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:14,037 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-18 23:33:14,037 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-18 23:33:14,042 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:14,083 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-18 23:33:14,083 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-18 23:33:14,622 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:14,652 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-18 23:33:14,652 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-18 23:33:15,253 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:15,270 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:15,295 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-18 23:33:15,295 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-18 23:33:15,306 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-18 23:33:15,307 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-18 23:33:15,929 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:15,962 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-18 23:33:15,962 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-18 23:33:16,454 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:16,476 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:16,501 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-18 23:33:16,502 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-18 23:33:16,512 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-18 23:33:16,513 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-18 23:33:17,085 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:17,119 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-18 23:33:17,119 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-18 23:33:17,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:17,615 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:17,697 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-18 23:33:17,698 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-18 23:33:17,702 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-18 23:33:17,702 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-18 23:33:18,188 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:18,224 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-18 23:33:18,224 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-18 23:33:18,738 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:18,752 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:18,794 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-18 23:33:18,794 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-18 23:33:18,828 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-18 23:33:18,829 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-18 23:33:19,268 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:19,302 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-18 23:33:19,302 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-18 23:33:19,773 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:19,814 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-18 23:33:19,815 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-18 23:33:19,876 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:19,920 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-18 23:33:19,921 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-18 23:33:20,213 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:20,241 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-18 23:33:20,242 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-18 23:33:20,645 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:20,678 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-18 23:33:20,679 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-18 23:33:20,951 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:20,998 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-18 23:33:20,998 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-18 23:33:21,011 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:21,043 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-18 23:33:21,043 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-18 23:33:21,444 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:21,472 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-18 23:33:21,473 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-18 23:33:21,859 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:21,893 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-18 23:33:21,893 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-18 23:33:22,110 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,159 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-18 23:33:22,160 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-18 23:33:22,243 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,270 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-18 23:33:22,271 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-18 23:33:22,591 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,619 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-18 23:33:22,619 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-18 23:33:22,946 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:22,974 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-18 23:33:22,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-18 23:33:23,237 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:23,282 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:23,284 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-18 23:33:23,284 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-18 23:33:23,308 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-18 23:33:23,308 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-18 23:33:23,551 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:23,581 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-18 23:33:23,582 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-18 23:33:23,852 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,008 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-18 23:33:24,008 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-18 23:33:24,303 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,305 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,327 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-18 23:33:24,328 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-18 23:33:24,379 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-18 23:33:24,380 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-18 23:33:24,560 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,582 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-18 23:33:24,582 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-18 23:33:24,773 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:24,798 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-18 23:33:24,798 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-18 23:33:24,989 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,007 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-18 23:33:25,008 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-18 23:33:25,200 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,225 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-18 23:33:25,225 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-18 23:33:25,348 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,379 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,400 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-18 23:33:25,400 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-18 23:33:25,400 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-18 23:33:25,401 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-18 23:33:25,581 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,605 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-18 23:33:25,605 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-18 23:33:25,764 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,783 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-18 23:33:25,783 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-18 23:33:25,912 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:25,930 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-18 23:33:25,931 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-18 23:33:26,018 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,040 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-18 23:33:26,044 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-18 23:33:26,112 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,124 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-18 23:33:26,125 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-18 23:33:26,175 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,183 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-18 23:33:26,184 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-18 23:33:26,231 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-18 23:33:26,232 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-18 23:33:26,235 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-18 23:33:26,236 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-18 23:33:26,238 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-18 23:33:26,238 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-18 23:33:26,240 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-18 23:33:26,241 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-18 23:33:26,245 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-18 23:33:26,247 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-18 23:33:26,248 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-18 23:33:26,251 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-18 23:33:26,252 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-18 23:33:26,254 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-18 23:33:26,255 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-18 23:33:26,255 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-18 23:33:26,256 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-18 23:33:26,257 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-18 23:33:26,257 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-18 23:33:26,258 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-18 23:33:26,259 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-18 23:33:26,259 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-18 23:33:26,259 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-18 23:33:26,261 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-18 23:33:26,261 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-18 23:33:26,262 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-18 23:33:26,262 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-18 23:33:26,262 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-18 23:33:26,263 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-18 23:33:26,263 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-18 23:33:26,264 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-18 23:33:26,264 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-18 23:33:26,265 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-18 23:33:26,265 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-18 23:33:26,267 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-18 23:33:26,268 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-18 23:33:26,268 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-18 23:33:26,269 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-18 23:33:26,269 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-18 23:33:26,270 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-18 23:33:26,270 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-18 23:33:26,271 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-18 23:33:26,272 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-18 23:33:26,273 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-18 23:33:26,274 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-18 23:33:26,274 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-18 23:33:26,275 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-18 23:33:26,276 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-18 23:33:26,276 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-18 23:33:26,278 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-18 23:33:26,279 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-18 23:33:26,279 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-18 23:33:26,280 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-18 23:33:26,280 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-18 23:33:26,281 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-18 23:33:26,281 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-18 23:33:26,282 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-18 23:33:26,285 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-18 23:33:26,286 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-18 23:33:26,286 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-18 23:33:26,287 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-18 23:33:26,287 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-18 23:33:26,288 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-18 23:33:26,289 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-18 23:33:26,291 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-18 23:33:26,293 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-18 23:33:26,293 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-18 23:33:26,294 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-18 23:33:26,295 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-18 23:33:26,295 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-18 23:33:26,296 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-18 23:33:26,297 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-18 23:33:26,297 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-18 23:33:26,301 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-18 23:33:26,302 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-18 23:33:26,303 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-18 23:33:26,305 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-18 23:33:26,306 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-18 23:33:26,307 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-18 23:33:26,308 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-18 23:33:26,308 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-18 23:33:26,309 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-18 23:33:26,309 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-18 23:33:26,310 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-18 23:33:26,312 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-18 23:33:26,314 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-18 23:33:26,317 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-18 23:33:26,360 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:26,370 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-18 23:33:26,373 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-18 23:33:26,374 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-18 23:33:26,375 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-18 23:33:26,375 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-18 23:33:26,376 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-18 23:33:26,376 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-18 23:33:26,377 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-18 23:33:26,378 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-18 23:33:26,378 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-18 23:33:26,379 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-18 23:33:26,379 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-18 23:33:26,380 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-18 23:33:26,381 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-18 23:33:26,387 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-18 23:33:26,387 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-18 23:33:26,389 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-18 23:33:26,390 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-18 23:33:26,391 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-18 23:33:26,392 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-18 23:33:26,393 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-18 23:33:26,393 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-18 23:33:26,411 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-18 23:33:26,415 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-18 23:33:26,446 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-18 23:33:26,447 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-18 23:33:27,319 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:27,381 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-18 23:33:27,384 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-18 23:33:28,245 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:28,292 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-18 23:33:28,293 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-18 23:33:28,568 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1642 条记录
2025-10-18 23:33:28,606 - backend.data_loader - DEBUG - Loaded 1642 records from API
2025-10-18 23:33:28,606 - backend.data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-18 23:33:29,095 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:29,145 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-18 23:33:29,152 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-18 23:33:30,091 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:30,139 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-18 23:33:30,140 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-18 23:33:30,972 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:31,017 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-18 23:33:31,018 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-18 23:33:31,802 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:31,848 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-18 23:33:31,849 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-18 23:33:32,781 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:32,822 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-18 23:33:32,822 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-18 23:33:33,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:33,652 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-18 23:33:33,653 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-18 23:33:34,482 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:34,539 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-18 23:33:34,540 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-18 23:33:35,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:35,434 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-18 23:33:35,435 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-18 23:33:36,208 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:36,254 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-18 23:33:36,255 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-18 23:33:37,072 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:37,126 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-18 23:33:37,126 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-18 23:33:37,999 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:38,060 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-18 23:33:38,060 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-18 23:33:38,879 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:38,924 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-18 23:33:38,925 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-18 23:33:39,705 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:39,748 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-18 23:33:39,748 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-18 23:33:40,544 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:40,585 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-18 23:33:40,586 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-18 23:33:41,423 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:41,463 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-18 23:33:41,463 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-18 23:33:42,254 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:42,293 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-18 23:33:42,294 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-18 23:33:43,046 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:43,087 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-18 23:33:43,088 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-18 23:33:43,885 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:43,926 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-18 23:33:43,927 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-18 23:33:44,688 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:44,733 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-18 23:33:44,734 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-18 23:33:45,501 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:45,540 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-18 23:33:45,541 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-18 23:33:46,250 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:46,293 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-18 23:33:46,294 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-18 23:33:47,011 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:47,048 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-18 23:33:47,049 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-18 23:33:47,821 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:47,863 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-18 23:33:47,863 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-18 23:33:48,546 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:48,588 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-18 23:33:48,588 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-18 23:33:49,254 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:49,297 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-18 23:33:49,297 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-18 23:33:50,011 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:50,056 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-18 23:33:50,057 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-18 23:33:50,796 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:50,836 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-18 23:33:50,836 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-18 23:33:51,552 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:51,592 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-18 23:33:51,593 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-18 23:33:52,255 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:52,302 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-18 23:33:52,303 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-18 23:33:52,922 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:52,962 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-18 23:33:52,962 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-18 23:33:53,596 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:53,647 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-18 23:33:53,648 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-18 23:33:54,286 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:54,325 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-18 23:33:54,325 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-18 23:33:54,917 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:54,957 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-18 23:33:54,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-18 23:33:55,535 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:55,574 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-18 23:33:55,575 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-18 23:33:56,142 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:56,180 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-18 23:33:56,181 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-18 23:33:56,783 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:56,821 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-18 23:33:56,822 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-18 23:33:57,422 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:57,470 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-18 23:33:57,470 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-18 23:33:58,021 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:58,068 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-18 23:33:58,068 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-18 23:33:58,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:58,748 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-18 23:33:58,759 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-18 23:33:59,282 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:59,316 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-18 23:33:59,316 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-18 23:33:59,869 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:33:59,912 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-18 23:33:59,912 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-18 23:34:00,431 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:00,471 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-18 23:34:00,471 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-18 23:34:00,964 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:01,009 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-18 23:34:01,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-18 23:34:01,509 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:01,549 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-18 23:34:01,550 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-18 23:34:02,006 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:02,045 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-18 23:34:02,045 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-18 23:34:02,539 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:02,623 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-18 23:34:02,623 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-18 23:34:03,074 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:03,120 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-18 23:34:03,121 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-18 23:34:03,564 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:03,601 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-18 23:34:03,601 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-18 23:34:04,094 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:04,130 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-18 23:34:04,130 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-18 23:34:04,541 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:04,569 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-18 23:34:04,570 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-18 23:34:04,996 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:05,028 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-18 23:34:05,029 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-18 23:34:05,409 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:05,434 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-18 23:34:05,435 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-18 23:34:05,798 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:05,845 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-18 23:34:05,846 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-18 23:34:06,193 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:06,221 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-18 23:34:06,221 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-18 23:34:06,532 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:06,562 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-18 23:34:06,563 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-18 23:34:06,864 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:06,890 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-18 23:34:06,890 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-18 23:34:07,185 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:07,224 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-18 23:34:07,225 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-18 23:34:07,507 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:07,542 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-18 23:34:07,543 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-18 23:34:07,833 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:07,870 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-18 23:34:07,871 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-18 23:34:08,140 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,172 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-18 23:34:08,173 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-18 23:34:08,423 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,452 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-18 23:34:08,453 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-18 23:34:08,683 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,718 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-18 23:34:08,719 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-18 23:34:08,957 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:08,987 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-18 23:34:08,987 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-18 23:34:09,200 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,228 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-18 23:34:09,229 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-18 23:34:09,426 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,456 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-18 23:34:09,457 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-18 23:34:09,662 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,692 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-18 23:34:09,692 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-18 23:34:09,869 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:09,890 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-18 23:34:09,891 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-18 23:34:10,054 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,071 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-18 23:34:10,072 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-18 23:34:10,228 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,248 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-18 23:34:10,248 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-18 23:34:10,395 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,423 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-18 23:34:10,424 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-18 23:34:10,565 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,581 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-18 23:34:10,582 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-18 23:34:10,725 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,748 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-18 23:34:10,749 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-18 23:34:10,872 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:10,895 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-18 23:34:10,896 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-18 23:34:10,975 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:11,006 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-18 23:34:11,007 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-18 23:34:11,067 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:11,093 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-18 23:34:11,094 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-18 23:34:11,147 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-18 23:34:11,153 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-18 23:34:11,153 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-18 23:34:11,194 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-18 23:34:11,194 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-18 23:34:11,195 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-18 23:34:11,195 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-18 23:34:11,195 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-18 23:34:11,196 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-18 23:34:11,196 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-18 23:34:11,196 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-18 23:34:11,197 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-18 23:34:11,197 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-18 23:34:11,197 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-18 23:34:11,198 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-18 23:34:11,198 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-18 23:34:11,198 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-18 23:34:11,199 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-18 23:34:11,199 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-18 23:34:11,199 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-18 23:34:11,200 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-18 23:34:11,201 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-18 23:34:11,201 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-18 23:34:11,202 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-18 23:34:11,203 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-18 23:34:11,203 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-18 23:34:11,203 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-18 23:34:11,204 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-18 23:34:11,204 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-18 23:34:11,204 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-18 23:34:11,205 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-18 23:34:11,206 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-18 23:34:11,207 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-18 23:34:11,208 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-18 23:34:11,209 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-18 23:34:11,210 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-18 23:34:11,211 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-18 23:34:11,212 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-18 23:34:11,213 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-18 23:34:11,214 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-18 23:34:11,215 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-18 23:34:11,216 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-18 23:34:11,217 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-18 23:34:11,218 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-18 23:34:11,219 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-18 23:34:11,219 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-18 23:34:11,713 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1642 条记录
2025-10-18 23:34:11,727 - backend.data_loader - DEBUG - Loaded 1642 records from API
2025-10-18 23:34:11,727 - backend.data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-18 23:34:11,727 - backend.database_builder - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-18 23:34:11,728 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-18 23:34:11,730 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:34:11,730 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:34:11,731 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:34:11,731 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:34:11,731 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:34:11,732 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-18 23:34:11,756 - backend.database_builder - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-18 23:34:11,757 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-18 23:34:11,758 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-18 23:34:11,758 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-18 23:34:11,764 - backend.database_builder - INFO - Inserted 1642 records into table 光模块在线总数量统计表
2025-10-18 23:34:11,776 - backend.database_builder - INFO - Database built/updated at test_optical_module.db (rebuild=True, status=0)
2025-10-19 00:03:28,464 - backend.data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 00:03:28,465 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 00:03:28,467 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.OpticalModuleInventoryDataSourceLoader object at 0x00000263D530CD70>
2025-10-19 00:03:28,467 - backend.data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 00:03:28,506 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 00:03:29,690 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:29,737 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 00:03:29,741 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 00:03:30,789 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:30,835 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 00:03:30,835 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 00:03:31,891 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:31,934 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 00:03:31,934 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 00:03:32,985 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:33,040 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 00:03:33,041 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 00:03:34,098 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:34,159 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 00:03:34,160 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 00:03:35,198 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:35,252 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 00:03:35,252 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 00:03:36,234 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:36,280 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 00:03:36,281 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 00:03:37,207 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:37,257 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 00:03:37,258 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 00:03:38,255 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:38,297 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 00:03:38,297 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 00:03:39,289 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:39,336 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 00:03:39,337 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 00:03:40,322 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:40,370 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 00:03:40,372 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 00:03:41,340 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:41,430 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 00:03:41,431 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 00:03:42,499 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:42,555 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 00:03:42,555 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 00:03:43,513 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:43,568 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 00:03:43,569 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 00:03:44,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:44,551 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 00:03:44,553 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 00:03:45,524 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:45,572 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 00:03:45,573 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 00:03:46,533 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:46,576 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 00:03:46,577 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 00:03:47,485 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:47,525 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 00:03:47,526 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 00:03:48,422 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:48,489 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 00:03:48,490 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 00:03:49,412 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:49,461 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 00:03:49,462 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 00:03:50,404 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:50,465 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 00:03:50,466 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 00:03:51,343 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:51,392 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 00:03:51,392 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 00:03:52,297 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:52,333 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 00:03:52,334 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 00:03:53,167 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:53,208 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 00:03:53,210 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 00:03:54,045 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:54,090 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 00:03:54,091 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 00:03:54,916 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:54,962 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 00:03:54,963 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 00:03:55,792 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:55,849 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 00:03:55,850 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 00:03:56,681 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:56,738 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 00:03:56,740 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 00:03:57,558 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:57,600 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 00:03:57,601 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 00:03:58,413 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:58,467 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 00:03:58,468 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 00:03:59,290 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:03:59,344 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 00:03:59,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 00:04:00,156 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:00,205 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 00:04:00,205 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 00:04:01,006 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:01,064 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 00:04:01,065 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 00:04:01,855 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:01,899 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 00:04:01,900 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 00:04:02,673 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:02,725 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 00:04:02,726 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 00:04:03,517 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:03,558 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 00:04:03,558 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 00:04:04,322 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:04,369 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 00:04:04,370 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 00:04:05,142 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:05,207 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 00:04:05,208 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 00:04:05,995 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:06,048 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 00:04:06,049 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 00:04:06,811 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:06,854 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 00:04:06,855 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 00:04:07,624 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:07,671 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 00:04:07,671 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 00:04:08,421 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:08,468 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 00:04:08,468 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 00:04:09,298 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:09,343 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 00:04:09,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 00:04:10,077 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:10,124 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 00:04:10,125 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 00:04:10,972 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:11,020 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 00:04:11,021 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 00:04:11,764 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:11,813 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 00:04:11,814 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 00:04:12,537 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:12,595 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 00:04:12,595 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 00:04:13,311 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:13,364 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 00:04:13,364 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 00:04:14,083 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:14,145 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 00:04:14,146 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 00:04:14,906 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:14,964 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 00:04:14,965 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 00:04:15,716 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:15,796 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 00:04:15,797 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 00:04:16,485 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:16,548 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-19 00:04:16,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-19 00:04:17,240 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:17,323 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-19 00:04:17,325 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-19 00:04:17,998 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:18,048 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-19 00:04:18,049 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-19 00:04:18,758 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:18,802 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-19 00:04:18,803 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-19 00:04:19,467 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:19,575 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-19 00:04:19,576 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-19 00:04:20,232 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:20,276 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-19 00:04:20,278 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-19 00:04:20,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:20,974 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-19 00:04:20,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-19 00:04:21,629 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:21,724 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-19 00:04:21,724 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-19 00:04:22,369 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:22,414 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-19 00:04:22,414 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-19 00:04:23,079 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:23,118 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-19 00:04:23,119 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-19 00:04:23,738 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:23,771 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-19 00:04:23,772 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-19 00:04:24,472 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:24,524 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-19 00:04:24,529 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-19 00:04:25,137 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:25,184 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-19 00:04:25,184 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-19 00:04:25,836 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:25,887 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-19 00:04:25,888 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-19 00:04:26,450 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:26,560 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-19 00:04:26,560 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-19 00:04:27,171 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:27,214 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-19 00:04:27,215 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-19 00:04:27,805 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:27,853 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-19 00:04:27,854 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-19 00:04:28,453 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:28,510 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-19 00:04:28,518 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-19 00:04:29,082 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:29,121 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-19 00:04:29,122 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-19 00:04:29,617 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:29,656 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-19 00:04:29,657 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-19 00:04:30,150 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:30,210 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-19 00:04:30,211 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-19 00:04:30,726 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:30,765 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-19 00:04:30,766 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-19 00:04:31,302 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:31,341 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-19 00:04:31,343 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-19 00:04:31,808 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:31,850 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-19 00:04:31,850 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-19 00:04:32,334 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:32,375 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-19 00:04:32,378 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-19 00:04:32,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:32,923 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-19 00:04:32,924 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-19 00:04:33,502 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:33,748 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-19 00:04:33,749 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-19 00:04:34,232 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:34,280 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-19 00:04:34,283 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-19 00:04:34,714 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:34,754 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-19 00:04:34,754 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-19 00:04:35,184 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:35,218 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-19 00:04:35,219 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-19 00:04:35,605 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:35,664 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-19 00:04:35,665 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-19 00:04:36,029 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:36,064 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-19 00:04:36,065 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-19 00:04:36,403 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:36,551 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-19 00:04:36,579 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-19 00:04:36,947 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:36,991 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-19 00:04:36,992 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-19 00:04:37,299 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:37,379 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-19 00:04:37,381 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-19 00:04:37,704 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:37,751 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-19 00:04:37,752 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-19 00:04:38,035 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:38,080 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-19 00:04:38,083 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-19 00:04:38,379 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:38,451 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-19 00:04:38,452 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-19 00:04:38,753 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:38,792 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-19 00:04:38,794 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-19 00:04:39,034 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,070 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-19 00:04:39,072 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-19 00:04:39,303 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,332 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-19 00:04:39,333 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-19 00:04:39,553 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,625 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-19 00:04:39,631 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-19 00:04:39,842 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:39,905 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-19 00:04:39,908 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-19 00:04:40,106 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,141 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-19 00:04:40,142 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-19 00:04:40,330 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,367 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-19 00:04:40,368 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-19 00:04:40,546 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,575 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-19 00:04:40,576 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-19 00:04:40,741 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,781 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-19 00:04:40,782 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-19 00:04:40,933 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:40,956 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-19 00:04:40,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-19 00:04:41,109 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,245 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-19 00:04:41,291 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-19 00:04:41,470 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,509 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-19 00:04:41,511 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-19 00:04:41,629 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,665 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-19 00:04:41,666 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-19 00:04:41,741 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,776 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-19 00:04:41,779 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-19 00:04:41,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,877 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-19 00:04:41,879 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-19 00:04:41,929 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:04:41,940 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-19 00:04:41,941 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-19 00:04:41,988 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-19 00:04:41,991 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-19 00:04:41,992 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-19 00:04:41,992 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-19 00:04:41,993 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-19 00:04:41,994 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-19 00:04:41,994 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-19 00:04:41,995 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-19 00:04:41,996 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-19 00:04:41,997 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-19 00:04:41,997 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-19 00:04:41,998 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-19 00:04:41,999 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-19 00:04:41,999 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-19 00:04:42,000 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-19 00:04:42,002 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-19 00:04:42,004 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-19 00:04:42,005 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-19 00:04:42,006 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-19 00:04:42,007 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-19 00:04:42,008 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-19 00:04:42,008 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-19 00:04:42,009 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-19 00:04:42,010 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-19 00:04:42,011 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-19 00:04:42,012 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-19 00:04:42,013 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-19 00:04:42,013 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-19 00:04:42,014 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-19 00:04:42,017 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-19 00:04:42,018 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-19 00:04:42,022 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-19 00:04:42,022 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-19 00:04:42,023 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-19 00:04:42,024 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-19 00:04:42,026 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-19 00:04:42,032 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-19 00:04:42,038 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-19 00:04:42,039 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-19 00:04:42,040 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-19 00:04:42,041 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-19 00:04:42,042 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-19 00:04:42,043 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-19 00:04:42,044 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-19 00:04:42,045 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-19 00:04:42,046 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-19 00:04:42,046 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-19 00:04:42,049 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-19 00:04:42,049 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-19 00:04:42,050 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-19 00:04:42,051 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-19 00:04:42,054 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-19 00:04:42,055 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-19 00:04:42,055 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-19 00:04:42,056 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-19 00:04:42,059 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-19 00:04:42,059 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-19 00:04:42,060 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-19 00:04:42,060 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-19 00:04:42,061 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-19 00:04:42,062 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-19 00:04:42,062 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-19 00:04:42,064 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-19 00:04:42,064 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-19 00:04:42,068 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-19 00:04:42,071 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-19 00:04:42,072 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-19 00:04:42,072 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-19 00:04:42,073 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-19 00:04:42,073 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-19 00:04:42,074 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-19 00:04:42,075 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-19 00:04:42,075 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-19 00:04:42,076 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-19 00:04:42,077 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-19 00:04:42,078 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-19 00:04:42,089 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-19 00:04:42,090 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-19 00:04:42,091 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-19 00:04:42,091 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-19 00:04:42,092 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-19 00:04:42,093 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-19 00:04:42,093 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-19 00:04:42,096 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-19 00:04:42,096 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-19 00:04:42,099 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-19 00:04:42,100 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-19 00:04:42,106 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-19 00:04:42,108 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-19 00:04:42,112 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-19 00:04:42,117 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-19 00:04:42,130 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-19 00:04:42,140 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-19 00:04:42,146 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-19 00:04:42,153 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-19 00:04:42,166 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-19 00:04:42,173 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-19 00:04:42,181 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-19 00:04:42,188 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-19 00:04:42,197 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-19 00:04:42,201 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-19 00:04:42,227 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-19 00:04:42,284 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-19 00:04:42,424 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-19 00:04:42,515 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-19 00:04:42,608 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-19 00:04:42,645 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-19 00:04:42,646 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-19 00:04:42,652 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-19 00:04:42,657 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-19 00:04:42,658 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 00:04:46,492 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1648 条记录
2025-10-19 00:04:46,571 - backend.data_loader - DEBUG - Loaded 1648 records from API
2025-10-19 00:04:46,573 - backend.data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 00:04:46,580 - backend.database_builder - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-19 00:04:46,585 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:04:46,603 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:04:46,609 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:04:46,611 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:04:46,613 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:04:46,617 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:04:46,619 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:04:46,691 - backend.database_builder - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-19 00:04:46,692 - backend.database_builder - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:04:46,693 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:04:46,695 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:04:46,697 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:04:46,702 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:04:46,707 - backend.database_builder - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:04:46,708 - backend.database_builder - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:04:46,756 - backend.database_builder - INFO - Inserted 1648 records into table 光模块在线总数量统计表
2025-10-19 00:04:46,807 - backend.database_builder - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 00:07:12,031 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 00:07:12,031 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 00:07:12,031 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 00:07:12,032 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x00000177FC47CD70>
2025-10-19 00:07:12,033 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 00:07:12,337 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,338 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "previousDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 00:07:12,338 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,338 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 00:07:12,340 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,341 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "remainingTimeMS": 4999}
2025-10-19 00:07:12,370 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 00:07:12,380 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.383800002979115, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:06.193Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:12,381 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,381 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "previousDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>"}
2025-10-19 00:07:12,382 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,382 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:12,382 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,383 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,439 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.047283400024753064}
2025-10-19 00:07:12,440 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.057959500001743436}
2025-10-19 00:07:12,441 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,455 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 14.248999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,456 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,457 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 00:07:12,458 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 00:07:12.458030
2025-10-19 00:07:12,458 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,459 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,460 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,460 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005603000172413886}
2025-10-19 00:07:12,461 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T00:07:12.458Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,483 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 22.113, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,484 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,485 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,485 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,485 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,486 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003588999970816076}
2025-10-19 00:07:12,486 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T00:07:12.458Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,557 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 70.551, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,560 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,560 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000177FC74F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}}
2025-10-19 00:07:12,561 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000177FC74F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3bb30ebeca5b53f588a41, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009383800002979115>]>", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,561 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,562 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0003215000033378601}
2025-10-19 00:07:12,562 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "command": "{\"getMore\": 8008865835941389949, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"goSzpoc9QA6wtIlsUfM1xg==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,876 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "durationMS": 314.072, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45750, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 00:07:12,877 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 00:07:12,878 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 00:07:12,896 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 00:07:12,899 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 00:07:12,899 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 00:07:12,909 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 00:07:12,910 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 00:07:12,914 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 00:07:12,914 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 00:07:12,915 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 00:07:12,915 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 00:07:12,915 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 00:07:12,916 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 00:07:12,916 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 00:07:12,916 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:07:12,917 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:07:12,917 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:07:12,917 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 00:07:12,918 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 00:07:12,919 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 00:07:12,948 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 00:07:12,949 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 00:07:12,950 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:07:12,951 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 00:07:12,952 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 00:07:12,952 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 00:07:12,952 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 00:07:12,961 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 00:07:12,961 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x00000177FC47CEC0>
2025-10-19 00:07:12,962 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 00:07:12,964 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 00:07:13,351 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 00:07:13,388 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.02651319999131374}
2025-10-19 00:07:13,395 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 00:07:13,434 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.020014100009575486}
2025-10-19 00:07:13,434 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 00:07:13,465 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.02138570000533946}
2025-10-19 00:07:13,466 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 00:07:13,495 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.02057939997757785}
2025-10-19 00:07:14,134 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:14,257 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 00:07:14,260 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 00:07:15,301 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:15,343 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 00:07:15,344 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 00:07:16,298 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:16,338 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 00:07:16,338 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 00:07:17,305 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:17,349 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 00:07:17,350 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 00:07:18,306 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:18,345 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 00:07:18,346 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 00:07:19,296 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:19,338 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 00:07:19,338 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 00:07:20,276 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:20,320 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 00:07:20,321 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 00:07:21,297 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:21,381 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 00:07:21,382 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 00:07:22,373 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:22,442 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10059.758199990029, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:16.209Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:22,443 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:22,455 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 00:07:22,456 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 00:07:23,418 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:23,459 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 00:07:23,460 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 00:07:24,375 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:24,494 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 00:07:24,494 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 00:07:25,402 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:25,449 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 00:07:25,450 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 00:07:26,352 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:26,390 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 00:07:26,391 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 00:07:27,286 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:27,332 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 00:07:27,332 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 00:07:28,227 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:28,273 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 00:07:28,274 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 00:07:29,206 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:29,246 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 00:07:29,246 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 00:07:30,154 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:30,194 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 00:07:30,194 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 00:07:31,057 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:31,096 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 00:07:31,096 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 00:07:31,959 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:31,999 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 00:07:31,999 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 00:07:32,406 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9962.505499977851, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:26.218Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:32,408 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:32,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:32,877 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 00:07:32,877 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 00:07:33,718 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:33,764 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 00:07:33,764 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 00:07:34,618 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:34,663 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 00:07:34,664 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 00:07:35,507 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:35,552 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 00:07:35,553 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 00:07:36,378 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:36,417 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 00:07:36,417 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 00:07:37,232 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:37,275 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 00:07:37,275 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 00:07:38,210 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:38,254 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 00:07:38,255 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 00:07:39,084 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:39,123 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 00:07:39,123 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 00:07:39,937 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:39,974 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 00:07:39,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 00:07:40,792 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:40,833 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 00:07:40,834 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 00:07:41,646 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:41,686 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 00:07:41,687 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 00:07:42,414 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10004.185300000245, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:36.226Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:42,415 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:42,505 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:42,549 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 00:07:42,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 00:07:43,359 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:43,400 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 00:07:43,401 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 00:07:44,202 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:44,244 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 00:07:44,244 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 00:07:45,036 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:45,126 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 00:07:45,130 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 00:07:45,925 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:45,967 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 00:07:45,968 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 00:07:46,763 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:46,804 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 00:07:46,805 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 00:07:47,591 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:47,630 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 00:07:47,630 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 00:07:48,404 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:48,442 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 00:07:48,443 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 00:07:49,218 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:49,264 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 00:07:49,264 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 00:07:50,037 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:50,075 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 00:07:50,075 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 00:07:50,839 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:50,892 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 00:07:50,893 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 00:07:51,655 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:51,697 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 00:07:51,697 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 00:07:52,425 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10009.212200006004, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:46.235Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:07:52,427 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:07:52,449 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:52,493 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 00:07:52,493 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 00:07:53,244 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:53,293 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 00:07:53,294 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 00:07:54,038 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:54,076 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 00:07:54,076 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 00:07:54,833 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:54,869 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 00:07:54,870 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 00:07:55,607 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:55,647 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 00:07:55,647 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 00:07:56,366 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:56,409 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 00:07:56,409 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 00:07:57,124 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:57,166 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 00:07:57,167 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 00:07:57,870 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:57,912 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 00:07:57,913 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 00:07:58,611 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:58,655 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 00:07:58,655 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 00:07:59,332 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:07:59,378 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-19 00:07:59,379 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-19 00:08:00,050 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:00,092 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-19 00:08:00,092 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-19 00:08:00,762 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:00,802 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-19 00:08:00,802 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-19 00:08:01,463 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:01,504 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-19 00:08:01,505 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-19 00:08:02,170 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:02,246 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-19 00:08:02,247 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-19 00:08:02,433 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10004.625500005204, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:07:56.245Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:08:02,434 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:08:02,909 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:02,958 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-19 00:08:02,958 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-19 00:08:03,577 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:03,607 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-19 00:08:03,607 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-19 00:08:04,328 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:04,367 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-19 00:08:04,368 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-19 00:08:04,969 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:05,000 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-19 00:08:05,000 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-19 00:08:05,601 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:05,639 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-19 00:08:05,640 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-19 00:08:06,238 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:06,279 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-19 00:08:06,280 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-19 00:08:06,933 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:06,975 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-19 00:08:06,975 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-19 00:08:07,602 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:07,638 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-19 00:08:07,638 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-19 00:08:08,310 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:08,362 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-19 00:08:08,363 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-19 00:08:08,925 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:08,957 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-19 00:08:08,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-19 00:08:09,550 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:09,584 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-19 00:08:09,585 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-19 00:08:10,150 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:10,185 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-19 00:08:10,185 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-19 00:08:10,753 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:10,787 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-19 00:08:10,787 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-19 00:08:11,322 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:11,354 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-19 00:08:11,354 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-19 00:08:11,884 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:11,918 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-19 00:08:11,918 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-19 00:08:12,402 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:12,447 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-19 00:08:12,448 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-19 00:08:12,670 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10235.267100011697, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:08:06.246Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:08:12,671 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:08:12,947 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:12,992 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-19 00:08:12,993 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-19 00:08:13,480 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:13,524 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-19 00:08:13,524 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-19 00:08:14,005 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:14,042 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-19 00:08:14,043 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-19 00:08:14,492 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:14,540 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-19 00:08:14,540 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-19 00:08:14,991 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:15,025 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-19 00:08:15,025 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-19 00:08:15,459 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:15,505 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-19 00:08:15,506 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-19 00:08:15,953 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:15,989 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-19 00:08:15,990 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-19 00:08:16,439 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:16,592 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-19 00:08:16,595 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-19 00:08:17,043 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:17,110 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-19 00:08:17,112 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-19 00:08:17,576 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:17,613 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-19 00:08:17,614 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-19 00:08:17,993 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:18,022 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-19 00:08:18,022 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-19 00:08:18,386 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:18,425 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-19 00:08:18,426 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-19 00:08:18,736 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:18,765 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-19 00:08:18,766 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-19 00:08:19,063 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:19,089 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-19 00:08:19,090 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-19 00:08:19,388 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:19,408 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-19 00:08:19,409 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-19 00:08:19,688 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:19,729 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-19 00:08:19,730 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-19 00:08:19,996 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,019 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-19 00:08:20,019 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-19 00:08:20,273 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,307 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-19 00:08:20,308 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-19 00:08:20,585 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,619 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-19 00:08:20,620 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-19 00:08:20,874 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:20,936 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-19 00:08:20,937 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-19 00:08:21,175 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,203 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-19 00:08:21,204 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-19 00:08:21,430 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,452 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-19 00:08:21,452 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-19 00:08:21,639 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,670 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-19 00:08:21,671 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-19 00:08:21,851 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:21,875 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-19 00:08:21,876 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-19 00:08:22,046 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,070 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-19 00:08:22,070 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-19 00:08:22,231 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,251 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-19 00:08:22,251 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-19 00:08:22,406 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,432 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-19 00:08:22,434 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-19 00:08:22,446 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9774.586199986516, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T16:08:16.257Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45748, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 00:08:22,447 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "driverConnectionId": 1, "serverConnectionId": 45748, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 00:08:22,597 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,633 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-19 00:08:22,634 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-19 00:08:22,766 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:22,879 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-19 00:08:22,879 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-19 00:08:23,007 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,033 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-19 00:08:23,033 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-19 00:08:23,111 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,130 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-19 00:08:23,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-19 00:08:23,185 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,205 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-19 00:08:23,206 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-19 00:08:23,251 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 00:08:23,258 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-19 00:08:23,258 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-19 00:08:23,300 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-19 00:08:23,301 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-19 00:08:23,302 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-19 00:08:23,302 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-19 00:08:23,302 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-19 00:08:23,303 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-19 00:08:23,303 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-19 00:08:23,304 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-19 00:08:23,304 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-19 00:08:23,305 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-19 00:08:23,305 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-19 00:08:23,306 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-19 00:08:23,306 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-19 00:08:23,307 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-19 00:08:23,307 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-19 00:08:23,308 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-19 00:08:23,308 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-19 00:08:23,309 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-19 00:08:23,309 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-19 00:08:23,310 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-19 00:08:23,310 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-19 00:08:23,311 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-19 00:08:23,311 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-19 00:08:23,312 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-19 00:08:23,312 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-19 00:08:23,313 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-19 00:08:23,313 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-19 00:08:23,314 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-19 00:08:23,314 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-19 00:08:23,315 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-19 00:08:23,315 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-19 00:08:23,316 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-19 00:08:23,316 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-19 00:08:23,317 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-19 00:08:23,317 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-19 00:08:23,318 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-19 00:08:23,318 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-19 00:08:23,319 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-19 00:08:23,319 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-19 00:08:23,319 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-19 00:08:23,320 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-19 00:08:23,321 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-19 00:08:23,321 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-19 00:08:23,321 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-19 00:08:23,322 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-19 00:08:23,322 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-19 00:08:23,323 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-19 00:08:23,323 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-19 00:08:23,324 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-19 00:08:23,324 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-19 00:08:23,325 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-19 00:08:23,325 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-19 00:08:23,326 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-19 00:08:23,326 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-19 00:08:23,327 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-19 00:08:23,328 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-19 00:08:23,328 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-19 00:08:23,328 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-19 00:08:23,329 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-19 00:08:23,329 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-19 00:08:23,330 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-19 00:08:23,330 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-19 00:08:23,331 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-19 00:08:23,331 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-19 00:08:23,332 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-19 00:08:23,332 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-19 00:08:23,332 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-19 00:08:23,333 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-19 00:08:23,333 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-19 00:08:23,334 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-19 00:08:23,334 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-19 00:08:23,334 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-19 00:08:23,335 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-19 00:08:23,335 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-19 00:08:23,335 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-19 00:08:23,336 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-19 00:08:23,336 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-19 00:08:23,337 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-19 00:08:23,337 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-19 00:08:23,338 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-19 00:08:23,338 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-19 00:08:23,338 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-19 00:08:23,339 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-19 00:08:23,339 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-19 00:08:23,340 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-19 00:08:23,340 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-19 00:08:23,341 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-19 00:08:23,341 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-19 00:08:23,341 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-19 00:08:23,342 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-19 00:08:23,342 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-19 00:08:23,343 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-19 00:08:23,343 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-19 00:08:23,343 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-19 00:08:23,344 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-19 00:08:23,344 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-19 00:08:23,345 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-19 00:08:23,345 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-19 00:08:23,345 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-19 00:08:23,346 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-19 00:08:23,346 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-19 00:08:23,346 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-19 00:08:23,347 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-19 00:08:23,347 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-19 00:08:23,347 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-19 00:08:23,348 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-19 00:08:23,349 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-19 00:08:23,349 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 00:08:24,210 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1648 条记录
2025-10-19 00:08:24,233 - data_loader - DEBUG - Loaded 1648 records from API
2025-10-19 00:08:24,233 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 00:08:24,234 - __main__ - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-19 00:08:24,234 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:08:24,234 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:08:24,235 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:08:24,236 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:08:24,237 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:08:24,237 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:08:24,237 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:08:24,248 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-19 00:08:24,248 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 00:08:24,248 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 00:08:24,248 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 00:08:24,249 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 00:08:24,256 - __main__ - INFO - Inserted 1648 records into table 光模块在线总数量统计表
2025-10-19 00:08:24,299 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 00:08:24,514 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3bb30ebeca5b53f588a41"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 2066.7651999974623, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:01:10,154 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:01:10,154 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 01:01:10,155 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:01:10,156 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x00000149DACACD70>
2025-10-19 01:01:10,156 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:01:10,430 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,430 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "previousDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:01:10,431 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,431 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:01:10,433 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,434 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "remainingTimeMS": 4999}
2025-10-19 01:01:10,459 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:01:10,470 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.661400010576472, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:04.326Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:10,471 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,471 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "previousDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>"}
2025-10-19 01:01:10,472 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,472 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:10,473 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,474 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,547 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05329229999915697}
2025-10-19 01:01:10,548 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07507910000276752}
2025-10-19 01:01:10,549 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,560 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 11.154, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,561 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,561 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:01:10,561 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:01:10.561810
2025-10-19 01:01:10,562 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,562 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,563 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,563 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00028160001966170967}
2025-10-19 01:01:10,563 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:01:10.561Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,583 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 19.417, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,584 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,584 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,585 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,586 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,586 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00037059999885968864}
2025-10-19 01:01:10,586 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:01:10.561Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,653 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 67.043, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,659 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,660 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x00000149DAF7F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}}
2025-10-19 01:01:10,660 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x00000149DAF7F4C0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3c7d63f6195eecb162425, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010661400010576472>]>", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,660 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,661 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0002919000107795}
2025-10-19 01:01:10,661 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "command": "{\"getMore\": 7690299585613915506, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/1md/x+GTKGgLB1kI8qBaQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,969 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "durationMS": 308.36400000000003, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45787, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:01:10,971 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:01:10,972 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:01:10,994 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:01:10,998 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:01:10,999 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:01:10,999 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:01:11,000 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:01:11,003 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:01:11,003 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:01:11,004 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:01:11,004 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:01:11,005 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:01:11,005 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:01:11,005 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:01:11,006 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:01:11,006 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:01:11,007 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:01:11,007 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:01:11,008 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:01:11,009 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:01:11,009 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:01:11,010 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:01:11,010 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:01:11,054 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:01:11,055 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:01:11,055 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:01:11,055 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:01:11,056 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:01:11,056 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:01:11,057 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:01:11,057 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:01:11,057 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:01:11,058 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:01:11,058 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:01:11,058 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:01:11,059 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:01:11,060 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:01:11,060 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:01:11,073 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:01:11,074 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x00000149DACACEC0>
2025-10-19 01:01:11,074 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 01:01:11,120 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 01:01:11,451 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 01:01:11,506 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.024551400012569502}
2025-10-19 01:01:11,507 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 01:01:11,541 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.023022999987006187}
2025-10-19 01:01:11,542 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 01:01:11,574 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.020814699993934482}
2025-10-19 01:01:11,575 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 01:01:11,606 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.021219999995082617}
2025-10-19 01:01:12,329 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:12,362 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 01:01:12,365 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 01:01:13,531 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:13,569 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 01:01:13,570 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 01:01:14,684 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:14,731 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 01:01:14,732 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 01:01:15,896 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:16,036 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 01:01:16,057 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 01:01:17,257 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:17,311 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 01:01:17,312 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 01:01:18,418 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:18,460 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 01:01:18,461 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 01:01:19,596 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:19,647 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 01:01:19,648 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 01:01:20,498 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10024.285999999847, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:14.352Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:20,499 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:20,723 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:20,764 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 01:01:20,765 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 01:01:21,837 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:21,914 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 01:01:21,915 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 01:01:23,074 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:23,154 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 01:01:23,154 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 01:01:24,220 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:24,286 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 01:01:24,286 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 01:01:25,319 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:25,365 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 01:01:25,366 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 01:01:26,370 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:26,436 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 01:01:26,439 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 01:01:27,491 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:27,533 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 01:01:27,534 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 01:01:28,636 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:28,676 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 01:01:28,677 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 01:01:29,826 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:29,866 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 01:01:29,867 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 01:01:30,509 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10009.411400009412, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:24.362Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:30,511 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:30,891 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:30,941 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 01:01:30,941 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 01:01:31,968 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:32,003 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 01:01:32,004 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 01:01:32,962 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:32,997 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 01:01:32,998 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 01:01:33,954 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:33,997 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 01:01:33,998 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 01:01:34,954 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:35,009 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 01:01:35,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 01:01:35,963 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:36,005 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 01:01:36,006 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 01:01:36,952 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:36,988 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 01:01:36,989 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 01:01:37,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:37,972 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 01:01:37,973 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 01:01:38,914 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:38,955 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 01:01:38,955 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 01:01:39,883 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:39,921 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 01:01:39,922 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 01:01:40,517 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10005.183499975828, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:34.372Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:40,518 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:40,839 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:40,878 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 01:01:40,878 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 01:01:41,793 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:41,834 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 01:01:41,835 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 01:01:42,743 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:42,786 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 01:01:42,787 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 01:01:43,690 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:43,728 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 01:01:43,728 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 01:01:44,624 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:44,666 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 01:01:44,666 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 01:01:45,562 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:45,606 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 01:01:45,606 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 01:01:46,493 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:46,550 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 01:01:46,550 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 01:01:47,437 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:47,475 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 01:01:47,475 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 01:01:48,351 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:48,398 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 01:01:48,398 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 01:01:49,266 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:49,309 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 01:01:49,309 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 01:01:50,162 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:50,213 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 01:01:50,214 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 01:01:50,529 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10010.035199986305, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:44.383Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:01:50,530 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:01:51,085 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:51,127 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 01:01:51,127 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 01:01:51,966 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:52,010 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 01:01:52,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 01:01:53,096 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:53,138 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 01:01:53,138 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 01:01:54,003 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:54,055 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 01:01:54,055 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 01:01:54,905 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:54,943 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 01:01:54,943 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 01:01:55,789 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:55,828 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 01:01:55,828 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 01:01:56,666 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:56,702 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 01:01:56,702 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 01:01:57,544 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:57,607 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 01:01:57,607 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 01:01:58,432 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:58,470 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 01:01:58,470 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 01:01:59,282 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:01:59,322 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 01:01:59,323 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 01:02:00,117 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:00,156 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 01:02:00,157 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 01:02:00,548 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10018.259800010128, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:01:54.399Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:02:00,551 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:02:00,946 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:00,981 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 01:02:00,981 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 01:02:01,762 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:01,803 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 01:02:01,803 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 01:02:02,572 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:02,613 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 01:02:02,613 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 01:02:03,377 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:03,424 - backend.dataSources.optical_module_inventory - INFO - 第 52 页返回 total = 53306（变化，之前=54306）
2025-10-19 01:02:03,425 - backend.dataSources.optical_module_inventory - INFO - 已请求页 52，返回 1000 条，累计已去重 51000 条 (reported total=53306)
2025-10-19 01:02:04,191 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:04,236 - backend.dataSources.optical_module_inventory - INFO - 第 53 页返回 total = 52306（变化，之前=53306）
2025-10-19 01:02:04,237 - backend.dataSources.optical_module_inventory - INFO - 已请求页 53，返回 1000 条，累计已去重 52000 条 (reported total=52306)
2025-10-19 01:02:04,973 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:05,028 - backend.dataSources.optical_module_inventory - INFO - 第 54 页返回 total = 51306（变化，之前=52306）
2025-10-19 01:02:05,029 - backend.dataSources.optical_module_inventory - INFO - 已请求页 54，返回 1000 条，累计已去重 53000 条 (reported total=51306)
2025-10-19 01:02:05,754 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:05,797 - backend.dataSources.optical_module_inventory - INFO - 第 55 页返回 total = 50306（变化，之前=51306）
2025-10-19 01:02:05,797 - backend.dataSources.optical_module_inventory - INFO - 已请求页 55，返回 1000 条，累计已去重 54000 条 (reported total=50306)
2025-10-19 01:02:06,518 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:06,568 - backend.dataSources.optical_module_inventory - INFO - 第 56 页返回 total = 49306（变化，之前=50306）
2025-10-19 01:02:06,568 - backend.dataSources.optical_module_inventory - INFO - 已请求页 56，返回 1000 条，累计已去重 55000 条 (reported total=49306)
2025-10-19 01:02:07,265 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:07,304 - backend.dataSources.optical_module_inventory - INFO - 第 57 页返回 total = 48306（变化，之前=49306）
2025-10-19 01:02:07,305 - backend.dataSources.optical_module_inventory - INFO - 已请求页 57，返回 1000 条，累计已去重 56000 条 (reported total=48306)
2025-10-19 01:02:07,988 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:08,031 - backend.dataSources.optical_module_inventory - INFO - 第 58 页返回 total = 47306（变化，之前=48306）
2025-10-19 01:02:08,031 - backend.dataSources.optical_module_inventory - INFO - 已请求页 58，返回 1000 条，累计已去重 57000 条 (reported total=47306)
2025-10-19 01:02:08,711 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:08,753 - backend.dataSources.optical_module_inventory - INFO - 第 59 页返回 total = 46306（变化，之前=47306）
2025-10-19 01:02:08,754 - backend.dataSources.optical_module_inventory - INFO - 已请求页 59，返回 1000 条，累计已去重 58000 条 (reported total=46306)
2025-10-19 01:02:09,419 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:09,461 - backend.dataSources.optical_module_inventory - INFO - 第 60 页返回 total = 45306（变化，之前=46306）
2025-10-19 01:02:09,461 - backend.dataSources.optical_module_inventory - INFO - 已请求页 60，返回 1000 条，累计已去重 59000 条 (reported total=45306)
2025-10-19 01:02:10,102 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:10,142 - backend.dataSources.optical_module_inventory - INFO - 第 61 页返回 total = 44306（变化，之前=45306）
2025-10-19 01:02:10,142 - backend.dataSources.optical_module_inventory - INFO - 已请求页 61，返回 1000 条，累计已去重 60000 条 (reported total=44306)
2025-10-19 01:02:10,554 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10002.825399977155, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:02:04.409Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:02:10,555 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:02:10,769 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:10,805 - backend.dataSources.optical_module_inventory - INFO - 第 62 页返回 total = 43306（变化，之前=44306）
2025-10-19 01:02:10,806 - backend.dataSources.optical_module_inventory - INFO - 已请求页 62，返回 1000 条，累计已去重 61000 条 (reported total=43306)
2025-10-19 01:02:11,430 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:11,466 - backend.dataSources.optical_module_inventory - INFO - 第 63 页返回 total = 42306（变化，之前=43306）
2025-10-19 01:02:11,467 - backend.dataSources.optical_module_inventory - INFO - 已请求页 63，返回 1000 条，累计已去重 62000 条 (reported total=42306)
2025-10-19 01:02:12,069 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:12,106 - backend.dataSources.optical_module_inventory - INFO - 第 64 页返回 total = 41306（变化，之前=42306）
2025-10-19 01:02:12,106 - backend.dataSources.optical_module_inventory - INFO - 已请求页 64，返回 1000 条，累计已去重 63000 条 (reported total=41306)
2025-10-19 01:02:12,707 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:12,741 - backend.dataSources.optical_module_inventory - INFO - 第 65 页返回 total = 40306（变化，之前=41306）
2025-10-19 01:02:12,742 - backend.dataSources.optical_module_inventory - INFO - 已请求页 65，返回 1000 条，累计已去重 64000 条 (reported total=40306)
2025-10-19 01:02:13,327 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:13,360 - backend.dataSources.optical_module_inventory - INFO - 第 66 页返回 total = 39306（变化，之前=40306）
2025-10-19 01:02:13,360 - backend.dataSources.optical_module_inventory - INFO - 已请求页 66，返回 1000 条，累计已去重 65000 条 (reported total=39306)
2025-10-19 01:02:13,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:13,973 - backend.dataSources.optical_module_inventory - INFO - 第 67 页返回 total = 38306（变化，之前=39306）
2025-10-19 01:02:13,973 - backend.dataSources.optical_module_inventory - INFO - 已请求页 67，返回 1000 条，累计已去重 66000 条 (reported total=38306)
2025-10-19 01:02:14,534 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:14,566 - backend.dataSources.optical_module_inventory - INFO - 第 68 页返回 total = 37306（变化，之前=38306）
2025-10-19 01:02:14,566 - backend.dataSources.optical_module_inventory - INFO - 已请求页 68，返回 1000 条，累计已去重 67000 条 (reported total=37306)
2025-10-19 01:02:15,115 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:15,149 - backend.dataSources.optical_module_inventory - INFO - 第 69 页返回 total = 36306（变化，之前=37306）
2025-10-19 01:02:15,150 - backend.dataSources.optical_module_inventory - INFO - 已请求页 69，返回 1000 条，累计已去重 68000 条 (reported total=36306)
2025-10-19 01:02:15,688 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:15,726 - backend.dataSources.optical_module_inventory - INFO - 第 70 页返回 total = 35306（变化，之前=36306）
2025-10-19 01:02:15,726 - backend.dataSources.optical_module_inventory - INFO - 已请求页 70，返回 1000 条，累计已去重 69000 条 (reported total=35306)
2025-10-19 01:02:16,260 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:16,357 - backend.dataSources.optical_module_inventory - INFO - 第 71 页返回 total = 34306（变化，之前=35306）
2025-10-19 01:02:16,358 - backend.dataSources.optical_module_inventory - INFO - 已请求页 71，返回 1000 条，累计已去重 70000 条 (reported total=34306)
2025-10-19 01:02:16,874 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:16,910 - backend.dataSources.optical_module_inventory - INFO - 第 72 页返回 total = 33306（变化，之前=34306）
2025-10-19 01:02:16,910 - backend.dataSources.optical_module_inventory - INFO - 已请求页 72，返回 1000 条，累计已去重 71000 条 (reported total=33306)
2025-10-19 01:02:17,409 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:17,441 - backend.dataSources.optical_module_inventory - INFO - 第 73 页返回 total = 32306（变化，之前=33306）
2025-10-19 01:02:17,442 - backend.dataSources.optical_module_inventory - INFO - 已请求页 73，返回 1000 条，累计已去重 72000 条 (reported total=32306)
2025-10-19 01:02:17,973 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:18,006 - backend.dataSources.optical_module_inventory - INFO - 第 74 页返回 total = 31306（变化，之前=32306）
2025-10-19 01:02:18,007 - backend.dataSources.optical_module_inventory - INFO - 已请求页 74，返回 1000 条，累计已去重 73000 条 (reported total=31306)
2025-10-19 01:02:18,567 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:18,605 - backend.dataSources.optical_module_inventory - INFO - 第 75 页返回 total = 30306（变化，之前=31306）
2025-10-19 01:02:18,605 - backend.dataSources.optical_module_inventory - INFO - 已请求页 75，返回 1000 条，累计已去重 74000 条 (reported total=30306)
2025-10-19 01:02:19,090 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:19,128 - backend.dataSources.optical_module_inventory - INFO - 第 76 页返回 total = 29306（变化，之前=30306）
2025-10-19 01:02:19,129 - backend.dataSources.optical_module_inventory - INFO - 已请求页 76，返回 1000 条，累计已去重 75000 条 (reported total=29306)
2025-10-19 01:02:19,615 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:19,654 - backend.dataSources.optical_module_inventory - INFO - 第 77 页返回 total = 28306（变化，之前=29306）
2025-10-19 01:02:19,654 - backend.dataSources.optical_module_inventory - INFO - 已请求页 77，返回 1000 条，累计已去重 76000 条 (reported total=28306)
2025-10-19 01:02:20,109 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:20,146 - backend.dataSources.optical_module_inventory - INFO - 第 78 页返回 total = 27306（变化，之前=28306）
2025-10-19 01:02:20,147 - backend.dataSources.optical_module_inventory - INFO - 已请求页 78，返回 1000 条，累计已去重 77000 条 (reported total=27306)
2025-10-19 01:02:20,568 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10012.134099990362, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:02:14.419Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45785, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:02:20,570 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "driverConnectionId": 1, "serverConnectionId": 45785, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:02:20,607 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:20,639 - backend.dataSources.optical_module_inventory - INFO - 第 79 页返回 total = 26306（变化，之前=27306）
2025-10-19 01:02:20,639 - backend.dataSources.optical_module_inventory - INFO - 已请求页 79，返回 1000 条，累计已去重 78000 条 (reported total=26306)
2025-10-19 01:02:21,070 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:21,103 - backend.dataSources.optical_module_inventory - INFO - 第 80 页返回 total = 25306（变化，之前=26306）
2025-10-19 01:02:21,103 - backend.dataSources.optical_module_inventory - INFO - 已请求页 80，返回 1000 条，累计已去重 79000 条 (reported total=25306)
2025-10-19 01:02:21,519 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:21,548 - backend.dataSources.optical_module_inventory - INFO - 第 81 页返回 total = 24306（变化，之前=25306）
2025-10-19 01:02:21,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 81，返回 1000 条，累计已去重 80000 条 (reported total=24306)
2025-10-19 01:02:21,943 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:21,980 - backend.dataSources.optical_module_inventory - INFO - 第 82 页返回 total = 23306（变化，之前=24306）
2025-10-19 01:02:21,981 - backend.dataSources.optical_module_inventory - INFO - 已请求页 82，返回 1000 条，累计已去重 81000 条 (reported total=23306)
2025-10-19 01:02:22,352 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:22,380 - backend.dataSources.optical_module_inventory - INFO - 第 83 页返回 total = 22306（变化，之前=23306）
2025-10-19 01:02:22,380 - backend.dataSources.optical_module_inventory - INFO - 已请求页 83，返回 1000 条，累计已去重 82000 条 (reported total=22306)
2025-10-19 01:02:22,724 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:22,751 - backend.dataSources.optical_module_inventory - INFO - 第 84 页返回 total = 21306（变化，之前=22306）
2025-10-19 01:02:22,751 - backend.dataSources.optical_module_inventory - INFO - 已请求页 84，返回 1000 条，累计已去重 83000 条 (reported total=21306)
2025-10-19 01:02:23,076 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:23,111 - backend.dataSources.optical_module_inventory - INFO - 第 85 页返回 total = 20306（变化，之前=21306）
2025-10-19 01:02:23,112 - backend.dataSources.optical_module_inventory - INFO - 已请求页 85，返回 1000 条，累计已去重 84000 条 (reported total=20306)
2025-10-19 01:02:23,427 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:23,459 - backend.dataSources.optical_module_inventory - INFO - 第 86 页返回 total = 19306（变化，之前=20306）
2025-10-19 01:02:23,460 - backend.dataSources.optical_module_inventory - INFO - 已请求页 86，返回 1000 条，累计已去重 85000 条 (reported total=19306)
2025-10-19 01:02:23,767 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:23,802 - backend.dataSources.optical_module_inventory - INFO - 第 87 页返回 total = 18306（变化，之前=19306）
2025-10-19 01:02:23,802 - backend.dataSources.optical_module_inventory - INFO - 已请求页 87，返回 1000 条，累计已去重 86000 条 (reported total=18306)
2025-10-19 01:02:24,096 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:24,131 - backend.dataSources.optical_module_inventory - INFO - 第 88 页返回 total = 17306（变化，之前=18306）
2025-10-19 01:02:24,131 - backend.dataSources.optical_module_inventory - INFO - 已请求页 88，返回 1000 条，累计已去重 87000 条 (reported total=17306)
2025-10-19 01:02:24,416 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:24,440 - backend.dataSources.optical_module_inventory - INFO - 第 89 页返回 total = 16306（变化，之前=17306）
2025-10-19 01:02:24,440 - backend.dataSources.optical_module_inventory - INFO - 已请求页 89，返回 1000 条，累计已去重 88000 条 (reported total=16306)
2025-10-19 01:02:24,712 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:24,736 - backend.dataSources.optical_module_inventory - INFO - 第 90 页返回 total = 15306（变化，之前=16306）
2025-10-19 01:02:24,736 - backend.dataSources.optical_module_inventory - INFO - 已请求页 90，返回 1000 条，累计已去重 89000 条 (reported total=15306)
2025-10-19 01:02:24,989 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,021 - backend.dataSources.optical_module_inventory - INFO - 第 91 页返回 total = 14306（变化，之前=15306）
2025-10-19 01:02:25,022 - backend.dataSources.optical_module_inventory - INFO - 已请求页 91，返回 1000 条，累计已去重 90000 条 (reported total=14306)
2025-10-19 01:02:25,267 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,292 - backend.dataSources.optical_module_inventory - INFO - 第 92 页返回 total = 13306（变化，之前=14306）
2025-10-19 01:02:25,293 - backend.dataSources.optical_module_inventory - INFO - 已请求页 92，返回 1000 条，累计已去重 91000 条 (reported total=13306)
2025-10-19 01:02:25,521 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,549 - backend.dataSources.optical_module_inventory - INFO - 第 93 页返回 total = 12306（变化，之前=13306）
2025-10-19 01:02:25,549 - backend.dataSources.optical_module_inventory - INFO - 已请求页 93，返回 1000 条，累计已去重 92000 条 (reported total=12306)
2025-10-19 01:02:25,761 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:25,784 - backend.dataSources.optical_module_inventory - INFO - 第 94 页返回 total = 11306（变化，之前=12306）
2025-10-19 01:02:25,784 - backend.dataSources.optical_module_inventory - INFO - 已请求页 94，返回 1000 条，累计已去重 93000 条 (reported total=11306)
2025-10-19 01:02:25,989 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,008 - backend.dataSources.optical_module_inventory - INFO - 第 95 页返回 total = 10306（变化，之前=11306）
2025-10-19 01:02:26,009 - backend.dataSources.optical_module_inventory - INFO - 已请求页 95，返回 1000 条，累计已去重 94000 条 (reported total=10306)
2025-10-19 01:02:26,201 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,220 - backend.dataSources.optical_module_inventory - INFO - 第 96 页返回 total = 9306（变化，之前=10306）
2025-10-19 01:02:26,220 - backend.dataSources.optical_module_inventory - INFO - 已请求页 96，返回 1000 条，累计已去重 95000 条 (reported total=9306)
2025-10-19 01:02:26,401 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,421 - backend.dataSources.optical_module_inventory - INFO - 第 97 页返回 total = 8306（变化，之前=9306）
2025-10-19 01:02:26,421 - backend.dataSources.optical_module_inventory - INFO - 已请求页 97，返回 1000 条，累计已去重 96000 条 (reported total=8306)
2025-10-19 01:02:26,593 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,614 - backend.dataSources.optical_module_inventory - INFO - 第 98 页返回 total = 7306（变化，之前=8306）
2025-10-19 01:02:26,614 - backend.dataSources.optical_module_inventory - INFO - 已请求页 98，返回 1000 条，累计已去重 97000 条 (reported total=7306)
2025-10-19 01:02:26,775 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,794 - backend.dataSources.optical_module_inventory - INFO - 第 99 页返回 total = 6306（变化，之前=7306）
2025-10-19 01:02:26,794 - backend.dataSources.optical_module_inventory - INFO - 已请求页 99，返回 1000 条，累计已去重 98000 条 (reported total=6306)
2025-10-19 01:02:26,941 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:26,957 - backend.dataSources.optical_module_inventory - INFO - 第 100 页返回 total = 5306（变化，之前=6306）
2025-10-19 01:02:26,958 - backend.dataSources.optical_module_inventory - INFO - 已请求页 100，返回 1000 条，累计已去重 99000 条 (reported total=5306)
2025-10-19 01:02:27,091 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,148 - backend.dataSources.optical_module_inventory - INFO - 第 101 页返回 total = 4306（变化，之前=5306）
2025-10-19 01:02:27,149 - backend.dataSources.optical_module_inventory - INFO - 已请求页 101，返回 1000 条，累计已去重 100000 条 (reported total=4306)
2025-10-19 01:02:27,270 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,289 - backend.dataSources.optical_module_inventory - INFO - 第 102 页返回 total = 3306（变化，之前=4306）
2025-10-19 01:02:27,289 - backend.dataSources.optical_module_inventory - INFO - 已请求页 102，返回 1000 条，累计已去重 101000 条 (reported total=3306)
2025-10-19 01:02:27,393 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,413 - backend.dataSources.optical_module_inventory - INFO - 第 103 页返回 total = 2306（变化，之前=3306）
2025-10-19 01:02:27,413 - backend.dataSources.optical_module_inventory - INFO - 已请求页 103，返回 1000 条，累计已去重 102000 条 (reported total=2306)
2025-10-19 01:02:27,484 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,494 - backend.dataSources.optical_module_inventory - INFO - 第 104 页返回 total = 1306（变化，之前=2306）
2025-10-19 01:02:27,495 - backend.dataSources.optical_module_inventory - INFO - 已请求页 104，返回 1000 条，累计已去重 103000 条 (reported total=1306)
2025-10-19 01:02:27,547 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:02:27,553 - backend.dataSources.optical_module_inventory - INFO - 第 105 页返回 total = 306（变化，之前=1306）
2025-10-19 01:02:27,553 - backend.dataSources.optical_module_inventory - INFO - 已请求页 105，返回 306 条，累计已去重 104000 条 (reported total=306)
2025-10-19 01:02:27,600 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 68
2025-10-19 01:02:27,601 - backend.dataSources.optical_module_inventory - INFO - 第 106 页返回 total = 0（变化，之前=306）
2025-10-19 01:02:27,602 - backend.dataSources.optical_module_inventory - INFO - 第 106 页无数据，结束
2025-10-19 01:02:27,602 - backend.dataSources.optical_module_inventory - INFO - 等待并行处理任务完成...
2025-10-19 01:02:27,603 - backend.dataSources.optical_module_inventory - DEBUG - page 1 处理完成，新增 1000 条
2025-10-19 01:02:27,603 - backend.dataSources.optical_module_inventory - DEBUG - page 2 处理完成，新增 1000 条
2025-10-19 01:02:27,603 - backend.dataSources.optical_module_inventory - DEBUG - page 3 处理完成，新增 1000 条
2025-10-19 01:02:27,604 - backend.dataSources.optical_module_inventory - DEBUG - page 4 处理完成，新增 1000 条
2025-10-19 01:02:27,604 - backend.dataSources.optical_module_inventory - DEBUG - page 5 处理完成，新增 1000 条
2025-10-19 01:02:27,605 - backend.dataSources.optical_module_inventory - DEBUG - page 6 处理完成，新增 1000 条
2025-10-19 01:02:27,605 - backend.dataSources.optical_module_inventory - DEBUG - page 7 处理完成，新增 1000 条
2025-10-19 01:02:27,605 - backend.dataSources.optical_module_inventory - DEBUG - page 8 处理完成，新增 1000 条
2025-10-19 01:02:27,606 - backend.dataSources.optical_module_inventory - DEBUG - page 9 处理完成，新增 1000 条
2025-10-19 01:02:27,606 - backend.dataSources.optical_module_inventory - DEBUG - page 10 处理完成，新增 1000 条
2025-10-19 01:02:27,606 - backend.dataSources.optical_module_inventory - DEBUG - page 11 处理完成，新增 1000 条
2025-10-19 01:02:27,607 - backend.dataSources.optical_module_inventory - DEBUG - page 12 处理完成，新增 1000 条
2025-10-19 01:02:27,607 - backend.dataSources.optical_module_inventory - DEBUG - page 13 处理完成，新增 1000 条
2025-10-19 01:02:27,608 - backend.dataSources.optical_module_inventory - DEBUG - page 14 处理完成，新增 1000 条
2025-10-19 01:02:27,608 - backend.dataSources.optical_module_inventory - DEBUG - page 15 处理完成，新增 1000 条
2025-10-19 01:02:27,608 - backend.dataSources.optical_module_inventory - DEBUG - page 16 处理完成，新增 1000 条
2025-10-19 01:02:27,609 - backend.dataSources.optical_module_inventory - DEBUG - page 17 处理完成，新增 1000 条
2025-10-19 01:02:27,609 - backend.dataSources.optical_module_inventory - DEBUG - page 18 处理完成，新增 1000 条
2025-10-19 01:02:27,609 - backend.dataSources.optical_module_inventory - DEBUG - page 19 处理完成，新增 1000 条
2025-10-19 01:02:27,610 - backend.dataSources.optical_module_inventory - DEBUG - page 20 处理完成，新增 1000 条
2025-10-19 01:02:27,610 - backend.dataSources.optical_module_inventory - DEBUG - page 21 处理完成，新增 1000 条
2025-10-19 01:02:27,611 - backend.dataSources.optical_module_inventory - DEBUG - page 22 处理完成，新增 1000 条
2025-10-19 01:02:27,611 - backend.dataSources.optical_module_inventory - DEBUG - page 23 处理完成，新增 1000 条
2025-10-19 01:02:27,612 - backend.dataSources.optical_module_inventory - DEBUG - page 24 处理完成，新增 1000 条
2025-10-19 01:02:27,612 - backend.dataSources.optical_module_inventory - DEBUG - page 25 处理完成，新增 1000 条
2025-10-19 01:02:27,612 - backend.dataSources.optical_module_inventory - DEBUG - page 26 处理完成，新增 1000 条
2025-10-19 01:02:27,613 - backend.dataSources.optical_module_inventory - DEBUG - page 27 处理完成，新增 1000 条
2025-10-19 01:02:27,613 - backend.dataSources.optical_module_inventory - DEBUG - page 28 处理完成，新增 1000 条
2025-10-19 01:02:27,614 - backend.dataSources.optical_module_inventory - DEBUG - page 29 处理完成，新增 1000 条
2025-10-19 01:02:27,614 - backend.dataSources.optical_module_inventory - DEBUG - page 30 处理完成，新增 1000 条
2025-10-19 01:02:27,615 - backend.dataSources.optical_module_inventory - DEBUG - page 31 处理完成，新增 1000 条
2025-10-19 01:02:27,616 - backend.dataSources.optical_module_inventory - DEBUG - page 32 处理完成，新增 1000 条
2025-10-19 01:02:27,616 - backend.dataSources.optical_module_inventory - DEBUG - page 33 处理完成，新增 1000 条
2025-10-19 01:02:27,617 - backend.dataSources.optical_module_inventory - DEBUG - page 34 处理完成，新增 1000 条
2025-10-19 01:02:27,617 - backend.dataSources.optical_module_inventory - DEBUG - page 35 处理完成，新增 1000 条
2025-10-19 01:02:27,617 - backend.dataSources.optical_module_inventory - DEBUG - page 36 处理完成，新增 1000 条
2025-10-19 01:02:27,618 - backend.dataSources.optical_module_inventory - DEBUG - page 37 处理完成，新增 1000 条
2025-10-19 01:02:27,618 - backend.dataSources.optical_module_inventory - DEBUG - page 38 处理完成，新增 1000 条
2025-10-19 01:02:27,618 - backend.dataSources.optical_module_inventory - DEBUG - page 39 处理完成，新增 1000 条
2025-10-19 01:02:27,619 - backend.dataSources.optical_module_inventory - DEBUG - page 40 处理完成，新增 1000 条
2025-10-19 01:02:27,620 - backend.dataSources.optical_module_inventory - DEBUG - page 41 处理完成，新增 1000 条
2025-10-19 01:02:27,620 - backend.dataSources.optical_module_inventory - DEBUG - page 42 处理完成，新增 1000 条
2025-10-19 01:02:27,620 - backend.dataSources.optical_module_inventory - DEBUG - page 43 处理完成，新增 1000 条
2025-10-19 01:02:27,621 - backend.dataSources.optical_module_inventory - DEBUG - page 44 处理完成，新增 1000 条
2025-10-19 01:02:27,621 - backend.dataSources.optical_module_inventory - DEBUG - page 45 处理完成，新增 1000 条
2025-10-19 01:02:27,622 - backend.dataSources.optical_module_inventory - DEBUG - page 46 处理完成，新增 1000 条
2025-10-19 01:02:27,622 - backend.dataSources.optical_module_inventory - DEBUG - page 47 处理完成，新增 1000 条
2025-10-19 01:02:27,622 - backend.dataSources.optical_module_inventory - DEBUG - page 48 处理完成，新增 1000 条
2025-10-19 01:02:27,623 - backend.dataSources.optical_module_inventory - DEBUG - page 49 处理完成，新增 1000 条
2025-10-19 01:02:27,623 - backend.dataSources.optical_module_inventory - DEBUG - page 50 处理完成，新增 1000 条
2025-10-19 01:02:27,623 - backend.dataSources.optical_module_inventory - DEBUG - page 51 处理完成，新增 1000 条
2025-10-19 01:02:27,624 - backend.dataSources.optical_module_inventory - DEBUG - page 52 处理完成，新增 1000 条
2025-10-19 01:02:27,624 - backend.dataSources.optical_module_inventory - DEBUG - page 53 处理完成，新增 1000 条
2025-10-19 01:02:27,625 - backend.dataSources.optical_module_inventory - DEBUG - page 54 处理完成，新增 1000 条
2025-10-19 01:02:27,625 - backend.dataSources.optical_module_inventory - DEBUG - page 55 处理完成，新增 1000 条
2025-10-19 01:02:27,625 - backend.dataSources.optical_module_inventory - DEBUG - page 56 处理完成，新增 1000 条
2025-10-19 01:02:27,626 - backend.dataSources.optical_module_inventory - DEBUG - page 57 处理完成，新增 1000 条
2025-10-19 01:02:27,626 - backend.dataSources.optical_module_inventory - DEBUG - page 58 处理完成，新增 1000 条
2025-10-19 01:02:27,627 - backend.dataSources.optical_module_inventory - DEBUG - page 59 处理完成，新增 1000 条
2025-10-19 01:02:27,627 - backend.dataSources.optical_module_inventory - DEBUG - page 60 处理完成，新增 1000 条
2025-10-19 01:02:27,628 - backend.dataSources.optical_module_inventory - DEBUG - page 61 处理完成，新增 1000 条
2025-10-19 01:02:27,628 - backend.dataSources.optical_module_inventory - DEBUG - page 62 处理完成，新增 1000 条
2025-10-19 01:02:27,628 - backend.dataSources.optical_module_inventory - DEBUG - page 63 处理完成，新增 1000 条
2025-10-19 01:02:27,629 - backend.dataSources.optical_module_inventory - DEBUG - page 64 处理完成，新增 1000 条
2025-10-19 01:02:27,629 - backend.dataSources.optical_module_inventory - DEBUG - page 65 处理完成，新增 1000 条
2025-10-19 01:02:27,629 - backend.dataSources.optical_module_inventory - DEBUG - page 66 处理完成，新增 1000 条
2025-10-19 01:02:27,630 - backend.dataSources.optical_module_inventory - DEBUG - page 67 处理完成，新增 1000 条
2025-10-19 01:02:27,630 - backend.dataSources.optical_module_inventory - DEBUG - page 68 处理完成，新增 1000 条
2025-10-19 01:02:27,631 - backend.dataSources.optical_module_inventory - DEBUG - page 69 处理完成，新增 1000 条
2025-10-19 01:02:27,631 - backend.dataSources.optical_module_inventory - DEBUG - page 70 处理完成，新增 1000 条
2025-10-19 01:02:27,632 - backend.dataSources.optical_module_inventory - DEBUG - page 71 处理完成，新增 1000 条
2025-10-19 01:02:27,632 - backend.dataSources.optical_module_inventory - DEBUG - page 72 处理完成，新增 1000 条
2025-10-19 01:02:27,633 - backend.dataSources.optical_module_inventory - DEBUG - page 73 处理完成，新增 1000 条
2025-10-19 01:02:27,633 - backend.dataSources.optical_module_inventory - DEBUG - page 74 处理完成，新增 1000 条
2025-10-19 01:02:27,634 - backend.dataSources.optical_module_inventory - DEBUG - page 75 处理完成，新增 1000 条
2025-10-19 01:02:27,634 - backend.dataSources.optical_module_inventory - DEBUG - page 76 处理完成，新增 1000 条
2025-10-19 01:02:27,635 - backend.dataSources.optical_module_inventory - DEBUG - page 77 处理完成，新增 1000 条
2025-10-19 01:02:27,635 - backend.dataSources.optical_module_inventory - DEBUG - page 78 处理完成，新增 1000 条
2025-10-19 01:02:27,635 - backend.dataSources.optical_module_inventory - DEBUG - page 79 处理完成，新增 1000 条
2025-10-19 01:02:27,636 - backend.dataSources.optical_module_inventory - DEBUG - page 80 处理完成，新增 1000 条
2025-10-19 01:02:27,636 - backend.dataSources.optical_module_inventory - DEBUG - page 81 处理完成，新增 1000 条
2025-10-19 01:02:27,636 - backend.dataSources.optical_module_inventory - DEBUG - page 82 处理完成，新增 1000 条
2025-10-19 01:02:27,637 - backend.dataSources.optical_module_inventory - DEBUG - page 83 处理完成，新增 1000 条
2025-10-19 01:02:27,637 - backend.dataSources.optical_module_inventory - DEBUG - page 84 处理完成，新增 1000 条
2025-10-19 01:02:27,637 - backend.dataSources.optical_module_inventory - DEBUG - page 85 处理完成，新增 1000 条
2025-10-19 01:02:27,638 - backend.dataSources.optical_module_inventory - DEBUG - page 86 处理完成，新增 1000 条
2025-10-19 01:02:27,638 - backend.dataSources.optical_module_inventory - DEBUG - page 87 处理完成，新增 1000 条
2025-10-19 01:02:27,639 - backend.dataSources.optical_module_inventory - DEBUG - page 88 处理完成，新增 1000 条
2025-10-19 01:02:27,639 - backend.dataSources.optical_module_inventory - DEBUG - page 89 处理完成，新增 1000 条
2025-10-19 01:02:27,639 - backend.dataSources.optical_module_inventory - DEBUG - page 90 处理完成，新增 1000 条
2025-10-19 01:02:27,640 - backend.dataSources.optical_module_inventory - DEBUG - page 91 处理完成，新增 1000 条
2025-10-19 01:02:27,640 - backend.dataSources.optical_module_inventory - DEBUG - page 92 处理完成，新增 1000 条
2025-10-19 01:02:27,640 - backend.dataSources.optical_module_inventory - DEBUG - page 93 处理完成，新增 1000 条
2025-10-19 01:02:27,641 - backend.dataSources.optical_module_inventory - DEBUG - page 94 处理完成，新增 1000 条
2025-10-19 01:02:27,641 - backend.dataSources.optical_module_inventory - DEBUG - page 95 处理完成，新增 1000 条
2025-10-19 01:02:27,642 - backend.dataSources.optical_module_inventory - DEBUG - page 96 处理完成，新增 1000 条
2025-10-19 01:02:27,642 - backend.dataSources.optical_module_inventory - DEBUG - page 97 处理完成，新增 1000 条
2025-10-19 01:02:27,642 - backend.dataSources.optical_module_inventory - DEBUG - page 98 处理完成，新增 1000 条
2025-10-19 01:02:27,643 - backend.dataSources.optical_module_inventory - DEBUG - page 99 处理完成，新增 1000 条
2025-10-19 01:02:27,643 - backend.dataSources.optical_module_inventory - DEBUG - page 100 处理完成，新增 1000 条
2025-10-19 01:02:27,644 - backend.dataSources.optical_module_inventory - DEBUG - page 101 处理完成，新增 1000 条
2025-10-19 01:02:27,644 - backend.dataSources.optical_module_inventory - DEBUG - page 102 处理完成，新增 1000 条
2025-10-19 01:02:27,644 - backend.dataSources.optical_module_inventory - DEBUG - page 103 处理完成，新增 1000 条
2025-10-19 01:02:27,645 - backend.dataSources.optical_module_inventory - DEBUG - page 104 处理完成，新增 1000 条
2025-10-19 01:02:27,645 - backend.dataSources.optical_module_inventory - DEBUG - page 105 处理完成，新增 306 条
2025-10-19 01:02:27,655 - backend.dataSources.optical_module_inventory - INFO - 抓取结束。去重后总记录数: 104306
2025-10-19 01:02:27,655 - backend.dataSources.optical_module_inventory - INFO - 最后一次 page_total 报告为: 0
2025-10-19 01:02:28,643 - backend.dataSources.optical_module_inventory - INFO - 处理完成，共生成 1131 条记录
2025-10-19 01:02:28,668 - data_loader - DEBUG - Loaded 1131 records from API
2025-10-19 01:02:28,668 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 01:02:28,669 - __main__ - DEBUG - Sample record columns: ['日期', '光模块型号', '光模块厂商', '机房', '集群', '客户', '在线总数量']
2025-10-19 01:02:28,670 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 01:02:28,670 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:02:28,671 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:02:28,672 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:02:28,672 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:02:28,673 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:02:28,674 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 01:02:28,677 - __main__ - INFO - Rebuilt table 光模块在线总数量统计表 from 光模块在线总数量统计表
2025-10-19 01:02:28,677 - __main__ - DEBUG - Sanitized name: 日期 -> 日期
2025-10-19 01:02:28,678 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:02:28,678 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:02:28,679 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:02:28,679 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:02:28,679 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:02:28,680 - __main__ - DEBUG - Sanitized name: 在线总数量 -> 在线总数量
2025-10-19 01:02:28,689 - __main__ - INFO - Inserted 1131 records into table 光模块在线总数量统计表
2025-10-19 01:02:28,713 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 01:02:28,793 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3c7d63f6195eecb162425"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 8222.534200001974, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:46:37,705 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:46:37,705 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:46:38,388 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,389 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:46:38,390 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,391 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:46:38,398 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,399 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "remainingTimeMS": 4998}
2025-10-19 01:46:38,426 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:46:38,438 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "driverConnectionId": 1, "serverConnectionId": 45820, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.948399994755164, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:46:32.327Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45820, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:46:38,439 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,440 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>"}
2025-10-19 01:46:38,441 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,443 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,444 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a1"}, "driverConnectionId": 1, "serverConnectionId": 45820, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:46:38,445 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,532 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07246399999712594}
2025-10-19 01:46:38,533 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.08973090001381934}
2025-10-19 01:46:38,534 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ghpsrqy4Rv6Arlcc59up+w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,546 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "durationMS": 11.551, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,547 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,548 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:46:38,553 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:46:38.552881
2025-10-19 01:46:38,554 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,556 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,558 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,560 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001292400003876537}
2025-10-19 01:46:38,561 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ghpsrqy4Rv6Arlcc59up+w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,573 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "durationMS": 12.215, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,575 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,576 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}}
2025-10-19 01:46:38,577 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a1, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009948399994755164>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,578 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,578 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006297999934758991}
2025-10-19 01:46:38,579 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ghpsrqy4Rv6Arlcc59up+w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,591 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "durationMS": 11.859, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45822, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,592 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a1"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,593 - backend.dataSources.roce_event - INFO - 查询到 0 条记录，返回 0 条
2025-10-19 01:46:38,594 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 01:46:38,594 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 01:46:38,594 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:46:38,595 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:46:38,596 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 01:46:38,613 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x000001DDA5D42E90>
2025-10-19 01:46:38,614 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:46:38,617 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,618 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:46:38,618 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,619 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:46:38,622 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,623 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "remainingTimeMS": 4998}
2025-10-19 01:46:38,633 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:46:38,644 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "driverConnectionId": 1, "serverConnectionId": 45823, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 9.902299992972985, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:46:32.534Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45823, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:46:38,646 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,647 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "previousDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>"}
2025-10-19 01:46:38,648 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,649 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "driverConnectionId": 1, "serverConnectionId": 45823, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:46:38,650 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,651 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,743 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0684973000024911}
2025-10-19 01:46:38,744 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.09438120000413619}
2025-10-19 01:46:38,745 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+skbhrxuRdW3bLqsXOztlw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,755 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "durationMS": 10.27, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,756 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,758 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:46:38,758 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:46:38.758807
2025-10-19 01:46:38,759 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,761 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,762 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,763 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0009633000008761883}
2025-10-19 01:46:38,764 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+skbhrxuRdW3bLqsXOztlw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,777 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "durationMS": 12.966999999999999, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,778 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,779 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}}
2025-10-19 01:46:38,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d27e03cf94497256a4a2, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.009902299992972985>]>", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,782 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,784 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.002233899984275922}
2025-10-19 01:46:38,785 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"quick_finish\": {\"$ne\": \"\\u662f\"}, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809598}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+skbhrxuRdW3bLqsXOztlw==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,797 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "durationMS": 11.568, "reply": "{\"cursor\": {\"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45824, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:46:38,798 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:46:38,800 - backend.dataSources.roce_event - INFO - 查询到 0 条记录，返回 0 条
2025-10-19 01:46:38,801 - backend.dataSources.roce_event - INFO - 处理完成，共生成 0 条记录
2025-10-19 01:46:38,801 - backend.data_loader - WARNING - No ROCE event data retrieved (status=1)
2025-10-19 01:46:38,802 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:46:38,803 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 01:46:39,158 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d27e03cf94497256a4a2"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 509.5201999938581, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:47:36,758 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:47:36,759 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:47:37,084 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,085 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:47:37,085 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,086 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:47:37,089 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,090 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "remainingTimeMS": 4999}
2025-10-19 01:47:37,115 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:47:37,126 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "driverConnectionId": 1, "serverConnectionId": 45826, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.45709999743849, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:47:31.015Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45826, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:47:37,127 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,127 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>"}
2025-10-19 01:47:37,128 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,129 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c034"}, "driverConnectionId": 1, "serverConnectionId": 45826, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:47:37,129 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,130 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,194 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.052689600008307025}
2025-10-19 01:47:37,195 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06598869999288581}
2025-10-19 01:47:37,196 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,208 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 11.977, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,210 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,211 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:47:37,212 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:47:37.212269
2025-10-19 01:47:37,213 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,213 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,214 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,215 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005193999968469143}
2025-10-19 01:47:37,216 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,227 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 11.192, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 160}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,228 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,228 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,229 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,230 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,230 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005296000163070858}
2025-10-19 01:47:37,231 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,291 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 59.816, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f3cad3e563a8974deeb387\"}, \"event_id\": \"38400362\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"NXLT01\", \"hostname\": \"NX-LT-DC-ROCE_TOR-105_01.NX\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"NXLT012F05-B-14-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4911194\", \"server_name\": \"k2-gpu-57\", \"instance_id\": \"9cd500ba-28da-4cc6-9f99-20ad084c5a24\", \"server_user\": \"\u5317\u4eac\u6708\u4e4b\u6697\u9762\u79d1\u6280\u6709\u9650\u516c\u53f8\", \"server_uid\": \"2000169742\", \"server_rack\": \"NXLT012F05-A-06-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.248.16.49\", \"private_ip\": \"10.35.100.29\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_0\", \"optical_model_sn\": \"MY2426050407-1\", \"optical_model_name\": \"400G_BASE_SR4_QSFPDD\", \"optical_model_vendor\": \"TRILIGHT\", \"first_alarm\": \"2025-10-19 01:13:21\", \"first_...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,298 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,298 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}}
2025-10-19 01:47:37,299 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c034, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01045709999743849>]>", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,367 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,369 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0023382999934256077}
2025-10-19 01:47:37,370 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "command": "{\"getMore\": 2714353000932349629, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZyRDJz1fQpKMYgCX+dpI4w==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,397 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "durationMS": 27.27, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68cbad7278be70bd3047bb11\"}, \"event_id\": \"2727771869\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_03_07.QH\", \"portname\": \"FourHundredGigE1/0/17\", \"rack\": \"QHDX013F04-09-06-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"S514359X4C04797\", \"server_name\": \"hd1-g8-gm403rs-v7-151370-vxnvgvw8.kscn.idc.xiaomi.com\", \"instance_id\": \"67d9e024-1cbd-4c67-ab0c-4766f9579e79\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-10-02-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.11.46\", \"private_ip\": \"10.44.141.5\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_6\", \"first_alarm\": \"2025-09-18 14:57:21\", \"first_ts\": 1758178641838, \"last_alarm\": \"2025-09-18 14:57:21\", \"last_ts\": 1758178641838...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45828, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,399 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c034"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,400 - backend.dataSources.roce_event - INFO - 查询到 160 条记录，返回 160 条
2025-10-19 01:47:37,402 - backend.dataSources.roce_event - INFO - 处理完成，共生成 160 条记录
2025-10-19 01:47:37,403 - backend.data_loader - DEBUG - Loaded 160 records from MongoDB
2025-10-19 01:47:37,403 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:47:37,407 - backend.data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:47:37,407 - backend.database_builder - DEBUG - Initialized DatabaseBuilder with db_path: test_roce_event.db
2025-10-19 01:47:37,409 - backend.database_builder - DEBUG - Processing data source: <backend.data_loader.RoceEventDataSourceLoader object at 0x0000016F94993390>
2025-10-19 01:47:37,410 - backend.data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:47:37,417 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,417 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:47:37,418 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,421 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:47:37,424 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,425 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "remainingTimeMS": 4998}
2025-10-19 01:47:37,450 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:47:37,468 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "driverConnectionId": 1, "serverConnectionId": 45829, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 17.068999994080514, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:47:31.357Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45829, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:47:37,469 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,470 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "previousDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>"}
2025-10-19 01:47:37,471 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,471 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "driverConnectionId": 1, "serverConnectionId": 45829, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:47:37,472 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,473 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,537 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.05147829998168163}
2025-10-19 01:47:37,538 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06554670000332408}
2025-10-19 01:47:37,559 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,607 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 48.342000000000006, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,609 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,610 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:47:37,611 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:47:37.611286
2025-10-19 01:47:37,611 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,681 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,683 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,684 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007759000000078231}
2025-10-19 01:47:37,684 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,697 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 12.276, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 160}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,698 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,699 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,700 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,701 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,701 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005727999960072339}
2025-10-19 01:47:37,702 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809657}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,775 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 73.519, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f3cad3e563a8974deeb387\"}, \"event_id\": \"38400362\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"NXLT01\", \"hostname\": \"NX-LT-DC-ROCE_TOR-105_01.NX\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"NXLT012F05-B-14-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4911194\", \"server_name\": \"k2-gpu-57\", \"instance_id\": \"9cd500ba-28da-4cc6-9f99-20ad084c5a24\", \"server_user\": \"\u5317\u4eac\u6708\u4e4b\u6697\u9762\u79d1\u6280\u6709\u9650\u516c\u53f8\", \"server_uid\": \"2000169742\", \"server_rack\": \"NXLT012F05-A-06-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.248.16.49\", \"private_ip\": \"10.35.100.29\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_0\", \"optical_model_sn\": \"MY2426050407-1\", \"optical_model_name\": \"400G_BASE_SR4_QSFPDD\", \"optical_model_vendor\": \"TRILIGHT\", \"first_alarm\": \"2025-10-19 01:13:21\", \"first_...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,778 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,779 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}}
2025-10-19 01:47:37,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000016F94592F20>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2b90953952f8933c035, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.017068999994080514>]>", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,781 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,781 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006067999929655343}
2025-10-19 01:47:37,782 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "command": "{\"getMore\": 4228974682212664188, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"tpuLXb5DSbqvYsezOAk5VA==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,810 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "durationMS": 27.929, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68cbad7278be70bd3047bb11\"}, \"event_id\": \"2727771869\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_03_07.QH\", \"portname\": \"FourHundredGigE1/0/17\", \"rack\": \"QHDX013F04-09-06-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"S514359X4C04797\", \"server_name\": \"hd1-g8-gm403rs-v7-151370-vxnvgvw8.kscn.idc.xiaomi.com\", \"instance_id\": \"67d9e024-1cbd-4c67-ab0c-4766f9579e79\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-10-02-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.11.46\", \"private_ip\": \"10.44.141.5\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_6\", \"first_alarm\": \"2025-09-18 14:57:21\", \"first_ts\": 1758178641838, \"last_alarm\": \"2025-09-18 14:57:21\", \"last_ts\": 1758178641838...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45831, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:47:37,812 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:47:37,814 - backend.dataSources.roce_event - INFO - 查询到 160 条记录，返回 160 条
2025-10-19 01:47:37,817 - backend.dataSources.roce_event - INFO - 处理完成，共生成 160 条记录
2025-10-19 01:47:37,818 - backend.data_loader - DEBUG - Loaded 160 records from MongoDB
2025-10-19 01:47:37,819 - backend.data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:47:37,819 - backend.database_builder - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 01:47:37,820 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:47:37,828 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:47:37,830 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:47:37,831 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:47:37,832 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:47:37,833 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:47:37,833 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:47:37,834 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:47:37,835 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:47:37,836 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:47:37,837 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:47:37,838 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:47:37,838 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:47:37,839 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:47:37,840 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:47:37,874 - backend.database_builder - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 01:47:37,877 - backend.database_builder - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:47:37,878 - backend.database_builder - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:47:37,880 - backend.database_builder - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:47:37,880 - backend.database_builder - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:47:37,881 - backend.database_builder - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:47:37,881 - backend.database_builder - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:47:37,882 - backend.database_builder - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:47:37,882 - backend.database_builder - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:47:37,883 - backend.database_builder - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:47:37,883 - backend.database_builder - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:47:37,884 - backend.database_builder - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:47:37,884 - backend.database_builder - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:47:37,884 - backend.database_builder - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:47:37,885 - backend.database_builder - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:47:37,885 - backend.database_builder - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:47:37,889 - backend.database_builder - INFO - Inserted 160 records into table ROCE网络事件-光模块故障表
2025-10-19 01:47:37,915 - backend.database_builder - INFO - Database built/updated at test_roce_event.db (rebuild=True, status=0)
2025-10-19 01:47:37,984 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d2b90953952f8933c035"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 512.7061999810394, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:48:27,642 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:48:27,643 - data_loader - DEBUG - Initialized OpticalModuleInventoryDataSourceLoader with table 光模块在线总数量统计表
2025-10-19 01:48:27,643 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:48:27,644 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:48:27,647 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x000001BF9EE34C20>
2025-10-19 01:48:27,648 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:48:27,940 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:27,940 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "previousDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:48:27,941 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,942 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:48:27,944 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:27,945 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "remainingTimeMS": 4999}
2025-10-19 01:48:27,978 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:48:27,990 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 11.094399989815429, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:21.879Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:27,991 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,992 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "previousDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>"}
2025-10-19 01:48:27,992 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,993 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:27,993 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:27,994 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,063 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0588817999814637}
2025-10-19 01:48:28,152 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.1591760000155773}
2025-10-19 01:48:28,153 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,189 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 35.295, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,190 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,190 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:48:28,190 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:48:28.190920
2025-10-19 01:48:28,191 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:28,193 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,199 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,201 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001726700022118166}
2025-10-19 01:48:28,202 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:48:28.190Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,241 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 39.379, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,242 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,243 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:28,243 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,244 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,244 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004670000053010881}
2025-10-19 01:48:28,245 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:48:28.190Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,331 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 86.06, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,342 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,342 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000001BF9F0DF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}}
2025-10-19 01:48:28,343 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000001BF9F0DF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d2eb1f536ee34b756a39, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.011094399989815429>]>", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,344 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,344 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00046549999387934804}
2025-10-19 01:48:28,345 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "command": "{\"getMore\": 6418431684034829798, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"n48DtcHLSBm/+orfyaLUGw==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,726 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "durationMS": 381.798, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45835, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:48:28,729 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:48:28,730 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:48:28,781 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:48:28,790 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:48:28,791 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:48:28,791 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:48:28,792 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:48:28,797 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:48:28,798 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:48:28,799 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:48:28,802 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:48:28,803 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:48:28,804 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:48:28,806 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:48:28,806 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:48:28,807 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:48:28,808 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:48:28,809 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:48:28,810 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:48:28,811 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:48:28,811 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:48:28,812 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:48:28,813 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:48:28,891 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:48:28,892 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:48:28,893 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:48:28,894 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:48:28,895 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:48:28,895 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:48:28,896 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:48:28,896 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:48:28,897 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:48:28,897 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:48:28,898 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:48:28,898 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:48:28,899 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:48:28,900 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:48:28,901 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:48:28,902 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:48:28,902 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:48:28,903 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:48:28,928 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:48:28,929 - __main__ - DEBUG - Processing data source: <data_loader.OpticalModuleInventoryDataSourceLoader object at 0x000001BF9EE34D70>
2025-10-19 01:48:28,929 - data_loader - DEBUG - Loading optical module inventory data from API
2025-10-19 01:48:28,946 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2}
2025-10-19 01:48:28,982 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): 10.69.77.238:80
2025-10-19 01:48:28,983 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 2, "durationMS": 0.025399899983312935}
2025-10-19 01:48:28,985 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3}
2025-10-19 01:48:29,018 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 3, "durationMS": 0.023195399990072474}
2025-10-19 01:48:29,020 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4}
2025-10-19 01:48:29,053 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 4, "durationMS": 0.020676600019214675}
2025-10-19 01:48:29,054 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5}
2025-10-19 01:48:29,088 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 5, "durationMS": 0.022528299974510446}
2025-10-19 01:48:30,063 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:30,109 - backend.dataSources.optical_module_inventory - INFO - 首次返回 total = 104306
2025-10-19 01:48:30,112 - backend.dataSources.optical_module_inventory - INFO - 已请求页 1，返回 1000 条，累计已去重 1000 条 (reported total=104306)
2025-10-19 01:48:31,152 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:31,234 - backend.dataSources.optical_module_inventory - INFO - 第 2 页返回 total = 103306（变化，之前=104306）
2025-10-19 01:48:31,235 - backend.dataSources.optical_module_inventory - INFO - 已请求页 2，返回 1000 条，累计已去重 1000 条 (reported total=103306)
2025-10-19 01:48:32,271 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:32,319 - backend.dataSources.optical_module_inventory - INFO - 第 3 页返回 total = 102306（变化，之前=103306）
2025-10-19 01:48:32,320 - backend.dataSources.optical_module_inventory - INFO - 已请求页 3，返回 1000 条，累计已去重 2000 条 (reported total=102306)
2025-10-19 01:48:33,359 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:33,411 - backend.dataSources.optical_module_inventory - INFO - 第 4 页返回 total = 101306（变化，之前=102306）
2025-10-19 01:48:33,412 - backend.dataSources.optical_module_inventory - INFO - 已请求页 4，返回 1000 条，累计已去重 3000 条 (reported total=101306)
2025-10-19 01:48:34,462 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:34,533 - backend.dataSources.optical_module_inventory - INFO - 第 5 页返回 total = 100306（变化，之前=101306）
2025-10-19 01:48:34,534 - backend.dataSources.optical_module_inventory - INFO - 已请求页 5，返回 1000 条，累计已去重 4000 条 (reported total=100306)
2025-10-19 01:48:35,585 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:35,756 - backend.dataSources.optical_module_inventory - INFO - 第 6 页返回 total = 99306（变化，之前=100306）
2025-10-19 01:48:35,759 - backend.dataSources.optical_module_inventory - INFO - 已请求页 6，返回 1000 条，累计已去重 5000 条 (reported total=99306)
2025-10-19 01:48:36,781 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:36,888 - backend.dataSources.optical_module_inventory - INFO - 第 7 页返回 total = 98306（变化，之前=99306）
2025-10-19 01:48:36,888 - backend.dataSources.optical_module_inventory - INFO - 已请求页 7，返回 1000 条，累计已去重 6000 条 (reported total=98306)
2025-10-19 01:48:37,884 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:37,924 - backend.dataSources.optical_module_inventory - INFO - 第 8 页返回 total = 97306（变化，之前=98306）
2025-10-19 01:48:37,925 - backend.dataSources.optical_module_inventory - INFO - 已请求页 8，返回 1000 条，累计已去重 7000 条 (reported total=97306)
2025-10-19 01:48:38,016 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10021.683200000552, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:31.904Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:38,017 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:38,907 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:38,955 - backend.dataSources.optical_module_inventory - INFO - 第 9 页返回 total = 96306（变化，之前=97306）
2025-10-19 01:48:38,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 9，返回 1000 条，累计已去重 8000 条 (reported total=96306)
2025-10-19 01:48:39,927 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:39,967 - backend.dataSources.optical_module_inventory - INFO - 第 10 页返回 total = 95306（变化，之前=96306）
2025-10-19 01:48:39,967 - backend.dataSources.optical_module_inventory - INFO - 已请求页 10，返回 1000 条，累计已去重 9000 条 (reported total=95306)
2025-10-19 01:48:40,934 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:40,982 - backend.dataSources.optical_module_inventory - INFO - 第 11 页返回 total = 94306（变化，之前=95306）
2025-10-19 01:48:40,983 - backend.dataSources.optical_module_inventory - INFO - 已请求页 11，返回 1000 条，累计已去重 10000 条 (reported total=94306)
2025-10-19 01:48:41,957 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:42,009 - backend.dataSources.optical_module_inventory - INFO - 第 12 页返回 total = 93306（变化，之前=94306）
2025-10-19 01:48:42,010 - backend.dataSources.optical_module_inventory - INFO - 已请求页 12，返回 1000 条，累计已去重 11000 条 (reported total=93306)
2025-10-19 01:48:43,113 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:43,151 - backend.dataSources.optical_module_inventory - INFO - 第 13 页返回 total = 92306（变化，之前=93306）
2025-10-19 01:48:43,151 - backend.dataSources.optical_module_inventory - INFO - 已请求页 13，返回 1000 条，累计已去重 12000 条 (reported total=92306)
2025-10-19 01:48:44,141 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:44,188 - backend.dataSources.optical_module_inventory - INFO - 第 14 页返回 total = 91306（变化，之前=92306）
2025-10-19 01:48:44,189 - backend.dataSources.optical_module_inventory - INFO - 已请求页 14，返回 1000 条，累计已去重 13000 条 (reported total=91306)
2025-10-19 01:48:45,117 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:45,154 - backend.dataSources.optical_module_inventory - INFO - 第 15 页返回 total = 90306（变化，之前=91306）
2025-10-19 01:48:45,155 - backend.dataSources.optical_module_inventory - INFO - 已请求页 15，返回 1000 条，累计已去重 14000 条 (reported total=90306)
2025-10-19 01:48:46,070 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:46,107 - backend.dataSources.optical_module_inventory - INFO - 第 16 页返回 total = 89306（变化，之前=90306）
2025-10-19 01:48:46,107 - backend.dataSources.optical_module_inventory - INFO - 已请求页 16，返回 1000 条，累计已去重 15000 条 (reported total=89306)
2025-10-19 01:48:47,022 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:47,069 - backend.dataSources.optical_module_inventory - INFO - 第 17 页返回 total = 88306（变化，之前=89306）
2025-10-19 01:48:47,070 - backend.dataSources.optical_module_inventory - INFO - 已请求页 17，返回 1000 条，累计已去重 16000 条 (reported total=88306)
2025-10-19 01:48:48,019 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:48,027 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10008.631400007289, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:41.915Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:48,030 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:48,061 - backend.dataSources.optical_module_inventory - INFO - 第 18 页返回 total = 87306（变化，之前=88306）
2025-10-19 01:48:48,062 - backend.dataSources.optical_module_inventory - INFO - 已请求页 18，返回 1000 条，累计已去重 17000 条 (reported total=87306)
2025-10-19 01:48:48,957 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:49,003 - backend.dataSources.optical_module_inventory - INFO - 第 19 页返回 total = 86306（变化，之前=87306）
2025-10-19 01:48:49,004 - backend.dataSources.optical_module_inventory - INFO - 已请求页 19，返回 1000 条，累计已去重 18000 条 (reported total=86306)
2025-10-19 01:48:49,920 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:49,956 - backend.dataSources.optical_module_inventory - INFO - 第 20 页返回 total = 85306（变化，之前=86306）
2025-10-19 01:48:49,957 - backend.dataSources.optical_module_inventory - INFO - 已请求页 20，返回 1000 条，累计已去重 19000 条 (reported total=85306)
2025-10-19 01:48:50,849 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:50,891 - backend.dataSources.optical_module_inventory - INFO - 第 21 页返回 total = 84306（变化，之前=85306）
2025-10-19 01:48:50,891 - backend.dataSources.optical_module_inventory - INFO - 已请求页 21，返回 1000 条，累计已去重 20000 条 (reported total=84306)
2025-10-19 01:48:51,772 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:51,815 - backend.dataSources.optical_module_inventory - INFO - 第 22 页返回 total = 83306（变化，之前=84306）
2025-10-19 01:48:51,816 - backend.dataSources.optical_module_inventory - INFO - 已请求页 22，返回 1000 条，累计已去重 21000 条 (reported total=83306)
2025-10-19 01:48:52,683 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:52,726 - backend.dataSources.optical_module_inventory - INFO - 第 23 页返回 total = 82306（变化，之前=83306）
2025-10-19 01:48:52,726 - backend.dataSources.optical_module_inventory - INFO - 已请求页 23，返回 1000 条，累计已去重 22000 条 (reported total=82306)
2025-10-19 01:48:53,585 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:53,631 - backend.dataSources.optical_module_inventory - INFO - 第 24 页返回 total = 81306（变化，之前=82306）
2025-10-19 01:48:53,632 - backend.dataSources.optical_module_inventory - INFO - 已请求页 24，返回 1000 条，累计已去重 23000 条 (reported total=81306)
2025-10-19 01:48:54,483 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:54,523 - backend.dataSources.optical_module_inventory - INFO - 第 25 页返回 total = 80306（变化，之前=81306）
2025-10-19 01:48:54,524 - backend.dataSources.optical_module_inventory - INFO - 已请求页 25，返回 1000 条，累计已去重 24000 条 (reported total=80306)
2025-10-19 01:48:55,365 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:55,409 - backend.dataSources.optical_module_inventory - INFO - 第 26 页返回 total = 79306（变化，之前=80306）
2025-10-19 01:48:55,410 - backend.dataSources.optical_module_inventory - INFO - 已请求页 26，返回 1000 条，累计已去重 25000 条 (reported total=79306)
2025-10-19 01:48:56,244 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:56,281 - backend.dataSources.optical_module_inventory - INFO - 第 27 页返回 total = 78306（变化，之前=79306）
2025-10-19 01:48:56,281 - backend.dataSources.optical_module_inventory - INFO - 已请求页 27，返回 1000 条，累计已去重 26000 条 (reported total=78306)
2025-10-19 01:48:57,114 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:57,158 - backend.dataSources.optical_module_inventory - INFO - 第 28 页返回 total = 77306（变化，之前=78306）
2025-10-19 01:48:57,159 - backend.dataSources.optical_module_inventory - INFO - 已请求页 28，返回 1000 条，累计已去重 27000 条 (reported total=77306)
2025-10-19 01:48:57,990 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:58,030 - backend.dataSources.optical_module_inventory - INFO - 第 29 页返回 total = 76306（变化，之前=77306）
2025-10-19 01:48:58,031 - backend.dataSources.optical_module_inventory - INFO - 已请求页 29，返回 1000 条，累计已去重 28000 条 (reported total=76306)
2025-10-19 01:48:58,041 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10009.770199976629, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:48:51.926Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:48:58,043 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:48:58,856 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:58,903 - backend.dataSources.optical_module_inventory - INFO - 第 30 页返回 total = 75306（变化，之前=76306）
2025-10-19 01:48:58,903 - backend.dataSources.optical_module_inventory - INFO - 已请求页 30，返回 1000 条，累计已去重 29000 条 (reported total=75306)
2025-10-19 01:48:59,717 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:48:59,758 - backend.dataSources.optical_module_inventory - INFO - 第 31 页返回 total = 74306（变化，之前=75306）
2025-10-19 01:48:59,759 - backend.dataSources.optical_module_inventory - INFO - 已请求页 31，返回 1000 条，累计已去重 30000 条 (reported total=74306)
2025-10-19 01:49:00,606 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:00,652 - backend.dataSources.optical_module_inventory - INFO - 第 32 页返回 total = 73306（变化，之前=74306）
2025-10-19 01:49:00,652 - backend.dataSources.optical_module_inventory - INFO - 已请求页 32，返回 1000 条，累计已去重 31000 条 (reported total=73306)
2025-10-19 01:49:01,478 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:01,525 - backend.dataSources.optical_module_inventory - INFO - 第 33 页返回 total = 72306（变化，之前=73306）
2025-10-19 01:49:01,525 - backend.dataSources.optical_module_inventory - INFO - 已请求页 33，返回 1000 条，累计已去重 32000 条 (reported total=72306)
2025-10-19 01:49:02,345 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:02,389 - backend.dataSources.optical_module_inventory - INFO - 第 34 页返回 total = 71306（变化，之前=72306）
2025-10-19 01:49:02,390 - backend.dataSources.optical_module_inventory - INFO - 已请求页 34，返回 1000 条，累计已去重 33000 条 (reported total=71306)
2025-10-19 01:49:03,188 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:03,239 - backend.dataSources.optical_module_inventory - INFO - 第 35 页返回 total = 70306（变化，之前=71306）
2025-10-19 01:49:03,240 - backend.dataSources.optical_module_inventory - INFO - 已请求页 35，返回 1000 条，累计已去重 34000 条 (reported total=70306)
2025-10-19 01:49:04,099 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:04,158 - backend.dataSources.optical_module_inventory - INFO - 第 36 页返回 total = 69306（变化，之前=70306）
2025-10-19 01:49:04,159 - backend.dataSources.optical_module_inventory - INFO - 已请求页 36，返回 1000 条，累计已去重 35000 条 (reported total=69306)
2025-10-19 01:49:05,024 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:05,062 - backend.dataSources.optical_module_inventory - INFO - 第 37 页返回 total = 68306（变化，之前=69306）
2025-10-19 01:49:05,063 - backend.dataSources.optical_module_inventory - INFO - 已请求页 37，返回 1000 条，累计已去重 36000 条 (reported total=68306)
2025-10-19 01:49:05,844 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:05,889 - backend.dataSources.optical_module_inventory - INFO - 第 38 页返回 total = 67306（变化，之前=68306）
2025-10-19 01:49:05,890 - backend.dataSources.optical_module_inventory - INFO - 已请求页 38，返回 1000 条，累计已去重 37000 条 (reported total=67306)
2025-10-19 01:49:06,717 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:06,756 - backend.dataSources.optical_module_inventory - INFO - 第 39 页返回 total = 66306（变化，之前=67306）
2025-10-19 01:49:06,757 - backend.dataSources.optical_module_inventory - INFO - 已请求页 39，返回 1000 条，累计已去重 38000 条 (reported total=66306)
2025-10-19 01:49:07,598 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:07,638 - backend.dataSources.optical_module_inventory - INFO - 第 40 页返回 total = 65306（变化，之前=66306）
2025-10-19 01:49:07,639 - backend.dataSources.optical_module_inventory - INFO - 已请求页 40，返回 1000 条，累计已去重 39000 条 (reported total=65306)
2025-10-19 01:49:08,069 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 10024.575499992352, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:49:01.936Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45833, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:49:08,083 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "driverConnectionId": 1, "serverConnectionId": 45833, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:49:08,439 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:08,495 - backend.dataSources.optical_module_inventory - INFO - 第 41 页返回 total = 64306（变化，之前=65306）
2025-10-19 01:49:08,496 - backend.dataSources.optical_module_inventory - INFO - 已请求页 41，返回 1000 条，累计已去重 40000 条 (reported total=64306)
2025-10-19 01:49:09,315 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:09,355 - backend.dataSources.optical_module_inventory - INFO - 第 42 页返回 total = 63306（变化，之前=64306）
2025-10-19 01:49:09,356 - backend.dataSources.optical_module_inventory - INFO - 已请求页 42，返回 1000 条，累计已去重 41000 条 (reported total=63306)
2025-10-19 01:49:10,134 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:10,173 - backend.dataSources.optical_module_inventory - INFO - 第 43 页返回 total = 62306（变化，之前=63306）
2025-10-19 01:49:10,174 - backend.dataSources.optical_module_inventory - INFO - 已请求页 43，返回 1000 条，累计已去重 42000 条 (reported total=62306)
2025-10-19 01:49:10,937 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:10,981 - backend.dataSources.optical_module_inventory - INFO - 第 44 页返回 total = 61306（变化，之前=62306）
2025-10-19 01:49:10,982 - backend.dataSources.optical_module_inventory - INFO - 已请求页 44，返回 1000 条，累计已去重 43000 条 (reported total=61306)
2025-10-19 01:49:11,737 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:11,777 - backend.dataSources.optical_module_inventory - INFO - 第 45 页返回 total = 60306（变化，之前=61306）
2025-10-19 01:49:11,777 - backend.dataSources.optical_module_inventory - INFO - 已请求页 45，返回 1000 条，累计已去重 44000 条 (reported total=60306)
2025-10-19 01:49:12,523 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:12,569 - backend.dataSources.optical_module_inventory - INFO - 第 46 页返回 total = 59306（变化，之前=60306）
2025-10-19 01:49:12,569 - backend.dataSources.optical_module_inventory - INFO - 已请求页 46，返回 1000 条，累计已去重 45000 条 (reported total=59306)
2025-10-19 01:49:13,307 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:13,355 - backend.dataSources.optical_module_inventory - INFO - 第 47 页返回 total = 58306（变化，之前=59306）
2025-10-19 01:49:13,356 - backend.dataSources.optical_module_inventory - INFO - 已请求页 47，返回 1000 条，累计已去重 46000 条 (reported total=58306)
2025-10-19 01:49:14,084 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:14,127 - backend.dataSources.optical_module_inventory - INFO - 第 48 页返回 total = 57306（变化，之前=58306）
2025-10-19 01:49:14,127 - backend.dataSources.optical_module_inventory - INFO - 已请求页 48，返回 1000 条，累计已去重 47000 条 (reported total=57306)
2025-10-19 01:49:14,853 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:14,892 - backend.dataSources.optical_module_inventory - INFO - 第 49 页返回 total = 56306（变化，之前=57306）
2025-10-19 01:49:14,893 - backend.dataSources.optical_module_inventory - INFO - 已请求页 49，返回 1000 条，累计已去重 48000 条 (reported total=56306)
2025-10-19 01:49:15,604 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:15,646 - backend.dataSources.optical_module_inventory - INFO - 第 50 页返回 total = 55306（变化，之前=56306）
2025-10-19 01:49:15,647 - backend.dataSources.optical_module_inventory - INFO - 已请求页 50，返回 1000 条，累计已去重 49000 条 (reported total=55306)
2025-10-19 01:49:16,350 - urllib3.connectionpool - DEBUG - http://10.69.77.238:80 "POST /open-apis/netware/get-acc-info HTTP/1.1" 200 None
2025-10-19 01:49:16,396 - backend.dataSources.optical_module_inventory - INFO - 第 51 页返回 total = 54306（变化，之前=55306）
2025-10-19 01:49:16,397 - backend.dataSources.optical_module_inventory - INFO - 已请求页 51，返回 1000 条，累计已去重 50000 条 (reported total=54306)
2025-10-19 01:49:17,104 - data_loader - INFO - Optical module inventory data load completed (status=0)
2025-10-19 01:49:17,295 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d2eb1f536ee34b756a39"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 9211.830800020834, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:49:34,393 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:49:34,394 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:49:34,394 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:49:34,396 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000027888694C20>
2025-10-19 01:49:34,397 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:49:34,948 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:34,949 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "previousDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:49:34,950 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:34,951 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:49:34,955 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:34,956 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "remainingTimeMS": 4999}
2025-10-19 01:49:34,984 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:49:35,000 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "driverConnectionId": 1, "serverConnectionId": 45840, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 13.821500004269183, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:49:28.887Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45840, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:49:35,003 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,005 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "previousDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>"}
2025-10-19 01:49:35,006 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,008 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "driverConnectionId": 1, "serverConnectionId": 45840, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:49:35,009 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,013 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,089 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06170149997342378}
2025-10-19 01:49:35,089 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.07991000000038184}
2025-10-19 01:49:35,090 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,101 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 11.093, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,102 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,103 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:49:35,103 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:49:35.103674
2025-10-19 01:49:35,104 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:35,105 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,106 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,106 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00050970001029782}
2025-10-19 01:49:35,107 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:49:35.103Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,128 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 21.456, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,129 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,130 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:35,131 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,133 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,134 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.001124100002925843}
2025-10-19 01:49:35,134 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:49:35.103Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,204 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 69.823, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,207 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,208 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}}
2025-10-19 01:49:35,209 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32e8d9f483a16c6163b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.013821500004269183>]>", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,210 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,211 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006693000032100827}
2025-10-19 01:49:35,212 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "command": "{\"getMore\": 5855557928888166629, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uKjoiIW+QbyY2GU5AeUNVQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,510 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "durationMS": 298.211, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45842, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,511 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32e8d9f483a16c6163b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,513 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:49:35,543 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:49:35,548 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:49:35,549 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:49:35,549 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:49:35,550 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,553 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:49:35,554 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,555 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:49:35,556 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:49:35,556 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:49:35,557 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:49:35,557 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:49:35,558 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,559 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,559 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,560 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,560 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:49:35,561 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:49:35,562 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:49:35,563 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:49:35,563 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:49:35,610 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:49:35,611 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,612 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:49:35,613 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,613 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:49:35,614 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:49:35,614 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:49:35,615 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:49:35,615 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:49:35,615 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,616 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,616 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,616 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,617 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:49:35,617 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:49:35,618 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:49:35,618 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:49:35,618 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:49:35,637 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:49:35,638 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000027888694D70>
2025-10-19 01:49:35,638 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:49:35,642 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,643 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "previousDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:49:35,644 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,645 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:49:35,648 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,650 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "remainingTimeMS": 4998}
2025-10-19 01:49:35,659 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:49:35,671 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "driverConnectionId": 1, "serverConnectionId": 45843, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.85120000061579, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:49:29.559Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45843, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:49:35,672 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,672 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "previousDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>"}
2025-10-19 01:49:35,673 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,674 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "driverConnectionId": 1, "serverConnectionId": 45843, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:49:35,674 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,675 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,735 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04888439999194816}
2025-10-19 01:49:35,736 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06161560001783073}
2025-10-19 01:49:35,737 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,747 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 10.097999999999999, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,748 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,748 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:49:35,749 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:49:35.749366
2025-10-19 01:49:35,750 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,751 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,752 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,753 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007989000005181879}
2025-10-19 01:49:35,754 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809775}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,766 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 12.548, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 160}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,767 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,768 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,769 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,771 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,772 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0008448000007774681}
2025-10-19 01:49:35,773 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809775}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,833 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 60.262, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68f3cad3e563a8974deeb387\"}, \"event_id\": \"38400362\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"NXLT01\", \"hostname\": \"NX-LT-DC-ROCE_TOR-105_01.NX\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"NXLT012F05-B-14-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4911194\", \"server_name\": \"k2-gpu-57\", \"instance_id\": \"9cd500ba-28da-4cc6-9f99-20ad084c5a24\", \"server_user\": \"\u5317\u4eac\u6708\u4e4b\u6697\u9762\u79d1\u6280\u6709\u9650\u516c\u53f8\", \"server_uid\": \"2000169742\", \"server_rack\": \"NXLT012F05-A-06-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.248.16.49\", \"private_ip\": \"10.35.100.29\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_0\", \"optical_model_sn\": \"MY2426050407-1\", \"optical_model_name\": \"400G_BASE_SR4_QSFPDD\", \"optical_model_vendor\": \"TRILIGHT\", \"first_alarm\": \"2025-10-19 01:13:21\", \"first_...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,834 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,835 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}}
2025-10-19 01:49:35,836 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002788893F600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d32f8d9f483a16c6163c, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01085120000061579>]>", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,837 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,837 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0007019999902695417}
2025-10-19 01:49:35,838 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "command": "{\"getMore\": 9017833390748816960, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Ynx3tQhkS1yChQOyIHpYyQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,860 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "durationMS": 21.602, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68cbad7278be70bd3047bb11\"}, \"event_id\": \"2727771869\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_03_07.QH\", \"portname\": \"FourHundredGigE1/0/17\", \"rack\": \"QHDX013F04-09-06-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"S514359X4C04797\", \"server_name\": \"hd1-g8-gm403rs-v7-151370-vxnvgvw8.kscn.idc.xiaomi.com\", \"instance_id\": \"67d9e024-1cbd-4c67-ab0c-4766f9579e79\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-10-02-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.11.46\", \"private_ip\": \"10.44.141.5\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_6\", \"first_alarm\": \"2025-09-18 14:57:21\", \"first_ts\": 1758178641838, \"last_alarm\": \"2025-09-18 14:57:21\", \"last_ts\": 1758178641838...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45845, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:49:35,861 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:49:35,863 - backend.dataSources.roce_event - INFO - 查询到 160 条记录，返回 160 条
2025-10-19 01:49:35,865 - backend.dataSources.roce_event - INFO - 处理完成，共生成 160 条记录
2025-10-19 01:49:35,866 - data_loader - DEBUG - Loaded 160 records from MongoDB
2025-10-19 01:49:35,866 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:49:35,867 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 01:49:35,868 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,868 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,869 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:49:35,870 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:49:35,871 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:49:35,872 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,873 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,873 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,874 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:49:35,875 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:49:35,875 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,876 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:49:35,877 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:49:35,879 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:49:35,880 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:49:35,890 - __main__ - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 01:49:35,891 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:49:35,891 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:49:35,892 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:49:35,892 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:49:35,892 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:49:35,893 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:49:35,893 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:49:35,894 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:49:35,894 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:49:35,895 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:49:35,896 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:49:35,897 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:49:35,897 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:49:35,898 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:49:35,898 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:49:35,902 - __main__ - INFO - Inserted 160 records into table ROCE网络事件-光模块故障表
2025-10-19 01:49:35,931 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 01:49:36,190 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d32f8d9f483a16c6163c"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 515.8074999926612, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-10-19 01:51:38,573 - data_loader - DEBUG - Initialized OpticalFailureDataSourceLoader with table 事件监控-光模块故障表
2025-10-19 01:51:38,574 - data_loader - DEBUG - Initialized RoceEventDataSourceLoader with table ROCE网络事件-光模块故障表
2025-10-19 01:51:38,574 - __main__ - DEBUG - Initialized DatabaseBuilder with db_path: custom_database.db
2025-10-19 01:51:38,575 - __main__ - DEBUG - Processing data source: <data_loader.OpticalFailureDataSourceLoader object at 0x0000015526934C20>
2025-10-19 01:51:38,576 - data_loader - DEBUG - Loading optical failure data from MongoDB
2025-10-19 01:51:38,885 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:38,886 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "previousDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:51:38,886 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,887 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:51:38,890 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:38,890 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "remainingTimeMS": 4999}
2025-10-19 01:51:38,900 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:51:38,911 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "driverConnectionId": 1, "serverConnectionId": 45848, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 10.100999992573634, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:51:32.804Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45848, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:51:38,912 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,913 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "previousDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>"}
2025-10-19 01:51:38,913 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,914 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,914 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "driverConnectionId": 1, "serverConnectionId": 45848, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:51:38,915 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:38,975 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0491436000156682}
2025-10-19 01:51:38,976 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.06218859998625703}
2025-10-19 01:51:38,977 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,989 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 11.888, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 6334, "operationId": 6334, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,990 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:38,990 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/network_event
2025-10-19 01:51:38,991 - backend.dataSources.optical_failure - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:51:38.990963
2025-10-19 01:51:38,991 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:38,992 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,992 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:38,993 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005557000113185495}
2025-10-19 01:51:38,993 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"aggregate\": \"event\", \"pipeline\": [{\"$match\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:51:38.990Z\"}}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,012 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 18.787000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 1226}], \"ns\": \"network_event.event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "network_event", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,013 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,014 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:39,014 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,015 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,016 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005109999910928309}
2025-10-19 01:51:39,016 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"find\": \"event\", \"filter\": {\"event_type\": \"NetworkDeviceInterface\", \"status_code\": 100, \"is_one_click_finish\": {\"$ne\": \"\\u4e00\\u952e\\u5b8c\\u6210\"}, \"starts_at\": {\"$gte\": {\"$date\": \"2025-07-21T00:00:00Z\"}, \"$lte\": {\"$date\": \"2025-10-19T01:51:38.990Z\"}}}, \"sort\": {\"starts_at\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,088 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 71.54299999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68d620b918b99eb113ff5895\"}, \"event_id\": \"1420131459891200\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QY-ZNJ-DC-ROCE_AGG-01_01_01_21.QY\", \"interface_name\": \"FourHundredGigE1/0/65\", \"device_rack\": \"QYZNJ012F03-J-12-25\", \"device_ip\": \"172.30.218.40\", \"device_role\": \"DC-ROCE_AGG\", \"device_idc\": \"QYZNJ01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QY-ZNJ-DC-ROCE_TOR-01_01_05_01.QY\", \"remote_interface_name\": \"FourHundredGigE1/0/88\", \"remote_device_rack\": \"QYZNJ013F04-J-01-25\", \"remote_device_ip\": \"172.30.218.84\", \"remote_device_role\": \"DC-ROCE_TOR\", \"remote_device_idc\": \"QYZNJ01\", \"remote_link_status\": \"IDLE\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\"...", "commandName": "find", "databaseName": "network_event", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,091 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,091 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}}
2025-10-19 01:51:39,092 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3aa6dba7b83003abe5a, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.010100999992573634>]>", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,092 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,093 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0006219999922905117}
2025-10-19 01:51:39,094 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "command": "{\"getMore\": 1487922067613449280, \"collection\": \"event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"6O5K7VZvRgioZ0ino924DQ==\", \"subType\": \"04\"}}}, \"$db\": \"network_event\"}", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,359 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "durationMS": 265.223, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68aed16bb16b8a00e7bf9123\"}, \"event_id\": \"1377922898722816\", \"policy_id\": \"5b9e6652-75f4-4536-9c38-c7ad2dcde5fc\", \"event_product\": \"basicnet\", \"event_class\": \"Basicnet\", \"event_type\": \"NetworkDeviceInterface\", \"event_code\": \"BGP_PRO_FLAPPING\", \"event_name\": \"BGP\u534f\u8bae\", \"event_status\": \"\u5df2\u5b8c\u6210\", \"status_code\": 100, \"hostname\": \"QH-QHDX-AZ-ROCE_AGG-02_01_01_46.QH\", \"interface_name\": \"FourHundredGigE1/0/17\", \"device_rack\": \"QHDX013F03-08-05-22\", \"device_ip\": \"172.30.47.14\", \"device_role\": \"AZ-ROCE_AGG\", \"device_idc\": \"QHDX01\", \"link_status\": \"IDLE\", \"product_type\": \"\u4ea4\u6362\u673a\", \"remote_hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_10_01.QH\", \"remote_interface_name\": \"FourHundredGigE1/0/102\", \"remote_device_rack\": \"QHDX014F03-05-07-25\", \"remote_device_ip\": \"172.30.47.41\", \"remote_device_role\": \"AZ-ROCE_TOR\", \"remote_device_idc\": \"QHDX01\", \"remote_product_type\": \"\u4ea4\u6362\u673a\", \"alert_count\": 1, \"last_alert_status\": \"firin...", "commandName": "getMore", "databaseName": "network_event", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 45850, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,360 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3aa6dba7b83003abe5a"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,361 - backend.dataSources.optical_failure - INFO - 查询到 1226 条记录，返回 1226 条
2025-10-19 01:51:39,384 - backend.dataSources.optical_failure - INFO - 处理完成，共生成 1333 条记录
2025-10-19 01:51:39,388 - data_loader - DEBUG - Loaded 1333 records from MongoDB
2025-10-19 01:51:39,388 - data_loader - INFO - Optical failure data load completed (status=0)
2025-10-19 01:51:39,389 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件类型', '事件名称', '开始时间', '隔离时间', '结束时间', '设备主机名', '设备端口名称', '光模块型号', '光模块厂商', '机房', '集群', '客户', '故障数', '认领时间', '建单时间', '操作时间']
2025-10-19 01:51:39,389 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,392 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:51:39,393 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,394 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:51:39,394 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:51:39,395 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:51:39,396 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:51:39,396 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:51:39,397 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,398 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,398 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,399 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,399 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:51:39,400 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:51:39,400 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:51:39,401 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:51:39,401 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:51:39,440 - __main__ - INFO - Rebuilt table 事件监控-光模块故障表 from 事件监控-光模块故障表
2025-10-19 01:51:39,440 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,440 - __main__ - DEBUG - Sanitized name: 事件类型 -> 事件类型
2025-10-19 01:51:39,441 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,441 - __main__ - DEBUG - Sanitized name: 开始时间 -> 开始时间
2025-10-19 01:51:39,441 - __main__ - DEBUG - Sanitized name: 隔离时间 -> 隔离时间
2025-10-19 01:51:39,442 - __main__ - DEBUG - Sanitized name: 结束时间 -> 结束时间
2025-10-19 01:51:39,442 - __main__ - DEBUG - Sanitized name: 设备主机名 -> 设备主机名
2025-10-19 01:51:39,442 - __main__ - DEBUG - Sanitized name: 设备端口名称 -> 设备端口名称
2025-10-19 01:51:39,443 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,443 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,443 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,444 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,444 - __main__ - DEBUG - Sanitized name: 客户 -> 客户
2025-10-19 01:51:39,445 - __main__ - DEBUG - Sanitized name: 故障数 -> 故障数
2025-10-19 01:51:39,445 - __main__ - DEBUG - Sanitized name: 认领时间 -> 认领时间
2025-10-19 01:51:39,445 - __main__ - DEBUG - Sanitized name: 建单时间 -> 建单时间
2025-10-19 01:51:39,446 - __main__ - DEBUG - Sanitized name: 操作时间 -> 操作时间
2025-10-19 01:51:39,460 - __main__ - INFO - Inserted 1333 records into table 事件监控-光模块故障表
2025-10-19 01:51:39,460 - __main__ - DEBUG - Processing data source: <data_loader.RoceEventDataSourceLoader object at 0x0000015526934D70>
2025-10-19 01:51:39,461 - data_loader - DEBUG - Loading ROCE event data from MongoDB
2025-10-19 01:51:39,499 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,502 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "previousDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>"}
2025-10-19 01:51:39,503 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,580 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "maxPoolSize": 50, "minPoolSize": 5}
2025-10-19 01:51:39,608 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,610 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "remainingTimeMS": 4998}
2025-10-19 01:51:39,619 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "driverConnectionId": 1, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false}
2025-10-19 01:51:39,637 - pymongo.topology - DEBUG - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "driverConnectionId": 1, "serverConnectionId": 45851, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": false, "durationMS": 16.80290000513196, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689c348dde6b9b0749267f44\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-10-18T17:51:33.524Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 45851, \"maxWireVersion\": 17, \"ok\": 1.0}"}
2025-10-19 01:51:39,644 - pymongo.connection - DEBUG - {"message": "Connection pool ready", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,651 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "previousDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Unknown, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>"}
2025-10-19 01:51:39,652 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,653 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,654 - pymongo.connection - DEBUG - {"message": "Connection created", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,654 - pymongo.topology - DEBUG - {"message": "Server heartbeat started", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "driverConnectionId": 1, "serverConnectionId": 45851, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true}
2025-10-19 01:51:39,713 - pymongo.connection - DEBUG - {"message": "Connection ready", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.04563830001279712}
2025-10-19 01:51:39,713 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.060567300010006875}
2025-10-19 01:51:39,714 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,726 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 11.494000000000002, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,727 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,728 - backend.dataSources.mongodb_connector - INFO - MongoDB连接成功: 10.69.74.235:8526/alertpolicy
2025-10-19 01:51:39,728 - backend.dataSources.roce_event - INFO - 查询时间范围: 2025-07-21 00:00:00 至 2025-10-19 01:51:39.728426
2025-10-19 01:51:39,729 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,729 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "count", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,730 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,730 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0004674999800045043}
2025-10-19 01:51:39,731 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"aggregate\": \"roce_event\", \"pipeline\": [{\"$match\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809899}}}, {\"$group\": {\"_id\": 1, \"n\": {\"$sum\": 1}}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,742 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 11.280999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": 1, \"n\": 106}], \"ns\": \"alertpolicy.roce_event\"}, \"ok\": 1.0}", "commandName": "aggregate", "databaseName": "alertpolicy", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,743 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,744 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,745 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,746 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,747 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.0005870999884791672}
2025-10-19 01:51:39,747 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"find\": \"roce_event\", \"filter\": {\"event_code\": \"CRC_ERROR\", \"process_code\": 40, \"create_ts\": {\"$gte\": 1753027200, \"$lte\": 1760809899}}, \"sort\": {\"create_ts\": -1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,798 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 50.856, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68cd0766269d3ff30ed547f0\"}, \"event_id\": \"1505554303\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_02_05.QH\", \"portname\": \"FourHundredGigE1/0/40\", \"rack\": \"QHDX013F04-08-06-23\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X4910834\", \"server_name\": \"hd1-g8-gm403rs-v7-151373-rrfbkbzm.kscn.idc.xiaomi.com\", \"instance_id\": \"b70e7899-ac9d-4780-b78d-b1a231806dfa\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F04-05-10-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.6.24\", \"private_ip\": \"10.44.136.120\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_4\", \"first_alarm\": \"2025-09-19 15:33:55\", \"first_ts\": 1758267235943, \"last_alarm\": \"2025-09-19 15:37:06.993\", \"last_ts\": 1758267...", "commandName": "find", "databaseName": "alertpolicy", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,799 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,800 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}}
2025-10-19 01:51:39,800 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x0000015526BDF600>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68f3d3ab6dba7b83003abe5b, topology_type: Single, servers: [<ServerDescription ('10.69.74.235', 8526) server_type: Standalone, rtt: 0.01680290000513196>]>", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,801 - pymongo.connection - DEBUG - {"message": "Connection checkout started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,801 - pymongo.connection - DEBUG - {"message": "Connection checked out", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1, "durationMS": 0.00036540001747198403}
2025-10-19 01:51:39,802 - pymongo.command - DEBUG - {"message": "Command started", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "command": "{\"getMore\": 2560297683458713375, \"collection\": \"roce_event\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"95CQerbpR6ekRI/b0aEbNQ==\", \"subType\": \"04\"}}}, \"$db\": \"alertpolicy\"}", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,812 - pymongo.command - DEBUG - {"message": "Command succeeded", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "durationMS": 10.576, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"68caccae78be70bd3047b1dd\"}, \"event_id\": \"2619316295\", \"event_name\": \"RoCE\u4ea4\u6362\u673a\u7aef\u53e3\u51fa\u73b0CRC\u9519\u8bef\", \"event_code\": \"CRC_ERROR\", \"idc\": \"QHDX01\", \"hostname\": \"QH-QHDX-AZ-ROCE_TOR-02_01_07_08.QH\", \"portname\": \"FourHundredGigE1/0/3\", \"rack\": \"QHDX013F02-05-10-22\", \"product_type\": \"\u4ea4\u6362\u673a\", \"server_sn\": \"A514359X5108621\", \"server_name\": \"hd1-g8-gm403rs-v7-155454-hslleofm.kscn.idc.xiaomi.com\", \"instance_id\": \"26e3ef8b-1d6e-48ec-9aaa-225dcfca9f31\", \"server_user\": \"\u5c0f\u7c73\u79d1\u6280\u6709\u9650\u8d23\u4efb\u516c\u53f8\", \"server_uid\": \"73406822\", \"server_rack\": \"QHDX013F02-01-04-1\", \"peer_product_type\": \"\u88f8\u91d1\u5c5e\u670d\u52a1\u5668\", \"roce_ip\": \"10.47.27.160\", \"private_ip\": \"10.44.143.108\", \"roce_interface_type\": \"\u8ba1\u7b97\", \"roce_interface_name\": \"\u7f51\u5361_7\", \"first_alarm\": \"2025-09-17 22:58:21\", \"first_ts\": 1758121101838, \"last_alarm\": \"2025-09-17 22:58:21\", \"last_ts\": 17581211018...", "commandName": "getMore", "databaseName": "alertpolicy", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 45853, "serverHost": "10.69.74.235", "serverPort": 8526}
2025-10-19 01:51:39,813 - pymongo.connection - DEBUG - {"message": "Connection checked in", "clientId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "driverConnectionId": 1}
2025-10-19 01:51:39,814 - backend.dataSources.roce_event - INFO - 查询到 106 条记录，返回 106 条
2025-10-19 01:51:39,815 - backend.dataSources.roce_event - INFO - 处理完成，共生成 106 条记录
2025-10-19 01:51:39,816 - data_loader - DEBUG - Loaded 106 records from MongoDB
2025-10-19 01:51:39,817 - data_loader - INFO - ROCE event data load completed (status=0)
2025-10-19 01:51:39,818 - __main__ - DEBUG - Sample record columns: ['事件ID', '事件名称', '产生时间', '交换机名称', '交换机端口名称', '机房', '光模块厂商', '光模块型号', '光模块SN', '光模块是否更换', '集群', '客户信息', '外包单号', '事件完成时间', '事件描述']
2025-10-19 01:51:39,818 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,819 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,820 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:51:39,820 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:51:39,821 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:51:39,822 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,822 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,823 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,823 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:51:39,824 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:51:39,824 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,825 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:51:39,826 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:51:39,826 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:51:39,827 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:51:39,828 - __main__ - INFO - Rebuilt table ROCE网络事件-光模块故障表 from ROCE网络事件-光模块故障表
2025-10-19 01:51:39,828 - __main__ - DEBUG - Sanitized name: 事件ID -> 事件ID
2025-10-19 01:51:39,829 - __main__ - DEBUG - Sanitized name: 事件名称 -> 事件名称
2025-10-19 01:51:39,829 - __main__ - DEBUG - Sanitized name: 产生时间 -> 产生时间
2025-10-19 01:51:39,829 - __main__ - DEBUG - Sanitized name: 交换机名称 -> 交换机名称
2025-10-19 01:51:39,830 - __main__ - DEBUG - Sanitized name: 交换机端口名称 -> 交换机端口名称
2025-10-19 01:51:39,830 - __main__ - DEBUG - Sanitized name: 机房 -> 机房
2025-10-19 01:51:39,831 - __main__ - DEBUG - Sanitized name: 光模块厂商 -> 光模块厂商
2025-10-19 01:51:39,831 - __main__ - DEBUG - Sanitized name: 光模块型号 -> 光模块型号
2025-10-19 01:51:39,831 - __main__ - DEBUG - Sanitized name: 光模块SN -> 光模块SN
2025-10-19 01:51:39,832 - __main__ - DEBUG - Sanitized name: 光模块是否更换 -> 光模块是否更换
2025-10-19 01:51:39,832 - __main__ - DEBUG - Sanitized name: 集群 -> 集群
2025-10-19 01:51:39,832 - __main__ - DEBUG - Sanitized name: 客户信息 -> 客户信息
2025-10-19 01:51:39,833 - __main__ - DEBUG - Sanitized name: 外包单号 -> 外包单号
2025-10-19 01:51:39,833 - __main__ - DEBUG - Sanitized name: 事件完成时间 -> 事件完成时间
2025-10-19 01:51:39,833 - __main__ - DEBUG - Sanitized name: 事件描述 -> 事件描述
2025-10-19 01:51:39,836 - __main__ - INFO - Inserted 106 records into table ROCE网络事件-光模块故障表
2025-10-19 01:51:39,867 - __main__ - INFO - Database built/updated at custom_database.db (rebuild=True, status=0)
2025-10-19 01:51:40,160 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68f3d3ab6dba7b83003abe5b"}, "serverHost": "10.69.74.235", "serverPort": 8526, "awaited": true, "durationMS": 505.5825999879744, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
